/*!
 * LMV v7.47.0
 * 
 * Copyright 2021 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.ModelAlignmentService=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=599)}({10:function(e,t,n){var r=n(32),o=n(33),i=o;i.v1=r,i.v4=o,e.exports=i},22:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},23:function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},32:function(e,t,n){var r,o,i=n(22),a=n(23),u=0,s=0;e.exports=function(e,t,n){var c=t&&n||0,f=t||[],l=(e=e||{}).node||r,p=void 0!==e.clockseq?e.clockseq:o;if(null==l||null==p){var h=i();null==l&&(l=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==p&&(p=o=16383&(h[6]<<8|h[7]))}var v=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:s+1,d=v-u+(m-s)/1e4;if(d<0&&void 0===e.clockseq&&(p=p+1&16383),(d<0||v>u)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=v,s=m,o=p;var g=(1e4*(268435455&(v+=122192928e5))+m)%4294967296;f[c++]=g>>>24&255,f[c++]=g>>>16&255,f[c++]=g>>>8&255,f[c++]=255&g;var y=v/4294967296*1e4&268435455;f[c++]=y>>>8&255,f[c++]=255&y,f[c++]=y>>>24&15|16,f[c++]=y>>>16&255,f[c++]=p>>>8|128,f[c++]=255&p;for(var b=0;b<6;++b)f[c+b]=l[b];return t||a(f)}},33:function(e,t,n){var r=n(22),o=n(23);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var u=0;u<16;++u)t[i+u]=a[u];return t||o(a)}},599:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function u(e){r(a,o,i,u,s,"next",e)}function s(e){r(a,o,i,u,s,"throw",e)}u(void 0)}))}}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,"default",(function(){return qe}));var a=AutodeskNamespace("Autodesk.AlignmentService"),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,a,u,s,c,f,l,p,h,v,m,d,g;return t=e,(n=[{key:"isWorking",value:function(){return!0}},{key:"clearCache",value:function(){}},{key:"fetchItems",value:(g=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return g.apply(this,arguments)})},{key:"loadTransform",value:(d=o(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)}))),function(e,t){return d.apply(this,arguments)})},{key:"getTransform",value:function(e,t){return null}},{key:"getIsLocked",value:function(e,t){return!1}},{key:"saveTransform",value:(m=o(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t,n){return m.apply(this,arguments)})},{key:"lockAlignment",value:(v=o(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return v.apply(this,arguments)})},{key:"unlockAlignment",value:(h=o(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},{key:"isAlignmentLocked",value:(p=o(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return p.apply(this,arguments)})},{key:"saveRegion",value:(l=o(regeneratorRuntime.mark((function e(t,n,r,o,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o){return l.apply(this,arguments)})},{key:"loadRegion",value:(f=o(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return f.apply(this,arguments)})},{key:"loadRegions",value:(c=o(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)})},{key:"deleteRegion",value:(s=o(regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return s.apply(this,arguments)})},{key:"saveRelationship",value:(u=o(regeneratorRuntime.mark((function e(t,n,r,o,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o){return u.apply(this,arguments)})},{key:"getRelationships",value:(a=o(regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"deleteRelationship",value:function(e){}}])&&i(t.prototype,n),r&&i(t,r),e}();a.RelationshipEntityTypes={Model3D:"viewpart3d",Region:"viewpartregion2d"},a.RelationshipIdPrefix={Name:"viewablePart=",Region:"&region="};var s=n(10);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,u,"next",e)}function u(e){f(i,r,o,a,u,"throw",e)}a(void 0)}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g(this,n)}}function g(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=Autodesk.Viewing.Private,k="Autodesk.Viewing.ModelAlignment",w="transform",x="relationship",R=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return"".concat(k).concat("__").concat(e).concat("__").concat(t).concat(n.length?"".concat("__").concat(n):"")},I=function(e){return{transform:e?e.elements:null,isLocked:!1}},A=function(e,t,n){return"".concat(e,"?").concat(Autodesk.AlignmentService.RelationshipIdPrefix.Name).concat(t).concat(n?"".concat(Autodesk.AlignmentService.RelationshipIdPrefix.Region).concat(n):"")},P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(y,e);var t,n,r,o,i,a,u,c,f,h,g=d(y);function y(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.LocalStorage;return p(this,y),(e=g.call(this)).localStorage=t,e}return v(y,[{key:"getTransform",value:function(e,t){var n=this.loadItem(w,e,t);return(null==n?void 0:n.transform)||null}},{key:"getIsLocked",value:function(e,t){var n=this.loadItem(w,e,t);return Boolean(null==n?void 0:n.isLocked)}},{key:"loadTransform",value:(h=l(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.loadItem(w,t,n),e.abrupt("return",null==r?void 0:r.transform);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"saveTransform",value:(f=l(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=this.loadItem(w,t,n)||I()).transform=r,e.abrupt("return",this.saveItem(w,t,n,o));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return f.apply(this,arguments)})},{key:"lockAlignment",value:(c=l(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=this.loadItem(w,t,n)||I()).isLocked=!0,e.abrupt("return",this.saveItem(w,t,n,r));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"isAlignmentLocked",value:(u=l(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getIsLocked(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"saveRegion",value:(a=l(regeneratorRuntime.mark((function e(t,n,r,o,i){var a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=this.loadItem(w,t,n)||I()).regions||(a.regions=[]),-1===(u=a.regions.findIndex((function(e){return e.regionId===r})))&&(u=a.regions.length),a.regions[u]={regionId:r,boundingBox:o,transform:i},e.abrupt("return",this.saveItem(w,t,n,a));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o){return a.apply(this,arguments)})},{key:"loadRegion",value:(i=l(regeneratorRuntime.mark((function e(t,n,r){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadRegions(t,n);case 2:return o=e.sent,i=o.find((function(e){return e.regionId===r})),e.abrupt("return",i||null);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"loadRegions",value:(o=l(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.loadItem(w,t,n),o=null==r?void 0:r.regions,e.abrupt("return",o||[]);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"deleteRegion",value:(r=l(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getRelationships(Autodesk.AlignmentService.RelationshipEntityTypes.Region,t,r,o),this.deleteRelationship(i.id),a=this.loadItem(w,n,r),u=null==a?void 0:a.regions){e.next=7;break}return console.warn("No regions to delete"),e.abrupt("return");case 7:region.length>1?(a.regions=u.filter((function(e){return e.regionId!==o})),this.saveItem(w,n,r,a)):this.deleteItem(w,n,r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n,o){return r.apply(this,arguments)})},{key:"saveRelationship",value:(n=l(regeneratorRuntime.mark((function e(t,n,r,o,i){var a,u,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=A(r,o,i),u=A(t,n),c=Object(s.v4)(),f={id:c,entities:[{domain:"autodesk-construction-alignment",type:Autodesk.AlignmentService.RelationshipEntityTypes.Region,id:a},{domain:"autodesk-construction-alignment",type:Autodesk.AlignmentService.RelationshipEntityTypes.Model3D,id:u}]},e.abrupt("return",this.saveItem(x,c,void 0,f));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r,o,i){return n.apply(this,arguments)})},{key:"getRelationships",value:(t=l(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,s,c,f,l,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=[],a=A(n,r,o),u=b.LocalStorage.getAllKeys(),s=0;s<u.length;s++)-1!==(c=u[s]).indexOf(x)&&(l=b.LocalStorage.getItem(c),(null==(p=l&&JSON.parse(l))||null===(f=p.entities)||void 0===f?void 0:f.some((function(e){return e.id===a&&e.type===t})))&&i.push(p));return e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)}))),function(e,n,r,o){return t.apply(this,arguments)})},{key:"deleteRelationship",value:function(e){this.deleteItem(x,e)}},{key:"loadItem",value:function(e,t,n){var r=R(e,t,n),o=this.localStorage.getItem(r),i=o&&JSON.parse(o);return(null==i?void 0:i.transform)&&(i.transform=new b.LmvMatrix4(!0).fromArray(i.transform)),(null==i?void 0:i.regions)&&(i.regions=i.regions.map((function(e){return e.transform&&(e.transform=new b.LmvMatrix4(!0).fromArray(e.transform)),e.boundingBox=(new THREE.Box2).set({x:e.boundingBox[0],y:e.boundingBox[1]},{x:e.boundingBox[2],y:e.boundingBox[3]}),e}))),i}},{key:"saveItem",value:function(e,t,n,r){var o,i;(null===(o=r)||void 0===o?void 0:o.transform)&&((r=Object.assign({},r)).transform=Array.from(r.transform.elements)),(null===(i=r)||void 0===i?void 0:i.regions)&&((r=Object.assign({},r)).regions=r.regions.map((function(e){var t=Object.assign({},e);return t.transform&&(t.transform=Array.from(t.transform.elements)),t.boundingBox=[t.boundingBox.min.x,t.boundingBox.min.y,t.boundingBox.max.x,t.boundingBox.max.y],t})));var a=R(e,t,n),u=JSON.stringify(r);return this.localStorage.setItem(a,u),!0}},{key:"deleteItem",value:function(e,t,n){var r=R(e,t,n);this.localStorage.removeItem(r)}}]),y}(u),O=function(){function e(){p(this,e),this.data={}}return v(e,[{key:"setItem",value:function(e,t){this.data[e]=t}},{key:"getItem",value:function(e){return this.data[e]}}]),e}();function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}u.ObjectLocalStorage=O;var T=Autodesk.Viewing.Private,E=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init(t)}var t,n,r;return t=e,(n=[{key:"init",value:function(e){this.checksum=void 0,this.transform=null,this.isLocked=!1,this.updatedAt=void 0,this.updatedBy=void 0,this.versionUrn=null==e?void 0:e.versionUrn,this.viewablePartId=null==e?void 0:e.viewablePartId,this.regions=void 0}},{key:"isDefaultState",value:function(){return!this.transform&&!this.isLocked&&!this.regions}},{key:"resetToDefaultState",value:function(){this.transform=null,this.isLocked=!1,this.regions=null}},{key:"createNew",value:function(e,t){return this.init(),this.versionUrn=e.versionUrn,this.viewablePartId=e.viewablePartId,this.transform=t,this}},{key:"load",value:function(e){return this.versionUrn=T.toUrlSafeBase64(e.versionUrn),this.viewablePartId=e.viewablePartId,e.regions&&(this.regions=e.regions.map((function(e){return e.transform&&(e.transform=new T.LmvMatrix4(!0).fromArray(e.transform)),e.boundingBox=(new THREE.Box2).set({x:e.boundingBox[0],y:e.boundingBox[1]},{x:e.boundingBox[2],y:e.boundingBox[3]}),e}))),this.checksum=e.checksum,this.isLocked=e.isLocked||!1,this.updatedAt=e.updatedAt,this.updatedBy=e.updatedBy,this.transform=Array.isArray(null==e?void 0:e.transform)?new T.LmvMatrix4(!0).fromArray(null==e?void 0:e.transform):null,this}},{key:"existsOnServer",value:function(){return Boolean(this.checksum)}},{key:"toObject",value:function(){return{checksum:this.checksum,isLocked:this.isLocked,transform:this.transform&&Array.from(this.transform.elements),regions:this.regions?this.regions.map((function(e){var t=Object.assign({},e);return t.transform&&(t.transform=Array.from(t.transform.elements)),t.boundingBox=[t.boundingBox.min.x,t.boundingBox.min.y,t.boundingBox.max.x,t.boundingBox.max.y],t})):void 0,versionUrn:T.fromUrlSafeBase64(this.versionUrn),viewablePartId:this.viewablePartId}}}])&&S(t.prototype,n),r&&S(t,r),e}();function j(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function _(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){j(i,r,o,a,u,"next",e)}function u(e){j(i,r,o,a,u,"throw",e)}a(void 0)}))}}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._fetchItems=t,this.cache={},this.urnToRequestIndex={},this.pendingRequests=[null]}var t,n,r,o,i;return t=e,(n=[{key:"clear",value:function(){this.cache={}}},{key:"fetchItems",value:(i=_(regeneratorRuntime.mark((function e(t){var n,r,o,i,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(e){return!a.cache[e.toString()]},(t=t.filter(n)).length){e.next=4;break}return e.abrupt("return");case 4:for(r=1;this.pendingRequests[r];)r++;return t.forEach((function(e){return a.urnToRequestIndex[e.toString()]=r})),o=this._fetchItems(t),this.pendingRequests[r]=o,e.next=11,o;case 11:i=e.sent,this.pendingRequests[r]=null,i&&t.forEach((function(e){var t=e.toString();a.cache[t]=i[t]})),t.forEach((function(e){delete a.urnToRequestIndex[e.toString()]}));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getCachedItem",value:function(e){var t=e.toString();return this.cache[t]}},{key:"getItem",value:(o=_(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getCachedItem(t))){e.next=3;break}return e.abrupt("return",n);case 3:if(r=t.toString(),!(o=this.urnToRequestIndex[r])){e.next=10;break}return e.next=8,this.pendingRequests[o];case 8:e.next=12;break;case 10:return e.next=12,this.fetchItems([t]);case 12:return e.abrupt("return",this.getCachedItem(t));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"setItem",value:function(e,t){var n=e.toString();this.cache[n]=t}}])&&B(t.prototype,n),r&&B(t,r),e}();function U(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){U(i,r,o,a,u,"next",e)}function u(e){U(i,r,o,a,u,"throw",e)}a(void 0)}))}}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var M=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxAttempts=10,this.startDelay=100,this.growFactor=1.1}var t,n,r;return t=e,(n=[{key:"getWaitingTime",value:function(e){return e?this.startDelay*Math.pow(this.growFactor,e-1):0}},{key:"run",value:function(e,t){var n=this;return new Promise((function(r){var o=0,i=function(){var a=C(regeneratorRuntime.mark((function a(){var u,s;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e();case 2:if(u=a.sent,!t(u)){a.next=5;break}return a.abrupt("return",r(u));case 5:if(!(++o>=n.maxAttempts)){a.next=8;break}return a.abrupt("return",r(u));case 8:s=n.getWaitingTime(o),window.setTimeout(i,s);case 10:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();i()}))}}])&&q(t.prototype,n),r&&q(t,r),e}(),D=function(){var e=C(regeneratorRuntime.mark((function e(t,n,r){var o,i,a,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=u.length>3&&void 0!==u[3]?u[3]:null,i={success:!1,data:null},e.next=4,t();case 4:return a=e.sent,e.next=7,new Promise((function(e){var t=new XMLHttpRequest;t.open(r,n,!0),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("accept","application/json"),t.setRequestHeader("Access-Control-Allow-Origin","*"),t.setRequestHeader("Authorization","Bearer "+a);var u=function(){e(i)};t.onload=function(){if(t.status<200||t.status>=300)u();else try{i.data=t.response?JSON.parse(t.response):null,i.success=!0,e(i)}catch(e){u()}},t.onerror=u,t.ontimeout=u,t.onabort=u,t.send(o&&JSON.stringify(o))}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),N=function(){var e=C(regeneratorRuntime.mark((function e(t,n,r,o){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(){return D(t,n,r,o)},a=function(e){return e.success},e.next=4,(new M).run(i,a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r,o){return e.apply(this,arguments)}}();function V(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function H(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){V(i,r,o,a,u,"next",e)}function u(e){V(i,r,o,a,u,"throw",e)}a(void 0)}))}}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t,n){return t&&W(e.prototype,t),n&&W(e,n),e}var Q=Autodesk.Viewing,z=Q.Private;function G(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var K=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;J(this,e),this.versionUrn=t,this.viewablePartId=n}return F(e,[{key:"toObject",value:function(){return{versionUrn:z.fromUrlSafeBase64(this.versionUrn),viewablePartId:this.viewablePartId||void 0}}},{key:"toString",value:function(){return"".concat(this.versionUrn).concat(this.viewablePartId?"__".concat(this.viewablePartId):"")}}],[{key:"fromUrns",value:function(t){return t&&t.map((function(t){return new e(t)}))}}]),e}(),X=function(e){var t=Q.EnvironmentConfigurations[Q.getEnv()];return(t.UPSTREAM||t.ROOT)+"/construction/alignment"+("QA"===e?"-dev":"")},Y=function(){return Q.token.accessToken},Z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.projectId,r=t.getAccessToken,o=void 0===r?Y:r,i=t.docsEnv,a=void 0===i?"":i,u=t.serviceBaseUrl,s=void 0===u?X(a):u,c=t.serviceVersion,f=void 0===c?"v1":c,l=t.onError,p=void 0===l?null:l;J(this,e),this.projectId=n,this.getAccessToken=o,this.onError=p,this.serviceUrl="".concat(s,"/").concat(f),this.itemsEndPoint="/projects/".concat(n,"/spaces/").concat("default","/items"),this.url=this.serviceUrl+this.itemsEndPoint}var t,n,r,o,i;return F(e,[{key:"fetchItems",value:(i=H(regeneratorRuntime.mark((function e(t){var n,r,o,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},t.length){e.next=3;break}return e.abrupt("return",n);case 3:return r=G(t,20),o=r.map((function(e){return i._doBatchRequest(e,n)})),e.next=8,Promise.all(o);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"_doBatchRequest",value:(o=H(regeneratorRuntime.mark((function e(t,n){var r,o,i,a,u,s,c,f,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r={},o=0;o<t.length;o++)r[o]=t[o].toObject();return e.next=5,N(this.getAccessToken,this.url+":getBatch","POST",r);case 5:if((i=e.sent).success){e.next=9;break}return this.onError(),e.abrupt("return");case 9:if(a=i.data){e.next=13;break}return console.warn("Unepxected request response: items:getBatch should get an empty response"),e.abrupt("return");case 13:for(u=a.results,s=0;s<t.length;s++)c=new K(t[s].versionUrn,t[s].viewablePartId),f=c.toString(),l=u&&u[s],n[f]=l?(new E).load(l):new E(c);return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"saveItem",value:(r=H(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.toObject(),r=t.existsOnServer()?"PATCH":"POST",e.next=4,N(this.getAccessToken,this.url,r,n);case 4:if((o=e.sent).success){e.next=8;break}return this.onError(),e.abrupt("return",!1);case 8:return o.data?t.load(o.data):(t.checksum=void 0,"DELETE"==r||console.warn("Unexpected request result: POST or PATCH should always respond an update item state")),e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"deleteItem",value:(n=H(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.toObject(),e.next=3,N(this.getAccessToken,this.url,"DELETE",n);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setItemLocked",value:(t=H(regeneratorRuntime.mark((function e(t,n){var r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.toObject(),o={versionUrn:r.versionUrn,viewablePartId:r.viewablePartId},i=n?":lock":":unlock",e.next=5,N(this.getAccessToken,this.url+i,"PATCH",o);case 5:if((a=e.sent).success){e.next=9;break}return this.onError(),e.abrupt("return");case 9:t.load(a.data);case 10:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}();function $(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function ee(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){$(i,r,o,a,u,"next",e)}function u(e){$(i,r,o,a,u,"throw",e)}a(void 0)}))}}function te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var re=Autodesk.Viewing,oe=(re.Private,function(e){var t=re.EnvironmentConfigurations[re.getEnv()];return(t.UPSTREAM||t.ROOT)+"/bim360/relationship"+("QA"===e?"-dev":"")}),ie=function(){return re.token.accessToken},ae=function(e,t,n){return"".concat(e,"?").concat(Autodesk.AlignmentService.RelationshipIdPrefix.Name).concat(encodeURIComponent(t)).concat(n?"".concat(Autodesk.AlignmentService.RelationshipIdPrefix.Region).concat(n):"")},ue="autodesk-construction-alignment",se=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.projectId,r=t.getAccessToken,o=void 0===r?ie:r,i=t.docsEnv,a=void 0===i?"":i,u=t.serviceBaseUrl,s=void 0===u?oe(a):u,c=t.serviceVersion,f=void 0===c?"v2":c,l=t.onError,p=void 0===l?null:l;te(this,e),this.projectId=n,this.getAccessToken=o,this.onError=p,this.serviceUrl="".concat(s,"/").concat(f),this.itemsEndPoint="/containers/".concat(n,"/relationships"),this.url=this.serviceUrl+this.itemsEndPoint}var t,n,r,o,i,a;return t=e,(n=[{key:"getRelationships",value:(a=ee(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,s,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ae(n,r,o),u=encodeURIComponent(a),s=":search?domain=".concat(ue,"&type=").concat(t,"&id=").concat(u),e.next=5,N(this.getAccessToken,this.url+s,"GET");case 5:if((c=e.sent).success){e.next=9;break}return this.onError(),e.abrupt("return",[]);case 9:if(f=null===(i=c.data)||void 0===i?void 0:i.relationships){e.next=13;break}return console.warn("Unepxected request response: relationships:search should get an empty array"),e.abrupt("return",[]);case 13:return f.forEach((function(e){e.entities.forEach((function(e){e.id=decodeURIComponent(e.id)}))})),e.abrupt("return",f);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"saveRelationship",value:(i=ee(regeneratorRuntime.mark((function e(t,n,r,o,i){var a,u,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ae(r,o,i),u=ae(t,n),s={entities:[{domain:ue,type:Autodesk.AlignmentService.RelationshipEntityTypes.Region,id:a},{domain:ue,type:Autodesk.AlignmentService.RelationshipEntityTypes.Model3D,id:u}]},c=[s],e.next=6,N(this.getAccessToken,this.url,"PUT",c);case 6:if(e.sent.success){e.next=10;break}return this.onError(),e.abrupt("return",!1);case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o){return i.apply(this,arguments)})},{key:"deleteRelationship",value:(o=ee(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[t],e.next=4,N(this.getAccessToken,this.url+":delete","POST",n);case 4:if(e.sent.success){e.next=8;break}return this.onError(),e.abrupt("return");case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})}])&&ne(t.prototype,n),r&&ne(t,r),e}();function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function le(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){fe(i,r,o,a,u,"next",e)}function u(e){fe(i,r,o,a,u,"throw",e)}a(void 0)}))}}function pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ve(e,t){return(ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ye(e);if(t){var o=ye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return de(this,n)}}function de(e,t){return!t||"object"!==ce(t)&&"function"!=typeof t?ge(e):t}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ve(e,t)}(b,e);var t,n,r,o,i,a,u,s,c,f,l,p,h,v,m,d,g,y=me(b);function b(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};pe(this,b);var n=(e=y.call(this)).onError.bind(ge(e));t.onError=n,e.alignmentApi=new Z(t),e.relationshipApi=new se(t);var r=function(){var t=le(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.alignmentApi.fetchItems(n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return e.cache=new L(r),e}return t=b,(n=[{key:"fetchItems",value:(g=le(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=K.fromUrns(t),e.next=3,this.cache.fetchItems(n);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"getTransform",value:function(e,t){var n=new K(e,t),r=this.cache.getCachedItem(n);if(r)return r.transform?r.transform.clone():null}},{key:"getIsLocked",value:function(e,t){var n=new K(e,t),r=this.cache.getCachedItem(n);return r?Boolean(r.isLocked):void 0}},{key:"loadTransform",value:(d=le(regeneratorRuntime.mark((function e(t,n){var r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new K(t,n),e.next=3,this.cache.getItem(o);case 3:return i=e.sent,e.abrupt("return",(null==i||null===(r=i.transform)||void 0===r?void 0:r.clone())||null);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"saveTransform",value:(m=le(regeneratorRuntime.mark((function e(t,n,r){var o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new K(t,n),e.next=3,this.cache.getItem(i);case 3:if(a=e.sent,u=null===(o=a)||void 0===o?void 0:o.transform,s=r,!(!u&&!s||u&&s&&s.equals(u))){e.next=6;break}return e.abrupt("return",!0);case 6:return a?a.transform=r:(a=(new E).createNew(i,r),this.cache.setItem(i,a)),e.next=9,this.alignmentApi.saveItem(a);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}var u,s}),e,this)}))),function(e,t,n){return m.apply(this,arguments)})},{key:"lockAlignment",value:(v=le(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new K(t,n),e.next=3,this.cache.getItem(r);case 3:if(!(o=e.sent).isLocked){e.next=6;break}return e.abrupt("return");case 6:if(o.existsOnServer()){e.next=10;break}return e.next=10,this.alignmentApi.saveItem(o);case 10:return e.next=12,this.alignmentApi.setItemLocked(o,!0);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"unlockAlignment",value:(h=le(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new K(t,n),e.next=3,this.cache.getItem(r);case 3:if((o=e.sent)&&o.isLocked){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.alignmentApi.setItemLocked(o,!1);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"isAlignmentLocked",value:(p=le(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new K(t,n),e.next=3,this.cache.getItem(r);case 3:return o=e.sent,e.abrupt("return",Boolean(null==o?void 0:o.isLocked));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"saveRegion",value:(l=le(regeneratorRuntime.mark((function e(t,n,r,o,i){var a,u,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new K(t,n),e.next=3,this.cache.getItem(a);case 3:return(u=e.sent)||(u=(new E).createNew(a,i),this.cache.setItem(a,u)),u.regions||(u.regions=[]),-1===(s=u.regions.findIndex((function(e){return e.regionId===r})))&&(s=u.regions.length),u.regions[s]={regionId:r,boundingBox:o,transform:i},e.next=11,this.alignmentApi.saveItem(u);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o){return l.apply(this,arguments)})},{key:"loadRegions",value:(f=le(regeneratorRuntime.mark((function e(t,n){var r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new K(t,n),e.next=3,this.cache.getItem(r);case 3:return o=e.sent,i=null==o?void 0:o.regions,e.abrupt("return",i||[]);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"loadRegion",value:(c=le(regeneratorRuntime.mark((function e(t,n,r){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadRegions(t,n);case 2:return o=e.sent,i=o.find((function(e){return e.regionId===r})),e.abrupt("return",i||null);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"deleteRegion",value:(s=le(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,s,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new K(n,r),e.next=3,this.getRelationships(Autodesk.AlignmentService.RelationshipEntityTypes.Region,t,r,o);case 3:if((a=e.sent).length){e.next=6;break}throw"No relationship to delete";case 6:return e.prev=6,e.next=9,Promise.all(a.map((function(e){return c.deleteRelationship(e.id)})));case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(6),e.t0;case 14:return e.next=16,this.cache.getItem(i);case 16:if(u=e.sent,s=null==u?void 0:u.regions){e.next=21;break}return console.warn("No regions to delete"),e.abrupt("return");case 21:if(!(s.length>1)){e.next=27;break}return u.regions=s.filter((function(e){return e.regionId!==o})),e.next=25,this.alignmentApi.saveItem(u);case 25:e.next=28;break;case 27:this.deleteItem(n,r);case 28:case"end":return e.stop()}}),e,this,[[6,11]])}))),function(e,t,n,r){return s.apply(this,arguments)})},{key:"getRelationships",value:(u=le(regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.relationshipApi.getRelationships(t,n,r,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return u.apply(this,arguments)})},{key:"saveRelationship",value:(a=le(regeneratorRuntime.mark((function e(t,n,r,o,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.relationshipApi.saveRelationship(t,n,r,o,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o){return a.apply(this,arguments)})},{key:"deleteRelationship",value:(i=le(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.relationshipApi.deleteRelationship(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onError",value:function(){this.error=!0}},{key:"isWorking",value:function(){return!this.error}},{key:"clearCache",value:function(){this.cache.clear()}},{key:"deleteItem",value:(o=le(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new K(t,n),e.next=3,this.cache.getItem(r);case 3:if((o=e.sent).existsOnServer()){e.next=6;break}return e.abrupt("return");case 6:if(!o.isLocked){e.next=9;break}return e.next=9,this.unlockAlignment(t,n);case 9:return this.cache.setItem(r,null),e.next=12,this.alignmentApi.deleteItem(r);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})}])&&he(t.prototype,n),r&&he(t,r),b}(u);function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function xe(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){we(i,r,o,a,u,"next",e)}function u(e){we(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ie(e,t,n){return(Ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Se(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Se(e);if(t){var o=Se(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}function Oe(e,t){return!t||"object"!==ke(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(s,e);var t,n,r,o,i,a,u=Pe(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=u.call(this,e)).items={},t}return t=s,(n=[{key:"getTransform",value:function(e,t){var n=this.getOverrideTransform(e,t);return void 0!==n?n?n.clone():null:Ie(Se(s.prototype),"getTransform",this).call(this,e,t)}},{key:"getIsLocked",value:function(e,t){return void 0!==this.getOverrideTransform(e,t)||Ie(Se(s.prototype),"getIsLocked",this).call(this,e,t)}},{key:"isAlignmentLocked",value:(a=xe(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.getOverrideTransform(t,n)){e.next=3;break}return e.abrupt("return",!0);case 3:return e.next=5,Ie(Se(s.prototype),"isAlignmentLocked",this).call(this,t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"loadTransform",value:(i=xe(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(r=this.getOverrideTransform(t,n))){e.next=3;break}return e.abrupt("return",r);case 3:return e.next=5,Ie(Se(s.prototype),"loadTransform",this).call(this,t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"setOverrideTransforms",value:function(e){this.items=e}},{key:"clearRedundantOverrides",value:(o=xe(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object.keys(this.items),e.next=3,this.fetchItems(t);case 3:n={},t.forEach((function(e){var t=new K(e),o=r.cache.getCachedItem(t),i=r.items[e],a=o.checksum==i.checksum;(null===i.checksum&&null===i.transform&&null===o.transform?o.versionUrn==e:a)||(n[e]=i)})),this.items=n;case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getOverrideTransform",value:function(e,t){if(!t){var n=this.items[e];if(n)return n.transform?n.transform.clone():null}}}])&&Re(t.prototype,n),r&&Re(t,r),s}(be);function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Le(e);if(t){var o=Le(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Be(this,n)}}function Be(e,t){return!t||"object"!==Ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Le(e){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ue=Autodesk.Viewing,Ce=AutodeskNamespace("Autodesk.ModelAlignmentService"),qe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(n,e);var t=_e(n);function n(e,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e,r)}return n}(Ue.Extension);Ue.theExtensionManager.registerExtension("Autodesk.ModelAlignmentService",qe),Ce.AlignmentService=u,Ce.AlignmentServiceLS=P,Ce.NucleusAlignmentAPI=Z,Ce.AlignmentServiceNucleus=be,Ce.AlignmentServiceNucleusOverridable=Te}});
//# sourceMappingURL=ModelAlignmentService.min.js.map
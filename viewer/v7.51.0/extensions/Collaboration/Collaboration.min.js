/*!
 * LMV v7.51.0
 * 
 * Copyright 2021 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.Collaboration=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=815)}({2:function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var o=(r=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),a=i.sources.map((function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"}));return[n].concat(a).concat([o]).join("\n")}var r;return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(i[a]=!0)}for(o=0;o<t.length;o++){var r=t[o];"number"==typeof r[0]&&i[r[0]]||(n&&!r[2]?r[2]=n:n&&(r[2]="("+r[2]+") and ("+n+")"),e.push(r))}},e}},3:function(t,e,n){var i,o,a={},r=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=i.apply(this,arguments)),o}),s=function(t,e){return e?e.querySelector(t):document.querySelector(t)},l=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var i=s.call(this,t,n);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),c=null,d=0,h=[],u=n(5);function p(t,e){for(var n=0;n<t.length;n++){var i=t[n],o=a[i.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](i.parts[r]);for(;r<i.parts.length;r++)o.parts.push(x(i.parts[r],e))}else{var s=[];for(r=0;r<i.parts.length;r++)s.push(x(i.parts[r],e));a[i.id]={id:i.id,refs:1,parts:s}}}}function f(t,e){for(var n=[],i={},o=0;o<t.length;o++){var a=t[o],r=e.base?a[0]+e.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};i[r]?i[r].parts.push(s):n.push(i[r]={id:r,parts:[s]})}return n}function v(t,e){var n=l(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=h[h.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),h.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=l(t.insertAt.before,n);n.insertBefore(e,o)}}function b(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=h.indexOf(t);e>=0&&h.splice(e,1)}function g(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return n.nc}();i&&(t.attrs.nonce=i)}return m(e,t.attrs),v(t,e),e}function m(t,e){Object.keys(e).forEach((function(n){t.setAttribute(n,e[n])}))}function x(t,e){var n,i,o,a;if(e.transform&&t.css){if(!(a="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=a}if(e.singleton){var r=d++;n=c||(c=g(e)),i=w.bind(null,n,r,!1),o=w.bind(null,n,r,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",m(e,t.attrs),v(t,e),e}(e),i=L.bind(null,n,e),o=function(){b(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(e),i=C.bind(null,n),o=function(){b(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else o()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=r()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=f(t,e);return p(n,e),function(t){for(var i=[],o=0;o<n.length;o++){var r=n[o];(s=a[r.id]).refs--,i.push(s)}t&&p(f(t,e),e);for(o=0;o<i.length;o++){var s;if(0===(s=i[o]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete a[s.id]}}}};var y,E=(y=[],function(t,e){return y[t]=e,y.filter(Boolean).join("\n")});function w(t,e,n,i){var o=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=E(e,o);else{var a=document.createTextNode(o),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(a,r[e]):t.appendChild(a)}}function C(t,e){var n=e.css,i=e.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function L(t,e,n){var i=n.css,o=n.sourceMap,a=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||a)&&(i=u(i)),o&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([i],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(r),s&&URL.revokeObjectURL(s)}},5:function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var o,a=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(o=0===a.indexOf("//")?a:0===a.indexOf("/")?n+a:i+a.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},544:function(t,e,n){var i=n(545);"string"==typeof i&&(i=[[t.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(3)(i,o);i.locals&&(t.exports=i.locals)},545:function(t,e,n){(t.exports=n(2)(!1)).push([t.i,".collabPanel{width:240px;min-width:240px;top:180px;left:220px;line-height:14px;border-spacing:1px;border-collapse:separate;color:#f4f4f4;resize:none;background:rgba(34,34,34,0.8)}.collabPanel .adsk-lmv-tftable{margin:0;width:100%}.adsk-lmv-tftable td{width:auto}.collabPanelContent{width:100%;height:calc(100% - 55px);resize:none;position:relative}.userListTable{max-height:180px;overflow-y:auto}.textEntry{color:#ffffff;font-size:12px;background:rgba(34,34,34,0.5)}.chatPanel{margin:1px;width:100%}.collabPanel input{width:calc(100% - 12px);border:0;padding:5px;resize:none}.videoPanel{position:relative;margin:1px;width:100%;max-height:720px}.videoMain{width:100%;height:100%}.videoInset{position:absolute;width:25%;height:25%;right:1px;bottom:1px}.chatHistory{margin:1px;width:100%;min-height:80px;max-height:180px;resize:none;border:0;overflow-y:auto}.chatHistory p{display:block;margin-top:6px;margin-bottom:1px;margin-left:0;margin-right:0;font-style:italic;font-weight:bold;color:#dddddd}.chatHistory .messageText{margin-top:2px}.statusBase{font-size:15px;text-align:center}.statusNormal{color:lime}.statusInControl{color:lime}.callButton{width:14px;color:#008000;cursor:pointer}.callButton:hover{color:#00ff00;cursor:pointer}.cameraButton{width:14px;color:#008000;cursor:pointer}.cameraButton:hover{color:#00ff00;cursor:pointer}.cameraDisconnectButton{color:#ffffff;cursor:pointer}.collabPointer{background-color:#ff0000;position:absolute;width:12px;height:12px;border-radius:50%}.collabBox{position:absolute;z-index:1;left:50%;top:50%;width:280px;height:auto;max-width:80%;background:rgba(34,34,34,0.8);padding:10px;visibility:hidden;border-radius:5px;border-width:1px;border-color:#b8b8b8;border-style:solid;white-space:-moz-pre-wrap;white-space:pre-line;word-wrap:break-word;word-break:break-all;transform:translate(-50%, -50%);-webkit-transform:translate(-50%, -50%);-moz-transform:translate(-50%, -50%)}.collabBoxTitle{color:#ffffff;display:block;word-wrap:break-word;word-break:break-all;font-size:14px;min-height:14px;padding:1px 1px 5px 1px;border-bottom:1px solid #c8c8c8;text-transform:uppercase;font-weight:bold;line-height:14px;resize:none;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.collabBoxText{display:block;color:#ffffff;word-wrap:break-word;word-break:break-word;font-size:12px;font-weight:bold;min-height:12px;margin:10px 0px 5px 0px;padding:3px}.collabBoxContent{color:#ffffff;margin-top:10px;font-size:12px;min-height:12px;list-style:disc}.collabBoxOK{display:block;z-index:2;width:120px;height:auto;margin-left:auto;float:right;line-height:20px;text-align:center;color:#ffffff;font-size:14px;background:rgba(0,0,0,0);border-radius:2px;border-width:1px;border-color:#505050;border-style:solid;padding:3px;cursor:pointer;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.collabBoxCopy{z-index:2;width:100px;height:auto;float:right;margin-left:auto;line-height:20px;text-align:center;color:#ffffff;font-size:14px;background:rgba(0,0,0,0);border-radius:2px;border-width:1px;border-color:#505050;border-style:solid;padding:3px;cursor:pointer;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.collabBoxCopy:hover{border-color:#eeeeee;background:#484848}.collabBoxOK:hover{border-color:#eeeeee;background:#484848}.collabBoxClose{position:absolute;top:0px;right:0px;padding:5px 10px 5px 0px;text-transform:uppercase;font-size:24px;font-weight:bold;line-height:24px;color:#e0e0e0;cursor:pointer}.collabBoxClose:hover{color:#E2580B}.collabBoxInputContainer input{background:rgba(55,55,55,0.5);color:#ffffff;width:97%;margin:2px 0 13px 0;padding:3px}.collabInviteButton{height:20px;display:block;font-size:14px;text-align:center}.collabInviteButton:hover{background-color:rgba(166,194,255,0.7);transition:all 0.2s ease;color:#ffffff;display:block;font-size:14px;text-align:center;cursor:pointer}\n",""])},815:function(t,e,n){"use strict";n.r(e),n.d(e,"Collaboration",(function(){return b}));var i=Autodesk.Viewing,o=i.Private;function a(t){this.getNames=function(){return["intercept"]},this.getName=function(){return"intercept"},this.activate=function(t){},this.deactivate=function(t){},this.update=function(t){return!1},this.handleSingleClick=function(t,e){return!1},this.handleDoubleClick=function(t,e){return!1},this.handleSingleTap=function(t){return!1},this.handleDoubleTap=function(t,e){return!1},this.handleKeyDown=function(t,e){return!1},this.handleKeyUp=function(t,e){return!1},this.handleWheelInput=function(e){return t.takeControl(),!1},this.handleButtonDown=function(e,n){return t.takeControl(),!1},this.handleButtonUp=function(t,e){return!1},this.handleMouseMove=function(e){return t.updatePointer(e),!1},this.handleGesture=function(e){return t.takeControl(),!1},this.handleBlur=function(t){return!1},this.handleResize=function(){}}function r(t){var e,n,a=this,r=this.viewer=null,s=!1,l=!1,c=!1,d=this.client=t,h=new THREE.Ray,u=null,p=!1;this.channelId=null;var f={seedURN:!1,objectSet:!0,viewport:!1,cutplanes:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}};function v(t){s=!0;var e=JSON.parse(t.data.msg);n.restoreState(e),r.impl.invalidate(!0,!1,!0),s=!1}function b(t){return Math.round(1e3*t)/1e3}function g(t){for(var e=0;e<t.length;e++)t[e]=b(t[e])}function m(t){var n=t.data.msg;!0===n[1]||c||(n[0]!=e&&(e=n[0],t.data.lastInControl=n[0],a.dispatchEvent({type:"controlChange",channelId:a.channelId,data:t.data})),l=!1,r.navigation.setView((new THREE.Vector3).set(n[2],n[3],n[4]),(new THREE.Vector3).set(n[5],n[6],n[7])),r.navigation.setCameraUpVector((new THREE.Vector3).set(n[8],n[9],n[10])))}function x(n){if(l||c){var i=n.camera,o=[i.position.x,i.position.y,i.position.z,i.target.x,i.target.y,i.target.z,i.up.x,i.up.y,i.up.z];g(o),o.unshift(c),o.unshift(t.getLocalId()),d.sendMessage("camera",o,a.channelId),e!=o[0]&&(e=o[0],a.dispatchEvent({type:"controlChange",channelId:a.channelId,data:{lastInControl:e}}))}}function y(t,e,n){if(t&&!u){var i=a.getDocument();(u=i.createElement("div")).classList.add("collabPointer")}t&&!p?(r.container.appendChild(u),p=!0):!t&&p&&(r.container.removeChild(u),p=!1),t&&(u.style.left=e-6+"px",u.style.top=n-6+"px")}function E(t){if(!l&&!c){var e=t.data.msg;h.origin.set(e[1],e[2],e[3]),h.direction.set(e[4],e[5],e[6]);var n=h.at(r.getCamera().near);n.project(r.getCamera()),y(!0,(n=r.impl.viewportToClient(n.x,n.y)).x,n.y)}}function w(e){if(!s){var i=n.getState(f);t.sendMessage("state",JSON.stringify(i),a.channelId)}}this.takeControl=function(){l=!0,y(!1)},this.updatePointer=function(e){!function(e){if(l){var n=r.impl.clientToViewport(e.canvasX,e.canvasY);r.impl.viewportToRay(n,h);var i=[h.origin.x,h.origin.y,h.origin.z,h.direction.x,h.direction.y,h.direction.z];g(i),i.unshift(t.getLocalId()),d.sendMessage("pointer",i,a.channelId)}}(e)},this.connectCamera=function(t){c=!t},this.attach=function(t){r&&this.detach(),this.viewer=r=t,n=new o.ViewerState(r),d.addEventListener("cameraChange",m),d.addEventListener("pointerMove",E),d.addEventListener("viewerState",v),r.hasEventListener(i.CAMERA_CHANGE_EVENT,x)||r.addEventListener(i.CAMERA_CHANGE_EVENT,x),r.hasEventListener(i.SELECTION_CHANGED_EVENT,w)||(r.addEventListener(i.SELECTION_CHANGED_EVENT,w),r.addEventListener(i.ISOLATE_EVENT,w),r.addEventListener(i.HIDE_EVENT,w),r.addEventListener(i.SHOW_EVENT,w),r.addEventListener(i.EXPLODE_CHANGE_EVENT,w),r.addEventListener(i.LAYER_VISIBILITY_CHANGED_EVENT,w),r.addEventListener(i.CUTPLANES_CHANGE_EVENT,w))},this.detach=function(){d&&(d.removeEventListener("cameraChange",m),d.removeEventListener("viewerState",v)),r&&(r.removeEventListener(i.CAMERA_CHANGE_EVENT,x),r.removeEventListener(i.SELECTION_CHANGED_EVENT,w),r.removeEventListener(i.ISOLATE_EVENT,w),r.removeEventListener(i.HIDE_EVENT,w),r.removeEventListener(i.SHOW_EVENT,w),r.removeEventListener(i.EXPLODE_CHANGE_EVENT,w),r.removeEventListener(i.LAYER_VISIBILITY_CHANGED_EVENT,w),r.removeEventListener(i.CUTPLANES_CHANGE_EVENT,w),this.viewer=r=null,n=null)}}r.prototype.constructor=r,Autodesk.Viewing.EventDispatcher.prototype.apply(r.prototype),i.GlobalManagerMixin.call(r.prototype);var s=Autodesk.Viewing,l=s.Extensions,c=s.Private,d=l.Collaboration;function h(t,e,n){this.viewer=t,this.client=e,this.viewtx=n,this.setGlobalManager(t.globalManager);s.UI.DockingPanel.call(this,t.container,"CollabPanel","Live review"),this.container.classList.add("collabPanel"),this.container.style.height="auto",this.container.dockRight=!0;var i=this.getDocument();this.content=i.createElement("div"),this.container.appendChild(this.content),this.content.classList.add("collabPanelContent"),this.tableContainer=i.createElement("div"),this.tableContainer.classList.add("userListTable","docking-panel-scroll"),this.table=i.createElement("table"),this.table.classList.add("adsk-lmv-tftable"),this.tbody=i.createElement("tbody"),this.table.appendChild(this.tbody),this.tableContainer.appendChild(this.table),this.content.appendChild(this.tableContainer),this.inviteDiv=i.createElement("div"),this.inviteDiv.className="collabBoxOK",this.inviteDiv.style.float="left",this.inviteDiv.style.width="232px",this.inviteDiv.setAttribute("data-i18n","Invite"),this.inviteDiv.textContent=Autodesk.Viewing.i18n.translate("Invite"),this.content.appendChild(this.inviteDiv),this.inviteDiv.addEventListener("click",(function(e){var n=new u;n.setGlobalManager(o.globalManager);var a=t.container;n.start(a,(function(){var t=Autodesk.Viewing.i18n.translate("Please Join My Live Review");i.location.href="mailto:?subject="+t}),"Invite Others","Email Invite",!0)})),this.chatHistory=i.createElement("div"),this.chatHistory.classList.add("chatHistory"),this.chatHistory.classList.add("textEntry"),this.chatHistory.classList.add("docking-panel-scroll"),this.content.appendChild(this.chatHistory),this.chatPanel=i.createElement("div"),this.chatPanel.classList.add("chatPanel"),this.textInput=i.createElement("input"),this.textInput.type="text",this.textInput.classList.add("textEntry"),this.textInput.placeholder=Autodesk.Viewing.i18n.translate("Type a message"),this.chatPanel.appendChild(this.textInput),this.content.appendChild(this.chatPanel),this.isCameraConnected=!0;var o=this;this.addEventListener(e,"userListChange",(function(t){if(!t.channelId||t.channelId===o.viewtx.channelId){var e=o.client.getChannelInfo(o.viewtx.channelId);e&&o.updateUsers(e.users)}})),this.addEventListener(this.viewtx,"controlChange",(function(t){t.channelId===o.viewtx.channelId&&o.updateUserInControl(t.data.lastInControl)})),this.addEventListener(e,"chatReceived",(function(t){t.channelId===o.viewtx.channelId&&o.updateChatHistory(t)})),this.textInput.onkeyup=function(t){o.handleChatInput(t)}}function u(){}Autodesk.Viewing.startLiveReviewSession=function(){d.Panel&&d.Panel.startSession()},Autodesk.Viewing.endLiveReviewSession=function(){d.Panel&&d.Panel.endSession()},h.prototype=Object.create(s.UI.DockingPanel.prototype),h.prototype.constructor=h,s.GlobalManagerMixin.call(h.prototype),h.prototype.startSession=function(){var t=this;if(!this.isVisible()){var e=new u;e.setGlobalManager(this.globalManager);var n=this.viewer.container;e.start(n,(function(){t.setVisible(!0,!0)}),"Start a Live Review","Start Review")}},h.prototype.endSession=function(){this.isVisible()&&(this.setVisible(!1,!0),this.reset())},h.prototype.updateUsers=function(t){for(var e=this.getDocument(),n=e.createElement("tbody"),i=0;i<t.length;i++){var o=n.insertRow(-1);o.id=t[i].id;var a=o.insertCell(0);a.style.width="14px",a.style.cursor="default";var r=e.createElement("div");r.classList.add("statusBase"),r.classList.add("statusNormal"),r.innerHTML="&#9679",a.appendChild(r),o.insertCell(1).textContent=t[i].name}this.table.replaceChild(n,this.tbody),this.tbody=n,this.fixComponentPlacement()},h.prototype.updateUserInControl=function(t){for(var e=0;e<this.tbody.rows.length;e++){var n=this.tbody.rows[e],i=n.cells[0].childNodes[0];n.id==t?(i.classList.remove("statusNormal"),i.classList.add("statusInControl"),i.innerHTML="&#9784",n.cells[1].style.color="#4CBA36"):(i.classList.remove("statusInControl"),i.classList.add("statusNormal"),i.innerHTML="&#9679",n.cells[1].style.color="#ffffff")}},h.prototype.updateChatHistory=function(t){var e=this.client.getUserById(t.data.from,t.channelId);if("/"!=t.data.msg.charAt(0)){var n=this.getDocument();if(this.chatHistory.lastUser!=e.name){var i=n.createElement("p"),o=n.createElement("div");o.classList.add("heading"),o.style.float="left",o.style.fontStyle="normal",o.style.color="#857E7E",o.textContent=e.name,i.appendChild(o);var a=n.createElement("div");a.classList.add("heading"),a.style.textAlign="right",a.style.fontStyle="normal",a.style.color="#857E7E",a.textContent=(new Date).toLocaleTimeString(),i.appendChild(a),this.chatHistory.appendChild(i),this.chatHistory.lastUser=e.name}else{var r=n.createElement("br");this.chatHistory.appendChild(r)}var s=n.createElement("span");s.classList.add("messageText"),s.textContent=t.data.msg,this.chatHistory.appendChild(s),this.chatHistory.scrollTop=this.chatHistory.scrollHeight}},h.prototype.handleChatInput=function(t){13==t.which&&0!=this.textInput.value.length&&(this.client.sendChatMessage(this.textInput.value,this.viewtx.channelId),this.textInput.value="",this.textInput.placeholder="")},h.prototype.fixComponentPlacement=function(t){var e=this.tableContainer.offsetHeight+this.chatPanel.offsetHeight;this.videoPanel?(e+=this.videoPanel.offsetHeight,this.chatHistory.style.height="calc(100% - "+e+"px)"):this.chatHistory.style.height="calc(100% - "+e+"px)"},h.prototype.removeCollabPrompt=function(){var t=this.getDocument().getElementById("collabBox");t&&(t.style.visibility="hidden",this.viewer.container.removeChild(t))},h.prototype.removeVideoPanel=function(){this.videoPanel&&this.content.removeChild(this.videoPanel),this.videoPanel=null},h.prototype.reset=function(t){var e=this.getDocument();if(this.tbody){var n=e.createElement("tbody");this.table.replaceChild(n,this.tbody),this.tbody=n}this.chatHistory.textContent="",this.textInput.value="",this.removeVideoPanel(),this.removeCollabPrompt()},u.prototype.start=function(t,e,n,i,o){if(t){var a=this.getWindow(),r=this.getDocument();if(!r.getElementById("collabBox")){var s=r.createElement("div");s.id="collabBox",s.className="collabBox",t.appendChild(s);var l=r.createElement("div");l.className="collabBoxTitle",l.textContent=Autodesk.Viewing.i18n.translate(n,{defaultValue:n}),s.appendChild(l),(v=r.createElement("span")).className="collabBoxText";var d="Enter your name";o&&(d="Review URL"),v.textContent=Autodesk.Viewing.i18n.translate(d,{defaultValue:d}),s.appendChild(v);var h=r.createElement("span");h.className="collabBoxInputContainer",s.appendChild(h);var u=r.createElement("input");if(u.type="text",u.className="collabBoxInputText",o){var p=a.location.toString();-1==p.indexOf("?")?p+="?invited=true":p+="&invited=true",Autodesk.Viewing.Private.docItemId&&(p+="&itemid="+Autodesk.Viewing.Private.docItemId),p+="&doNotRedirect=true",u.value=p}h.appendChild(u),u.onkeyup=function(n){13==n.keyCode&&(s.style.visibility="hidden",t.removeChild(s),c.setUserName(u.value),e())};var f=r.createElement("div");if(f.className="collabBoxClose",f.innerHTML="&times;",f.addEventListener("click",(function(e){s.style.visibility="hidden",t.removeChild(s)})),s.appendChild(f),o){var v;(v=r.createElement("span")).className="collabBoxText",v.style.marginTop="0px";d="Copy and send this URL to invite others";v.textContent=Autodesk.Viewing.i18n.translate(d,{defaultValue:d}),s.appendChild(v)}else{var b=r.createElement("div");b.className="collabBoxOK",b.textContent=Autodesk.Viewing.i18n.translate(i,{defaultValue:i}),b.addEventListener("click",(function(n){s.style.visibility="hidden",t.removeChild(s),""!==u.value.trim()&&c.setUserName(u.value),e()})),s.appendChild(b)}s.style.visibility="visible",u.focus(),o&&u.select()}}},s.GlobalManagerMixin.call(u.prototype);n(544);var p=Autodesk.Viewing,f=p.Private,v=p.UI;function b(t,e){p.Extension.call(this,t,e),e&&e.rtc&&e.rtc.disableRTCToolbarButton&&(this.disableRTCToolbarButton=!0),this.name="collaboration"}b.prototype=Object.create(p.Extension.prototype),b.prototype.constructor=b;var g=b.prototype;g.initNetwork=function(t){this.viewtx&&!t||(this.viewtx=new r(this.client),this.viewtx.setGlobalManager(this.globalManager),this.interceptor=new a(this.viewtx),this.viewer.toolController.registerTool(this.interceptor))},g.createUI=function(){var t=this,e=this.viewer;if(this.initNetwork(!1),this.panel=new h(this.viewer,this.client,this.viewtx),b.Panel=this.panel,this.collabButton=new v.Button("toolbar-collaborateTool"),this.collabButton.setToolTip("Live review"),this.collabButton.setIcon("adsk-icon-live-review"),this.collabButton.onClick=function(e){var n=t.panel.isVisible();document.getElementById("collabBox")||(n||t.inviteDivInstantiated||t.activeStatus?t.deactivate():t.activate())},this.disableRTCToolbarButton&&this.collabButton.setVisible(!1,!0),this.panel.addVisibilityListener((function(n){if(n){if(e.model){var i=e.model.getData();t.viewtx.channelId=i.basePath,t.viewtx.attach(e),t.client.connect(t.viewtx.channelId),t.client.join(t.viewtx.channelId)}e.toolController.activateTool(t.interceptor.getName());t.collabButton.setState(v.Button.State.ACTIVE),f.logger.track({category:"viewer_rtc_start"})}else f.logger&&t.client.isConnected()&&f.logger.track({category:"viewer_rtc_stop"}),t.viewtx.detach(e),t.viewtx.channelId=null,t.client.disconnect(),t.panel.reset(),e.toolController.deactivateTool(t.interceptor.getName()),t.collabButton.setState(v.Button.State.INACTIVE)})),e.modelTools.addControl(this.collabButton),Autodesk.Viewing.Private.getParameterByName("invited")){var n=new u;n.setGlobalManager(this.globalManager);var i=e.container;n.start(i,(function(){t.panel.setVisible(!0,!0)}),"Join a Live Review","Join Review")}},g.close=function(){this.panel.setVisible(!1,!0),this.panel.reset()},g.load=function(){var t=this.viewer,e=this;return function(){e.client=f.MessageClient.GetInstance(e.options?e.options.messageServerURL:void 0),e.socketErrorHandler=function(n){f.ErrorHandler.reportError(t.container,Autodesk.Viewing.ErrorCodes.RTC_ERROR,n.data),e.close()},e.client.addEventListener("socketError",e.socketErrorHandler);var n=e.getWindow();e.presenceChannelId=n.location.host,t.modelTools?e.createUI():t.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,(function n(i){t.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,n),e.createUI()}))}(),!0},g.unload=function(){var t=this.viewer;return this.client.removeEventListener("socketError",this.socketErrorHandler),this.socketErrorHandler=null,this.viewtx.detach(t),this.client.disconnect(),this.panel&&(this.panel.reset(),this.panel.setVisible(!1),this.panel.uninitialize(),this.panel=null),t.toolController.deactivateTool(this.interceptor.getName()),this.interceptor=null,this.collabButton.removeFromParent(),this.collabButton=null,!0},g.activate=function(){if(!this.activeStatus){var t=this.viewer,e=new u;e.setGlobalManager(this.globalManager);var n=t.container;e.start(n,function(){this.panel.setVisible(!0,!0)}.bind(this),"Start a Live Review","Start Review"),this.activeStatus=!0}return!0},g.deactivate=function(){return this.activeStatus&&(this.panel.setVisible(!1,!0),this.panel.reset(),this.activeStatus=!1),!0},p.theExtensionManager.registerExtension("Autodesk.Viewing.Collaboration",b)}});
//# sourceMappingURL=Collaboration.min.js.map
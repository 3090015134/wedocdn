/*!
 * LMV v7.51.0
 * 
 * Copyright 2021 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.Snapping=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=540)}({540:function(e,t,r){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=c(e);if(t){var n=c(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return o(this,r)}}function o(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=Autodesk.Viewing,u=AutodeskNamespace("Autodesk.Viewing.Extensions.Snapping");function d(t,r){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e.exports[i]=t[i],r[i]=t[i])}d(r(71),u),d(r(541),u),d(r(72),u);var p=function(e){"use strict";!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,i,o=a(c);function c(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),o.call(this,e,t)}return t=c,(r=[{key:"load",value:function(){return this.viewer.loadExtension("Autodesk.CompGeom")}},{key:"unload",value:function(){return!0}},{key:"activate",value:function(){return!0}},{key:"deactivate",value:function(){return!1}}])&&n(t.prototype,r),i&&n(t,i),c}(l.Extension);l.theExtensionManager.registerExtension("Autodesk.Snapping",p)},541:function(e,t,r){"use strict";r.r(t),r.d(t,"Snapper",(function(){return y}));var i=r(72),n=r(71);function s(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function o(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=Autodesk.Viewing.MeasureCommon,l=c.EPSILON,u=c.SnapType,d=c.SnapResult,p=Autodesk.Viewing,h=p.Private.VertexBufferReader;function v(e,t){return Math.abs(e-t)<=.001}function g(e,t){return Math.abs(e.x-t.x)<=.001&&Math.abs(e.y-t.y)<=.001&&Math.abs(e.z-t.z)<=.001}function f(e,t,r){if(t.equals(r))return e.distanceTo(t);var i,n,s=new THREE.Vector3,a=new THREE.Vector3;return s.subVectors(t,e),a.subVectors(r,t),n=s.dot(a),s.subVectors(r,t),(n=-n/s.dot(s))<0?i=e.distanceTo(t):n>1?i=e.distanceTo(r):(s.subVectors(e,t),a.subVectors(e,r),s.cross(a),a.subVectors(r,t),i=Math.sqrt(s.dot(s))/Math.sqrt(a.dot(a))),i}var E={Unknown:0,Line:1,CircularArc:2,EllipticalArc:3},m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=E.Unknown,this.viewportId=t,this.distance=0,this.lineStart=null,this.lineEnd=null,this.radius=0,this.radiusX=0,this.radiusY=0,this.center=null,this.startAngle=0,this.endAngle=0}var t,r,i;return t=e,(r=[{key:"fromLine",value:function(e,t){return this.type=E.Line,this.lineStart=e.clone(),this.lineEnd=t.clone(),this}},{key:"fromCircularArc",value:function(e,t,r,i){return this.type=E.CircularArc,this.center=e.clone(),this.radius=t,this.start=r,this.end=i,this}},{key:"fromEllipticalArc",value:function(e,t,r,i,n){return this.type=E.EllipticalArc,this.center=e.clone(),this.radiusX=t,this.radiusY=r,this.start=i,this.end=n,this}},{key:"isLine",value:function(){return this.type===E.Line}},{key:"isCircularArc",value:function(){return this.type===E.CirularArc}},{key:"isEllipticalArc",value:function(){return this.type===E.EllipticalArc}},{key:"getIntersection",value:function(e,t){if(this.isLine()&&e.isLine())return Object(n.intersectLines)(this.lineStart,this.lineEnd,e.lineStart,e.lineEnd,!1,t)}}])&&o(t.prototype,r),i&&o(t,i),e}();function y(e,t){var r=new d,a=e;this.setGlobalManager(e.globalManager);var o,E=t||{};o=E.markupMode?["snapper-markup"]:E.toolName?[E.toolName]:["snapper"];var y=!1,T=Number.MAX_VALUE,w=null,R=!1,V=!1,S=!1,x=null,b=!1,A=null;this.indicator=new i.SnapperIndicator(e,this),this.markupMode=E.markupMode,this.renderSnappedGeometry=E.renderSnappedGeometry,this.renderSnappedTopology=E.renderSnappedTopology,this.detectRadiusInPixels=p.isMobileDevice()?50:10,this.isActive=function(){return y},this.getNames=function(){return o},this.getName=function(){return o[0]},this.getPriority=function(){return 60},this.activate=function(){y=!0,this.indicator||(this.indicator=new i.SnapperIndicator(e,this))},this.deactivate=function(){y=!1,this.indicator&&(this.indicator.destroy(),this.indicator=null)},this.copyResults=function(e){r.copyTo(e)},this.getEdge=function(){return r.geomEdge},this.getVertex=function(){return r.geomVertex},this.getGeometry=function(){return r.getGeometry()},this.getGeometryType=function(){return r.geomType},this.getIntersectPoint=function(){return r.intersectPoint},this.getSnapResult=function(){return r},this.isSnapped=function(){return S},this.clearSnapped=function(){r.clear(),S=!1},this.setViewportId=function(e){x=e},this.setSnapToPixel=function(e){b=e},this.getSnapToPixel=function(){return b},this.setSnapToArc=function(e){r.snapToArc=e},this.getSnapToArc=function(){return r.snapToArc},this.setArc=function(e){r.isArc=e},this.getArc=function(){return r.isArc},this.setSnapFilter=function(e){A=e},this.snapping3D=function(e){if(r.snapNode=e.dbId,r.intersectPoint=e.intersectPoint,r.modelId=e.model?e.model.id:null,e.model){var t,i=e.face;t=e.fragId&&void 0!==e.fragId.length?e.fragId:[e.fragId],r.hasTopology=e.model.hasTopology(),r.hasTopology?this.snapping3DwithTopology(i,t,e.model):this.snapping3DtoMesh(i,t,e.model)}},this.snapping3DwithTopology=function(e,t,i){r.snapNode&&(t=[],i.getData().instanceTree.enumNodeFragments(r.snapNode,(function(e){t.push(e)}),!0)),r.geomFace=r.geomEdge=r.geomVertex=null,T=Number.MAX_VALUE;for(var n=0;n<t.length;++n){var s=t[n],o=a.impl.getRenderProxy(i,s),c=o.geometry,l=i.getTopoIndex(s),d=i.getTopology(l),p=d.faces,h=d.edges;if(!r.geomFace){r.geomFace=this.faceSnappingWithTopology(e,c,p,o),r.geomFace&&(r.geomFace.fragId=s);var v=(new THREE.Matrix3).getNormalMatrix(o.matrixWorld);r.faceNormal=e.normal.applyMatrix3(v).normalize()}this.edgeSnappingWithTopology(r.intersectPoint,c,h,o)}if(r.geomVertex=this.vertexSnappingWithTopology(r.geomEdge,r.intersectPoint),r.geomFace){if(r.radius=this.setDetectRadius(r.intersectPoint),(E.forceSnapVertices||w<r.radius)&&r.geomVertex)r.geomType=u.SNAP_VERTEX;else if((E.forceSnapEdges||T<r.radius)&&r.geomEdge){var g=this.edgeIsCircle(r.geomEdge);g?(r.circularArcCenter=g,r.circularArcRadius=g.distanceTo(r.geomEdge.vertices[0]),r.geomEdge.center=r.circularArcCenter,r.geomEdge.radius=r.circularArcRadius,r.geomType=u.SNAP_CIRCULARARC):this.edgeIsCurved(r.geomEdge)?r.geomType=u.SNAP_CURVEDEDGE:r.geomType=u.SNAP_EDGE}else this.faceIsCurved(r.geomFace)?r.geomType=u.SNAP_CURVEDFACE:r.geomType=u.SNAP_FACE;S=!0}},this.snapping3DtoMesh=function(e,t,i){for(var n=0;n<t.length;++n){var s=t[n],o=a.impl.getRenderProxy(i,s),c=o.geometry;if((o.isLine||o.isWideLine)&&e){r.geomEdge=this.extractLineGeometry(e,c),r.geomEdge.applyMatrix(o.matrixWorld),r.geomVertex=this.vertexSnapping(r.geomEdge,r.intersectPoint),r.radius=this.setDetectRadius(r.intersectPoint),E.forceSnapVertices||w<r.radius?r.geomType=u.SNAP_VERTEX:r.geomType=u.SNAP_EDGE,S=!0;break}if(e instanceof THREE.Face3&&(r.geomFace=this.faceSnapping(e,c)),r.geomFace){r.geomFace.applyMatrix(o.matrixWorld),r.geomEdge=this.edgeSnapping(r.geomFace,r.intersectPoint),r.geomVertex=this.vertexSnapping(r.geomEdge,r.intersectPoint);var l=(new THREE.Matrix3).getNormalMatrix(o.matrixWorld);r.faceNormal=e.normal.applyMatrix3(l).normalize(),r.radius=this.setDetectRadius(r.intersectPoint),E.forceSnapVertices||w<r.radius?r.geomType=u.SNAP_VERTEX:E.forceSnapEdges||T<r.radius?r.geomType=u.SNAP_EDGE:r.geomType=u.SNAP_FACE,S=!0;break}}},this.faceSnappingWithTopology=function(e,t,r,i){var n=new THREE.Vector3,s=new THREE.Vector3,a=new THREE.Vector3,o=new THREE.Geometry,c=t.attributes;if(void 0!==c.index){for(var l=t.vb?t.vb:c.position.array,u=t.vb?t.vbstride:3,d=0;d<r.length;d++){for(var p=r[d].indexList,h=r[d].id,v=0;v<p.length;v+=3)if(e.a===p[v]){if(e.b===p[v+1]&&e.c===p[v+2]||e.b===p[v+2]&&e.c===p[v+1])break}else if(e.a===p[v+1]){if(e.b===p[v]&&e.c===p[v+2]||e.b===p[v+2]&&e.c===p[v])break}else if(e.a===p[v+2]&&(e.b===p[v]&&e.c===p[v+1]||e.b===p[v+1]&&e.c===p[v]))break;if(v<p.length)break}if(d<r.length)for(var g=0;g<p.length;g+=3){n.set(l[p[g]*u],l[p[g]*u+1],l[p[g]*u+2]),s.set(l[p[g+1]*u],l[p[g+1]*u+1],l[p[g+1]*u+2]),a.set(l[p[g+2]*u],l[p[g+2]*u+1],l[p[g+2]*u+2]);var f=o.vertices.length;o.vertices.push(n.clone()),o.vertices.push(s.clone()),o.vertices.push(a.clone()),o.faces.push(new THREE.Face3(f,f+1,f+2))}}return o.vertices.length>0?(o.faceId=h,o.applyMatrix(i.matrixWorld),o):null},this.faceSnapping=function(e,t){var r=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,s=new THREE.Geometry,a=t.attributes,o=a.index&&(a.index.array||t.ib),c=t.vb?t.vb:a.position.array,l=t.vb?t.vbstride:3,u=t.offsets;u&&0!==u.length||(u=[{start:0,count:o?o.length:c.length,index:0}]);for(var d=0;d<u.length;++d)for(var p=u[d].start,h=u[d].count,f=u[d].index,E=p;E<p+h;E+=3){var m=f+(o?o[E]:E),y=f+(o?o[E+1]:E+1),T=f+(o?o[E+2]:E+2);r.set(c[m*l],c[m*l+1],c[m*l+2]),i.set(c[y*l],c[y*l+1],c[y*l+2]),n.set(c[T*l],c[T*l+1],c[T*l+2]);var w=THREE.Triangle.normal(r,i,n),R=new THREE.Vector3;if(R.set(c[e.a*l],c[e.a*l+1],c[e.a*l+2]),g(w,e.normal)&&v(w.dot(r),e.normal.dot(R))){var V=s.vertices.length;s.vertices.push(r.clone()),s.vertices.push(i.clone()),s.vertices.push(n.clone()),s.faces.push(new THREE.Face3(V,V+1,V+2))}}return s.vertices.length>0?this.getTrianglesOnSameFace(s,e,c,l):null},this.getTrianglesOnSameFace=function(e,t,r,i){var n=!1,s=e.vertices.slice(),a=new THREE.Vector3;a.set(r[t.a*i],r[t.a*i+1],r[t.a*i+2]);var o=new THREE.Vector3;o.set(r[t.b*i],r[t.b*i+1],r[t.b*i+2]);var c=new THREE.Vector3;c.set(r[t.c*i],r[t.c*i+1],r[t.c*i+2]);var l=new THREE.Geometry;l.vertices.push(a),l.vertices.push(o),l.vertices.push(c),l.faces.push(new THREE.Face3(0,1,2));var u=[];do{u=[];for(var d=0;d<s.length;d+=3)if(s[d].equals(a)&&s[d+1].equals(o)&&s[d+2].equals(c))n=!0,u.push(d);else for(var p=0;p<l.vertices.length;p+=3)if(this.trianglesSharedEdge(s[d],s[d+1],s[d+2],l.vertices[p],l.vertices[p+1],l.vertices[p+2])){var h=l.vertices.length;l.vertices.push(s[d].clone()),l.vertices.push(s[d+1].clone()),l.vertices.push(s[d+2].clone()),l.faces.push(new THREE.Face3(h,h+1,h+2)),u.push(d);break}for(var v=u.length-1;v>=0;--v)s.splice(u[v],3)}while(u.length>0);return n?l:null},this.trianglesSharedEdge=function(e,t,r,i,n,s){var a=!1,o=!1,c=!1;return(e.equals(i)||e.equals(n)||e.equals(s))&&(a=!0),(t.equals(i)||t.equals(n)||t.equals(s))&&(o=!0),(r.equals(i)||r.equals(n)||r.equals(s))&&(c=!0),!!(a&o||a&c||o&c)},this.edgeSnappingWithTopology=function(e,t,i,n){var s,a=new THREE.Geometry,o=Number.MAX_VALUE,c=new THREE.Vector3,l=new THREE.Vector3,u=t.attributes;if(void 0!==u.index&&null!=i){for(var d=t.vb?t.vb:u.position.array,p=t.vb?t.vbstride:3,h=0;h<i.length;h++)for(var v=i[h].indexList,g=0;g<v.length-1;g++){c.set(d[v[g]*p],d[v[g]*p+1],d[v[g]*p+2]),l.set(d[v[g+1]*p],d[v[g+1]*p+1],d[v[g+1]*p+2]),c.applyMatrix4(n.matrixWorld),l.applyMatrix4(n.matrixWorld);var E=f(e,c,l);E<o&&(o=E,s=h)}if(s){v=i[s].indexList;for(var m=0;m<v.length-1;m++)a.vertices.push(new THREE.Vector3(d[v[m]*p],d[v[m]*p+1],d[v[m]*p+2])),a.vertices.push(new THREE.Vector3(d[v[m+1]*p],d[v[m+1]*p+1],d[v[m+1]*p+2]))}}T>=o&&a.vertices.length>0&&(T=o,a.applyMatrix(n.matrixWorld),r.geomEdge=a)},this.extractLineGeometry=function(e,t){var r=new THREE.Vector3,i=new THREE.Vector3,n=t.attributes,s=t.vb?t.vb:n.position.array,a=t.vb?t.vbstride:3;r.set(s[e.a*a],s[e.a*a+1],s[e.a*a+2]),i.set(s[e.b*a],s[e.b*a+1],s[e.b*a+2]);var o=new THREE.Geometry;return o.vertices.push(r,i),o},this.edgeSnapping=function(e,t){for(var r=new THREE.Geometry,i=!0,n=!0,s=!0,a=0;a<e.vertices.length;a+=3){for(var o=0;o<e.vertices.length;o+=3)a!==o&&((e.vertices[a].equals(e.vertices[o])||e.vertices[a].equals(e.vertices[o+1])||e.vertices[a].equals(e.vertices[o+2]))&&(e.vertices[a+1].equals(e.vertices[o])||e.vertices[a+1].equals(e.vertices[o+1])||e.vertices[a+1].equals(e.vertices[o+2]))&&(i=!1),(e.vertices[a].equals(e.vertices[o])||e.vertices[a].equals(e.vertices[o+1])||e.vertices[a].equals(e.vertices[o+2]))&&(e.vertices[a+2].equals(e.vertices[o])||e.vertices[a+2].equals(e.vertices[o+1])||e.vertices[a+2].equals(e.vertices[o+2]))&&(n=!1),(e.vertices[a+1].equals(e.vertices[o])||e.vertices[a+1].equals(e.vertices[o+1])||e.vertices[a+1].equals(e.vertices[o+2]))&&(e.vertices[a+2].equals(e.vertices[o])||e.vertices[a+2].equals(e.vertices[o+1])||e.vertices[a+2].equals(e.vertices[o+2]))&&(s=!1));i&&(r.vertices.push(e.vertices[a].clone()),r.vertices.push(e.vertices[a+1].clone())),n&&(r.vertices.push(e.vertices[a].clone()),r.vertices.push(e.vertices[a+2].clone())),s&&(r.vertices.push(e.vertices[a+1].clone()),r.vertices.push(e.vertices[a+2].clone())),i=!0,n=!0,s=!0}for(var c,l=new THREE.Geometry,u=Number.MAX_VALUE,d=0;d<r.vertices.length;d+=2){var p=f(t,r.vertices[d],r.vertices[d+1]);p<u&&(u=p,c=d)}return l.vertices.push(r.vertices[c].clone()),l.vertices.push(r.vertices[c+1].clone()),l.vertices=this.getConnectedLineSegmentsOnSameLine(r,l.vertices),T=u,l},this.getConnectedLineSegmentsOnSameLine=function(e,t){var r,i,n=e.vertices.slice(),s=t[0],a=t[1],o=[];do{o=[];for(var c=0;c<n.length;c+=2)if(!n[c].equals(s)||!n[c+1].equals(a))for(var l=0;l<t.length;l+=2)if(n[c].equals(t[l])||n[c+1].equals(t[l])||n[c].equals(t[l+1])||n[c+1].equals(t[l+1])){var u=new THREE.Vector3,d=new THREE.Vector3;if(u.subVectors(t[l],t[l+1]),u.normalize(),d.subVectors(n[c],n[c+1]),d.normalize(),g(u,d)||(r=u,i=d,Math.abs(r.x+i.x)<=.001&&Math.abs(r.y+i.y)<=.001&&Math.abs(r.z+i.z)<=.001)){o.push(c);break}}for(var p=o.length-1;p>=0;--p)t.push(n[o[p]]),t.push(n[o[p]+1]),n.splice(o[p],2)}while(o.length>0);return t},this.vertexSnappingWithTopology=function(e,t){var r=Number.MAX_VALUE,i=new THREE.Vector3;if(e&&e.vertices.length>1){var n=t.distanceTo(e.vertices[0]),s=t.distanceTo(e.vertices[e.vertices.length-1]);n<=s?(r=n,i=e.vertices[0].clone()):(r=s,i=e.vertices[e.vertices.length-1].clone())}return w=r,i},this.vertexSnapping=function(e,t){for(var r=Number.MAX_VALUE,i=new THREE.Vector3,n=0;n<e.vertices.length;++n){var s=t.distanceTo(e.vertices[n]);s<r-.001&&(r=s,i=e.vertices[n].clone())}return w=r,i},this.edgeIsCircle=function(e){var t=e.vertices;if(t.length<8)return!1;if(t[0].equals(t[t.length-1])){for(var r=new THREE.Vector3(0,0,0),i=0;i<t.length;i+=2)r.add(t[i]);r.divideScalar(t.length/2);for(var n=r.distanceTo(t[0]),s=0;s<t.length;s+=2)if(!(Math.abs(r.distanceTo(t[s])-n)<=.001))return!1;return r}return!1},this.edgeIsCurved=function(e){var t=e.vertices;if(t.length<=2)return!1;if(t[0].equals(t[t.length-1]))return!0;var r=new THREE.Vector3;r.subVectors(t[0],t[1]);for(var i=new THREE.Vector3,n=2;n<t.length;n+=2)if(i.subVectors(t[n],t[n+1]),!g(r,i))return!0;return!1},this.faceIsCurved=function(e){var t=e.vertices,r=e.faces;if(r.length<=1)return!1;for(var i=THREE.Triangle.normal(t[r[0].a],t[r[0].b],t[r[0].c]),n=t[r[0].a],s=1;s<r.length;s++){var a=THREE.Triangle.normal(t[r[s].a],t[r[s].b],t[r[s].c]),o=t[r[s].a];if(!g(i,a)||!v(i.dot(n),a.dot(o)))return!0}return!1},this.angleVector2=function(e){return e.x>0&&e.y>=0?Math.atan(e.y/e.x):e.x>=0&&e.y<0?Math.atan(e.y/e.x)+2*Math.PI:e.x<0&&e.y<=0||e.x<=0&&e.y>0?Math.atan(e.y/e.x)+Math.PI:null};function P(e,t,r){this.viewer=e,this.snapper=t,this.lineGeom=new THREE.Geometry,this.circularArc=null,this.circularArcCenter,this.circularArcRadius,this.ellipticalArc=null,this.ellipticalArcCenter,this.minDist=Number.MAX_VALUE,this.matrix=new THREE.Matrix4,this.vpIdLine=null,this.vpIdCircular=null,this.vpIdElliptical=null,this.detectRadius=r,this.snapCandidates=[]}P.prototype.onLineSegment=function(e,t,r,i,n){var s=this.snapper.getIntersectPoint(),a=this.lineGeom.vertices,o=new THREE.Vector3(e,t,s.z),c=new THREE.Vector3(r,i,s.z);this.matrix&&(o.applyMatrix4(this.matrix),c.applyMatrix4(this.matrix));var l=f(s,o,c);l>this.detectRadius||(this.snapCandidates.push(new m(n,l).fromLine(o,c)),l<this.minDist&&(a.splice(0,2,o,c),this.minDist=l,this.vpIdLine=n))},P.prototype.onCircularArc=function(e,t,r,i,s,a){var o=this.snapper.getIntersectPoint(),c=new THREE.Vector2(o.x,o.y),l=new THREE.Vector2(e,t);c.sub(l);var u=Object(n.nearestPointOnCircularArc)(o,l,s,r,i),d=u.distanceTo(o);if(this.snapCandidates.push(new m(a,d).fromCircularArc(l,s,r,i)),!(d>this.detectRadius)){var p,h=this.snapper.angleVector2(c);if(i>r&&h>=r&&h<=i)p=new THREE.CircleGeometry(s,100,r,i-r);else{if(!(i<r&&(h>=r||h<=i)))return;p=new THREE.CircleGeometry(s,100,r,2*Math.PI-r+i)}p.vertices.splice(0,1),p.applyMatrix((new THREE.Matrix4).makeTranslation(e,t,o.z)),this.circularArc=p,this.circularArcCenter=new THREE.Vector3(e,t,o.z),this.circularArcRadius=s,this.snapPoint=new THREE.Vector3(u.x,u.y,o.z),this.vpIdCircular=a}},P.prototype.onEllipticalArc=function(e,t,r,i,n,s,a,o){var l=this.snapper.getIntersectPoint(),u=new THREE.Vector2(l.x,l.y),d=n-this.detectRadius,p=s-this.detectRadius,h=n+this.detectRadius,g=s+this.detectRadius,f=(u.x-e)*(u.x-e)/(d*d)+(u.y-t)*(u.y-t)/(p*p),E=(u.x-e)*(u.x-e)/(h*h)+(u.y-t)*(u.y-t)/(g*g),y=new THREE.Vector2(e,t);u.sub(y),u.x*=s,u.y*=n;var T=this.snapper.angleVector2(u);if(i>2*Math.PI&&(i=2*Math.PI),f>=1&&E<=1&&(i>r&&T>=r&&T<=i||i<r&&(T>=r||T<=i))){var w=function(e,t,r,i,n,s,a){for(var o=new THREE.Geometry,c=0;c<a;c++){var l=new THREE.Vector3(0,0,0),u=c/(a-1);Autodesk.Extensions.CompGeom.getEllipseArcPoint(u,e,t,r,i,n,s,0,l),o.vertices.push(l)}return o}(e,t,n,s,r,i,50);v(i-r,2*Math.PI)||w.vertices.pop(),w.applyMatrix((new THREE.Matrix4).makeTranslation(0,0,l.z));var R=c.nearestVertexInVertexToEdge(l,w),V=THREE.Vector2.prototype.distanceTo.call(R,l),S=new THREE.Vector2(e,t);this.snapCandidates.push(new m(o,V).makeEllipticalArc(S,n,s,r,i)),this.ellipticalArc=w,this.ellipticalArcCenter=new THREE.Vector3(e,t,l.z),this.vpIdElliptical=o}},P.prototype.setMatrix=function(e){this.matrix=e||new THREE.Matrix4},this.snapping2D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var i=e.dbId,n=e.fragId,o=e.intersectPoint,c=e.model,l=void 0===c?a.model:c;if(!l.is3d()){r.modelId=e.model?e.model.id:null,r.hasTopology=!1,r.intersectPoint=o;var d,p=1;a.impl.is2d||(d=l.getModelToViewerTransform())&&(p=d.getMaxScaleOnAxis(),r.intersectPoint=o.clone(),r.intersectPoint.applyMatrix4(l.getInverseModelToViewerTransform())),r.radius=this.setDetectRadius(o)/p;var v=null!=l.getFragmentList();if(!v)return S=!0,r.geomType=u.SNAP_VERTEX,r.geomVertex=o,void(d&&r.intersectPoint.applyMatrix4(d));var g=new P(a,this,r.radius);if(t.enumSegments){var f=r.intersectPoint.x-r.radius,E=r.intersectPoint.y-r.radius,m=r.intersectPoint.x+r.radius,y=r.intersectPoint.y+r.radius;t.enumSegments(f,E,m,y,g)}else{var T=n;if(void 0===T){if(!b)return;T=[]}else Array.isArray(T)||(T=[T]);for(var w=0;w<T.length;++w){var R=a.impl.getRenderProxy(l,T[w]);if(R&&R.geometry){g.setMatrix(R.matrix);var V=new h(R.geometry);V.enumGeomsForObject(l.reverseMapDbIdFor2D(i),g),g.setMatrix()}}}if(this.finishSnapping2D(g,r.intersectPoint),!S&&b&&(S=!0,r.geomType=u.RASTER_PIXEL,r.geomVertex=r.intersectPoint),d){var x,A,M=[r.snapPoint,r.geomVertex,r.intersectPoint,r.circularArcCenter,null===(x=r.geomEdge)||void 0===x?void 0:x.vertices[0],null===(A=r.geomEdge)||void 0===A?void 0:A.vertices[1]];(M=s(new Set(M.filter((function(e){return e}))))).forEach((function(e){return e.applyMatrix4(d)})),r.circularArcRadius&&(r.circularArcRadius*=p),r.radius*=p}}}},this.snapping2DOverlay=function(e,t,i,n){r.hasTopology=!1,r.intersectPoint=e,r.radius=n||this.setDetectRadius(e);for(var s=new P(a,this,r.radius),o=0;o<t.length;o++){var c=t[o];new h(c.geometry).enumGeoms(i,s)}this.finishSnapping2D(s,e)},this.finishSnapping2D=function(e,t){if(null!==x){e.snapCandidates=e.snapCandidates.filter((function(e){return e.viewportId===x}))}var i=function(e,t,r){if(e.sort((function(e,t){return e.distance-t.distance})),e.length<2)return null;for(var i={viewportId:e[0].viewportId,snapPoint:new THREE.Vector3(0,0,t.z)},n=e[0],s=1;s<e.length;s++){var a=e[s];if(n.getIntersection(a,i.snapPoint))if(THREE.Vector2.prototype.distanceTo.call(i.snapPoint,t)<r)return i}return null}(e.snapCandidates,t,e.detectRadius);if(i)return r.viewportIndex2d=i.viewportId,r.snapPoint=i.snapPoint,r.geomType=u.SNAP_INTERSECTION,r.geomVertex=i.snapPoint,void(S=!0);if(e.circularArc){if(r.viewportIndex2d=e.vpIdCircular,r.snapPoint=e.snapPoint,null!==x&&x!==r.viewportIndex2d)return;t.distanceTo(e.circularArc.vertices[0])<r.radius?(r.geomVertex=e.circularArc.vertices[0],r.geomType=u.SNAP_VERTEX):t.distanceTo(e.circularArc.vertices[e.circularArc.vertices.length-1])<r.radius?(r.geomVertex=e.circularArc.vertices[e.circularArc.vertices.length-1],r.geomType=u.SNAP_VERTEX):(this.lineStripToPieces(e.circularArc),r.geomEdge=e.circularArc,r.circularArcCenter=e.circularArcCenter,r.circularArcRadius=e.circularArcRadius,r.geomType=u.SNAP_CIRCULARARC),S=!0}else if(e.ellipticalArc){if(r.viewportIndex2d=e.vpIdElliptical,null!==x&&x!==r.viewportIndex2d)return;t.distanceTo(e.ellipticalArc.vertices[0])<r.radius?(r.geomVertex=e.ellipticalArc.vertices[0],r.geomType=u.SNAP_VERTEX):t.distanceTo(e.ellipticalArc.vertices[e.ellipticalArc.vertices.length-1])<r.radius?(r.geomVertex=e.ellipticalArc.vertices[e.ellipticalArc.vertices.length-1],r.geomType=u.SNAP_VERTEX):(this.lineStripToPieces(e.ellipticalArc),r.geomEdge=e.ellipticalArc,r.circularArcCenter=e.ellipticalArcCenter,r.circularArcRadius=null,r.geomType=u.SNAP_CIRCULARARC),S=!0}else if(e.lineGeom.vertices.length){if(r.viewportIndex2d=e.vpIdLine,null!==x&&x!==r.viewportIndex2d)return;if(r.geomEdge=e.lineGeom,this.markupMode){var n=e.lineGeom.vertices[0],s=e.lineGeom.vertices[1],a=new THREE.Vector3;a.addVectors(n,s),a.divideScalar(2);var o=t.distanceTo(a),c=t.distanceTo(n),d=t.distanceTo(s);r.geomEdge=e.lineGeom,o<r.radius?(r.geomVertex=a,r.geomType=u.SNAP_VERTEX):c<r.radius?(r.geomVertex=n,r.geomType=u.SNAP_VERTEX):d<r.radius?(r.geomVertex=s,r.geomType=u.SNAP_VERTEX):r.geomType=u.SNAP_EDGE,e.lineGeom.vertices[0].distanceTo(e.lineGeom.vertices[1])<l&&(r.geomType=u.SNAP_CIRCLE_CENTER)}else t.distanceTo(e.lineGeom.vertices[0])<r.radius?(e.lineGeom.vertices[0].distanceTo(e.lineGeom.vertices[1])<l?r.geomType=u.SNAP_CIRCLE_CENTER:r.geomType=u.SNAP_VERTEX,r.geomVertex=e.lineGeom.vertices[0]):E.forceSnapVertices||t.distanceTo(e.lineGeom.vertices[1])<r.radius?(r.geomVertex=e.lineGeom.vertices[1],r.geomType=u.SNAP_VERTEX):r.geomType=u.SNAP_EDGE;S=!0}},this.snappingRasterPixel=function(e){if(e){var t=e.intersectPoint;r.intersectPoint=t,r.hasTopology=!1,r.radius=this.setDetectRadius(t),r.geomType=u.RASTER_PIXEL,r.geomVertex=t,S=!0}},this.snapMidpoint=function(){if(r.isMidpoint=!1,S&&r.geomType===u.SNAP_EDGE){var e=r.geomEdge,t=e.vertices[0],i=e.vertices[1],n=new THREE.Vector3((t.x+i.x)/2,(t.y+i.y)/2,(t.z+i.z)/2);r.intersectPoint.distanceTo(n)<2*r.radius&&(r.geomVertex=n,r.geomType=u.SNAP_MIDPOINT)}},this.setPerpendicular=function(e){r.isPerpendicular=e},this.lineStripToPieces=function(e){for(var t=e.vertices,r=t.length-2;r>0;r--)t.splice(r,0,t[r])},this.setDetectRadius=function(e){var t=a.navigation,r=t.getCamera(),i=t.getPosition(),n=e.clone(),s=r.isPerspective?n.sub(i).length():t.getEyeVector().length(),o=t.getVerticalFov(),c=2*s*Math.tan(THREE.Math.degToRad(.5*o)),l=t.getScreenViewport(),u=this.getWindow().devicePixelRatio||1;return this.detectRadiusInPixels*c/(l.height*u)},this.handleButtonDown=function(){return R=!0,!1},this.handleButtonUp=function(){return R=!1,!1},this.handleMouseMove=function(e){return R||this.onMouseMove({x:e.canvasX,y:e.canvasY}),!1},this.handleSingleTap=function(e){return this.handleMouseMove(e)},this.handlePressHold=function(e){if(p.isMobileDevice())switch(e.type){case"press":V=!0,this.onMouseMove({x:e.canvasX,y:e.canvasY});break;case"pressup":this.onMouseMove({x:e.canvasX,y:e.canvasY}),V=!1}return!1},this.handleGesture=function(e){if(p.isMobileDevice()&&V)switch(e.type){case"dragstart":case"dragmove":this.onMouseMove({x:e.canvasX,y:e.canvasY});break;case"dragend":this.onMouseMove({x:e.canvasX,y:e.canvasY}),V=!1}return!1},this.onMouseDown=function(e){return this.onMouseMove(e)},this.onMouseMove=function(e){var t,i;this.clearSnapped();var n=a.impl.snappingHitTest(e.x,e.y,!1);if(!n&&b){var s=a.impl.clientToViewport(e.x,e.y);n={intersectPoint:a.impl.intersectGroundViewport(s)}}if(!n||!n.intersectPoint)return!1;var o=(null===(t=n.model)||void 0===t?void 0:t.isLeaflet())||a.impl.is2d&&(null===(i=a.model)||void 0===i?void 0:i.isLeaflet());if(n.face)this.snapping3D(n);else if(!n.dbId&&0!==n.dbId||o){(b||o)&&this.snappingRasterPixel(n)}else this.snapping2D(n);return this.snapMidpoint(),!(A&&!A(r))||(this.clearSnapped(),!1)}}p.GlobalManagerMixin.call(y.prototype)},71:function(e,t,r){"use strict";r.r(t),r.d(t,"nearestPointOnCircularArc",(function(){return i})),r.d(t,"intersectLines",(function(){return n}));var i=function(e,t,r,i,n,s){var a=(s=s||new THREE.Vector2).copy(e).sub(t).normalize(),o=Math.atan2(a.y,a.x);if(Autodesk.Extensions.CompGeom.angleInsideArc(o,i,n))return a.multiplyScalar(r).add(t);var c=Autodesk.Extensions.CompGeom.getEllipsePoint(i,t.x,t.y,r,r),l=Autodesk.Extensions.CompGeom.getEllipsePoint(n,t.x,t.y,r,r),u=c.distanceToSquared(e)<=l.distanceToSquared(e);return s.copy(u?c:l),s},n=function(e,t,r,i,n,s){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1e-5,o=(i.y-r.y)*(t.x-e.x)-(i.x-r.x)*(t.y-e.y);if(Math.abs(o)<a)return null;var c=(i.x-r.x)*(e.y-r.y)-(i.y-r.y)*(e.x-r.x);if(c/=o,n){var l=(t.x-e.x)*(e.y-r.y)-(t.y-e.y)*(e.x-r.x);if(l/=o,c<0||c>1||l<0||l>1)return null}return(s=s||new THREE.Vector2).x=e.x+c*(t.x-e.x),s.y=e.y+c*(t.y-e.y),s}},72:function(e,t,r){"use strict";r.r(t),r.d(t,"SnapperIndicator",(function(){return u}));var i=Autodesk.Viewing.MeasureCommon,n=i.isEqualVectors,s=i.EPSILON,a=i.SnapType,o="MeasureTool-snapper-geometries",c="MeasureTool-snapper-indicator",l=null;function u(e,t){this.viewer=e,this.snapper=t,this.overlayType=0,this.previewsIntersectPoint=null,this.viewer.impl.createOverlayScene(o),this.viewer.impl.createOverlayScene(c),this.geometryMaterial=new THREE.MeshPhongMaterial({color:52224,ambient:52224,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),this.indicatorMaterial=new THREE.MeshBasicMaterial({color:16742144,ambient:16742144,opacity:1,transparent:!1,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide})}u.prototype.constructor=u;var d=u.prototype;d.render=function(){var e=this.snapper.getSnapResult();n(this.previewsIntersectPoint,e.intersectPoint,s)||this.clearOverlay(o),this.clearOverlay(c),e.isEmpty()||((this.snapper.renderSnappedGeometry||e.hasTopology&&this.snapper.renderSnappedTopology)&&this.renderGeometry(e),this.renderIndicator(e),this.previewsIntersectPoint=e.intersectPoint.clone())},d.removeOverlay=function(e){this.viewer.impl.clearOverlay(e),this.viewer.impl.removeOverlayScene(e)},d.clearOverlay=function(e){this.removeOverlay(e),this.viewer.impl.createOverlayScene(e)},d.clearOverlays=function(){this.removeOverlay(o),this.viewer.impl.createOverlayScene(o),this.removeOverlay(c),this.viewer.impl.createOverlayScene(c),this.previewsIntersectPoint=null},d.addOverlay=function(e,t){this.viewer.impl.addOverlay(e,t)},d.drawFace=function(e,t,r){var i=new THREE.Mesh(e,t,!0);r===o&&(this.overlayType=1),this.addOverlay(r,i)},d.cylinderMesh=function(e,t,r,i){var n=(new THREE.Vector3).subVectors(t,e),s=new THREE.Matrix4;s.lookAt(e,t,(new THREE.Object3D).up),s.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-n.length(),0,0,0,0,0,1)),i=i||.5;var a=new THREE.CylinderGeometry(i,i,1,8,1,!0),o=new THREE.Mesh(a,r);return a=null,o.applyMatrix(s),o.position.x=(t.x+e.x)/2,o.position.y=(t.y+e.y)/2,o.position.z=(t.z+e.z)/2,o},d.renderGeometry=function(e){if(!n(this.previewsIntersectPoint,e.intersectPoint,s))switch(e.geomType){case a.SNAP_VERTEX:a.RASTER_PIXEL,this.drawPoint(e.geomVertex,this.geometryMaterial,o);break;case a.SNAP_EDGE:case a.SNAP_CURVEDEDGE:case a.SNAP_CIRCULARARC:case a.SNAP_MIDPOINT:this.drawLine(e.geomEdge,this.geometryMaterial,.3,o);break;case a.SNAP_FACE:case a.SNAP_CURVEDFACE:this.drawFace(e.geomFace,this.geometryMaterial,o)}},d.renderVertexIndicator=function(e){var t=i.getSnapResultPosition(e,this.viewer),r=1.2*this.setScale(t),n=this.viewer.navigation.getCameraRightVector().multiplyScalar(r),s=this.viewer.navigation.getCameraUpVector().multiplyScalar(r),a=new THREE.Geometry,o=new THREE.Vector3;o.addVectors(t,n),o.addVectors(o,s),a.vertices[0]=o.clone(),o.subVectors(t,n),o.addVectors(o,s),a.vertices[1]=o.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),o.addVectors(t,n),o.subVectors(o,s),a.vertices[0]=o.clone(),o.subVectors(t,n),o.subVectors(o,s),a.vertices[1]=o.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),o.subVectors(t,n),o.subVectors(o,s),a.vertices[0]=o.clone(),o.subVectors(t,n),o.addVectors(o,s),a.vertices[1]=o.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),o.addVectors(t,n),o.subVectors(o,s),a.vertices[0]=o.clone(),o.addVectors(t,n),o.addVectors(o,s),a.vertices[1]=o.clone(),this.drawLine(a,this.indicatorMaterial,.2,c)},d.renderMidpointIndicator=function(e){var t=e.geomVertex,r=1.2*this.setScale(t),i=this.viewer.navigation.getCameraRightVector().multiplyScalar(r),n=this.viewer.navigation.getCameraUpVector().multiplyScalar(r),s=new THREE.Geometry,a=new THREE.Vector3;a.addVectors(t,i),a.subVectors(a,n),s.vertices[0]=a.clone(),a.subVectors(t,i),a.subVectors(a,n),s.vertices[1]=a.clone(),this.drawLine(s,this.indicatorMaterial,.2,c),a.subVectors(t,i),a.subVectors(a,n),s.vertices[0]=a.clone(),a.addVectors(t,n),s.vertices[1]=a.clone(),this.drawLine(s,this.indicatorMaterial,.2,c),a.addVectors(t,i),a.subVectors(a,n),s.vertices[0]=a.clone(),a.addVectors(t,n),s.vertices[1]=a.clone(),this.drawLine(s,this.indicatorMaterial,.2,c)},d.renderEdgeIndicator=function(e){var t=i.getSnapResultPosition(e,this.viewer),r=1.2*this.setScale(t),n=this.viewer.navigation.getCameraRightVector().multiplyScalar(r),s=this.viewer.navigation.getCameraUpVector().multiplyScalar(r),a=new THREE.Geometry,o=new THREE.Vector3;o.addVectors(t,n),o.subVectors(o,s),a.vertices[0]=o.clone(),a.vertices[1]=t.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),o.subVectors(t,n),o.subVectors(o,s),a.vertices[0]=o.clone(),a.vertices[1]=t.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),o.addVectors(t,s),a.vertices[0]=o.clone(),a.vertices[1]=t.clone(),this.drawLine(a,this.indicatorMaterial,.2,c)},d.renderCircleIndicator=function(e){var t=i.getSnapResultPosition(e,this.viewer);this.drawCircle(t,this.indicatorMaterial,c)},d.renderPerpendicular=function(e){var t=i.getSnapResultPosition(e,this.viewer),r=1.2*this.setScale(t),n=this.viewer.navigation.getCameraRightVector().multiplyScalar(r),s=this.viewer.navigation.getCameraUpVector().multiplyScalar(r),a=new THREE.Geometry,o=new THREE.Vector3;a.vertices[0]=t.clone(),o.subVectors(t,n),a.vertices[1]=o.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),o.addVectors(t,n),o.subVectors(o,s),a.vertices[0]=o.clone(),o.subVectors(t,n),o.subVectors(o,s),a.vertices[1]=o.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),o.subVectors(t,n),o.subVectors(o,s),a.vertices[0]=o.clone(),o.subVectors(t,n),o.addVectors(o,s),a.vertices[1]=o.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),a.vertices[0]=t.clone(),o.subVectors(t,s),a.vertices[1]=o.clone(),this.drawLine(a,this.indicatorMaterial,.2,c)},d.renderPixelIndicator=function(e){var t=i.getSnapResultPosition(e,this.viewer),r=1.2*this.setScale(t),n=this.viewer.navigation.getCameraRightVector().multiplyScalar(r),s=this.viewer.navigation.getCameraUpVector().multiplyScalar(r),a=new THREE.Geometry,o=new THREE.Vector3;o.subVectors(t,n),o.addVectors(o,s),a.vertices[0]=o.clone(),a.vertices[1]=t.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),o.addVectors(t,n),o.addVectors(o,s),a.vertices[0]=o.clone(),a.vertices[1]=t.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),o.addVectors(t,n),o.subVectors(o,s),a.vertices[0]=o.clone(),a.vertices[1]=t.clone(),this.drawLine(a,this.indicatorMaterial,.2,c),o.subVectors(t,n),o.subVectors(o,s),a.vertices[0]=o.clone(),a.vertices[1]=t.clone(),this.drawLine(a,this.indicatorMaterial,.2,c)},d.renderIndicator=function(e){if(e.isPerpendicular)this.renderPerpendicular(e);else if(e.snapToArc)e.isArc&&e.geomType===a.SNAP_CIRCULARARC&&this.viewer.model.is2d()&&!this.viewer.model.isPdf()&&this.renderVertexIndicator(e);else switch(e.geomType){case a.SNAP_VERTEX:case a.SNAP_INTERSECTION:this.renderVertexIndicator(e);break;case a.SNAP_MIDPOINT:this.renderMidpointIndicator(e);break;case a.SNAP_CIRCLE_CENTER:this.renderCircleIndicator(e);break;case a.SNAP_EDGE:case a.SNAP_CURVEDEDGE:this.renderEdgeIndicator(e);break;case a.SNAP_CIRCULARARC:this.viewer.model.is2d()?this.renderVertexIndicator(e):this.renderCircleIndicator(e);break;case a.SNAP_FACE:case a.SNAP_CURVEDFACE:this.renderVertexIndicator(e);break;case a.RASTER_PIXEL:this.renderPixelIndicator(e)}},d.drawLine=function(e,t,r,i){i===o&&(this.overlayType=2);for(var n=0;n<e.vertices.length;n+=2){var s=this.cylinderMesh(e.vertices[n],e.vertices[n+1],t,r);this.setEdgeScale(s),this.addOverlay(i,s)}},d.drawPoint=function(e,t,r){if(!this.viewer.model.isLeaflet()){l||(l=new THREE.SphereGeometry(1));var i=new THREE.Mesh(l,t);i.position.set(e.x,e.y,e.z),this.setPointScale(i),r===o&&(this.overlayType=3),this.addOverlay(r,i)}},d.drawCircle=function(e,t,r){var i=new THREE.TorusGeometry(1.2,.2,2,20),n=new THREE.Mesh(i,t);n.lookAt(this.viewer.navigation.getEyeVector().normalize()),i=null,n.position.set(e.x,e.y,e.z),this.setCircleScale(n),this.addOverlay(r,n)},d.setScale=function(e){var t=this.viewer.navigation,r=t.getCamera(),i=t.getPosition(),n=e.clone(),s=r.isPerspective?n.sub(i).length():t.getEyeVector().length(),a=t.getVerticalFov();return 5*(2*s*Math.tan(THREE.Math.degToRad(.5*a)))/t.getScreenViewport().height},d.setPointScale=function(e){var t=this.setScale(e.position);e.scale.x=t,e.scale.y=t,e.scale.z=t},d.setCircleScale=function(e){var t=this.setScale(e.position);e.scale.x=t,e.scale.y=t},d.setEdgeScale=function(e){var t=this.setScale(e.position);e.scale.x=t,e.scale.z=t},d.updatePointScale=function(e){if(3==this.overlayType){var t=this.viewer.impl.overlayScenes[e];if(t)for(var r=t.scene,i=0;i<r.children.length;i++){var n=r.children[i];n&&this.setPointScale(n)}}},d.updateEdgeScale=function(e){if(2==this.overlayType){var t=this.viewer.impl.overlayScenes[e];if(t)for(var r=t.scene,i=0;i<r.children.length;i++){var n=r.children[i];n&&this.setEdgeScale(n)}}},d.onCameraChange=function(){this.updatePointScale(o),this.updateEdgeScale(o),this.render()},d.destroy=function(){this.removeOverlay(o),this.removeOverlay(c),l&&(l.dispose(),l=null)}}});
//# sourceMappingURL=Snapping.min.js.map
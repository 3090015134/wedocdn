/*!
 * LMV v7.9.0
 * 
 * Copyright 2019 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.BimMarkups=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=464)}([function(e,t,n){var r=n(350),i=n(45),A=36e5,a=6e4,o=2,s=/[T ]/,u=/:/,l=/^(\d{2})$/,c=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],h=/^(\d{4})/,d=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],f=/^-(\d{2})$/,p=/^-?(\d{3})$/,g=/^-?(\d{2})-?(\d{2})$/,y=/^-?W(\d{2})$/,m=/^-?W(\d{2})-?(\d{1})$/,E=/^(\d{2}([.,]\d*)?)$/,v=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,B=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/([Z+-].*)$/,k=/^(Z)$/,C=/^([+-])(\d{2})$/,b=/^([+-])(\d{2}):?(\d{2})$/;function S(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(i(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var T=function(e){var t,n={},r=e.split(s);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var i=w.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),M=function(e,t){var n,r=c[t],i=d[t];if(n=h.exec(e)||i.exec(e)){var A=n[1];return{year:parseInt(A,10),restDateString:e.slice(A.length)}}if(n=l.exec(e)||r.exec(e)){var a=n[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(T.date,n),U=M.year,Q=function(e,t){if(null===t)return null;var n,r,i,A;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=f.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=p.exec(e)){r=new Date(0);var a=parseInt(n[1],10);return r.setUTCFullYear(t,0,a),r}if(n=g.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var o=parseInt(n[2],10);return r.setUTCFullYear(t,i,o),r}if(n=y.exec(e))return A=parseInt(n[1],10)-1,S(t,A);if(n=m.exec(e)){A=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return S(t,A,s)}return null}(M.restDateString,U);if(Q){var x,F=Q.getTime(),_=0;if(T.time&&(_=function(e){var t,n,r;if(t=E.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*A;if(t=v.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*A+r*a;if(t=B.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*A+r*a+1e3*i}return null}(T.time)),T.timezone)x=function(e){var t,n;if(t=k.exec(e))return 0;if(t=C.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=b.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(T.timezone)*a;else{var H=F+_,L=new Date(H);x=r(L);var I=new Date(H);I.setDate(L.getDate()+1);var D=r(I)-r(L);D>0&&(x+=D)}return new Date(F+_+x)}return new Date(e)}},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(a=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),A=r.sources.map((function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"}));return[n].concat(A).concat([i]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var A=this[i][0];"number"==typeof A&&(r[A]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(e,t,n){var r,i,A={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=r.apply(this,arguments)),i}),o=function(e,t){return t?t.querySelector(e):document.querySelector(e)},s=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=o.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),u=null,l=0,c=[],h=n(3);function d(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=A[r.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](r.parts[a]);for(;a<r.parts.length;a++)i.parts.push(E(r.parts[a],t))}else{var o=[];for(a=0;a<r.parts.length;a++)o.push(E(r.parts[a],t));A[r.id]={id:r.id,refs:1,parts:o}}}}function f(e,t){for(var n=[],r={},i=0;i<e.length;i++){var A=e[i],a=t.base?A[0]+t.base:A[0],o={css:A[1],media:A[2],sourceMap:A[3]};r[a]?r[a].parts.push(o):n.push(r[a]={id:a,parts:[o]})}return n}function p(e,t){var n=s(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=c[c.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),c.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=s(e.insertAt.before,n);n.insertBefore(t,i)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function y(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return m(t,e.attrs),p(e,t),t}function m(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function E(e,t){var n,r,i,A;if(t.transform&&e.css){if(!(A="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=A}if(t.singleton){var a=l++;n=u||(u=y(t)),r=w.bind(null,n,a,!1),i=w.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",m(t,e.attrs),p(e,t),t}(t),r=C.bind(null,n,t),i=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=y(t),r=k.bind(null,n),i=function(){g(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=f(e,t);return d(n,t),function(e){for(var r=[],i=0;i<n.length;i++){var a=n[i];(o=A[a.id]).refs--,r.push(o)}e&&d(f(e,t),t);for(i=0;i<r.length;i++){var o;if(0===(o=r[i]).refs){for(var s=0;s<o.parts.length;s++)o.parts[s]();delete A[o.id]}}}};var v,B=(v=[],function(e,t){return v[e]=t,v.filter(Boolean).join("\n")});function w(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=B(t,i);else{var A=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(A,a[t]):e.appendChild(A)}}function k(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function C(e,t,n){var r=n.css,i=n.sourceMap,A=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||A)&&(r=h(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(a),o&&URL.revokeObjectURL(o)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var i,A=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(A)?e:(i=0===A.indexOf("//")?A:0===A.indexOf("/")?n+A:r+A.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},function(e,t){e.exports=THREE},,,,function(e,t,n){var r=n(452),i=n(453),A=i;A.v1=r,A.v4=i,e.exports=A},,,function(e,t,n){(function(e,r){var i;function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/**
                                                                                                                                                                                                                                                                                                                                                      * @license
                                                                                                                                                                                                                                                                                                                                                      * Lodash (Custom Build) <https://lodash.com/>
                                                                                                                                                                                                                                                                                                                                                      * Build: `lodash include="cloneDeep,debounce,findLast,remove" exports="amd"`
                                                                                                                                                                                                                                                                                                                                                      * Copyright JS Foundation and other contributors <https://js.foundation/>
                                                                                                                                                                                                                                                                                                                                                      * Released under MIT license <https://lodash.com/license>
                                                                                                                                                                                                                                                                                                                                                      * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
                                                                                                                                                                                                                                                                                                                                                      * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
                                                                                                                                                                                                                                                                                                                                                      */(function(){var a,o=200,s="Expected a function",u="__lodash_hash_undefined__",l=500,c=1,h=2,d=4,f=1,p=2,g=1/0,y=9007199254740991,m=17976931348623157e292,E=NaN,v="[object Arguments]",B="[object Array]",w="[object AsyncFunction]",k="[object Boolean]",C="[object Date]",b="[object Error]",S="[object Function]",T="[object GeneratorFunction]",M="[object Map]",U="[object Number]",Q="[object Null]",x="[object Object]",F="[object Proxy]",_="[object RegExp]",H="[object Set]",L="[object String]",I="[object Symbol]",D="[object Undefined]",O="[object WeakMap]",R="[object ArrayBuffer]",N="[object DataView]",P="[object Float32Array]",K="[object Float64Array]",V="[object Int8Array]",j="[object Int16Array]",G="[object Int32Array]",z="[object Uint8Array]",Y="[object Uint8ClampedArray]",W="[object Uint16Array]",X="[object Uint32Array]",J=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,q=/^\w*$/,Z=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$=/^\s+|\s+$/g,ee=/\\(\\)?/g,te=/\w*$/,ne=/^[-+]0x[0-9a-f]+$/i,re=/^0b[01]+$/i,ie=/^\[object .+?Constructor\]$/,Ae=/^0o[0-7]+$/i,ae=/^(?:0|[1-9]\d*)$/,oe={};oe[P]=oe[K]=oe[V]=oe[j]=oe[G]=oe[z]=oe[Y]=oe[W]=oe[X]=!0,oe[v]=oe[B]=oe[R]=oe[k]=oe[N]=oe[C]=oe[b]=oe[S]=oe[M]=oe[U]=oe[x]=oe[_]=oe[H]=oe[L]=oe[O]=!1;var se={};se[v]=se[B]=se[R]=se[N]=se[k]=se[C]=se[P]=se[K]=se[V]=se[j]=se[G]=se[M]=se[U]=se[x]=se[_]=se[H]=se[L]=se[I]=se[z]=se[Y]=se[W]=se[X]=!0,se[b]=se[S]=se[O]=!1;var ue=parseInt,le="object"==(void 0===e?"undefined":A(e))&&e&&e.Object===Object&&e,ce="object"==("undefined"==typeof self?"undefined":A(self))&&self&&self.Object===Object&&self,he=le||ce||Function("return this")(),de="object"==A(t)&&t&&!t.nodeType&&t,fe=de&&"object"==A(r)&&r&&!r.nodeType&&r,pe=fe&&fe.exports===de,ge=pe&&le.process,ye=function(){try{return ge&&ge.binding&&ge.binding("util")}catch(e){}}(),me=ye&&ye.isMap,Ee=ye&&ye.isSet,ve=ye&&ye.isTypedArray;function Be(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function we(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function ke(e){return function(t){return e(t)}}function Ce(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function be(e,t){return function(n){return e(t(n))}}function Se(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var Te,Me=Array.prototype,Ue=Function.prototype,Qe=Object.prototype,xe=he["__core-js_shared__"],Fe=Ue.toString,_e=Qe.hasOwnProperty,He=(Te=/[^.]+$/.exec(xe&&xe.keys&&xe.keys.IE_PROTO||""))?"Symbol(src)_1."+Te:"",Le=Qe.toString,Ie=RegExp("^"+Fe.call(_e).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=pe?he.Buffer:a,Oe=he.Symbol,Re=he.Uint8Array,Ne=De?De.allocUnsafe:a,Pe=be(Object.getPrototypeOf,Object),Ke=Object.create,Ve=Qe.propertyIsEnumerable,je=Me.splice,Ge=Oe?Oe.toStringTag:a,ze=function(){try{var e=Vt(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ye=Object.getOwnPropertySymbols,We=De?De.isBuffer:a,Xe=be(Object.keys,Object),Je=Math.max,qe=Math.min,Ze=Vt(he,"DataView"),$e=Vt(he,"Map"),et=Vt(he,"Promise"),tt=Vt(he,"Set"),nt=Vt(he,"WeakMap"),rt=Vt(Object,"create"),it=en(Ze),At=en($e),at=en(et),ot=en(tt),st=en(nt),ut=Oe?Oe.prototype:a,lt=ut?ut.valueOf:a,ct=ut?ut.toString:a;function ht(){}var dt=function(){function e(){}return function(t){if(!pn(t))return{};if(Ke)return Ke(t);e.prototype=t;var n=new e;return e.prototype=a,n}}();function ft(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function pt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function gt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function yt(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new gt;++t<n;)this.add(e[t])}function mt(e){var t=this.__data__=new pt(e);this.size=t.size}function Et(e,t){var n=ln(e),r=!n&&un(e),i=!n&&!r&&hn(e),A=!n&&!r&&!i&&vn(e),a=n||r||i||A,o=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],s=o.length;for(var u in e)!t&&!_e.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||A&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Yt(u,s))||o.push(u);return o}function vt(e,t,n){var r=e[t];_e.call(e,t)&&sn(r,n)&&(n!==a||t in e)||wt(e,t,n)}function Bt(e,t){for(var n=e.length;n--;)if(sn(e[n][0],t))return n;return-1}function wt(e,t,n){"__proto__"==t&&ze?ze(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function kt(e,t,n,r,i,A){var o,s=t&c,u=t&h,l=t&d;if(n&&(o=i?n(e,r,i,A):n(e)),o!==a)return o;if(!pn(e))return e;var f=ln(e);if(f){if(o=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&_e.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!s)return function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(e,o)}else{var p=zt(e),g=p==S||p==T;if(hn(e))return function(e,t){if(t)return e.slice();var n=e.length,r=Ne?Ne(n):new e.constructor(n);return e.copy(r),r}(e,s);if(p==x||p==v||g&&!i){if(o=u||g?{}:function(e){return"function"!=typeof e.constructor||Xt(e)?{}:dt(Pe(e))}(e),!s)return u?function(e,t){return Dt(e,Gt(e),t)}(e,function(e,t){return e&&Dt(t,Mn(t),e)}(o,e)):function(e,t){return Dt(e,jt(e),t)}(e,function(e,t){return e&&Dt(t,Tn(t),e)}(o,e))}else{if(!se[p])return i?e:{};o=function(e,t,n){var r=e.constructor;switch(t){case R:return It(e);case k:case C:return new r(+e);case N:return function(e,t){var n=t?It(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case P:case K:case V:case j:case G:case z:case Y:case W:case X:return function(e,t){var n=t?It(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,n);case M:return new r;case U:case L:return new r(e);case _:return(a=new(A=e).constructor(A.source,te.exec(A))).lastIndex=A.lastIndex,a;case H:return new r;case I:return i=e,lt?Object(lt.call(i)):{}}var i;var A,a}(e,p,s)}}A||(A=new mt);var y=A.get(e);if(y)return y;if(A.set(e,o),mn(e))return e.forEach((function(r){o.add(kt(r,t,n,r,e,A))})),o;if(yn(e))return e.forEach((function(r,i){o.set(i,kt(r,t,n,i,e,A))})),o;var m=f?a:(l?u?Nt:Rt:u?Mn:Tn)(e);return function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););}(m||e,(function(r,i){m&&(r=e[i=r]),vt(o,i,kt(r,t,n,i,e,A))})),o}function Ct(e,t){for(var n=0,r=(t=Lt(t,e)).length;null!=e&&n<r;)e=e[$t(t[n++])];return n&&n==r?e:a}function bt(e,t,n){var r=t(e);return ln(e)?r:Be(r,n(e))}function St(e){return null==e?e===a?D:Q:Ge&&Ge in Object(e)?function(e){var t=_e.call(e,Ge),n=e[Ge];try{e[Ge]=a;var r=!0}catch(e){}var i=Le.call(e);r&&(t?e[Ge]=n:delete e[Ge]);return i}(e):function(e){return Le.call(e)}(e)}function Tt(e,t){return null!=e&&t in Object(e)}function Mt(e){return gn(e)&&St(e)==v}function Ut(e,t,n,r,i){return e===t||(null==e||null==t||!gn(e)&&!gn(t)?e!=e&&t!=t:function(e,t,n,r,i,A){var o=ln(e),s=ln(t),u=o?B:zt(e),l=s?B:zt(t),c=(u=u==v?x:u)==x,h=(l=l==v?x:l)==x,d=u==l;if(d&&hn(e)){if(!hn(t))return!1;o=!0,c=!1}if(d&&!c)return A||(A=new mt),o||vn(e)?Ot(e,t,n,r,i,A):function(e,t,n,r,i,A,a){switch(n){case N:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case R:return!(e.byteLength!=t.byteLength||!A(new Re(e),new Re(t)));case k:case C:case U:return sn(+e,+t);case b:return e.name==t.name&&e.message==t.message;case _:case L:return e==t+"";case M:var o=Ce;case H:var s=r&f;if(o||(o=Se),e.size!=t.size&&!s)return!1;var u=a.get(e);if(u)return u==t;r|=p,a.set(e,t);var l=Ot(o(e),o(t),r,i,A,a);return a.delete(e),l;case I:if(lt)return lt.call(e)==lt.call(t)}return!1}(e,t,u,n,r,i,A);if(!(n&f)){var g=c&&_e.call(e,"__wrapped__"),y=h&&_e.call(t,"__wrapped__");if(g||y){var m=g?e.value():e,E=y?t.value():t;return A||(A=new mt),i(m,E,n,r,A)}}if(!d)return!1;return A||(A=new mt),function(e,t,n,r,i,A){var o=n&f,s=Rt(e),u=s.length,l=Rt(t).length;if(u!=l&&!o)return!1;var c=u;for(;c--;){var h=s[c];if(!(o?h in t:_e.call(t,h)))return!1}var d=A.get(e);if(d&&A.get(t))return d==t;var p=!0;A.set(e,t),A.set(t,e);var g=o;for(;++c<u;){h=s[c];var y=e[h],m=t[h];if(r)var E=o?r(m,y,h,t,e,A):r(y,m,h,e,t,A);if(!(E===a?y===m||i(y,m,n,r,A):E)){p=!1;break}g||(g="constructor"==h)}if(p&&!g){var v=e.constructor,B=t.constructor;v!=B&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof B&&B instanceof B)&&(p=!1)}return A.delete(e),A.delete(t),p}(e,t,n,r,i,A)}(e,t,n,r,Ut,i))}function Qt(e){return!(!pn(e)||(t=e,He&&He in t))&&(dn(e)?Ie:ie).test(en(e));var t}function xt(e){return"function"==typeof e?e:null==e?Un:"object"==A(e)?ln(e)?function(e,t){if(Wt(e)&&Jt(t))return qt($t(e),t);return function(n){var r=bn(n,e);return r===a&&r===t?Sn(n,e):Ut(t,r,f|p)}}(e[0],e[1]):function(e){var t=function(e){var t=Tn(e),n=t.length;for(;n--;){var r=t[n],i=e[r];t[n]=[r,i,Jt(i)]}return t}(e);if(1==t.length&&t[0][2])return qt(t[0][0],t[0][1]);return function(n){return n===e||function(e,t,n,r){var i=n.length,A=i,o=!r;if(null==e)return!A;for(e=Object(e);i--;){var s=n[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<A;){var u=(s=n[i])[0],l=e[u],c=s[1];if(o&&s[2]){if(l===a&&!(u in e))return!1}else{var h=new mt;if(r)var d=r(l,c,u,e,t,h);if(!(d===a?Ut(c,l,f|p,r,h):d))return!1}}return!0}(n,e,t)}}(e):xn(e)}function Ft(e){if(!pn(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Xt(e),n=[];for(var r in e)("constructor"!=r||!t&&_e.call(e,r))&&n.push(r);return n}function _t(e){if("string"==typeof e)return e;if(ln(e))return function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}(e,_t)+"";if(En(e))return ct?ct.call(e):"";var t=e+"";return"0"==t&&1/e==-g?"-0":t}function Ht(e,t){return null==(e=function(e,t){return t.length<2?e:Ct(e,function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var A=Array(i);++r<i;)A[r]=e[r+t];return A}(t,0,-1))}(e,t=Lt(t,e)))||delete e[$t(nn(t))]}function Lt(e,t){return ln(e)?e:Wt(e,t)?[e]:Zt(Cn(e))}function It(e){var t=new e.constructor(e.byteLength);return new Re(t).set(new Re(e)),t}function Dt(e,t,n,r){var i=!n;n||(n={});for(var A=-1,o=t.length;++A<o;){var s=t[A],u=r?r(n[s],e[s],s,n,e):a;u===a&&(u=e[s]),i?wt(n,s,u):vt(n,s,u)}return n}function Ot(e,t,n,r,i,A){var o=n&f,s=e.length,u=t.length;if(s!=u&&!(o&&u>s))return!1;var l=A.get(e);if(l&&A.get(t))return l==t;var c=-1,h=!0,d=n&p?new yt:a;for(A.set(e,t),A.set(t,e);++c<s;){var g=e[c],y=t[c];if(r)var m=o?r(y,g,c,t,e,A):r(g,y,c,e,t,A);if(m!==a){if(m)continue;h=!1;break}if(d){if(!we(t,(function(e,t){if(a=t,!d.has(a)&&(g===e||i(g,e,n,r,A)))return d.push(t);var a}))){h=!1;break}}else if(g!==y&&!i(g,y,n,r,A)){h=!1;break}}return A.delete(e),A.delete(t),h}function Rt(e){return bt(e,Tn,jt)}function Nt(e){return bt(e,Mn,Gt)}function Pt(){var e=ht.iteratee||Qn;return e=e===Qn?xt:e,arguments.length?e(arguments[0],arguments[1]):e}function Kt(e,t){var n,r,i=e.__data__;return("string"==(r=A(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Vt(e,t){var n=function(e,t){return null==e?a:e[t]}(e,t);return Qt(n)?n:a}ft.prototype.clear=function(){this.__data__=rt?rt(null):{},this.size=0},ft.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ft.prototype.get=function(e){var t=this.__data__;if(rt){var n=t[e];return n===u?a:n}return _e.call(t,e)?t[e]:a},ft.prototype.has=function(e){var t=this.__data__;return rt?t[e]!==a:_e.call(t,e)},ft.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=rt&&t===a?u:t,this},pt.prototype.clear=function(){this.__data__=[],this.size=0},pt.prototype.delete=function(e){var t=this.__data__,n=Bt(t,e);return!(n<0)&&(n==t.length-1?t.pop():je.call(t,n,1),--this.size,!0)},pt.prototype.get=function(e){var t=this.__data__,n=Bt(t,e);return n<0?a:t[n][1]},pt.prototype.has=function(e){return Bt(this.__data__,e)>-1},pt.prototype.set=function(e,t){var n=this.__data__,r=Bt(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},gt.prototype.clear=function(){this.size=0,this.__data__={hash:new ft,map:new($e||pt),string:new ft}},gt.prototype.delete=function(e){var t=Kt(this,e).delete(e);return this.size-=t?1:0,t},gt.prototype.get=function(e){return Kt(this,e).get(e)},gt.prototype.has=function(e){return Kt(this,e).has(e)},gt.prototype.set=function(e,t){var n=Kt(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},yt.prototype.add=yt.prototype.push=function(e){return this.__data__.set(e,u),this},yt.prototype.has=function(e){return this.__data__.has(e)},mt.prototype.clear=function(){this.__data__=new pt,this.size=0},mt.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},mt.prototype.get=function(e){return this.__data__.get(e)},mt.prototype.has=function(e){return this.__data__.has(e)},mt.prototype.set=function(e,t){var n=this.__data__;if(n instanceof pt){var r=n.__data__;if(!$e||r.length<o-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new gt(r)}return n.set(e,t),this.size=n.size,this};var jt=Ye?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,A=[];++n<r;){var a=e[n];t(a,n,e)&&(A[i++]=a)}return A}(Ye(e),(function(t){return Ve.call(e,t)})))}:Fn,Gt=Ye?function(e){for(var t=[];e;)Be(t,jt(e)),e=Pe(e);return t}:Fn,zt=St;function Yt(e,t){var n=A(e);return!!(t=null==t?y:t)&&("number"==n||"symbol"!=n&&ae.test(e))&&e>-1&&e%1==0&&e<t}function Wt(e,t){if(ln(e))return!1;var n=A(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!En(e))||(q.test(e)||!J.test(e)||null!=t&&e in Object(t))}function Xt(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Qe)}function Jt(e){return e==e&&!pn(e)}function qt(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==a||e in Object(n)))}}(Ze&&zt(new Ze(new ArrayBuffer(1)))!=N||$e&&zt(new $e)!=M||et&&"[object Promise]"!=zt(et.resolve())||tt&&zt(new tt)!=H||nt&&zt(new nt)!=O)&&(zt=function(e){var t=St(e),n=t==x?e.constructor:a,r=n?en(n):"";if(r)switch(r){case it:return N;case At:return M;case at:return"[object Promise]";case ot:return H;case st:return O}return t});var Zt=function(e){var t=on(e,(function(e){return n.size===l&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Z,(function(e,n,r,i){t.push(r?i.replace(ee,"$1"):n||e)})),t}));function $t(e){if("string"==typeof e||En(e))return e;var t=e+"";return"0"==t&&1/e==-g?"-0":t}function en(e){if(null!=e){try{return Fe.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function tn(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return n!==a&&(i=wn(n),i=n<0?Je(r+i,0):qe(i,r-1)),function(e,t,n,r){for(var i=e.length,A=n+(r?1:-1);r?A--:++A<i;)if(t(e[A],A,e))return A;return-1}(e,Pt(t,3),i,!0)}function nn(e){var t=null==e?0:e.length;return t?e[t-1]:a}var rn,An=(rn=tn,function(e,t,n){var r=Object(e);if(!cn(e)){var i=Pt(t,3);e=Tn(e),t=function(e){return i(r[e],e,r)}}var A=rn(e,t,n);return A>-1?r[i?e[A]:A]:a}),an=function(){return he.Date.now()};function on(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(s);var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],A=n.cache;if(A.has(i))return A.get(i);var a=e.apply(this,r);return n.cache=A.set(i,a)||A,a};return n.cache=new(on.Cache||gt),n}function sn(e,t){return e===t||e!=e&&t!=t}on.Cache=gt;var un=Mt(function(){return arguments}())?Mt:function(e){return gn(e)&&_e.call(e,"callee")&&!Ve.call(e,"callee")},ln=Array.isArray;function cn(e){return null!=e&&fn(e.length)&&!dn(e)}var hn=We||_n;function dn(e){if(!pn(e))return!1;var t=St(e);return t==S||t==T||t==w||t==F}function fn(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=y}function pn(e){var t=A(e);return null!=e&&("object"==t||"function"==t)}function gn(e){return null!=e&&"object"==A(e)}var yn=me?ke(me):function(e){return gn(e)&&zt(e)==M},mn=Ee?ke(Ee):function(e){return gn(e)&&zt(e)==H};function En(e){return"symbol"==A(e)||gn(e)&&St(e)==I}var vn=ve?ke(ve):function(e){return gn(e)&&fn(e.length)&&!!oe[St(e)]};function Bn(e){return e?(e=kn(e))===g||e===-g?(e<0?-1:1)*m:e==e?e:0:0===e?e:0}function wn(e){var t=Bn(e),n=t%1;return t==t?n?t-n:t:0}function kn(e){if("number"==typeof e)return e;if(En(e))return E;if(pn(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=pn(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace($,"");var n=re.test(e);return n||Ae.test(e)?ue(e.slice(2),n?2:8):ne.test(e)?E:+e}function Cn(e){return null==e?"":_t(e)}function bn(e,t,n){var r=null==e?a:Ct(e,t);return r===a?n:r}function Sn(e,t){return null!=e&&function(e,t,n){for(var r=-1,i=(t=Lt(t,e)).length,A=!1;++r<i;){var a=$t(t[r]);if(!(A=null!=e&&n(e,a)))break;e=e[a]}return A||++r!=i?A:!!(i=null==e?0:e.length)&&fn(i)&&Yt(a,i)&&(ln(e)||un(e))}(e,t,Tt)}function Tn(e){return cn(e)?Et(e):function(e){if(!Xt(e))return Xe(e);var t=[];for(var n in Object(e))_e.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}function Mn(e){return cn(e)?Et(e,!0):Ft(e)}function Un(e){return e}function Qn(e){return xt("function"==typeof e?e:kt(e,c))}function xn(e){return Wt(e)?(t=$t(e),function(e){return null==e?a:e[t]}):function(e){return function(t){return Ct(t,e)}}(e);var t}function Fn(){return[]}function _n(){return!1}ht.debounce=function(e,t,n){var r,i,A,o,u,l,c=0,h=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError(s);function p(t){var n=r,A=i;return r=i=a,c=t,o=e.apply(A,n)}function g(e){var n=e-l;return l===a||n>=t||n<0||d&&e-c>=A}function y(){var e=an();if(g(e))return m(e);u=setTimeout(y,function(e){var n=t-(e-l);return d?qe(n,A-(e-c)):n}(e))}function m(e){return u=a,f&&r?p(e):(r=i=a,o)}function E(){var e=an(),n=g(e);if(r=arguments,i=this,l=e,n){if(u===a)return function(e){return c=e,u=setTimeout(y,t),h?p(e):o}(l);if(d)return u=setTimeout(y,t),p(l)}return u===a&&(u=setTimeout(y,t)),o}return t=kn(t)||0,pn(n)&&(h=!!n.leading,A=(d="maxWait"in n)?Je(kn(n.maxWait)||0,t):A,f="trailing"in n?!!n.trailing:f),E.cancel=function(){u!==a&&clearTimeout(u),c=0,r=l=i=u=a},E.flush=function(){return u===a?o:m(an())},E},ht.iteratee=Qn,ht.keys=Tn,ht.keysIn=Mn,ht.memoize=on,ht.property=xn,ht.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],A=e.length;for(t=Pt(t,3);++r<A;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return function(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==A){var A=i;Yt(i)?je.call(e,i,1):Ht(e,i)}}}(e,i),n},ht.cloneDeep=function(e){return kt(e,c|d)},ht.eq=sn,ht.findLast=An,ht.findLastIndex=tn,ht.get=bn,ht.hasIn=Sn,ht.identity=Un,ht.isArguments=un,ht.isArray=ln,ht.isArrayLike=cn,ht.isBuffer=hn,ht.isFunction=dn,ht.isLength=fn,ht.isMap=yn,ht.isObject=pn,ht.isObjectLike=gn,ht.isSet=mn,ht.isSymbol=En,ht.isTypedArray=vn,ht.last=nn,ht.stubArray=Fn,ht.stubFalse=_n,ht.now=an,ht.toFinite=Bn,ht.toInteger=wn,ht.toNumber=kn,ht.toString=Cn,ht.VERSION="4.17.5","object"==A(n(64))&&n(64)&&((i=function(){return ht}.call(t,n,t,r))===a||(r.exports=i))}).call(this)}).call(this,n(14),n(63)(e))},,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,function(e,t,n){var r=n(0),i=n(17);e.exports=function(e){var t=r(e),n=t.getFullYear(),A=new Date(0);A.setFullYear(n+1,0,4),A.setHours(0,0,0,0);var a=i(A),o=new Date(0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);var s=i(o);return t.getTime()>=a.getTime()?n+1:t.getTime()>=s.getTime()?n:n-1}},function(e,t,n){var r=n(35);e.exports=function(e){return r(e,{weekStartsOn:1})}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e);return t.setHours(0,0,0,0),t}},,,function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setDate(n.getDate()+i),n}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},function(e,t,n){var r=n(16),i=n(17);e.exports=function(e){var t=r(e),n=new Date(0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),i(n)}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e).getTime(),i=r(t).getTime();return n<i?-1:n>i?1:0}},,,,,,function(e,t,n){"use strict";var r=n(4);n.d(t,"a",(function(){return i}));var i=function(e,t){this.textureID=void 0!==t?t:"tDiffuse",this.material=function(e){var t={vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return e.uniforms&&(t.uniforms=r.UniformsUtils.clone(e.uniforms)),e.defines&&(t.defines=Object.assign({},e.defines)),e.extensions&&(t.extensions=Object.assign({},e.extensions)),e.attributes&&(t.attributes=e.attributes),new r.ShaderMaterial(t)}(e),this.uniforms=this.material.uniforms,this.renderToScreen=!1,this.enabled=!0,this.clear=!1,this.camera=new r.OrthographicCamera(-1,1,1,-1,0,1);var n=new r.BufferGeometry,i=new Float32Array(9);i[0]=-1,i[1]=-1,i[2]=0,i[3]=3,i[4]=-1,i[5]=0,i[6]=-1,i[7]=3,i[8]=0;var A=new Float32Array(6);A[0]=0,A[1]=0,A[2]=2,A[3]=0,A[4]=0,A[5]=2;var a=new Float32Array(9);a[0]=0,a[1]=0,a[2]=1,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=1,n.addAttribute("position",new r.BufferAttribute(i,3)),n.addAttribute("normal",new r.BufferAttribute(a,3)),n.addAttribute("uv",new r.BufferAttribute(A,2)),this.quad=new r.Mesh(n,this.material),this.scene=new r.Scene,this.scene.add(this.quad)};i.prototype={render:function(e,t,n,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture||n),this.renderToScreen||!t?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}}},,,,function(e,t,n){e.exports={addDays:n(21),addHours:n(65),addISOYears:n(66),addMilliseconds:n(22),addMinutes:n(68),addMonths:n(37),addQuarters:n(69),addSeconds:n(70),addWeeks:n(47),addYears:n(71),areRangesOverlapping:n(351),closestIndexTo:n(352),closestTo:n(353),compareAsc:n(24),compareDesc:n(48),differenceInCalendarDays:n(36),differenceInCalendarISOWeeks:n(354),differenceInCalendarISOYears:n(72),differenceInCalendarMonths:n(73),differenceInCalendarQuarters:n(355),differenceInCalendarWeeks:n(356),differenceInCalendarYears:n(75),differenceInDays:n(76),differenceInHours:n(357),differenceInISOYears:n(358),differenceInMilliseconds:n(38),differenceInMinutes:n(359),differenceInMonths:n(49),differenceInQuarters:n(360),differenceInSeconds:n(50),differenceInWeeks:n(361),differenceInYears:n(362),distanceInWords:n(78),distanceInWordsStrict:n(366),distanceInWordsToNow:n(367),eachDay:n(368),endOfDay:n(52),endOfHour:n(369),endOfISOWeek:n(370),endOfISOYear:n(371),endOfMinute:n(372),endOfMonth:n(80),endOfQuarter:n(373),endOfSecond:n(374),endOfToday:n(375),endOfTomorrow:n(376),endOfWeek:n(79),endOfYear:n(377),endOfYesterday:n(378),format:n(379),getDate:n(380),getDay:n(381),getDayOfYear:n(81),getDaysInMonth:n(46),getDaysInYear:n(382),getHours:n(383),getISODay:n(85),getISOWeek:n(53),getISOWeeksInYear:n(384),getISOYear:n(16),getMilliseconds:n(385),getMinutes:n(386),getMonth:n(387),getOverlappingDaysInRanges:n(388),getQuarter:n(74),getSeconds:n(389),getTime:n(390),getYear:n(391),isAfter:n(392),isBefore:n(393),isDate:n(45),isEqual:n(394),isFirstDayOfMonth:n(395),isFriday:n(396),isFuture:n(397),isLastDayOfMonth:n(398),isLeapYear:n(84),isMonday:n(399),isPast:n(400),isSameDay:n(401),isSameHour:n(86),isSameISOWeek:n(88),isSameISOYear:n(89),isSameMinute:n(90),isSameMonth:n(92),isSameQuarter:n(93),isSameSecond:n(95),isSameWeek:n(54),isSameYear:n(97),isSaturday:n(402),isSunday:n(403),isThisHour:n(404),isThisISOWeek:n(405),isThisISOYear:n(406),isThisMinute:n(407),isThisMonth:n(408),isThisQuarter:n(409),isThisSecond:n(410),isThisWeek:n(411),isThisYear:n(412),isThursday:n(413),isToday:n(414),isTomorrow:n(415),isTuesday:n(416),isValid:n(83),isWednesday:n(417),isWeekend:n(418),isWithinRange:n(419),isYesterday:n(420),lastDayOfISOWeek:n(421),lastDayOfISOYear:n(422),lastDayOfMonth:n(423),lastDayOfQuarter:n(424),lastDayOfWeek:n(98),lastDayOfYear:n(425),max:n(426),min:n(427),parse:n(0),setDate:n(428),setDay:n(429),setDayOfYear:n(430),setHours:n(431),setISODay:n(432),setISOWeek:n(433),setISOYear:n(67),setMilliseconds:n(434),setMinutes:n(435),setMonth:n(99),setQuarter:n(436),setSeconds:n(437),setYear:n(438),startOfDay:n(18),startOfHour:n(87),startOfISOWeek:n(17),startOfISOYear:n(23),startOfMinute:n(91),startOfMonth:n(439),startOfQuarter:n(94),startOfSecond:n(96),startOfToday:n(440),startOfTomorrow:n(441),startOfWeek:n(35),startOfYear:n(82),startOfYesterday:n(442),subDays:n(443),subHours:n(444),subISOYears:n(77),subMilliseconds:n(445),subMinutes:n(446),subMonths:n(447),subQuarters:n(448),subSeconds:n(449),subWeeks:n(450),subYears:n(451)}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),A=i.getDay(),a=(A<n?7:0)+A-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}},function(e,t,n){var r=n(18),i=6e4,A=864e5;e.exports=function(e,t){var n=r(e),a=r(t),o=n.getTime()-n.getTimezoneOffset()*i,s=a.getTime()-a.getTimezoneOffset()*i;return Math.round((o-s)/A)}},function(e,t,n){var r=n(0),i=n(46);e.exports=function(e,t){var n=r(e),A=Number(t),a=n.getMonth()+A,o=new Date(0);o.setFullYear(n.getFullYear(),a,1),o.setHours(0,0,0,0);var s=i(o);return n.setMonth(a,Math.min(s,n.getDate())),n}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()-i.getTime()}},,,,,,,function(e,t){e.exports=function(e){return e instanceof Date}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e),n=t.getFullYear(),i=t.getMonth(),A=new Date(0);return A.setFullYear(n,i+1,0),A.setHours(0,0,0,0),A.getDate()}},function(e,t,n){var r=n(21);e.exports=function(e,t){var n=Number(t);return r(e,7*n)}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e).getTime(),i=r(t).getTime();return n>i?-1:n<i?1:0}},function(e,t,n){var r=n(0),i=n(73),A=n(24);e.exports=function(e,t){var n=r(e),a=r(t),o=A(n,a),s=Math.abs(i(n,a));return n.setMonth(n.getMonth()-o*s),o*(s-(A(n,a)===-o))}},function(e,t,n){var r=n(38);e.exports=function(e,t){var n=r(e,t)/1e3;return n>0?Math.floor(n):Math.ceil(n)}},function(e,t,n){var r=n(363),i=n(364);e.exports={distanceInWords:r(),format:i()}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e);return t.setHours(23,59,59,999),t}},function(e,t,n){var r=n(0),i=n(17),A=n(23),a=6048e5;e.exports=function(e){var t=r(e),n=i(t).getTime()-A(t).getTime();return Math.round(n/a)+1}},function(e,t,n){var r=n(35);e.exports=function(e,t,n){var i=r(e,n),A=r(t,n);return i.getTime()===A.getTime()}},,,,,,,,,function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){var r=n(22),i=36e5;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},function(e,t,n){var r=n(16),i=n(67);e.exports=function(e,t){var n=Number(t);return i(e,r(e)+n)}},function(e,t,n){var r=n(0),i=n(23),A=n(36);e.exports=function(e,t){var n=r(e),a=Number(t),o=A(n,i(n)),s=new Date(0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),(n=i(s)).setDate(n.getDate()+o),n}},function(e,t,n){var r=n(22),i=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},function(e,t,n){var r=n(37);e.exports=function(e,t){var n=Number(t);return r(e,3*n)}},function(e,t,n){var r=n(22);e.exports=function(e,t){var n=Number(t);return r(e,1e3*n)}},function(e,t,n){var r=n(37);e.exports=function(e,t){var n=Number(t);return r(e,12*n)}},function(e,t,n){var r=n(16);e.exports=function(e,t){return r(e)-r(t)}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=r(t);return 12*(n.getFullYear()-i.getFullYear())+(n.getMonth()-i.getMonth())}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e);return Math.floor(t.getMonth()/3)+1}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=r(t);return n.getFullYear()-i.getFullYear()}},function(e,t,n){var r=n(0),i=n(36),A=n(24);e.exports=function(e,t){var n=r(e),a=r(t),o=A(n,a),s=Math.abs(i(n,a));return n.setDate(n.getDate()-o*s),o*(s-(A(n,a)===-o))}},function(e,t,n){var r=n(66);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(48),i=n(0),A=n(50),a=n(49),o=n(51),s=1440,u=2520,l=43200,c=86400;e.exports=function(e,t,n){var h=n||{},d=r(e,t),f=h.locale,p=o.distanceInWords.localize;f&&f.distanceInWords&&f.distanceInWords.localize&&(p=f.distanceInWords.localize);var g,y,m={addSuffix:Boolean(h.addSuffix),comparison:d};d>0?(g=i(e),y=i(t)):(g=i(t),y=i(e));var E,v=A(y,g),B=y.getTimezoneOffset()-g.getTimezoneOffset(),w=Math.round(v/60)-B;if(w<2)return h.includeSeconds?v<5?p("lessThanXSeconds",5,m):v<10?p("lessThanXSeconds",10,m):v<20?p("lessThanXSeconds",20,m):v<40?p("halfAMinute",null,m):p(v<60?"lessThanXMinutes":"xMinutes",1,m):0===w?p("lessThanXMinutes",1,m):p("xMinutes",w,m);if(w<45)return p("xMinutes",w,m);if(w<90)return p("aboutXHours",1,m);if(w<s)return p("aboutXHours",Math.round(w/60),m);if(w<u)return p("xDays",1,m);if(w<l)return p("xDays",Math.round(w/s),m);if(w<c)return p("aboutXMonths",E=Math.round(w/l),m);if((E=a(y,g))<12)return p("xMonths",Math.round(w/l),m);var k=E%12,C=Math.floor(E/12);return k<3?p("aboutXYears",C,m):k<9?p("overXYears",C,m):p("almostXYears",C+1,m)}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),A=i.getDay(),a=6+(A<n?-7:0)-(A-n);return i.setDate(i.getDate()+a),i.setHours(23,59,59,999),i}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}},function(e,t,n){var r=n(0),i=n(82),A=n(36);e.exports=function(e){var t=r(e);return A(t,i(t))+1}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}},function(e,t,n){var r=n(45);e.exports=function(e){if(r(e))return!isNaN(e);throw new TypeError(toString.call(e)+" is not an instance of Date")}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e).getFullYear();return t%400==0||t%4==0&&t%100!=0}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e).getDay();return 0===t&&(t=7),t}},function(e,t,n){var r=n(87);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e);return t.setMinutes(0,0,0),t}},function(e,t,n){var r=n(54);e.exports=function(e,t){return r(e,t,{weekStartsOn:1})}},function(e,t,n){var r=n(23);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(91);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e);return t.setSeconds(0,0),t}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=r(t);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}},function(e,t,n){var r=n(94);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e),n=t.getMonth(),i=n-n%3;return t.setMonth(i,1),t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(96);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e);return t.setMilliseconds(0),t}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=r(t);return n.getFullYear()===i.getFullYear()}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),A=i.getDay(),a=6+(A<n?-7:0)-(A-n);return i.setHours(0,0,0,0),i.setDate(i.getDate()+a),i}},function(e,t,n){var r=n(0),i=n(46);e.exports=function(e,t){var n=r(e),A=Number(t),a=n.getFullYear(),o=n.getDate(),s=new Date(0);s.setFullYear(a,A,15),s.setHours(0,0,0,0);var u=i(s);return n.setMonth(A,Math.min(o,u)),n}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){!function(){var t=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],n="undefined"!=typeof window,r=n&&null!=window.mozInnerScreenX;function i(e,i,A){var a=e.ownerDocument,o=a.defaultView||a.parentWindow;if(!n)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var s=A&&A.debug||!1;if(s){var u=a.querySelector("#input-textarea-caret-position-mirror-div");u&&u.parentNode.removeChild(u)}var l=a.createElement("div");l.id="input-textarea-caret-position-mirror-div",a.body.appendChild(l);var c=l.style,h=o.getComputedStyle?o.getComputedStyle(e):e.currentStyle,d="INPUT"===e.nodeName;c.whiteSpace="pre-wrap",d||(c.wordWrap="break-word"),c.position="absolute",s||(c.visibility="hidden"),t.forEach((function(e){d&&"lineHeight"===e?c.lineHeight=h.height:c[e]=h[e]})),r?e.scrollHeight>parseInt(h.height)&&(c.overflowY="scroll"):c.overflow="hidden",l.textContent=e.value.substring(0,i),d&&(l.textContent=l.textContent.replace(/\s/g," "));var f=a.createElement("span");f.textContent=e.value.substring(i)||".",l.appendChild(f);var p={top:f.offsetTop+parseInt(h.borderTopWidth),left:f.offsetLeft+parseInt(h.borderLeftWidth),height:parseInt(h.lineHeight)};return s?f.style.backgroundColor="#aaa":a.body.removeChild(l),p}void 0!==e.exports?e.exports=i:n&&(_window.getCaretCoordinates=i)}()},function(e,t){e.exports="precision highp float;\n#define MESHLINE_PATH_ROUND_CAP     2.\n#define MESHLINE_PATH_FLAT_CAP      3.\nattribute vec3 position;\nattribute vec2 previous;\nattribute vec2 next;\nattribute float side;\nattribute float width;\nattribute float counters;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform vec2 resolution;\nuniform float lineWidth;\nuniform float opacity;\nvarying float vCounters;\nvarying float vPointType;\nvarying float vDistance;\nvarying float aaRange;\nvarying float totalWidth;\nvarying vec2 center;\nvarying vec2 finalPos;\nfloat when_eq(float x, float y) {\n  return 1.0 - abs(sign(x - y));\n}\nfloat when_neq(float x, float y) {\n  return abs(sign(x - y));\n}\nvoid main() {\n    float pixelsPerUnit = 0.5 * resolution.x * projectionMatrix[0][0];\n    vCounters = counters;\n    vPointType = abs(side);\n    float sideSgn = sign(side);\n    vec4 curPosition = modelViewMatrix * vec4(position.xy, 0.0, 1.0);\n    vec2 prevPos = (modelViewMatrix * vec4(previous, 0.0, 1.0)).xy;\n    vec2 nextPos = (modelViewMatrix * vec4(next, 0.0, 1.0)).xy;\n#ifdef IS_IE_11\n    aaRange = when_neq(width, 0.0) * when_eq(opacity, 1.0) * 1.0 / pixelsPerUnit;\n#else\n    aaRange = when_neq(width, 0.0) * 1.0 / pixelsPerUnit;\n#endif\n    \n    float minSize = when_neq(width, 0.0) * 0.5 / pixelsPerUnit;    \n   \n    totalWidth = lineWidth * width;\n    \n    float w = max(.5 * totalWidth, minSize) + aaRange;\n    \n    vDistance = w * sideSgn;\n    vec2 dir;\n    if (nextPos == curPosition.xy) {\n        dir = normalize(curPosition.xy - prevPos);\n    } else if (prevPos == curPosition.xy) {\n        dir = normalize(nextPos - curPosition.xy);\n    } else {\n#ifdef MITER\n        vec2 dir1 = normalize(curPosition.xy - prevPos);\n        vec2 dir2 = normalize(nextPos - curPosition.xy);\n        dir = normalize(dir1 + dir2);\n        vec2 perp = vec2(-dir1.y, dir1.x);\n        vec2 miter = vec2(-dir.y, dir.x);\n        w = clamp(w / dot(miter, perp), minSize + aaRange, 20. * w);\n#else\n        dir = normalize(curPosition.xy - prevPos);\n#endif\n    }\n    vec2 normal = vec2(-dir.y, dir.x);\n    normal *= w * sideSgn;\n    \n    if (vPointType == MESHLINE_PATH_ROUND_CAP) {\n        center = curPosition.xy;\n        curPosition.xy += normal;\n    } else  {\n        curPosition.xy += normal;\n        center = curPosition.xy;\n    }\n    \n    if (vCounters < 0.0 || vCounters > 1.0) {\n        normal = vec2(dir.x, dir.y);\n        normal *= sign(vCounters) * w;\n        curPosition.xy += normal;\n    }\n  \n    finalPos = curPosition.xy;\n    gl_Position = projectionMatrix * curPosition;\n}\n"},function(e,t){e.exports="#extension GL_OES_standard_derivatives : enable\nprecision highp float;\n#define MESHLINE_PATH_FLAT_CAP      3.0\nuniform vec3 color;\nuniform float opacity;\nvarying float vCounters;\nvarying float vDistance;\nvarying float aaRange;\nvarying float totalWidth;\nvarying vec2 center;\nvarying vec2 finalPos;\nvarying float vPointType;\nfloat when_eq(float x, float y) {\n  return 1.0 - abs(sign(x - y));\n}\nfloat getSmoothStep(float t, float d) {\n    return smoothstep(t - aaRange, t + aaRange, abs(d));\n}\nvoid main() {\n    float t = totalWidth / 2.0;\n    float d = vDistance;\n    float aa = 1.0;\n    if (vCounters < 0.0 || vCounters > 1.0) {\n        d = length(finalPos - center);\n        if (vPointType == MESHLINE_PATH_FLAT_CAP) {\n            t = aaRange;\n        }\n        if (d > t + aaRange) {\n            discard;\n        }\n        aa = 1.0 - getSmoothStep(t, d);       \n    }\n        \n#ifdef IS_IE_11\n    aa = (1.0 - when_eq(opacity, 1.0) * getSmoothStep(totalWidth / 2.0, vDistance)) * aa;\n#else\n    aa = (1.0 - getSmoothStep(totalWidth / 2.0, vDistance)) * aa;\n#endif\n    gl_FragColor = vec4(color, opacity * aa);\n}\n"},function(e,t,n){(function(e){var n,r,i,A;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*!
                                                                                                                                                                                                                                                                                                                                                      * html2canvas 1.0.0-alpha.12 <https://html2canvas.hertzen.com>
                                                                                                                                                                                                                                                                                                                                                      * Copyright (c) 2018 Niklas von Hertzen <https://hertzen.com>
                                                                                                                                                                                                                                                                                                                                                      * Released under MIT License
                                                                                                                                                                                                                                                                                                                                                      */A=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=27)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,A=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,A=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw A}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=/^#([a-f0-9]{3})$/i,a=function(e){var t=e.match(A);return!!t&&[parseInt(t[1][0]+t[1][0],16),parseInt(t[1][1]+t[1][1],16),parseInt(t[1][2]+t[1][2],16),null]},o=/^#([a-f0-9]{6})$/i,s=function(e){var t=e.match(o);return!!t&&[parseInt(t[1].substring(0,2),16),parseInt(t[1].substring(2,4),16),parseInt(t[1].substring(4,6),16),null]},u=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/,l=function(e){var t=e.match(u);return!!t&&[Number(t[1]),Number(t[2]),Number(t[3]),null]},c=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/,h=function(e){var t=e.match(c);return!!(t&&t.length>4)&&[Number(t[1]),Number(t[2]),Number(t[3]),Number(t[4])]},d=function(e){return[Math.min(e[0],255),Math.min(e[1],255),Math.min(e[2],255),e.length>3?e[3]:null]},f=function(e){var t=g[e.toLowerCase()];return t||!1},p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=Array.isArray(t)?d(t):a(t)||l(t)||h(t)||f(t)||s(t)||[0,0,0,null],i=r(n,4),A=i[0],o=i[1],u=i[2],c=i[3];this.r=A,this.g=o,this.b=u,this.a=c}return i(e,[{key:"isTransparent",value:function(){return 0===this.a}},{key:"toString",value:function(){return null!==this.a&&1!==this.a?"rgba("+this.r+","+this.g+","+this.b+","+this.a+")":"rgb("+this.r+","+this.g+","+this.b+")"}}]),e}();t.default=p;var g={transparent:[0,0,0,0],aliceblue:[240,248,255,null],antiquewhite:[250,235,215,null],aqua:[0,255,255,null],aquamarine:[127,255,212,null],azure:[240,255,255,null],beige:[245,245,220,null],bisque:[255,228,196,null],black:[0,0,0,null],blanchedalmond:[255,235,205,null],blue:[0,0,255,null],blueviolet:[138,43,226,null],brown:[165,42,42,null],burlywood:[222,184,135,null],cadetblue:[95,158,160,null],chartreuse:[127,255,0,null],chocolate:[210,105,30,null],coral:[255,127,80,null],cornflowerblue:[100,149,237,null],cornsilk:[255,248,220,null],crimson:[220,20,60,null],cyan:[0,255,255,null],darkblue:[0,0,139,null],darkcyan:[0,139,139,null],darkgoldenrod:[184,134,11,null],darkgray:[169,169,169,null],darkgreen:[0,100,0,null],darkgrey:[169,169,169,null],darkkhaki:[189,183,107,null],darkmagenta:[139,0,139,null],darkolivegreen:[85,107,47,null],darkorange:[255,140,0,null],darkorchid:[153,50,204,null],darkred:[139,0,0,null],darksalmon:[233,150,122,null],darkseagreen:[143,188,143,null],darkslateblue:[72,61,139,null],darkslategray:[47,79,79,null],darkslategrey:[47,79,79,null],darkturquoise:[0,206,209,null],darkviolet:[148,0,211,null],deeppink:[255,20,147,null],deepskyblue:[0,191,255,null],dimgray:[105,105,105,null],dimgrey:[105,105,105,null],dodgerblue:[30,144,255,null],firebrick:[178,34,34,null],floralwhite:[255,250,240,null],forestgreen:[34,139,34,null],fuchsia:[255,0,255,null],gainsboro:[220,220,220,null],ghostwhite:[248,248,255,null],gold:[255,215,0,null],goldenrod:[218,165,32,null],gray:[128,128,128,null],green:[0,128,0,null],greenyellow:[173,255,47,null],grey:[128,128,128,null],honeydew:[240,255,240,null],hotpink:[255,105,180,null],indianred:[205,92,92,null],indigo:[75,0,130,null],ivory:[255,255,240,null],khaki:[240,230,140,null],lavender:[230,230,250,null],lavenderblush:[255,240,245,null],lawngreen:[124,252,0,null],lemonchiffon:[255,250,205,null],lightblue:[173,216,230,null],lightcoral:[240,128,128,null],lightcyan:[224,255,255,null],lightgoldenrodyellow:[250,250,210,null],lightgray:[211,211,211,null],lightgreen:[144,238,144,null],lightgrey:[211,211,211,null],lightpink:[255,182,193,null],lightsalmon:[255,160,122,null],lightseagreen:[32,178,170,null],lightskyblue:[135,206,250,null],lightslategray:[119,136,153,null],lightslategrey:[119,136,153,null],lightsteelblue:[176,196,222,null],lightyellow:[255,255,224,null],lime:[0,255,0,null],limegreen:[50,205,50,null],linen:[250,240,230,null],magenta:[255,0,255,null],maroon:[128,0,0,null],mediumaquamarine:[102,205,170,null],mediumblue:[0,0,205,null],mediumorchid:[186,85,211,null],mediumpurple:[147,112,219,null],mediumseagreen:[60,179,113,null],mediumslateblue:[123,104,238,null],mediumspringgreen:[0,250,154,null],mediumturquoise:[72,209,204,null],mediumvioletred:[199,21,133,null],midnightblue:[25,25,112,null],mintcream:[245,255,250,null],mistyrose:[255,228,225,null],moccasin:[255,228,181,null],navajowhite:[255,222,173,null],navy:[0,0,128,null],oldlace:[253,245,230,null],olive:[128,128,0,null],olivedrab:[107,142,35,null],orange:[255,165,0,null],orangered:[255,69,0,null],orchid:[218,112,214,null],palegoldenrod:[238,232,170,null],palegreen:[152,251,152,null],paleturquoise:[175,238,238,null],palevioletred:[219,112,147,null],papayawhip:[255,239,213,null],peachpuff:[255,218,185,null],peru:[205,133,63,null],pink:[255,192,203,null],plum:[221,160,221,null],powderblue:[176,224,230,null],purple:[128,0,128,null],rebeccapurple:[102,51,153,null],red:[255,0,0,null],rosybrown:[188,143,143,null],royalblue:[65,105,225,null],saddlebrown:[139,69,19,null],salmon:[250,128,114,null],sandybrown:[244,164,96,null],seagreen:[46,139,87,null],seashell:[255,245,238,null],sienna:[160,82,45,null],silver:[192,192,192,null],skyblue:[135,206,235,null],slateblue:[106,90,205,null],slategray:[112,128,144,null],slategrey:[112,128,144,null],snow:[255,250,250,null],springgreen:[0,255,127,null],steelblue:[70,130,180,null],tan:[210,180,140,null],teal:[0,128,128,null],thistle:[216,191,216,null],tomato:[255,99,71,null],turquoise:[64,224,208,null],violet:[238,130,238,null],wheat:[245,222,179,null],white:[255,255,255,null],whitesmoke:[245,245,245,null],yellow:[255,255,0,null],yellowgreen:[154,205,50,null]};t.TRANSPARENT=new p([0,0,0,0])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateLengthFromValueWithUnit=t.LENGTH_TYPE=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=n(3);(r=A)&&r.__esModule;var a=t.LENGTH_TYPE={PX:0,PERCENTAGE:1},o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="%"===t.substr(t.length-1)?a.PERCENTAGE:a.PX;var n=parseFloat(t);isNaN(n)&&console.error('Invalid value given for Length: "'+t+'"'),this.value=isNaN(n)?0:n}return i(e,[{key:"isPercentage",value:function(){return this.type===a.PERCENTAGE}},{key:"getAbsoluteValue",value:function(e){return this.isPercentage()?e*(this.value/100):this.value}}],[{key:"create",value:function(t){return new e(t)}}]),e}();t.default=o,t.calculateLengthFromValueWithUnit=function(e,t,n){switch(n){case"px":case"%":return new o(t+n);case"em":case"rem":var r=new o(t);return r.value*="em"===n?parseFloat(e.style.font.fontSize):function e(t){var n=t.parent;return n?e(n):parseFloat(t.style.font.fontSize)}(e),r;default:return new o("0")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBoundCurves=t.calculatePaddingBoxPath=t.calculateBorderBoxPath=t.parsePathForBorder=t.parseDocumentSize=t.calculateContentBox=t.calculatePaddingBox=t.parseBounds=t.Bounds=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(7)),A=a(n(32));function a(e){return e&&e.__esModule?e:{default:e}}var o=t.Bounds=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.left=t,this.top=n,this.width=r,this.height=i}return r(e,null,[{key:"fromClientRect",value:function(t,n,r){return new e(t.left+n,t.top+r,t.width,t.height)}}]),e}(),s=(t.parseBounds=function(e,t,n){return o.fromClientRect(e.getBoundingClientRect(),t,n)},t.calculatePaddingBox=function(e,t){return new o(e.left+t[3].borderWidth,e.top+t[0].borderWidth,e.width-(t[1].borderWidth+t[3].borderWidth),e.height-(t[0].borderWidth+t[2].borderWidth))},t.calculateContentBox=function(e,t,n){var r=t[0].value,i=t[1].value,A=t[2].value,a=t[3].value;return new o(e.left+a+n[3].borderWidth,e.top+r+n[0].borderWidth,e.width-(n[1].borderWidth+n[3].borderWidth+a+i),e.height-(n[0].borderWidth+n[2].borderWidth+r+A))},t.parseDocumentSize=function(e){var t=e.body,n=e.documentElement;if(!t||!n)throw new Error("Unable to get document size");var r=Math.max(Math.max(t.scrollWidth,n.scrollWidth),Math.max(t.offsetWidth,n.offsetWidth),Math.max(t.clientWidth,n.clientWidth)),i=Math.max(Math.max(t.scrollHeight,n.scrollHeight),Math.max(t.offsetHeight,n.offsetHeight),Math.max(t.clientHeight,n.clientHeight));return new o(0,0,r,i)},t.parsePathForBorder=function(e,t){switch(t){case 0:return s(e.topLeftOuter,e.topLeftInner,e.topRightOuter,e.topRightInner);case 1:return s(e.topRightOuter,e.topRightInner,e.bottomRightOuter,e.bottomRightInner);case 2:return s(e.bottomRightOuter,e.bottomRightInner,e.bottomLeftOuter,e.bottomLeftInner);case 3:default:return s(e.bottomLeftOuter,e.bottomLeftInner,e.topLeftOuter,e.topLeftInner)}},function(e,t,n,r){var i=[];return e instanceof A.default?i.push(e.subdivide(.5,!1)):i.push(e),n instanceof A.default?i.push(n.subdivide(.5,!0)):i.push(n),r instanceof A.default?i.push(r.subdivide(.5,!0).reverse()):i.push(r),t instanceof A.default?i.push(t.subdivide(.5,!1).reverse()):i.push(t),i}),u=(t.calculateBorderBoxPath=function(e){return[e.topLeftOuter,e.topRightOuter,e.bottomRightOuter,e.bottomLeftOuter]},t.calculatePaddingBoxPath=function(e){return[e.topLeftInner,e.topRightInner,e.bottomRightInner,e.bottomLeftInner]},t.parseBoundCurves=function(e,t,n){var r=n[u.TOP_LEFT][0].getAbsoluteValue(e.width),A=n[u.TOP_LEFT][1].getAbsoluteValue(e.height),a=n[u.TOP_RIGHT][0].getAbsoluteValue(e.width),o=n[u.TOP_RIGHT][1].getAbsoluteValue(e.height),s=n[u.BOTTOM_RIGHT][0].getAbsoluteValue(e.width),c=n[u.BOTTOM_RIGHT][1].getAbsoluteValue(e.height),h=n[u.BOTTOM_LEFT][0].getAbsoluteValue(e.width),d=n[u.BOTTOM_LEFT][1].getAbsoluteValue(e.height),f=[];f.push((r+a)/e.width),f.push((h+s)/e.width),f.push((A+d)/e.height),f.push((o+c)/e.height);var p=Math.max.apply(Math,f);p>1&&(r/=p,A/=p,a/=p,o/=p,s/=p,c/=p,h/=p,d/=p);var g=e.width-a,y=e.height-c,m=e.width-s,E=e.height-d;return{topLeftOuter:r>0||A>0?l(e.left,e.top,r,A,u.TOP_LEFT):new i.default(e.left,e.top),topLeftInner:r>0||A>0?l(e.left+t[3].borderWidth,e.top+t[0].borderWidth,Math.max(0,r-t[3].borderWidth),Math.max(0,A-t[0].borderWidth),u.TOP_LEFT):new i.default(e.left+t[3].borderWidth,e.top+t[0].borderWidth),topRightOuter:a>0||o>0?l(e.left+g,e.top,a,o,u.TOP_RIGHT):new i.default(e.left+e.width,e.top),topRightInner:a>0||o>0?l(e.left+Math.min(g,e.width+t[3].borderWidth),e.top+t[0].borderWidth,g>e.width+t[3].borderWidth?0:a-t[3].borderWidth,o-t[0].borderWidth,u.TOP_RIGHT):new i.default(e.left+e.width-t[1].borderWidth,e.top+t[0].borderWidth),bottomRightOuter:s>0||c>0?l(e.left+m,e.top+y,s,c,u.BOTTOM_RIGHT):new i.default(e.left+e.width,e.top+e.height),bottomRightInner:s>0||c>0?l(e.left+Math.min(m,e.width-t[3].borderWidth),e.top+Math.min(y,e.height+t[0].borderWidth),Math.max(0,s-t[1].borderWidth),c-t[2].borderWidth,u.BOTTOM_RIGHT):new i.default(e.left+e.width-t[1].borderWidth,e.top+e.height-t[2].borderWidth),bottomLeftOuter:h>0||d>0?l(e.left,e.top+E,h,d,u.BOTTOM_LEFT):new i.default(e.left,e.top+e.height),bottomLeftInner:h>0||d>0?l(e.left+t[3].borderWidth,e.top+E,Math.max(0,h-t[3].borderWidth),d-t[2].borderWidth,u.BOTTOM_LEFT):new i.default(e.left+t[3].borderWidth,e.top+e.height-t[2].borderWidth)}},{TOP_LEFT:0,TOP_RIGHT:1,BOTTOM_RIGHT:2,BOTTOM_LEFT:3}),l=function(e,t,n,r,a){var o=(Math.sqrt(2)-1)/3*4,s=n*o,l=r*o,c=e+n,h=t+r;switch(a){case u.TOP_LEFT:return new A.default(new i.default(e,h),new i.default(e,h-l),new i.default(c-s,t),new i.default(c,t));case u.TOP_RIGHT:return new A.default(new i.default(e,t),new i.default(e+s,t),new i.default(c,h-l),new i.default(c,h));case u.BOTTOM_RIGHT:return new A.default(new i.default(c,t),new i.default(c,t+l),new i.default(e+s,h),new i.default(e,h));case u.BOTTOM_LEFT:default:return new A.default(new i.default(c,h),new i.default(c-s,h),new i.default(e,t+l),new i.default(e,t))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=n(0),a=(r=A)&&r.__esModule?r:{default:r},o=n(4),s=n(5),u=n(12),l=n(33),c=n(34),h=n(35),d=n(36),f=n(37),p=n(38),g=n(8),y=n(39),m=n(40),E=n(18),v=n(17),B=n(19),w=n(11),k=n(41),C=n(20),b=n(42),S=n(43),T=n(44),M=n(45),U=n(2),Q=n(21),x=n(14),F=["INPUT","TEXTAREA","SELECT"],_=function(){function e(t,n,r,i){var A=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=n,this.tagName=t.tagName,this.index=i,this.childNodes=[],this.listItems=[],"number"==typeof t.start&&(this.listStart=t.start);var o=t.ownerDocument.defaultView,_=o.pageXOffset,L=o.pageYOffset,I=o.getComputedStyle(t,null),D=(0,c.parseDisplay)(I.display),O="radio"===t.type||"checkbox"===t.type,R=(0,B.parsePosition)(I.position);if(this.style={background:O?Q.INPUT_BACKGROUND:(0,s.parseBackground)(I,r),border:O?Q.INPUT_BORDERS:(0,u.parseBorder)(I),borderRadius:(t instanceof o.HTMLInputElement||t instanceof HTMLInputElement)&&O?(0,Q.getInputBorderRadius)(t):(0,l.parseBorderRadius)(I),color:O?Q.INPUT_COLOR:new a.default(I.color),display:D,float:(0,h.parseCSSFloat)(I.float),font:(0,d.parseFont)(I),letterSpacing:(0,f.parseLetterSpacing)(I.letterSpacing),listStyle:D===c.DISPLAY.LIST_ITEM?(0,g.parseListStyle)(I):null,lineBreak:(0,p.parseLineBreak)(I.lineBreak),margin:(0,y.parseMargin)(I),opacity:parseFloat(I.opacity),overflow:-1===F.indexOf(t.tagName)?(0,m.parseOverflow)(I.overflow):m.OVERFLOW.HIDDEN,overflowWrap:(0,E.parseOverflowWrap)(I.overflowWrap?I.overflowWrap:I.wordWrap),padding:(0,v.parsePadding)(I),position:R,textDecoration:(0,w.parseTextDecoration)(I),textShadow:(0,k.parseTextShadow)(I.textShadow),textTransform:(0,C.parseTextTransform)(I.textTransform),transform:(0,b.parseTransform)(I),visibility:(0,S.parseVisibility)(I.visibility),wordBreak:(0,T.parseWordBreak)(I.wordBreak),zIndex:(0,M.parseZIndex)(R!==B.POSITION.STATIC?I.zIndex:"auto")},this.isTransformed()&&(t.style.transform="matrix(1,0,0,1,0,0)"),D===c.DISPLAY.LIST_ITEM){var N=(0,x.getListOwner)(this);if(N){var P=N.listItems.length;N.listItems.push(this),this.listIndex=t.hasAttribute("value")&&"number"==typeof t.value?t.value:0===P?"number"==typeof N.listStart?N.listStart:1:N.listItems[P-1].listIndex+1}}"IMG"===t.tagName&&t.addEventListener("load",(function(){A.bounds=(0,U.parseBounds)(t,_,L),A.curvedBounds=(0,U.parseBoundCurves)(A.bounds,A.style.border,A.style.borderRadius)})),this.image=H(t,r),this.bounds=O?(0,Q.reformatInputBounds)((0,U.parseBounds)(t,_,L)):(0,U.parseBounds)(t,_,L),this.curvedBounds=(0,U.parseBoundCurves)(this.bounds,this.style.border,this.style.borderRadius),this.name=t.tagName.toLowerCase()+(t.id?"#"+t.id:"")+t.className.toString().split(" ").map((function(e){return e.length?"."+e:""})).join("")}return i(e,[{key:"getClipPaths",value:function(){var e=this.parent?this.parent.getClipPaths():[];return this.style.overflow!==m.OVERFLOW.VISIBLE?e.concat([(0,U.calculatePaddingBoxPath)(this.curvedBounds)]):e}},{key:"isInFlow",value:function(){return this.isRootElement()&&!this.isFloating()&&!this.isAbsolutelyPositioned()}},{key:"isVisible",value:function(){return!(0,o.contains)(this.style.display,c.DISPLAY.NONE)&&this.style.opacity>0&&this.style.visibility===S.VISIBILITY.VISIBLE}},{key:"isAbsolutelyPositioned",value:function(){return this.style.position!==B.POSITION.STATIC&&this.style.position!==B.POSITION.RELATIVE}},{key:"isPositioned",value:function(){return this.style.position!==B.POSITION.STATIC}},{key:"isFloating",value:function(){return this.style.float!==h.FLOAT.NONE}},{key:"isRootElement",value:function(){return null===this.parent}},{key:"isTransformed",value:function(){return null!==this.style.transform}},{key:"isPositionedWithZIndex",value:function(){return this.isPositioned()&&!this.style.zIndex.auto}},{key:"isInlineLevel",value:function(){return(0,o.contains)(this.style.display,c.DISPLAY.INLINE)||(0,o.contains)(this.style.display,c.DISPLAY.INLINE_BLOCK)||(0,o.contains)(this.style.display,c.DISPLAY.INLINE_FLEX)||(0,o.contains)(this.style.display,c.DISPLAY.INLINE_GRID)||(0,o.contains)(this.style.display,c.DISPLAY.INLINE_LIST_ITEM)||(0,o.contains)(this.style.display,c.DISPLAY.INLINE_TABLE)}},{key:"isInlineBlockOrInlineTable",value:function(){return(0,o.contains)(this.style.display,c.DISPLAY.INLINE_BLOCK)||(0,o.contains)(this.style.display,c.DISPLAY.INLINE_TABLE)}}]),e}();t.default=_;var H=function(e,t){if(e instanceof e.ownerDocument.defaultView.SVGSVGElement||e instanceof SVGSVGElement){var n=new XMLSerializer;return t.loadImage("data:image/svg+xml,"+encodeURIComponent(n.serializeToString(e)))}switch(e.tagName){case"IMG":var r=e;return t.loadImage(r.currentSrc||r.src);case"CANVAS":var i=e;return t.loadCanvas(i);case"IFRAME":var A=e.getAttribute("data-html2canvas-internal-iframe-key");if(A)return A}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contains=function(e,t){return 0!=(e&t)},t.distance=function(e,t){return Math.sqrt(e*e+t*t)},t.copyCSSStyles=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e.item(n);"content"!==r&&t.style.setProperty(r,e.getPropertyValue(r))}return t},t.SMALL_IMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBackgroundImage=t.parseBackground=t.calculateBackgroundRepeatPath=t.calculateBackgroundPosition=t.calculateBackgroungPositioningArea=t.calculateBackgroungPaintingArea=t.calculateGradientBackgroundSize=t.calculateBackgroundSize=t.BACKGROUND_ORIGIN=t.BACKGROUND_CLIP=t.BACKGROUND_SIZE=t.BACKGROUND_REPEAT=void 0;var r=u(n(0)),i=u(n(1)),A=u(n(31)),a=u(n(7)),o=n(2),s=n(17);function u(e){return e&&e.__esModule?e:{default:e}}var l=t.BACKGROUND_REPEAT={REPEAT:0,NO_REPEAT:1,REPEAT_X:2,REPEAT_Y:3},c=t.BACKGROUND_SIZE={AUTO:0,CONTAIN:1,COVER:2,LENGTH:3},h=t.BACKGROUND_CLIP={BORDER_BOX:0,PADDING_BOX:1,CONTENT_BOX:2},d=t.BACKGROUND_ORIGIN=h,f=function e(t){switch(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t){case"contain":this.size=c.CONTAIN;break;case"cover":this.size=c.COVER;break;case"auto":this.size=c.AUTO;break;default:this.value=new i.default(t)}},p=(t.calculateBackgroundSize=function(e,t,n){var r=0,i=0,a=e.size;if(a[0].size===c.CONTAIN||a[0].size===c.COVER){var o=n.width/n.height,s=t.width/t.height;return o<s!=(a[0].size===c.COVER)?new A.default(n.width,n.width/s):new A.default(n.height*s,n.height)}return a[0].value&&(r=a[0].value.getAbsoluteValue(n.width)),a[0].size===c.AUTO&&a[1].size===c.AUTO?i=t.height:a[1].size===c.AUTO?i=r/t.width*t.height:a[1].value&&(i=a[1].value.getAbsoluteValue(n.height)),a[0].size===c.AUTO&&(r=i/t.height*t.width),new A.default(r,i)},t.calculateGradientBackgroundSize=function(e,t){var n=e.size,r=n[0].value?n[0].value.getAbsoluteValue(t.width):t.width,i=n[1].value?n[1].value.getAbsoluteValue(t.height):n[0].value?r:t.height;return new A.default(r,i)},new f("auto")),g=(t.calculateBackgroungPaintingArea=function(e,t){switch(t){case h.BORDER_BOX:return(0,o.calculateBorderBoxPath)(e);case h.PADDING_BOX:default:return(0,o.calculatePaddingBoxPath)(e)}},t.calculateBackgroungPositioningArea=function(e,t,n,r){var i=(0,o.calculatePaddingBox)(t,r);switch(e){case d.BORDER_BOX:return t;case d.CONTENT_BOX:var A=n[s.PADDING_SIDES.LEFT].getAbsoluteValue(t.width),a=n[s.PADDING_SIDES.RIGHT].getAbsoluteValue(t.width),u=n[s.PADDING_SIDES.TOP].getAbsoluteValue(t.width),l=n[s.PADDING_SIDES.BOTTOM].getAbsoluteValue(t.width);return new o.Bounds(i.left+A,i.top+u,i.width-A-a,i.height-u-l);case d.PADDING_BOX:default:return i}},t.calculateBackgroundPosition=function(e,t,n){return new a.default(e[0].getAbsoluteValue(n.width-t.width),e[1].getAbsoluteValue(n.height-t.height))},t.calculateBackgroundRepeatPath=function(e,t,n,r,i){switch(e.repeat){case l.REPEAT_X:return[new a.default(Math.round(i.left),Math.round(r.top+t.y)),new a.default(Math.round(i.left+i.width),Math.round(r.top+t.y)),new a.default(Math.round(i.left+i.width),Math.round(n.height+r.top+t.y)),new a.default(Math.round(i.left),Math.round(n.height+r.top+t.y))];case l.REPEAT_Y:return[new a.default(Math.round(r.left+t.x),Math.round(i.top)),new a.default(Math.round(r.left+t.x+n.width),Math.round(i.top)),new a.default(Math.round(r.left+t.x+n.width),Math.round(i.height+i.top)),new a.default(Math.round(r.left+t.x),Math.round(i.height+i.top))];case l.NO_REPEAT:return[new a.default(Math.round(r.left+t.x),Math.round(r.top+t.y)),new a.default(Math.round(r.left+t.x+n.width),Math.round(r.top+t.y)),new a.default(Math.round(r.left+t.x+n.width),Math.round(r.top+t.y+n.height)),new a.default(Math.round(r.left+t.x),Math.round(r.top+t.y+n.height))];default:return[new a.default(Math.round(i.left),Math.round(i.top)),new a.default(Math.round(i.left+i.width),Math.round(i.top)),new a.default(Math.round(i.left+i.width),Math.round(i.height+i.top)),new a.default(Math.round(i.left),Math.round(i.height+i.top))]}},t.parseBackground=function(e,t){return{backgroundColor:new r.default(e.backgroundColor),backgroundImage:E(e,t),backgroundClip:g(e.backgroundClip),backgroundOrigin:y(e.backgroundOrigin)}},function(e){switch(e){case"padding-box":return h.PADDING_BOX;case"content-box":return h.CONTENT_BOX}return h.BORDER_BOX}),y=function(e){switch(e){case"padding-box":return d.PADDING_BOX;case"content-box":return d.CONTENT_BOX}return d.BORDER_BOX},m=function(e){switch(e.trim()){case"no-repeat":return l.NO_REPEAT;case"repeat-x":case"repeat no-repeat":return l.REPEAT_X;case"repeat-y":case"no-repeat repeat":return l.REPEAT_Y;case"repeat":return l.REPEAT}return console.error('Invalid background-repeat value "'+e+'"'),l.REPEAT},E=function(e,t){var n=w(e.backgroundImage).map((function(e){if("url"===e.method){var n=t.loadImage(e.args[0]);e.args=n?[n]:[]}return e})),r=e.backgroundPosition.split(","),i=e.backgroundRepeat.split(","),A=e.backgroundSize.split(",");return n.map((function(e,t){var n=(A[t]||"auto").trim().split(" ").map(v),a=(r[t]||"auto").trim().split(" ").map(B);return{source:e,repeat:m("string"==typeof i[t]?i[t]:i[0]),size:n.length<2?[n[0],p]:[n[0],n[1]],position:a.length<2?[a[0],a[0]]:[a[0],a[1]]}}))},v=function(e){return"auto"===e?p:new f(e)},B=function(e){switch(e){case"bottom":case"right":return new i.default("100%");case"left":case"top":return new i.default("0%");case"auto":return new i.default("0")}return new i.default(e)},w=t.parseBackgroundImage=function(e){var t=/^\s$/,n=[],r=[],i="",A=null,a="",o=0,s=0,u=function(){var e="";if(i){'"'===a.substr(0,1)&&(a=a.substr(1,a.length-2)),a&&r.push(a.trim());var t=i.indexOf("-",1)+1;"-"===i.substr(0,1)&&t>0&&(e=i.substr(0,t).toLowerCase(),i=i.substr(t)),"none"!==(i=i.toLowerCase())&&n.push({prefix:e,method:i,args:r})}r=[],i=a=""};return e.split("").forEach((function(e){if(0!==o||!t.test(e)){switch(e){case'"':A?A===e&&(A=null):A=e;break;case"(":if(A)break;if(0===o)return void(o=1);s++;break;case")":if(A)break;if(1===o){if(0===s)return o=0,void u();s--}break;case",":if(A)break;if(0===o)return void u();if(1===o&&0===s&&!i.match(/^url$/i))return r.push(a.trim()),void(a="")}0===o?i+=e:a+=e}})),u(),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PATH={VECTOR:0,BEZIER_CURVE:1,CIRCLE:2}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=r.PATH.VECTOR,this.x=t,this.y=n,isNaN(t)&&console.error("Invalid x value given for Vector"),isNaN(n)&&console.error("Invalid y value given for Vector")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseListStyle=t.parseListStyleType=t.LIST_STYLE_TYPE=t.LIST_STYLE_POSITION=void 0;var r=n(5),i=t.LIST_STYLE_POSITION={INSIDE:0,OUTSIDE:1},A=t.LIST_STYLE_TYPE={NONE:-1,DISC:0,CIRCLE:1,SQUARE:2,DECIMAL:3,CJK_DECIMAL:4,DECIMAL_LEADING_ZERO:5,LOWER_ROMAN:6,UPPER_ROMAN:7,LOWER_GREEK:8,LOWER_ALPHA:9,UPPER_ALPHA:10,ARABIC_INDIC:11,ARMENIAN:12,BENGALI:13,CAMBODIAN:14,CJK_EARTHLY_BRANCH:15,CJK_HEAVENLY_STEM:16,CJK_IDEOGRAPHIC:17,DEVANAGARI:18,ETHIOPIC_NUMERIC:19,GEORGIAN:20,GUJARATI:21,GURMUKHI:22,HEBREW:22,HIRAGANA:23,HIRAGANA_IROHA:24,JAPANESE_FORMAL:25,JAPANESE_INFORMAL:26,KANNADA:27,KATAKANA:28,KATAKANA_IROHA:29,KHMER:30,KOREAN_HANGUL_FORMAL:31,KOREAN_HANJA_FORMAL:32,KOREAN_HANJA_INFORMAL:33,LAO:34,LOWER_ARMENIAN:35,MALAYALAM:36,MONGOLIAN:37,MYANMAR:38,ORIYA:39,PERSIAN:40,SIMP_CHINESE_FORMAL:41,SIMP_CHINESE_INFORMAL:42,TAMIL:43,TELUGU:44,THAI:45,TIBETAN:46,TRAD_CHINESE_FORMAL:47,TRAD_CHINESE_INFORMAL:48,UPPER_ARMENIAN:49,DISCLOSURE_OPEN:50,DISCLOSURE_CLOSED:51},a=t.parseListStyleType=function(e){switch(e){case"disc":return A.DISC;case"circle":return A.CIRCLE;case"square":return A.SQUARE;case"decimal":return A.DECIMAL;case"cjk-decimal":return A.CJK_DECIMAL;case"decimal-leading-zero":return A.DECIMAL_LEADING_ZERO;case"lower-roman":return A.LOWER_ROMAN;case"upper-roman":return A.UPPER_ROMAN;case"lower-greek":return A.LOWER_GREEK;case"lower-alpha":return A.LOWER_ALPHA;case"upper-alpha":return A.UPPER_ALPHA;case"arabic-indic":return A.ARABIC_INDIC;case"armenian":return A.ARMENIAN;case"bengali":return A.BENGALI;case"cambodian":return A.CAMBODIAN;case"cjk-earthly-branch":return A.CJK_EARTHLY_BRANCH;case"cjk-heavenly-stem":return A.CJK_HEAVENLY_STEM;case"cjk-ideographic":return A.CJK_IDEOGRAPHIC;case"devanagari":return A.DEVANAGARI;case"ethiopic-numeric":return A.ETHIOPIC_NUMERIC;case"georgian":return A.GEORGIAN;case"gujarati":return A.GUJARATI;case"gurmukhi":return A.GURMUKHI;case"hebrew":return A.HEBREW;case"hiragana":return A.HIRAGANA;case"hiragana-iroha":return A.HIRAGANA_IROHA;case"japanese-formal":return A.JAPANESE_FORMAL;case"japanese-informal":return A.JAPANESE_INFORMAL;case"kannada":return A.KANNADA;case"katakana":return A.KATAKANA;case"katakana-iroha":return A.KATAKANA_IROHA;case"khmer":return A.KHMER;case"korean-hangul-formal":return A.KOREAN_HANGUL_FORMAL;case"korean-hanja-formal":return A.KOREAN_HANJA_FORMAL;case"korean-hanja-informal":return A.KOREAN_HANJA_INFORMAL;case"lao":return A.LAO;case"lower-armenian":return A.LOWER_ARMENIAN;case"malayalam":return A.MALAYALAM;case"mongolian":return A.MONGOLIAN;case"myanmar":return A.MYANMAR;case"oriya":return A.ORIYA;case"persian":return A.PERSIAN;case"simp-chinese-formal":return A.SIMP_CHINESE_FORMAL;case"simp-chinese-informal":return A.SIMP_CHINESE_INFORMAL;case"tamil":return A.TAMIL;case"telugu":return A.TELUGU;case"thai":return A.THAI;case"tibetan":return A.TIBETAN;case"trad-chinese-formal":return A.TRAD_CHINESE_FORMAL;case"trad-chinese-informal":return A.TRAD_CHINESE_INFORMAL;case"upper-armenian":return A.UPPER_ARMENIAN;case"disclosure-open":return A.DISCLOSURE_OPEN;case"disclosure-closed":return A.DISCLOSURE_CLOSED;case"none":default:return A.NONE}},o=(t.parseListStyle=function(e){var t=(0,r.parseBackgroundImage)(e.getPropertyValue("list-style-image"));return{listStyleType:a(e.getPropertyValue("list-style-type")),listStyleImage:t.length?t[0]:null,listStylePosition:o(e.getPropertyValue("list-style-position"))}},function(e){switch(e){case"inside":return i.INSIDE;case"outside":default:return i.OUTSIDE}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(20),A=n(22),a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text=t,this.parent=n,this.bounds=r}return r(e,null,[{key:"fromTextNode",value:function(t,n){var r=s(t.data,n.style.textTransform);return new e(r,n,(0,A.parseTextBounds)(r,n,t))}}]),e}();t.default=a;var o=/(^|\s|:|-|\(|\))([a-z])/g,s=function(e,t){switch(t){case i.TEXT_TRANSFORM.LOWERCASE:return e.toLowerCase();case i.TEXT_TRANSFORM.CAPITALIZE:return e.replace(o,u);case i.TEXT_TRANSFORM.UPPERCASE:return e.toUpperCase();default:return e}};function u(e,t,n){return e.length>0?t+n.toUpperCase():e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),i=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},A={get SUPPORT_RANGE_BOUNDS(){var e=function(e){if(e.createRange){var t=e.createRange();if(t.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height="123px",n.style.display="block",e.body.appendChild(n),t.selectNode(n);var r=t.getBoundingClientRect(),i=Math.round(r.height);if(e.body.removeChild(n),123===i)return!0}}return!1}(document);return Object.defineProperty(A,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=function(e){var t=new Image,n=e.createElement("canvas"),r=n.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(t,0,0),n.toDataURL()}catch(e){return!1}return!0}(document);return Object.defineProperty(A,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_BASE64_DRAWING(){return function(e){var t=function(e,t){var n=new Image,r=e.createElement("canvas"),i=r.getContext("2d");return new Promise((function(e){n.src=t;var A=function(){try{i.drawImage(n,0,0),r.toDataURL()}catch(t){return e(!1)}return e(!0)};n.onload=A,n.onerror=function(){return e(!1)},!0===n.complete&&setTimeout((function(){A()}),500)}))}(document,e);return Object.defineProperty(A,"SUPPORT_BASE64_DRAWING",{value:function(){return t}}),t}},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?function(e){var t=e.createElement("canvas");t.width=100,t.height=100;var n=t.getContext("2d");n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,100,100);var A=new Image,a=t.toDataURL();A.src=a;var o=(0,r.createForeignObjectSVG)(100,100,0,0,A);return n.fillStyle="red",n.fillRect(0,0,100,100),(0,r.loadSerializedSVG)(o).then((function(t){n.drawImage(t,0,0);var A=n.getImageData(0,0,100,100).data;n.fillStyle="red",n.fillRect(0,0,100,100);var o=e.createElement("div");return o.style.backgroundImage="url("+a+")",o.style.height="100px",i(A)?(0,r.loadSerializedSVG)((0,r.createForeignObjectSVG)(100,100,0,0,o)):Promise.reject(!1)})).then((function(e){return n.drawImage(e,0,0),i(n.getImageData(0,0,100,100).data)})).catch((function(e){return!1}))}(document):Promise.resolve(!1);return Object.defineProperty(A,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=void 0!==(new Image).crossOrigin;return Object.defineProperty(A,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(A,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(A,"SUPPORT_CORS_XHR",{value:e}),e}};t.default=A},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTextDecoration=t.TEXT_DECORATION_LINE=t.TEXT_DECORATION=t.TEXT_DECORATION_STYLE=void 0;var r,i=n(0),A=(r=i)&&r.__esModule?r:{default:r},a=t.TEXT_DECORATION_STYLE={SOLID:0,DOUBLE:1,DOTTED:2,DASHED:3,WAVY:4},o=t.TEXT_DECORATION={NONE:null},s=t.TEXT_DECORATION_LINE={UNDERLINE:1,OVERLINE:2,LINE_THROUGH:3,BLINK:4},u=function(e){switch(e){case"underline":return s.UNDERLINE;case"overline":return s.OVERLINE;case"line-through":return s.LINE_THROUGH}return s.BLINK};t.parseTextDecoration=function(e){var t,n="none"===(t=e.textDecorationLine?e.textDecorationLine:e.textDecoration)?null:t.split(" ").map(u);return null===n?o.NONE:{textDecorationLine:n,textDecorationColor:e.textDecorationColor?new A.default(e.textDecorationColor):null,textDecorationStyle:function(e){switch(e){case"double":return a.DOUBLE;case"dotted":return a.DOTTED;case"dashed":return a.DASHED;case"wavy":return a.WAVY}return a.SOLID}(e.textDecorationStyle)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBorder=t.BORDER_SIDES=t.BORDER_STYLE=void 0;var r,i=n(0),A=(r=i)&&r.__esModule?r:{default:r},a=t.BORDER_STYLE={NONE:0,SOLID:1},o=t.BORDER_SIDES={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3},s=Object.keys(o).map((function(e){return e.toLowerCase()}));t.parseBorder=function(e){return s.map((function(t){var n=new A.default(e.getPropertyValue("border-"+t+"-color")),r=function(e){switch(e){case"none":return a.NONE}return a.SOLID}(e.getPropertyValue("border-"+t+"-style")),i=parseFloat(e.getPropertyValue("border-"+t+"-width"));return{borderColor:n,borderStyle:r,borderWidth:isNaN(i)?0:i}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toCodePoints=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var A=e.charCodeAt(n++);56320==(64512&A)?t.push(((1023&i)<<10)+(1023&A)+65536):(t.push(i),n--)}else t.push(i)}return t},t.fromCodePoint=function(){if(String.fromCodePoint)return String.fromCodePoint.apply(String,arguments);var e=arguments.length;if(!e)return"";for(var t=[],n=-1,r="";++n<e;){var i=arguments.length<=n?void 0:arguments[n];i<=65535?t.push(i):(i-=65536,t.push(55296+(i>>10),i%1024+56320)),(n+1===e||t.length>16384)&&(r+=String.fromCharCode.apply(String,t),t.length=0)}return r};for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="undefined"==typeof Uint8Array?[]:new Uint8Array(256),A=0;A<r.length;A++)i[r.charCodeAt(A)]=A;t.decode=function(e){var t=.75*e.length,n=e.length,r=void 0,A=0,a=void 0,o=void 0,s=void 0,u=void 0;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);var l="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(t):new Array(t),c=Array.isArray(l)?l:new Uint8Array(l);for(r=0;r<n;r+=4)a=i[e.charCodeAt(r)],o=i[e.charCodeAt(r+1)],s=i[e.charCodeAt(r+2)],u=i[e.charCodeAt(r+3)],c[A++]=a<<2|o>>4,c[A++]=(15&o)<<4|s>>2,c[A++]=(3&s)<<6|63&u;return l},t.polyUint16Array=function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n.push(e[r+1]<<8|e[r]);return n},t.polyUint32Array=function(e){for(var t=e.length,n=[],r=0;r<t;r+=4)n.push(e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]);return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCounterText=t.inlineListItemElement=t.getListOwner=void 0;var r=n(4),i=s(n(3)),A=s(n(9)),a=n(8),o=n(24);function s(e){return e&&e.__esModule?e:{default:e}}var u=["OL","UL","MENU"],l=(t.getListOwner=function(e){var t=e.parent;if(!t)return null;do{if(-1!==u.indexOf(t.tagName))return t;t=t.parent}while(t);return e.parent},t.inlineListItemElement=function(e,t,n){var o=t.style.listStyle;if(o){var s=e.ownerDocument.defaultView.getComputedStyle(e,null),u=e.ownerDocument.createElement("html2canvaswrapper");switch((0,r.copyCSSStyles)(s,u),u.style.position="absolute",u.style.bottom="auto",u.style.display="block",u.style.letterSpacing="normal",o.listStylePosition){case a.LIST_STYLE_POSITION.OUTSIDE:u.style.left="auto",u.style.right=e.ownerDocument.defaultView.innerWidth-t.bounds.left-t.style.margin[1].getAbsoluteValue(t.bounds.width)+7+"px",u.style.textAlign="right";break;case a.LIST_STYLE_POSITION.INSIDE:u.style.left=t.bounds.left-t.style.margin[3].getAbsoluteValue(t.bounds.width)+"px",u.style.right="auto",u.style.textAlign="left"}var l=void 0,c=t.style.margin[0].getAbsoluteValue(t.bounds.width),h=o.listStyleImage;if(h)if("url"===h.method){var d=e.ownerDocument.createElement("img");d.src=h.args[0],u.style.top=t.bounds.top-c+"px",u.style.width="auto",u.style.height="auto",u.appendChild(d)}else{var f=.5*parseFloat(t.style.font.fontSize);u.style.top=t.bounds.top-c+t.bounds.height-1.5*f+"px",u.style.width=f+"px",u.style.height=f+"px",u.style.backgroundImage=s.listStyleImage}else"number"==typeof t.listIndex&&(l=e.ownerDocument.createTextNode(E(t.listIndex,o.listStyleType,!0)),u.appendChild(l),u.style.top=t.bounds.top-c+"px");var p=e.ownerDocument.body;p.appendChild(u),l?(t.childNodes.push(A.default.fromTextNode(l,t)),p.removeChild(u)):t.childNodes.push(new i.default(u,t,n,0))}},{integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]}),c={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},h={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},d={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},f=function(e,t,n,r,i,A){return e<t||e>n?E(e,i,A.length>0):r.integers.reduce((function(t,n,i){for(;e>=n;)e-=n,t+=r.values[i];return t}),"")+A},p=function(e,t,n,r){var i="";do{n||e--,i=r(e)+i,e/=t}while(e*t>=t);return i},g=function(e,t,n,r,i){var A=n-t+1;return(e<0?"-":"")+(p(Math.abs(e),A,r,(function(e){return(0,o.fromCodePoint)(Math.floor(e%A)+t)}))+i)},y=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:". ",r=t.length;return p(Math.abs(e),r,!1,(function(e){return t[Math.floor(e%r)]}))+n},m=function(e,t,n,i,A,o){if(e<-9999||e>9999)return E(e,a.LIST_STYLE_TYPE.CJK_DECIMAL,A.length>0);var s=Math.abs(e),u=A;if(0===s)return t[0]+u;for(var l=0;s>0&&l<=4;l++){var c=s%10;0===c&&(0,r.contains)(o,1)&&""!==u?u=t[c]+u:c>1||1===c&&0===l||1===c&&1===l&&(0,r.contains)(o,2)||1===c&&1===l&&(0,r.contains)(o,4)&&e>100||1===c&&l>1&&(0,r.contains)(o,8)?u=t[c]+(l>0?n[l-1]:"")+u:1===c&&l>0&&(u=n[l-1]+u),s=Math.floor(s/10)}return(e<0?i:"")+u},E=t.createCounterText=function(e,t,n){var r=n?". ":"",i=n?"、":"",A=n?", ":"";switch(t){case a.LIST_STYLE_TYPE.DISC:return"•";case a.LIST_STYLE_TYPE.CIRCLE:return"◦";case a.LIST_STYLE_TYPE.SQUARE:return"◾";case a.LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO:var o=g(e,48,57,!0,r);return o.length<4?"0"+o:o;case a.LIST_STYLE_TYPE.CJK_DECIMAL:return y(e,"〇一二三四五六七八九",i);case a.LIST_STYLE_TYPE.LOWER_ROMAN:return f(e,1,3999,l,a.LIST_STYLE_TYPE.DECIMAL,r).toLowerCase();case a.LIST_STYLE_TYPE.UPPER_ROMAN:return f(e,1,3999,l,a.LIST_STYLE_TYPE.DECIMAL,r);case a.LIST_STYLE_TYPE.LOWER_GREEK:return g(e,945,969,!1,r);case a.LIST_STYLE_TYPE.LOWER_ALPHA:return g(e,97,122,!1,r);case a.LIST_STYLE_TYPE.UPPER_ALPHA:return g(e,65,90,!1,r);case a.LIST_STYLE_TYPE.ARABIC_INDIC:return g(e,1632,1641,!0,r);case a.LIST_STYLE_TYPE.ARMENIAN:case a.LIST_STYLE_TYPE.UPPER_ARMENIAN:return f(e,1,9999,c,a.LIST_STYLE_TYPE.DECIMAL,r);case a.LIST_STYLE_TYPE.LOWER_ARMENIAN:return f(e,1,9999,c,a.LIST_STYLE_TYPE.DECIMAL,r).toLowerCase();case a.LIST_STYLE_TYPE.BENGALI:return g(e,2534,2543,!0,r);case a.LIST_STYLE_TYPE.CAMBODIAN:case a.LIST_STYLE_TYPE.KHMER:return g(e,6112,6121,!0,r);case a.LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH:return y(e,"子丑寅卯辰巳午未申酉戌亥",i);case a.LIST_STYLE_TYPE.CJK_HEAVENLY_STEM:return y(e,"甲乙丙丁戊己庚辛壬癸",i);case a.LIST_STYLE_TYPE.CJK_IDEOGRAPHIC:case a.LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL:return m(e,"零一二三四五六七八九","十百千萬","負",i,14);case a.LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL:return m(e,"零壹貳參肆伍陸柒捌玖","拾佰仟萬","負",i,15);case a.LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL:return m(e,"零一二三四五六七八九","十百千萬","负",i,14);case a.LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL:return m(e,"零壹贰叁肆伍陆柒捌玖","拾佰仟萬","负",i,15);case a.LIST_STYLE_TYPE.JAPANESE_INFORMAL:return m(e,"〇一二三四五六七八九","十百千万","マイナス",i,0);case a.LIST_STYLE_TYPE.JAPANESE_FORMAL:return m(e,"零壱弐参四伍六七八九","拾百千万","マイナス",i,7);case a.LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL:return m(e,"영일이삼사오육칠팔구","십백천만","마이너스 ",A,7);case a.LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL:return m(e,"零一二三四五六七八九","十百千萬","마이너스 ",A,0);case a.LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL:return m(e,"零壹貳參四五六七八九","拾百千","마이너스 ",A,7);case a.LIST_STYLE_TYPE.DEVANAGARI:return g(e,2406,2415,!0,r);case a.LIST_STYLE_TYPE.GEORGIAN:return f(e,1,19999,d,a.LIST_STYLE_TYPE.DECIMAL,r);case a.LIST_STYLE_TYPE.GUJARATI:return g(e,2790,2799,!0,r);case a.LIST_STYLE_TYPE.GURMUKHI:return g(e,2662,2671,!0,r);case a.LIST_STYLE_TYPE.HEBREW:return f(e,1,10999,h,a.LIST_STYLE_TYPE.DECIMAL,r);case a.LIST_STYLE_TYPE.HIRAGANA:return y(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case a.LIST_STYLE_TYPE.HIRAGANA_IROHA:return y(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case a.LIST_STYLE_TYPE.KANNADA:return g(e,3302,3311,!0,r);case a.LIST_STYLE_TYPE.KATAKANA:return y(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",i);case a.LIST_STYLE_TYPE.KATAKANA_IROHA:return y(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",i);case a.LIST_STYLE_TYPE.LAO:return g(e,3792,3801,!0,r);case a.LIST_STYLE_TYPE.MONGOLIAN:return g(e,6160,6169,!0,r);case a.LIST_STYLE_TYPE.MYANMAR:return g(e,4160,4169,!0,r);case a.LIST_STYLE_TYPE.ORIYA:return g(e,2918,2927,!0,r);case a.LIST_STYLE_TYPE.PERSIAN:return g(e,1776,1785,!0,r);case a.LIST_STYLE_TYPE.TAMIL:return g(e,3046,3055,!0,r);case a.LIST_STYLE_TYPE.TELUGU:return g(e,3174,3183,!0,r);case a.LIST_STYLE_TYPE.THAI:return g(e,3664,3673,!0,r);case a.LIST_STYLE_TYPE.TIBETAN:return g(e,3872,3881,!0,r);case a.LIST_STYLE_TYPE.DECIMAL:default:return g(e,48,57,!0,r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6),A=n(11),a=function(e,t){var n=Math.max.apply(null,e.colorStops.map((function(e){return e.stop}))),r=1/Math.max(1,n);e.colorStops.forEach((function(e){t.addColorStop(r*e.stop,e.color.toString())}))},o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t||document.createElement("canvas")}return r(e,[{key:"render",value:function(e){this.ctx=this.canvas.getContext("2d"),this.options=e,this.canvas.width=Math.floor(e.width*e.scale),this.canvas.height=Math.floor(e.height*e.scale),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-e.x,-e.y),this.ctx.textBaseline="bottom",e.logger.log("Canvas renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+this.options.scale)}},{key:"clip",value:function(e,t){var n=this;e.length&&(this.ctx.save(),e.forEach((function(e){n.path(e),n.ctx.clip()}))),t(),e.length&&this.ctx.restore()}},{key:"drawImage",value:function(e,t,n){this.ctx.drawImage(e,t.left,t.top,t.width,t.height,n.left,n.top,n.width,n.height)}},{key:"drawShape",value:function(e,t){this.path(e),this.ctx.fillStyle=t.toString(),this.ctx.fill()}},{key:"fill",value:function(e){this.ctx.fillStyle=e.toString(),this.ctx.fill()}},{key:"getTarget",value:function(){return this.canvas.getContext("2d").setTransform(1,0,0,1,0,0),Promise.resolve(this.canvas)}},{key:"path",value:function(e){var t=this;this.ctx.beginPath(),Array.isArray(e)?e.forEach((function(e,n){var r=e.type===i.PATH.VECTOR?e:e.start;0===n?t.ctx.moveTo(r.x,r.y):t.ctx.lineTo(r.x,r.y),e.type===i.PATH.BEZIER_CURVE&&t.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)})):this.ctx.arc(e.x+e.radius,e.y+e.radius,e.radius,0,2*Math.PI,!0),this.ctx.closePath()}},{key:"rectangle",value:function(e,t,n,r,i){this.ctx.fillStyle=i.toString(),this.ctx.fillRect(e,t,n,r)}},{key:"renderLinearGradient",value:function(e,t){var n=this.ctx.createLinearGradient(e.left+t.direction.x1,e.top+t.direction.y1,e.left+t.direction.x0,e.top+t.direction.y0);a(t,n),this.ctx.fillStyle=n,this.ctx.fillRect(e.left,e.top,e.width,e.height)}},{key:"renderRadialGradient",value:function(e,t){var n=this,r=e.left+t.center.x,i=e.top+t.center.y,A=this.ctx.createRadialGradient(r,i,0,r,i,t.radius.x);if(A)if(a(t,A),this.ctx.fillStyle=A,t.radius.x!==t.radius.y){var o=e.left+.5*e.width,s=e.top+.5*e.height,u=t.radius.y/t.radius.x,l=1/u;this.transform(o,s,[1,0,0,u,0,0],(function(){return n.ctx.fillRect(e.left,l*(e.top-s)+s,e.width,e.height*l)}))}else this.ctx.fillRect(e.left,e.top,e.width,e.height)}},{key:"renderRepeat",value:function(e,t,n,r,i){this.path(e),this.ctx.fillStyle=this.ctx.createPattern(this.resizeImage(t,n),"repeat"),this.ctx.translate(r,i),this.ctx.fill(),this.ctx.translate(-r,-i)}},{key:"renderTextNode",value:function(e,t,n,r,i){var a=this;this.ctx.font=[n.fontStyle,n.fontVariant,n.fontWeight,n.fontSize,n.fontFamily].join(" "),e.forEach((function(e){if(a.ctx.fillStyle=t.toString(),i&&e.text.trim().length?i.slice(0).reverse().forEach((function(t){a.ctx.shadowColor=t.color.toString(),a.ctx.shadowOffsetX=t.offsetX*a.options.scale,a.ctx.shadowOffsetY=t.offsetY*a.options.scale,a.ctx.shadowBlur=t.blur,a.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height)})):a.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height),null!==r){var o=r.textDecorationColor||t;r.textDecorationLine.forEach((function(t){switch(t){case A.TEXT_DECORATION_LINE.UNDERLINE:var r=a.options.fontMetrics.getMetrics(n).baseline;a.rectangle(e.bounds.left,Math.round(e.bounds.top+r),e.bounds.width,1,o);break;case A.TEXT_DECORATION_LINE.OVERLINE:a.rectangle(e.bounds.left,Math.round(e.bounds.top),e.bounds.width,1,o);break;case A.TEXT_DECORATION_LINE.LINE_THROUGH:var i=a.options.fontMetrics.getMetrics(n).middle;a.rectangle(e.bounds.left,Math.ceil(e.bounds.top+i),e.bounds.width,1,o)}}))}}))}},{key:"resizeImage",value:function(e,t){if(e.width===t.width&&e.height===t.height)return e;var n=this.canvas.ownerDocument.createElement("canvas");return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),n}},{key:"setOpacity",value:function(e){this.ctx.globalAlpha=e}},{key:"transform",value:function(e,t,n,r){this.ctx.save(),this.ctx.translate(e,t),this.ctx.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.ctx.translate(-e,-t),r(),this.ctx.restore()}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enabled="undefined"!=typeof window&&t,this.start=r||Date.now(),this.id=n}return r(e,[{key:"child",value:function(t){return new e(this.enabled,t,this.start)}},{key:"log",value:function(){if(this.enabled&&window.console&&window.console.log){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-this.start+"ms",this.id?"html2canvas ("+this.id+"):":"html2canvas:"].concat([].slice.call(t,0)))}}},{key:"error",value:function(){if(this.enabled&&window.console&&window.console.error){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];Function.prototype.bind.call(window.console.error,window.console).apply(window.console,[Date.now()-this.start+"ms",this.id?"html2canvas ("+this.id+"):":"html2canvas:"].concat([].slice.call(t,0)))}}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsePadding=t.PADDING_SIDES=void 0;var r,i=n(1),A=(r=i)&&r.__esModule?r:{default:r};t.PADDING_SIDES={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3};var a=["top","right","bottom","left"];t.parsePadding=function(e){return a.map((function(t){return new A.default(e.getPropertyValue("padding-"+t))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.OVERFLOW_WRAP={NORMAL:0,BREAK_WORD:1};t.parseOverflowWrap=function(e){switch(e){case"break-word":return r.BREAK_WORD;case"normal":default:return r.NORMAL}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.POSITION={STATIC:0,RELATIVE:1,ABSOLUTE:2,FIXED:3,STICKY:4};t.parsePosition=function(e){switch(e){case"relative":return r.RELATIVE;case"absolute":return r.ABSOLUTE;case"fixed":return r.FIXED;case"sticky":return r.STICKY}return r.STATIC}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.TEXT_TRANSFORM={NONE:0,LOWERCASE:1,UPPERCASE:2,CAPITALIZE:3};t.parseTextTransform=function(e){switch(e){case"uppercase":return r.UPPERCASE;case"lowercase":return r.LOWERCASE;case"capitalize":return r.CAPITALIZE}return r.NONE}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reformatInputBounds=t.inlineSelectElement=t.inlineTextAreaElement=t.inlineInputElement=t.getInputBorderRadius=t.INPUT_BACKGROUND=t.INPUT_BORDERS=t.INPUT_COLOR=void 0;var r=c(n(9)),i=n(5),A=n(12),a=c(n(50)),o=c(n(7)),s=c(n(0)),u=c(n(1)),l=(n(2),n(22),n(4));function c(e){return e&&e.__esModule?e:{default:e}}t.INPUT_COLOR=new s.default([42,42,42]);var h=new s.default([165,165,165]),d=new s.default([222,222,222]),f={borderWidth:1,borderColor:h,borderStyle:A.BORDER_STYLE.SOLID},p=(t.INPUT_BORDERS=[f,f,f,f],t.INPUT_BACKGROUND={backgroundColor:d,backgroundImage:[],backgroundClip:i.BACKGROUND_CLIP.PADDING_BOX,backgroundOrigin:i.BACKGROUND_ORIGIN.PADDING_BOX},new u.default("50%")),g=[p,p],y=[g,g,g,g],m=new u.default("3px"),E=[m,m],v=[E,E,E,E],B=(t.getInputBorderRadius=function(e){return"radio"===e.type?y:v},t.inlineInputElement=function(e,t){if("radio"===e.type||"checkbox"===e.type){if(e.checked){var n=Math.min(t.bounds.width,t.bounds.height);t.childNodes.push("checkbox"===e.type?[new o.default(t.bounds.left+.39363*n,t.bounds.top+.79*n),new o.default(t.bounds.left+.16*n,t.bounds.top+.5549*n),new o.default(t.bounds.left+.27347*n,t.bounds.top+.44071*n),new o.default(t.bounds.left+.39694*n,t.bounds.top+.5649*n),new o.default(t.bounds.left+.72983*n,t.bounds.top+.23*n),new o.default(t.bounds.left+.84*n,t.bounds.top+.34085*n),new o.default(t.bounds.left+.39363*n,t.bounds.top+.79*n)]:new a.default(t.bounds.left+n/4,t.bounds.top+n/4,n/4))}}else B(w(e),e,t,!1)},t.inlineTextAreaElement=function(e,t){B(e.value,e,t,!0)},t.inlineSelectElement=function(e,t){var n=e.options[e.selectedIndex||0];B(n&&n.text||"",e,t,!1)},t.reformatInputBounds=function(e){return e.width>e.height?(e.left+=(e.width-e.height)/2,e.width=e.height):e.width<e.height&&(e.top+=(e.height-e.width)/2,e.height=e.width),e},function(e,t,n,i){var A=t.ownerDocument.body;if(e.length>0&&A){var a=t.ownerDocument.createElement("html2canvaswrapper");(0,l.copyCSSStyles)(t.ownerDocument.defaultView.getComputedStyle(t,null),a),a.style.position="absolute",a.style.left=n.bounds.left+"px",a.style.top=n.bounds.top+"px",i||(a.style.whiteSpace="nowrap");var o=t.ownerDocument.createTextNode(e);a.appendChild(o),A.appendChild(a),n.childNodes.push(r.default.fromTextNode(o,n)),A.removeChild(a)}}),w=function(e){var t="password"===e.type?new Array(e.value.length+1).join("•"):e.value;return 0===t.length?e.placeholder||"":t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTextBounds=t.TextBounds=void 0;var r,i=n(2),A=n(11),a=n(10),o=(r=a)&&r.__esModule?r:{default:r},s=n(24),u=t.TextBounds=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text=t,this.bounds=n},l=(t.parseTextBounds=function(e,t,n){for(var r=0!==t.style.letterSpacing?(0,s.toCodePoints)(e).map((function(e){return(0,s.fromCodePoint)(e)})):(0,s.breakWords)(e,t),i=r.length,a=n.parentNode?n.parentNode.ownerDocument.defaultView:null,h=a?a.pageXOffset:0,d=a?a.pageYOffset:0,f=[],p=0,g=0;g<i;g++){var y=r[g];if(t.style.textDecoration!==A.TEXT_DECORATION.NONE||y.trim().length>0)if(o.default.SUPPORT_RANGE_BOUNDS)f.push(new u(y,c(n,p,y.length,h,d)));else{var m=n.splitText(y.length);f.push(new u(y,l(n,h,d))),n=m}else o.default.SUPPORT_RANGE_BOUNDS||(n=n.splitText(y.length));p+=y.length}return f},function(e,t,n){var r=e.ownerDocument.createElement("html2canvaswrapper");r.appendChild(e.cloneNode(!0));var A=e.parentNode;if(A){A.replaceChild(r,e);var a=(0,i.parseBounds)(r,t,n);return r.firstChild&&A.replaceChild(r.firstChild,r),a}return new i.Bounds(0,0,0,0)}),c=function(e,t,n,r,A){var a=e.ownerDocument.createRange();return a.setStart(e,t),a.setEnd(e,t+n),i.Bounds.fromClientRect(a.getBoundingClientRect(),r,A)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element=t}return r(e,[{key:"render",value:function(e){var t=this;this.options=e,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=Math.floor(e.width)*e.scale,this.canvas.height=Math.floor(e.height)*e.scale,this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",e.logger.log("ForeignObject renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+e.scale);var n=A(Math.max(e.windowWidth,e.width)*e.scale,Math.max(e.windowHeight,e.height)*e.scale,e.scrollX*e.scale,e.scrollY*e.scale,this.element);return a(n).then((function(n){return e.backgroundColor&&(t.ctx.fillStyle=e.backgroundColor.toString(),t.ctx.fillRect(0,0,e.width*e.scale,e.height*e.scale)),t.ctx.drawImage(n,-e.x*e.scale,-e.y*e.scale),t.canvas}))}}]),e}();t.default=i;var A=t.createForeignObjectSVG=function(e,t,n,r,i){var A="http://www.w3.org/2000/svg",a=document.createElementNS(A,"svg"),o=document.createElementNS(A,"foreignObject");return a.setAttributeNS(null,"width",e),a.setAttributeNS(null,"height",t),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",n),o.setAttributeNS(null,"y",r),o.setAttributeNS(null,"externalResourcesRequired","true"),a.appendChild(o),o.appendChild(i),a},a=t.loadSerializedSVG=function(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){return t(r)},r.onerror=n,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakWords=t.fromCodePoint=t.toCodePoints=void 0;var r=n(46);Object.defineProperty(t,"toCodePoints",{enumerable:!0,get:function(){return r.toCodePoints}}),Object.defineProperty(t,"fromCodePoint",{enumerable:!0,get:function(){return r.fromCodePoint}});var i,A=n(3),a=((i=A)&&i.__esModule,n(18));t.breakWords=function(e,t){for(var n=(0,r.LineBreaker)(e,{lineBreak:t.style.lineBreak,wordBreak:t.style.overflowWrap===a.OVERFLOW_WRAP.BREAK_WORD?"break-word":t.style.wordBreak}),i=[],A=void 0;!(A=n.next()).done;)i.push(A.value.slice());return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontMetrics=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4);t.FontMetrics=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={},this._document=t}return r(e,[{key:"_parseMetrics",value:function(e){var t=this._document.createElement("div"),n=this._document.createElement("img"),r=this._document.createElement("span"),A=this._document.body;if(!A)throw new Error("No document found for font metrics");t.style.visibility="hidden",t.style.fontFamily=e.fontFamily,t.style.fontSize=e.fontSize,t.style.margin="0",t.style.padding="0",A.appendChild(t),n.src=i.SMALL_IMAGE,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",r.style.fontFamily=e.fontFamily,r.style.fontSize=e.fontSize,r.style.margin="0",r.style.padding="0",r.appendChild(this._document.createTextNode("Hidden Text")),t.appendChild(r),t.appendChild(n);var a=n.offsetTop-r.offsetTop+2;t.removeChild(r),t.appendChild(this._document.createTextNode("Hidden Text")),t.style.lineHeight="normal",n.style.verticalAlign="super";var o=n.offsetTop-t.offsetTop+2;return A.removeChild(t),{baseline:a,middle:o}}},{key:"getMetrics",value:function(e){var t=e.fontFamily+" "+e.fontSize;return void 0===this._data[t]&&(this._data[t]=this._parseMetrics(e)),this._data[t]}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Proxy=void 0;var r,i=n(10),A=(r=i)&&r.__esModule?r:{default:r};t.Proxy=function(e,t){if(!t.proxy)return Promise.reject("No proxy defined");var n=t.proxy;return new Promise((function(r,i){var a=A.default.SUPPORT_CORS_XHR&&A.default.SUPPORT_RESPONSE_TYPE?"blob":"text",o=A.default.SUPPORT_CORS_XHR?new XMLHttpRequest:new XDomainRequest;if(o.onload=function(){if(o instanceof XMLHttpRequest)if(200===o.status)if("text"===a)r(o.response);else{var t=new FileReader;t.addEventListener("load",(function(){return r(t.result)}),!1),t.addEventListener("error",(function(e){return i(e)}),!1),t.readAsDataURL(o.response)}else i("Failed to proxy resource "+e.substring(0,256)+" with status code "+o.status);else r(o.responseText)},o.onerror=i,o.open("GET",n+"?url="+encodeURIComponent(e)+"&responseType="+a),"text"!==a&&o instanceof XMLHttpRequest&&(o.responseType=a),t.imageTimeout){var s=t.imageTimeout;o.timeout=s,o.ontimeout=function(){return i("Timed out ("+s+"ms) proxying "+e.substring(0,256))}}o.send()}))}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=o(n(15)),A=o(n(16)),a=n(28);function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e,t){var n=t||{},o=new A.default("boolean"!=typeof n.logging||n.logging);o.log("html2canvas 1.0.0-alpha.12"),"function"==typeof n.onrendered&&o.error("onrendered option is deprecated, html2canvas returns a Promise with the canvas as the value");var s=e.ownerDocument;if(!s)return Promise.reject("Provided element is not within a Document");var u=s.defaultView,l={async:!0,allowTaint:!1,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,scale:u.devicePixelRatio||1,target:new i.default(n.canvas),useCORS:!1,windowWidth:u.innerWidth,windowHeight:u.innerHeight,scrollX:u.pageXOffset,scrollY:u.pageYOffset},c=(0,a.renderElement)(e,r({},l,n),o);return c.catch((function(e){throw o.error(e),e}))};s.CanvasRenderer=i.default,e.exports=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderElement=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,A=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,A=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw A}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=(d(n(16)),n(29)),A=d(n(51)),a=d(n(23)),o=d(n(10)),s=n(2),u=n(54),l=n(25),c=n(0),h=d(c);function d(e){return e&&e.__esModule?e:{default:e}}t.renderElement=function e(t,n,d){var f=t.ownerDocument,p=new s.Bounds(n.scrollX,n.scrollY,n.windowWidth,n.windowHeight),g=f.documentElement?new h.default(getComputedStyle(f.documentElement).backgroundColor):c.TRANSPARENT,y=f.body?new h.default(getComputedStyle(f.body).backgroundColor):c.TRANSPARENT,m=t===f.documentElement?g.isTransparent()?y.isTransparent()?n.backgroundColor?new h.default(n.backgroundColor):null:y:g:n.backgroundColor?new h.default(n.backgroundColor):null;return(n.foreignObjectRendering?o.default.SUPPORT_FOREIGNOBJECT_DRAWING:Promise.resolve(!1)).then((function(o){return o?(h=new u.DocumentCloner(t,n,d,!0,e),d.log("Document cloned, using foreignObject rendering"),h.inlineFonts(f).then((function(){return h.resourceLoader.ready()})).then((function(){var e=new a.default(h.documentElement),r=f.defaultView,i=r.pageXOffset,A=r.pageYOffset,o="HTML"===t.tagName||"BODY"===t.tagName?(0,s.parseDocumentSize)(f):(0,s.parseBounds)(t,i,A),u=o.width,l=o.height,c=o.left,p=o.top;return e.render({backgroundColor:m,logger:d,scale:n.scale,x:"number"==typeof n.x?n.x:c,y:"number"==typeof n.y?n.y:p,width:"number"==typeof n.width?n.width:Math.ceil(u),height:"number"==typeof n.height?n.height:Math.ceil(l),windowWidth:n.windowWidth,windowHeight:n.windowHeight,scrollX:n.scrollX,scrollY:n.scrollY})}))):(0,u.cloneWindow)(f,p,t,n,d,e).then((function(e){var t=r(e,3),a=t[0],o=t[1],u=t[2];d.log("Document cloned, using computed rendering");var h=(0,i.NodeParser)(o,u,d),p=o.ownerDocument;return m===h.container.style.background.backgroundColor&&(h.container.style.background.backgroundColor=c.TRANSPARENT),u.ready().then((function(e){var t=new l.FontMetrics(p);d.log("Starting renderer");var r=p.defaultView,i=r.pageXOffset,u=r.pageYOffset,c="HTML"===o.tagName||"BODY"===o.tagName?(0,s.parseDocumentSize)(f):(0,s.parseBounds)(o,i,u),g=c.width,y=c.height,E=c.left,v=c.top,B={backgroundColor:m,fontMetrics:t,imageStore:e,logger:d,scale:n.scale,x:"number"==typeof n.x?n.x:E,y:"number"==typeof n.y?n.y:v,width:"number"==typeof n.width?n.width:Math.ceil(g),height:"number"==typeof n.height?n.height:Math.ceil(y)};if(Array.isArray(n.target))return Promise.all(n.target.map((function(e){return new A.default(e,B).render(h)})));var w=new A.default(n.target,B).render(h);return!0===n.removeContainer&&(a.parentNode?a.parentNode.removeChild(a):d.log("Cannot detach cloned iframe as it is not in the DOM anymore")),w}))}));var h}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeParser=void 0;var r=u(n(30)),i=u(n(3)),A=u(n(9)),a=n(21),o=n(14),s=n(8);function u(e){return e&&e.__esModule?e:{default:e}}t.NodeParser=function(e,t,n){n.log("Starting node parsing");var A=0,a=new i.default(e,null,t,A++),o=new r.default(a,null,!0);return c(e,a,o,t,1),n.log("Finished parsing node tree"),o};var l=["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"],c=function e(t,n,u,c,f){if(f>5e4)throw new Error("Recursion error while parsing node tree");for(var p,g=t.firstChild;g;g=p){p=g.nextSibling;var y=g.ownerDocument.defaultView;if(g instanceof y.Text||g instanceof Text||y.parent&&g instanceof y.parent.Text)g.data.trim().length>0&&n.childNodes.push(A.default.fromTextNode(g,n));else if(g instanceof y.HTMLElement||g instanceof HTMLElement||y.parent&&g instanceof y.parent.HTMLElement){if(-1===l.indexOf(g.nodeName)){var m=new i.default(g,n,c,f++);if(m.isVisible()){"INPUT"===g.tagName?(0,a.inlineInputElement)(g,m):"TEXTAREA"===g.tagName?(0,a.inlineTextAreaElement)(g,m):"SELECT"===g.tagName?(0,a.inlineSelectElement)(g,m):m.style.listStyle&&m.style.listStyle.listStyleType!==s.LIST_STYLE_TYPE.NONE&&(0,o.inlineListItemElement)(g,m,c);var E="TEXTAREA"!==g.tagName,v=h(m,g);if(v||d(m)){var B=v||m.isPositioned()?u.getRealParentStackingContext():u,w=new r.default(m,B,v);B.contexts.push(w),E&&e(g,m,w,c,f)}else u.children.push(m),E&&e(g,m,u,c,f)}}}else if(g instanceof y.SVGSVGElement||g instanceof SVGSVGElement||y.parent&&g instanceof y.parent.SVGSVGElement){var k=new i.default(g,n,c,f++),C=h(k,g);if(C||d(k)){var b=C||k.isPositioned()?u.getRealParentStackingContext():u,S=new r.default(k,b,C);b.contexts.push(S)}else u.children.push(k)}}},h=function(e,t){return e.isRootElement()||e.isPositionedWithZIndex()||e.style.opacity<1||e.isTransformed()||f(e,t)},d=function(e){return e.isPositioned()||e.isFloating()},f=function(e,t){return"BODY"===t.nodeName&&e.parent instanceof i.default&&e.parent.style.background.backgroundColor.isTransparent()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=n(3);(r=A)&&r.__esModule,n(19);var a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.parent=n,this.contexts=[],this.children=[],this.treatAsRealStackingContext=r}return i(e,[{key:"getOpacity",value:function(){return this.parent?this.container.style.opacity*this.parent.getOpacity():this.container.style.opacity}},{key:"getRealParentStackingContext",value:function(){return!this.parent||this.treatAsRealStackingContext?this:this.parent.getRealParentStackingContext()}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=n(6),a=n(7),o=(r=a)&&r.__esModule?r:{default:r},s=function(e,t,n){return new o.default(e.x+(t.x-e.x)*n,e.y+(t.y-e.y)*n)},u=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=A.PATH.BEZIER_CURVE,this.start=t,this.startControl=n,this.endControl=r,this.end=i}return i(e,[{key:"subdivide",value:function(t,n){var r=s(this.start,this.startControl,t),i=s(this.startControl,this.endControl,t),A=s(this.endControl,this.end,t),a=s(r,i,t),o=s(i,A,t),u=s(a,o,t);return n?new e(this.start,r,a,u):new e(u,o,A,this.end)}},{key:"reverse",value:function(){return new e(this.end,this.endControl,this.startControl,this.start)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBorderRadius=void 0;var r,i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,A=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,A=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw A}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},A=n(1),a=(r=A)&&r.__esModule?r:{default:r},o=["top-left","top-right","bottom-right","bottom-left"];t.parseBorderRadius=function(e){return o.map((function(t){var n=e.getPropertyValue("border-"+t+"-radius").split(" ").map(a.default.create),r=i(n,2),A=r[0],o=r[1];return void 0===o?[A,A]:[A,o]}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.DISPLAY={NONE:1,BLOCK:2,INLINE:4,RUN_IN:8,FLOW:16,FLOW_ROOT:32,TABLE:64,FLEX:128,GRID:256,RUBY:512,SUBGRID:1024,LIST_ITEM:2048,TABLE_ROW_GROUP:4096,TABLE_HEADER_GROUP:8192,TABLE_FOOTER_GROUP:16384,TABLE_ROW:32768,TABLE_CELL:65536,TABLE_COLUMN_GROUP:1<<17,TABLE_COLUMN:1<<18,TABLE_CAPTION:1<<19,RUBY_BASE:1<<20,RUBY_TEXT:1<<21,RUBY_BASE_CONTAINER:1<<22,RUBY_TEXT_CONTAINER:1<<23,CONTENTS:1<<24,INLINE_BLOCK:1<<25,INLINE_LIST_ITEM:1<<26,INLINE_TABLE:1<<27,INLINE_FLEX:1<<28,INLINE_GRID:1<<29},i=function(e,t){return e|function(e){switch(e){case"block":return r.BLOCK;case"inline":return r.INLINE;case"run-in":return r.RUN_IN;case"flow":return r.FLOW;case"flow-root":return r.FLOW_ROOT;case"table":return r.TABLE;case"flex":return r.FLEX;case"grid":return r.GRID;case"ruby":return r.RUBY;case"subgrid":return r.SUBGRID;case"list-item":return r.LIST_ITEM;case"table-row-group":return r.TABLE_ROW_GROUP;case"table-header-group":return r.TABLE_HEADER_GROUP;case"table-footer-group":return r.TABLE_FOOTER_GROUP;case"table-row":return r.TABLE_ROW;case"table-cell":return r.TABLE_CELL;case"table-column-group":return r.TABLE_COLUMN_GROUP;case"table-column":return r.TABLE_COLUMN;case"table-caption":return r.TABLE_CAPTION;case"ruby-base":return r.RUBY_BASE;case"ruby-text":return r.RUBY_TEXT;case"ruby-base-container":return r.RUBY_BASE_CONTAINER;case"ruby-text-container":return r.RUBY_TEXT_CONTAINER;case"contents":return r.CONTENTS;case"inline-block":return r.INLINE_BLOCK;case"inline-list-item":return r.INLINE_LIST_ITEM;case"inline-table":return r.INLINE_TABLE;case"inline-flex":return r.INLINE_FLEX;case"inline-grid":return r.INLINE_GRID}return r.NONE}(t)};t.parseDisplay=function(e){return e.split(" ").reduce(i,0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.FLOAT={NONE:0,LEFT:1,RIGHT:2,INLINE_START:3,INLINE_END:4};t.parseCSSFloat=function(e){switch(e){case"left":return r.LEFT;case"right":return r.RIGHT;case"inline-start":return r.INLINE_START;case"inline-end":return r.INLINE_END}return r.NONE}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFont=function(e){return{fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontVariant:e.fontVariant,fontWeight:function(e){switch(e){case"normal":return 400;case"bold":return 700}var t=parseInt(e,10);return isNaN(t)?400:t}(e.fontWeight)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLetterSpacing=function(e){if("normal"===e)return 0;var t=parseFloat(e);return isNaN(t)?0:t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.LINE_BREAK={NORMAL:"normal",STRICT:"strict"};t.parseLineBreak=function(e){switch(e){case"strict":return r.STRICT;case"normal":default:return r.NORMAL}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseMargin=void 0;var r,i=n(1),A=(r=i)&&r.__esModule?r:{default:r},a=["top","right","bottom","left"];t.parseMargin=function(e){return a.map((function(t){return new A.default(e.getPropertyValue("margin-"+t))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.OVERFLOW={VISIBLE:0,HIDDEN:1,SCROLL:2,AUTO:3};t.parseOverflow=function(e){switch(e){case"hidden":return r.HIDDEN;case"scroll":return r.SCROLL;case"auto":return r.AUTO;case"visible":default:return r.VISIBLE}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTextShadow=void 0;var r,i=n(0),A=(r=i)&&r.__esModule?r:{default:r},a=/^([+-]|\d|\.)$/i;t.parseTextShadow=function(e){if("none"===e||"string"!=typeof e)return null;for(var t="",n=!1,r=[],i=[],o=0,s=null,u=function(){t.length&&(n?r.push(parseFloat(t)):s=new A.default(t)),n=!1,t=""},l=function(){r.length&&null!==s&&i.push({color:s,offsetX:r[0]||0,offsetY:r[1]||0,blur:r[2]||0}),r.splice(0,r.length),s=null},c=0;c<e.length;c++){var h=e[c];switch(h){case"(":t+=h,o++;break;case")":t+=h,o--;break;case",":0===o?(u(),l()):t+=h;break;case" ":0===o?u():t+=h;break;default:0===t.length&&a.test(h)&&(n=!0),t+=h}}return u(),l(),0===i.length?null:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTransform=void 0;var r,i=n(1),A=(r=i)&&r.__esModule?r:{default:r},a=function(e){return parseFloat(e.trim())},o=/(matrix|matrix3d)\((.+)\)/,s=(t.parseTransform=function(e){var t=u(e.transform||e.webkitTransform||e.mozTransform||e.msTransform||e.oTransform);return null===t?null:{transform:t,transformOrigin:s(e.transformOrigin||e.webkitTransformOrigin||e.mozTransformOrigin||e.msTransformOrigin||e.oTransformOrigin)}},function(e){if("string"!=typeof e){var t=new A.default("0");return[t,t]}var n=e.split(" ").map(A.default.create);return[n[0],n[1]]}),u=function(e){if("none"===e||"string"!=typeof e)return null;var t=e.match(o);if(t){if("matrix"===t[1]){var n=t[2].split(",").map(a);return[n[0],n[1],n[2],n[3],n[4],n[5]]}var r=t[2].split(",").map(a);return[r[0],r[1],r[4],r[5],r[12],r[13]]}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.VISIBILITY={VISIBLE:0,HIDDEN:1,COLLAPSE:2};t.parseVisibility=function(e){switch(e){case"hidden":return r.HIDDEN;case"collapse":return r.COLLAPSE;case"visible":default:return r.VISIBLE}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.WORD_BREAK={NORMAL:"normal",BREAK_ALL:"break-all",KEEP_ALL:"keep-all"};t.parseWordBreak=function(e){switch(e){case"break-all":return r.BREAK_ALL;case"keep-all":return r.KEEP_ALL;case"normal":default:return r.NORMAL}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseZIndex=function(e){var t="auto"===e;return{auto:t,order:t?0:parseInt(e,10)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13);Object.defineProperty(t,"toCodePoints",{enumerable:!0,get:function(){return r.toCodePoints}}),Object.defineProperty(t,"fromCodePoint",{enumerable:!0,get:function(){return r.fromCodePoint}});var i=n(47);Object.defineProperty(t,"LineBreaker",{enumerable:!0,get:function(){return i.LineBreaker}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineBreaker=t.inlineBreakOpportunities=t.lineBreakAtIndex=t.codePointsToCharacterClasses=t.UnicodeTrie=t.BREAK_ALLOWED=t.BREAK_NOT_ALLOWED=t.BREAK_MANDATORY=t.classes=t.LETTER_NUMBER_MODIFIER=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,A=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,A=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw A}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=n(48),o=n(49),s=(r=o)&&r.__esModule?r:{default:r},u=n(13),l=t.LETTER_NUMBER_MODIFIER=50,c=10,h=13,d=15,f=17,p=18,g=19,y=20,m=21,E=22,v=24,B=25,w=26,k=27,C=28,b=30,S=32,T=33,M=34,U=35,Q=37,x=38,F=39,_=40,H=42,L=(t.classes={BK:1,CR:2,LF:3,CM:4,NL:5,SG:6,WJ:7,ZW:8,GL:9,SP:c,ZWJ:11,B2:12,BA:h,BB:14,HY:d,CB:16,CL:f,CP:p,EX:g,IN:y,NS:m,OP:E,QU:23,IS:v,NU:B,PO:w,PR:k,SY:C,AI:29,AL:b,CJ:31,EB:S,EM:T,H2:M,H3:U,HL:36,ID:Q,JL:x,JV:F,JT:_,RI:41,SA:H,XX:43},t.BREAK_MANDATORY="!"),I=t.BREAK_NOT_ALLOWED="×",D=t.BREAK_ALLOWED="÷",O=t.UnicodeTrie=(0,a.createTrieFromBase64)(s.default),R=[b,36],N=[1,2,3,5],P=[c,8],K=[k,w],V=N.concat(P),j=[x,F,_,M,U],G=[d,h],z=t.codePointsToCharacterClasses=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"strict",n=[],r=[],i=[];return e.forEach((function(e,A){var a=O.get(e);if(a>l?(i.push(!0),a-=l):i.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(e))return r.push(A),n.push(16);if(4===a||11===a){if(0===A)return r.push(A),n.push(b);var o=n[A-1];return-1===V.indexOf(o)?(r.push(r[A-1]),n.push(o)):(r.push(A),n.push(b))}return r.push(A),31===a?n.push("strict"===t?m:Q):a===H?n.push(b):29===a?n.push(b):43===a?e>=131072&&e<=196605||e>=196608&&e<=262141?n.push(Q):n.push(b):void n.push(a)})),[r,n,i]},Y=function(e,t,n,r){var i=r[n];if(Array.isArray(e)?-1!==e.indexOf(i):e===i)for(var A=n;A<=r.length;){var a=r[++A];if(a===t)return!0;if(a!==c)break}if(i===c)for(var o=n;o>0;){var s=r[--o];if(Array.isArray(e)?-1!==e.indexOf(s):e===s)for(var u=n;u<=r.length;){var l=r[++u];if(l===t)return!0;if(l!==c)break}if(s!==c)break}return!1},W=function(e,t){for(var n=e;n>=0;){var r=t[n];if(r!==c)return r;n--}return 0},X=function(e,t,n,r,i){if(0===n[r])return I;var A=r-1;if(Array.isArray(i)&&!0===i[A])return I;var a=A-1,o=A+1,s=t[A],u=a>=0?t[a]:0,l=t[o];if(2===s&&3===l)return I;if(-1!==N.indexOf(s))return L;if(-1!==N.indexOf(l))return I;if(-1!==P.indexOf(l))return I;if(8===W(A,t))return D;if(11===O.get(e[A])&&(l===Q||l===S||l===T))return I;if(7===s||7===l)return I;if(9===s)return I;if(-1===[c,h,d].indexOf(s)&&9===l)return I;if(-1!==[f,p,g,v,C].indexOf(l))return I;if(W(A,t)===E)return I;if(Y(23,E,A,t))return I;if(Y([f,p],m,A,t))return I;if(Y(12,12,A,t))return I;if(s===c)return D;if(23===s||23===l)return I;if(16===l||16===s)return D;if(-1!==[h,d,m].indexOf(l)||14===s)return I;if(36===u&&-1!==G.indexOf(s))return I;if(s===C&&36===l)return I;if(l===y&&-1!==R.concat(y,g,B,Q,S,T).indexOf(s))return I;if(-1!==R.indexOf(l)&&s===B||-1!==R.indexOf(s)&&l===B)return I;if(s===k&&-1!==[Q,S,T].indexOf(l)||-1!==[Q,S,T].indexOf(s)&&l===w)return I;if(-1!==R.indexOf(s)&&-1!==K.indexOf(l)||-1!==K.indexOf(s)&&-1!==R.indexOf(l))return I;if(-1!==[k,w].indexOf(s)&&(l===B||-1!==[E,d].indexOf(l)&&t[o+1]===B)||-1!==[E,d].indexOf(s)&&l===B||s===B&&-1!==[B,C,v].indexOf(l))return I;if(-1!==[B,C,v,f,p].indexOf(l))for(var b=A;b>=0;){var H=t[b];if(H===B)return I;if(-1===[C,v].indexOf(H))break;b--}if(-1!==[k,w].indexOf(l))for(var V=-1!==[f,p].indexOf(s)?a:A;V>=0;){var z=t[V];if(z===B)return I;if(-1===[C,v].indexOf(z))break;V--}if(x===s&&-1!==[x,F,M,U].indexOf(l)||-1!==[F,M].indexOf(s)&&-1!==[F,_].indexOf(l)||-1!==[_,U].indexOf(s)&&l===_)return I;if(-1!==j.indexOf(s)&&-1!==[y,w].indexOf(l)||-1!==j.indexOf(l)&&s===k)return I;if(-1!==R.indexOf(s)&&-1!==R.indexOf(l))return I;if(s===v&&-1!==R.indexOf(l))return I;if(-1!==R.concat(B).indexOf(s)&&l===E||-1!==R.concat(B).indexOf(l)&&s===p)return I;if(41===s&&41===l){for(var X=n[A],J=1;X>0&&41===t[--X];)J++;if(J%2!=0)return I}return s===S&&l===T?I:D},J=(t.lineBreakAtIndex=function(e,t){if(0===t)return I;if(t>=e.length)return L;var n=z(e),r=A(n,2),i=r[0],a=r[1];return X(e,a,i,t)},function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var n=z(e,t.lineBreak),r=A(n,3),i=r[0],a=r[1],o=r[2];return"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(a=a.map((function(e){return-1!==[B,b,H].indexOf(e)?Q:e}))),[i,a,"keep-all"===t.wordBreak?o.map((function(t,n){return t&&e[n]>=19968&&e[n]<=40959})):null]}),q=(t.inlineBreakOpportunities=function(e,t){var n=(0,u.toCodePoints)(e),r=I,i=J(n,t),a=A(i,3),o=a[0],s=a[1],l=a[2];return n.forEach((function(e,t){r+=(0,u.fromCodePoint)(e)+(t>=n.length-1?L:X(n,s,o,t+1,l))})),r},function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._codePoints=t,this.required=n===L,this.start=r,this.end=i}return i(e,[{key:"slice",value:function(){return u.fromCodePoint.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this._codePoints.slice(this.start,this.end)))}}]),e}());t.LineBreaker=function(e,t){var n=(0,u.toCodePoints)(e),r=J(n,t),i=A(r,3),a=i[0],o=i[1],s=i[2],l=n.length,c=0,h=0;return{next:function(){if(h>=l)return{done:!0};for(var e=I;h<l&&(e=X(n,o,a,++h,s))===I;);if(e!==I||h===l){var t=new q(n,e,c,h);return c=h,{value:t,done:!1}}return{done:!0}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Trie=t.createTrieFromBase64=t.UTRIE2_INDEX_2_MASK=t.UTRIE2_INDEX_2_BLOCK_LENGTH=t.UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=t.UTRIE2_INDEX_1_OFFSET=t.UTRIE2_UTF8_2B_INDEX_2_LENGTH=t.UTRIE2_UTF8_2B_INDEX_2_OFFSET=t.UTRIE2_INDEX_2_BMP_LENGTH=t.UTRIE2_LSCP_INDEX_2_LENGTH=t.UTRIE2_DATA_MASK=t.UTRIE2_DATA_BLOCK_LENGTH=t.UTRIE2_LSCP_INDEX_2_OFFSET=t.UTRIE2_SHIFT_1_2=t.UTRIE2_INDEX_SHIFT=t.UTRIE2_SHIFT_1=t.UTRIE2_SHIFT_2=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(13),A=t.UTRIE2_SHIFT_2=5,a=t.UTRIE2_SHIFT_1=11,o=t.UTRIE2_INDEX_SHIFT=2,s=t.UTRIE2_SHIFT_1_2=a-A,u=t.UTRIE2_LSCP_INDEX_2_OFFSET=65536>>A,l=t.UTRIE2_DATA_BLOCK_LENGTH=1<<A,c=t.UTRIE2_DATA_MASK=l-1,h=t.UTRIE2_LSCP_INDEX_2_LENGTH=1024>>A,d=t.UTRIE2_INDEX_2_BMP_LENGTH=u+h,f=t.UTRIE2_UTF8_2B_INDEX_2_OFFSET=d,p=t.UTRIE2_UTF8_2B_INDEX_2_LENGTH=32,g=t.UTRIE2_INDEX_1_OFFSET=f+p,y=t.UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=65536>>a,m=t.UTRIE2_INDEX_2_BLOCK_LENGTH=1<<s,E=t.UTRIE2_INDEX_2_MASK=m-1,v=(t.createTrieFromBase64=function(e){var t=(0,i.decode)(e),n=Array.isArray(t)?(0,i.polyUint32Array)(t):new Uint32Array(t),r=Array.isArray(t)?(0,i.polyUint16Array)(t):new Uint16Array(t),A=r.slice(12,n[4]/2),a=2===n[5]?r.slice((24+n[4])/2):n.slice(Math.ceil((24+n[4])/4));return new v(n[0],n[1],n[2],n[3],A,a)},t.Trie=function(){function e(t,n,r,i,A,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initialValue=t,this.errorValue=n,this.highStart=r,this.highValueIndex=i,this.index=A,this.data=a}return r(e,[{key:"get",value:function(e){var t=void 0;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>A])<<o)+(e&c),this.data[t];if(e<=65535)return t=((t=this.index[u+(e-55296>>A)])<<o)+(e&c),this.data[t];if(e<this.highStart)return t=g-y+(e>>a),t=this.index[t],t+=e>>A&E,t=((t=this.index[t])<<o)+(e&c),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue}}]),e}())},function(e,t,n){"use strict";e.exports="KwAAAAAAAAAACA4AIDoAAPAfAAACAAAAAAAIABAAGABAAEgAUABYAF4AZgBeAGYAYABoAHAAeABeAGYAfACEAIAAiACQAJgAoACoAK0AtQC9AMUAXgBmAF4AZgBeAGYAzQDVAF4AZgDRANkA3gDmAOwA9AD8AAQBDAEUARoBIgGAAIgAJwEvATcBPwFFAU0BTAFUAVwBZAFsAXMBewGDATAAiwGTAZsBogGkAawBtAG8AcIBygHSAdoB4AHoAfAB+AH+AQYCDgIWAv4BHgImAi4CNgI+AkUCTQJTAlsCYwJrAnECeQKBAk0CiQKRApkCoQKoArACuALAAsQCzAIwANQC3ALkAjAA7AL0AvwCAQMJAxADGAMwACADJgMuAzYDPgOAAEYDSgNSA1IDUgNaA1oDYANiA2IDgACAAGoDgAByA3YDfgOAAIQDgACKA5IDmgOAAIAAogOqA4AAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAK8DtwOAAIAAvwPHA88D1wPfAyAD5wPsA/QD/AOAAIAABAQMBBIEgAAWBB4EJgQuBDMEIAM7BEEEXgBJBCADUQRZBGEEaQQwADAAcQQ+AXkEgQSJBJEEgACYBIAAoASoBK8EtwQwAL8ExQSAAIAAgACAAIAAgACgAM0EXgBeAF4AXgBeAF4AXgBeANUEXgDZBOEEXgDpBPEE+QQBBQkFEQUZBSEFKQUxBTUFPQVFBUwFVAVcBV4AYwVeAGsFcwV7BYMFiwWSBV4AmgWgBacFXgBeAF4AXgBeAKsFXgCyBbEFugW7BcIFwgXIBcIFwgXQBdQF3AXkBesF8wX7BQMGCwYTBhsGIwYrBjMGOwZeAD8GRwZNBl4AVAZbBl4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAGMGXgBqBnEGXgBeAF4AXgBeAF4AXgBeAF4AXgB5BoAG4wSGBo4GkwaAAIADHgR5AF4AXgBeAJsGgABGA4AAowarBrMGswagALsGwwbLBjAA0wbaBtoG3QbaBtoG2gbaBtoG2gblBusG8wb7BgMHCwcTBxsHCwcjBysHMAc1BzUHOgdCB9oGSgdSB1oHYAfaBloHaAfaBlIH2gbaBtoG2gbaBtoG2gbaBjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHbQdeAF4ANQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQd1B30HNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B4MH2gaKB68EgACAAIAAgACAAIAAgACAAI8HlwdeAJ8HpweAAIAArwe3B14AXgC/B8UHygcwANAH2AfgB4AA6AfwBz4B+AcACFwBCAgPCBcIogEYAR8IJwiAAC8INwg/CCADRwhPCFcIXwhnCEoDGgSAAIAAgABvCHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIhAiLCI4IMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAANQc1BzUHNQc1BzUHNQc1BzUHNQc1B54INQc1B6II2gaqCLIIugiAAIAAvgjGCIAAgACAAIAAgACAAIAAgACAAIAAywiHAYAA0wiAANkI3QjlCO0I9Aj8CIAAgACAAAIJCgkSCRoJIgknCTYHLwk3CZYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiAAIAAAAFAAXgBeAGAAcABeAHwAQACQAKAArQC9AJ4AXgBeAE0A3gBRAN4A7AD8AMwBGgEAAKcBNwEFAUwBXAF4QkhCmEKnArcCgAHHAsABz4LAAcABwAHAAd+C6ABoAG+C/4LAAcABwAHAAc+DF4MAAcAB54M3gweDV4Nng3eDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEeDqABVg6WDqABoQ6gAaABoAHXDvcONw/3DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DncPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB7cPPwlGCU4JMACAAIAAgABWCV4JYQmAAGkJcAl4CXwJgAkwADAAMAAwAIgJgACLCZMJgACZCZ8JowmrCYAAswkwAF4AXgB8AIAAuwkABMMJyQmAAM4JgADVCTAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAqwYWBNkIMAAwADAAMADdCeAJ6AnuCR4E9gkwAP4JBQoNCjAAMACAABUK0wiAAB0KJAosCjQKgAAwADwKQwqAAEsKvQmdCVMKWwowADAAgACAALcEMACAAGMKgABrCjAAMAAwADAAMAAwADAAMAAwADAAMAAeBDAAMAAwADAAMAAwADAAMAAwADAAMAAwAIkEPQFzCnoKiQSCCooKkAqJBJgKoAqkCokEGAGsCrQKvArBCjAAMADJCtEKFQHZCuEK/gHpCvEKMAAwADAAMACAAIwE+QowAIAAPwEBCzAAMAAwADAAMACAAAkLEQswAIAAPwEZCyELgAAOCCkLMAAxCzkLMAAwADAAMAAwADAAXgBeAEELMAAwADAAMAAwADAAMAAwAEkLTQtVC4AAXAtkC4AAiQkwADAAMAAwADAAMAAwADAAbAtxC3kLgAuFC4sLMAAwAJMLlwufCzAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAApwswADAAMACAAIAAgACvC4AAgACAAIAAgACAALcLMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAvwuAAMcLgACAAIAAgACAAIAAyguAAIAAgACAAIAA0QswADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAANkLgACAAIAA4AswADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACJCR4E6AswADAAhwHwC4AA+AsADAgMEAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMACAAIAAGAwdDCUMMAAwAC0MNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQw1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHPQwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADUHNQc1BzUHNQc1BzUHNQc2BzAAMAA5DDUHNQc1BzUHNQc1BzUHNQc1BzUHNQdFDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAATQxSDFoMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAF4AXgBeAF4AXgBeAF4AYgxeAGoMXgBxDHkMfwxeAIUMXgBeAI0MMAAwADAAMAAwAF4AXgCVDJ0MMAAwADAAMABeAF4ApQxeAKsMswy7DF4Awgy9DMoMXgBeAF4AXgBeAF4AXgBeAF4AXgDRDNkMeQBqCeAM3Ax8AOYM7Az0DPgMXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgCgAAANoAAHDQ4NFg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAeDSYNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAC4NMABeAF4ANg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAD4NRg1ODVYNXg1mDTAAbQ0wADAAMAAwADAAMAAwADAA2gbaBtoG2gbaBtoG2gbaBnUNeg3CBYANwgWFDdoGjA3aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gaUDZwNpA2oDdoG2gawDbcNvw3HDdoG2gbPDdYN3A3fDeYN2gbsDfMN2gbaBvoN/g3aBgYODg7aBl4AXgBeABYOXgBeACUG2gYeDl4AJA5eACwO2w3aBtoGMQ45DtoG2gbaBtoGQQ7aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B1EO2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQdZDjUHNQc1BzUHNQc1B2EONQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHaA41BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B3AO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B2EO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBkkOeA6gAKAAoAAwADAAMAAwAKAAoACgAKAAoACgAKAAgA4wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAD//wQABAAEAAQABAAEAAQABAAEAA0AAwABAAEAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAKABMAFwAeABsAGgAeABcAFgASAB4AGwAYAA8AGAAcAEsASwBLAEsASwBLAEsASwBLAEsAGAAYAB4AHgAeABMAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAFgAbABIAHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYADQARAB4ABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkAFgAaABsAGwAbAB4AHQAdAB4ATwAXAB4ADQAeAB4AGgAbAE8ATwAOAFAAHQAdAB0ATwBPABcATwBPAE8AFgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwArAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAAQABAANAA0ASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAUAArACsAKwArACsAKwArACsABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAGgAaAFAAUABQAFAAUABMAB4AGwBQAB4AKwArACsABAAEAAQAKwBQAFAAUABQAFAAUAArACsAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUAArAFAAUAArACsABAArAAQABAAEAAQABAArACsAKwArAAQABAArACsABAAEAAQAKwArACsABAArACsAKwArACsAKwArAFAAUABQAFAAKwBQACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwAEAAQAUABQAFAABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQAKwArAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeABsAKwArACsAKwArACsAKwBQAAQABAAEAAQABAAEACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAKwArACsAKwArACsAKwArAAQABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwAEAFAAKwBQAFAAUABQAFAAUAArACsAKwBQAFAAUAArAFAAUABQAFAAKwArACsAUABQACsAUAArAFAAUAArACsAKwBQAFAAKwArACsAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQAKwArACsABAAEAAQAKwAEAAQABAAEACsAKwBQACsAKwArACsAKwArAAQAKwArACsAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAB4AHgAeAB4AHgAeABsAHgArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArAFAAUABQACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAB4AUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArACsAKwArACsAKwArAFAAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwArAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAKwBcAFwAKwBcACsAKwBcACsAKwArACsAKwArAFwAXABcAFwAKwBcAFwAXABcAFwAXABcACsAXABcAFwAKwBcACsAXAArACsAXABcACsAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgArACoAKgBcACsAKwBcAFwAXABcAFwAKwBcACsAKgAqACoAKgAqACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAFwAXABcAFwAUAAOAA4ADgAOAB4ADgAOAAkADgAOAA0ACQATABMAEwATABMACQAeABMAHgAeAB4ABAAEAB4AHgAeAB4AHgAeAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUAANAAQAHgAEAB4ABAAWABEAFgARAAQABABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAAQABAAEAAQABAANAAQABABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsADQANAB4AHgAeAB4AHgAeAAQAHgAeAB4AHgAeAB4AKwAeAB4ADgAOAA0ADgAeAB4AHgAeAB4ACQAJACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgAeAB4AHgBcAFwAXABcAFwAXAAqACoAKgAqAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAKgAqACoAKgAqACoAKgBcAFwAXAAqACoAKgAqAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAXAAqAEsASwBLAEsASwBLAEsASwBLAEsAKgAqACoAKgAqACoAUABQAFAAUABQAFAAKwBQACsAKwArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQACsAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwAEAAQABAAeAA0AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAEQArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAADQANAA0AUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAA0ADQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoADQANABUAXAANAB4ADQAbAFwAKgArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAB4AHgATABMADQANAA4AHgATABMAHgAEAAQABAAJACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAUABQAFAAUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwAeACsAKwArABMAEwBLAEsASwBLAEsASwBLAEsASwBLAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwBcAFwAXABcAFwAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcACsAKwArACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwAeAB4AXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsABABLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKgAqACoAKgAqACoAKgBcACoAKgAqACoAKgAqACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAUABQAFAAUABQAFAAUAArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4ADQANAA0ADQAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAHgAeAB4AHgBQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwANAA0ADQANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwBQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsABAAEAAQAHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAABABQAFAAUABQAAQABAAEAFAAUAAEAAQABAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAKwBQACsAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAKwArAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAKwAeAB4AHgAeAB4AHgAeAA4AHgArAA0ADQANAA0ADQANAA0ACQANAA0ADQAIAAQACwAEAAQADQAJAA0ADQAMAB0AHQAeABcAFwAWABcAFwAXABYAFwAdAB0AHgAeABQAFAAUAA0AAQABAAQABAAEAAQABAAJABoAGgAaABoAGgAaABoAGgAeABcAFwAdABUAFQAeAB4AHgAeAB4AHgAYABYAEQAVABUAFQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgANAB4ADQANAA0ADQAeAA0ADQANAAcAHgAeAB4AHgArAAQABAAEAAQABAAEAAQABAAEAAQAUABQACsAKwBPAFAAUABQAFAAUAAeAB4AHgAWABEATwBQAE8ATwBPAE8AUABQAFAAUABQAB4AHgAeABYAEQArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGgAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgBQABoAHgAdAB4AUAAeABoAHgAeAB4AHgAeAB4AHgAeAB4ATwAeAFAAGwAeAB4AUABQAFAAUABQAB4AHgAeAB0AHQAeAFAAHgBQAB4AUAAeAFAATwBQAFAAHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AUABQAFAAUABPAE8AUABQAFAAUABQAE8AUABQAE8AUABPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAE8ATwBPAE8ATwBPAE8ATwBPAE8AUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAATwAeAB4AKwArACsAKwAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB0AHQAeAB4AHgAdAB0AHgAeAB0AHgAeAB4AHQAeAB0AGwAbAB4AHQAeAB4AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB0AHgAdAB4AHQAdAB0AHQAdAB0AHgAdAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAdAB0AHQAdAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAlACUAHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB0AHQAeAB4AHgAeAB0AHQAdAB4AHgAdAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB0AHQAeAB4AHQAeAB4AHgAeAB0AHQAeAB4AHgAeACUAJQAdAB0AJQAeACUAJQAlACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHQAdAB0AHgAdACUAHQAdAB4AHQAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHQAdAB0AHQAlAB4AJQAlACUAHQAlACUAHQAdAB0AJQAlAB0AHQAlAB0AHQAlACUAJQAeAB0AHgAeAB4AHgAdAB0AJQAdAB0AHQAdAB0AHQAlACUAJQAlACUAHQAlACUAIAAlAB0AHQAlACUAJQAlACUAJQAlACUAHgAeAB4AJQAlACAAIAAgACAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeABcAFwAXABcAFwAXAB4AEwATACUAHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACUAJQBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwArACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAE8ATwBPAE8ATwBPAE8ATwAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeACsAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUAArACsAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQBQAFAAUABQACsAKwArACsAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAABAAEAAQAKwAEAAQAKwArACsAKwArAAQABAAEAAQAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsABAAEAAQAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsADQANAA0ADQANAA0ADQANAB4AKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAUABQAFAAUABQAA0ADQANAA0ADQANABQAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwANAA0ADQANAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAeAAQABAAEAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLACsADQArAB4AKwArAAQABAAEAAQAUABQAB4AUAArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwAEAAQABAAEAAQABAAEAAQABAAOAA0ADQATABMAHgAeAB4ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0AUABQAFAAUAAEAAQAKwArAAQADQANAB4AUAArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXABcAA0ADQANACoASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUAArACsAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANACsADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEcARwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwAeAAQABAANAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAEAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUAArACsAUAArACsAUABQACsAKwBQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAeAB4ADQANAA0ADQAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAArAAQABAArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAEAAQABAAEAAQABAAEACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAFgAWAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAKwBQACsAKwArACsAKwArAFAAKwArACsAKwBQACsAUAArAFAAKwBQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQACsAUAArAFAAKwBQACsAUABQACsAUAArACsAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAUABQAFAAUAArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUAArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAlACUAJQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeACUAJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeACUAJQAlACUAJQAeACUAJQAlACUAJQAgACAAIAAlACUAIAAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIQAhACEAIQAhACUAJQAgACAAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAIAAlACUAJQAlACAAJQAgACAAIAAgACAAIAAgACAAIAAlACUAJQAgACUAJQAlACUAIAAgACAAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeACUAHgAlAB4AJQAlACUAJQAlACAAJQAlACUAJQAeACUAHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAIAAgACAAIAAgAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFwAXABcAFQAVABUAHgAeAB4AHgAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAlACAAIAAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsA"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=r.PATH.CIRCLE,this.x=t,this.y=n,this.radius=i,isNaN(t)&&console.error("Invalid x value given for Circle"),isNaN(n)&&console.error("Invalid y value given for Circle"),isNaN(i)&&console.error("Invalid radius value given for Circle")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,A=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,A=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw A}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},A=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),o=(n(25),n(52)),s=n(9),u=(r=s)&&r.__esModule?r:{default:r},l=n(5),c=n(12),h=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=t,this.options=n,t.render(n)}return A(e,[{key:"renderNode",value:function(e){e.isVisible()&&(this.renderNodeBackgroundAndBorders(e),this.renderNodeContent(e))}},{key:"renderNodeContent",value:function(e){var t=this,n=function(){if(e.childNodes.length&&e.childNodes.forEach((function(n){if(n instanceof u.default){var r=n.parent.style;t.target.renderTextNode(n.bounds,r.color,r.font,r.textDecoration,r.textShadow)}else t.target.drawShape(n,e.style.color)})),e.image){var n=t.options.imageStore.get(e.image);if(n){var r=(0,a.calculateContentBox)(e.bounds,e.style.padding,e.style.border),i="number"==typeof n.width&&n.width>0?n.width:r.width,A="number"==typeof n.height&&n.height>0?n.height:r.height;i>0&&A>0&&t.target.clip([(0,a.calculatePaddingBoxPath)(e.curvedBounds)],(function(){t.target.drawImage(n,new a.Bounds(0,0,i,A),r)}))}}},r=e.getClipPaths();r.length?this.target.clip(r,n):n()}},{key:"renderNodeBackgroundAndBorders",value:function(e){var t=this,n=!e.style.background.backgroundColor.isTransparent()||e.style.background.backgroundImage.length,r=e.style.border.some((function(e){return e.borderStyle!==c.BORDER_STYLE.NONE&&!e.borderColor.isTransparent()})),i=function(){var r=(0,l.calculateBackgroungPaintingArea)(e.curvedBounds,e.style.background.backgroundClip);n&&t.target.clip([r],(function(){e.style.background.backgroundColor.isTransparent()||t.target.fill(e.style.background.backgroundColor),t.renderBackgroundImage(e)})),e.style.border.forEach((function(n,r){n.borderStyle===c.BORDER_STYLE.NONE||n.borderColor.isTransparent()||t.renderBorder(n,r,e.curvedBounds)}))};if(n||r){var A=e.parent?e.parent.getClipPaths():[];A.length?this.target.clip(A,i):i()}}},{key:"renderBackgroundImage",value:function(e){var t=this;e.style.background.backgroundImage.slice(0).reverse().forEach((function(n){"url"===n.source.method&&n.source.args.length?t.renderBackgroundRepeat(e,n):/gradient/i.test(n.source.method)&&t.renderBackgroundGradient(e,n)}))}},{key:"renderBackgroundRepeat",value:function(e,t){var n=this.options.imageStore.get(t.source.args[0]);if(n){var r=(0,l.calculateBackgroungPositioningArea)(e.style.background.backgroundOrigin,e.bounds,e.style.padding,e.style.border),i=(0,l.calculateBackgroundSize)(t,n,r),A=(0,l.calculateBackgroundPosition)(t.position,i,r),a=(0,l.calculateBackgroundRepeatPath)(t,A,i,r,e.bounds),o=Math.round(r.left+A.x),s=Math.round(r.top+A.y);this.target.renderRepeat(a,n,i,o,s)}}},{key:"renderBackgroundGradient",value:function(e,t){var n=(0,l.calculateBackgroungPositioningArea)(e.style.background.backgroundOrigin,e.bounds,e.style.padding,e.style.border),r=(0,l.calculateGradientBackgroundSize)(t,n),i=(0,l.calculateBackgroundPosition)(t.position,r,n),A=new a.Bounds(Math.round(n.left+i.x),Math.round(n.top+i.y),r.width,r.height),s=(0,o.parseGradient)(e,t.source,A);if(s)switch(s.type){case o.GRADIENT_TYPE.LINEAR_GRADIENT:this.target.renderLinearGradient(A,s);break;case o.GRADIENT_TYPE.RADIAL_GRADIENT:this.target.renderRadialGradient(A,s)}}},{key:"renderBorder",value:function(e,t,n){this.target.drawShape((0,a.parsePathForBorder)(n,t),e.borderColor)}},{key:"renderStack",value:function(e){var t=this;if(e.container.isVisible()){var n=e.getOpacity();n!==this._opacity&&(this.target.setOpacity(e.getOpacity()),this._opacity=n);var r=e.container.style.transform;null!==r?this.target.transform(e.container.bounds.left+r.transformOrigin[0].value,e.container.bounds.top+r.transformOrigin[1].value,r.transform,(function(){return t.renderStackContent(e)})):this.renderStackContent(e)}}},{key:"renderStackContent",value:function(e){var t=f(e),n=i(t,5),r=n[0],A=n[1],a=n[2],o=n[3],s=n[4],u=d(e),l=i(u,2),c=l[0],h=l[1];this.renderNodeBackgroundAndBorders(e.container),r.sort(p).forEach(this.renderStack,this),this.renderNodeContent(e.container),h.forEach(this.renderNode,this),o.forEach(this.renderStack,this),s.forEach(this.renderStack,this),c.forEach(this.renderNode,this),A.forEach(this.renderStack,this),a.sort(p).forEach(this.renderStack,this)}},{key:"render",value:function(e){var t=this;this.options.backgroundColor&&this.target.rectangle(this.options.x,this.options.y,this.options.width,this.options.height,this.options.backgroundColor),this.renderStack(e);var n=this.target.getTarget();return n.then((function(e){return t.options.logger.log("Render completed"),e}))}}]),e}();t.default=h;var d=function(e){for(var t=[],n=[],r=e.children.length,i=0;i<r;i++){var A=e.children[i];A.isInlineLevel()?t.push(A):n.push(A)}return[t,n]},f=function(e){for(var t=[],n=[],r=[],i=[],A=[],a=e.contexts.length,o=0;o<a;o++){var s=e.contexts[o];s.container.isPositioned()||s.container.style.opacity<1||s.container.isTransformed()?s.container.style.zIndex.order<0?t.push(s):s.container.style.zIndex.order>0?r.push(s):n.push(s):s.container.isFloating()?i.push(s):A.push(s)}return[t,n,r,i,A]},p=function(e,t){return e.container.style.zIndex.order>t.container.style.zIndex.order?1:e.container.style.zIndex.order<t.container.style.zIndex.order?-1:e.container.index>t.container.index?1:-1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformWebkitRadialGradientArgs=t.parseGradient=t.RadialGradient=t.LinearGradient=t.RADIAL_GRADIENT_SHAPE=t.GRADIENT_TYPE=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,A=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,A=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw A}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=(u(n(3)),n(53)),A=u(n(0)),a=n(1),o=u(a),s=n(4);function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=/^(to )?(left|top|right|bottom)( (left|top|right|bottom))?$/i,h=/^([+-]?\d*\.?\d+)% ([+-]?\d*\.?\d+)%$/i,d=/(px)|%|( 0)$/i,f=/^(from|to|color-stop)\((?:([\d.]+)(%)?,\s*)?(.+?)\)$/i,p=/^\s*(circle|ellipse)?\s*((?:([\d.]+)(px|r?em|%)\s*(?:([\d.]+)(px|r?em|%))?)|closest-side|closest-corner|farthest-side|farthest-corner)?\s*(?:at\s*(?:(left|center|right)|([\d.]+)(px|r?em|%))\s+(?:(top|center|bottom)|([\d.]+)(px|r?em|%)))?(?:\s|$)/i,g=t.GRADIENT_TYPE={LINEAR_GRADIENT:0,RADIAL_GRADIENT:1},y=t.RADIAL_GRADIENT_SHAPE={CIRCLE:0,ELLIPSE:1},m={left:new o.default("0%"),top:new o.default("0%"),center:new o.default("50%"),right:new o.default("100%"),bottom:new o.default("100%")},E=t.LinearGradient=function e(t,n){l(this,e),this.type=g.LINEAR_GRADIENT,this.colorStops=t,this.direction=n},v=t.RadialGradient=function e(t,n,r,i){l(this,e),this.type=g.RADIAL_GRADIENT,this.colorStops=t,this.shape=n,this.center=r,this.radius=i},B=(t.parseGradient=function(e,t,n){var r=t.args,i=t.method,A=t.prefix;return"linear-gradient"===i?w(r,n,!!A):"gradient"===i&&"linear"===r[0]?w(["to bottom"].concat(x(r.slice(3))),n,!!A):"radial-gradient"===i?k(e,"-webkit-"===A?Q(r):r,n):"gradient"===i&&"radial"===r[0]?k(e,x(Q(r.slice(1))),n):void 0},function(e,t,n){for(var r=[],i=t;i<e.length;i++){var a=e[i],s=d.test(a),u=a.lastIndexOf(" "),l=new A.default(s?a.substring(0,u):a),c=s?new o.default(a.substring(u+1)):i===t?new o.default("0%"):i===e.length-1?new o.default("100%"):null;r.push({color:l,stop:c})}for(var h=r.map((function(e){var t=e.color,r=e.stop;return{color:t,stop:0===n?0:r?r.getAbsoluteValue(n)/n:null}})),f=h[0].stop,p=0;p<h.length;p++)if(null!==f){var g=h[p].stop;if(null===g){for(var y=p;null===h[y].stop;)y++;for(var m=y-p+1,E=(h[y].stop-f)/m;p<y;p++)f=h[p].stop=f+E}else f=g}return h}),w=function(e,t,n){var r=(0,i.parseAngle)(e[0]),A=c.test(e[0]),a=A||null!==r||h.test(e[0]),o=a?null!==r?C(n?r-.5*Math.PI:r,t):A?S(e[0],t):T(e[0],t):C(Math.PI,t),u=a?1:0,l=Math.min((0,s.distance)(Math.abs(o.x0)+Math.abs(o.x1),Math.abs(o.y0)+Math.abs(o.y1)),2*t.width,2*t.height);return new E(B(e,u,l),o)},k=function(e,t,n){var r=t[0].match(p),i=r&&("circle"===r[1]||void 0!==r[3]&&void 0===r[5])?y.CIRCLE:y.ELLIPSE,A={},o={};r&&(void 0!==r[3]&&(A.x=(0,a.calculateLengthFromValueWithUnit)(e,r[3],r[4]).getAbsoluteValue(n.width)),void 0!==r[5]&&(A.y=(0,a.calculateLengthFromValueWithUnit)(e,r[5],r[6]).getAbsoluteValue(n.height)),r[7]?o.x=m[r[7].toLowerCase()]:void 0!==r[8]&&(o.x=(0,a.calculateLengthFromValueWithUnit)(e,r[8],r[9])),r[10]?o.y=m[r[10].toLowerCase()]:void 0!==r[11]&&(o.y=(0,a.calculateLengthFromValueWithUnit)(e,r[11],r[12])));var s={x:void 0===o.x?n.width/2:o.x.getAbsoluteValue(n.width),y:void 0===o.y?n.height/2:o.y.getAbsoluteValue(n.height)},u=U(r&&r[2]||"farthest-corner",i,s,A,n);return new v(B(t,r?1:0,Math.min(u.x,u.y)),i,s,u)},C=function(e,t){var n=t.width,r=t.height,i=.5*n,A=.5*r,a=(Math.abs(n*Math.sin(e))+Math.abs(r*Math.cos(e)))/2,o=i+Math.sin(e)*a,s=A-Math.cos(e)*a;return{x0:o,x1:n-o,y0:s,y1:r-s}},b=function(e){return Math.acos(e.width/2/((0,s.distance)(e.width,e.height)/2))},S=function(e,t){switch(e){case"bottom":case"to top":return C(0,t);case"left":case"to right":return C(Math.PI/2,t);case"right":case"to left":return C(3*Math.PI/2,t);case"top right":case"right top":case"to bottom left":case"to left bottom":return C(Math.PI+b(t),t);case"top left":case"left top":case"to bottom right":case"to right bottom":return C(Math.PI-b(t),t);case"bottom left":case"left bottom":case"to top right":case"to right top":return C(b(t),t);case"bottom right":case"right bottom":case"to top left":case"to left top":return C(2*Math.PI-b(t),t);case"top":case"to bottom":default:return C(Math.PI,t)}},T=function(e,t){var n=e.split(" ").map(parseFloat),i=r(n,2),A=i[0],a=i[1],o=A/100*t.width/(a/100*t.height);return C(Math.atan(isNaN(o)?1:o)+Math.PI/2,t)},M=function(e,t,n,r){return[{x:0,y:0},{x:0,y:e.height},{x:e.width,y:0},{x:e.width,y:e.height}].reduce((function(e,i){var A=(0,s.distance)(t-i.x,n-i.y);return(r?A<e.optimumDistance:A>e.optimumDistance)?{optimumCorner:i,optimumDistance:A}:e}),{optimumDistance:r?1/0:-1/0,optimumCorner:null}).optimumCorner},U=function(e,t,n,r,i){var A=n.x,a=n.y,o=0,u=0;switch(e){case"closest-side":t===y.CIRCLE?o=u=Math.min(Math.abs(A),Math.abs(A-i.width),Math.abs(a),Math.abs(a-i.height)):t===y.ELLIPSE&&(o=Math.min(Math.abs(A),Math.abs(A-i.width)),u=Math.min(Math.abs(a),Math.abs(a-i.height)));break;case"closest-corner":if(t===y.CIRCLE)o=u=Math.min((0,s.distance)(A,a),(0,s.distance)(A,a-i.height),(0,s.distance)(A-i.width,a),(0,s.distance)(A-i.width,a-i.height));else if(t===y.ELLIPSE){var l=Math.min(Math.abs(a),Math.abs(a-i.height))/Math.min(Math.abs(A),Math.abs(A-i.width)),c=M(i,A,a,!0);u=l*(o=(0,s.distance)(c.x-A,(c.y-a)/l))}break;case"farthest-side":t===y.CIRCLE?o=u=Math.max(Math.abs(A),Math.abs(A-i.width),Math.abs(a),Math.abs(a-i.height)):t===y.ELLIPSE&&(o=Math.max(Math.abs(A),Math.abs(A-i.width)),u=Math.max(Math.abs(a),Math.abs(a-i.height)));break;case"farthest-corner":if(t===y.CIRCLE)o=u=Math.max((0,s.distance)(A,a),(0,s.distance)(A,a-i.height),(0,s.distance)(A-i.width,a),(0,s.distance)(A-i.width,a-i.height));else if(t===y.ELLIPSE){var h=Math.max(Math.abs(a),Math.abs(a-i.height))/Math.max(Math.abs(A),Math.abs(A-i.width)),d=M(i,A,a,!1);u=h*(o=(0,s.distance)(d.x-A,(d.y-a)/h))}break;default:o=r.x||0,u=void 0!==r.y?r.y:o}return{x:o,y:u}},Q=t.transformWebkitRadialGradientArgs=function(e){var t="",n="",r="",i="",A=0,a=/^(left|center|right|\d+(?:px|r?em|%)?)(?:\s+(top|center|bottom|\d+(?:px|r?em|%)?))?$/i,o=/^\d+(px|r?em|%)?(?:\s+\d+(px|r?em|%)?)?$/i,s=e[A].match(a);s&&A++;var u=e[A].match(/^(circle|ellipse)?\s*(closest-side|closest-corner|farthest-side|farthest-corner|contain|cover)?$/i);u&&(t=u[1]||"","contain"===(r=u[2]||"")?r="closest-side":"cover"===r&&(r="farthest-corner"),A++);var l=e[A].match(o);l&&A++;var c=e[A].match(a);c&&A++;var h=e[A].match(o);h&&A++;var d=c||s;d&&d[1]&&(i=d[1]+(/^\d+$/.test(d[1])?"px":""),d[2]&&(i+=" "+d[2]+(/^\d+$/.test(d[2])?"px":"")));var f=h||l;return f&&(n=f[0],f[1]||(n+="px")),!i||t||n||r||(n=i,i=""),i&&(i="at "+i),[[t,r,n,i].filter((function(e){return!!e})).join(" ")].concat(e.slice(A))},x=function(e){return e.map((function(e){return e.match(f)})).map((function(t,n){if(!t)return e[n];switch(t[1]){case"from":return t[4]+" 0%";case"to":return t[4]+" 100%";case"color-stop":return"%"===t[3]?t[4]+" "+t[2]:t[4]+" "+100*parseFloat(t[2])+"%"}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/([+-]?\d*\.?\d+)(deg|grad|rad|turn)/i;t.parseAngle=function(e){var t=e.match(r);if(t){var n=parseFloat(t[1]);switch(t[2].toLowerCase()){case"deg":return Math.PI*n/180;case"grad":return Math.PI/200*n;case"rad":return n;case"turn":return 2*Math.PI*n}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneWindow=t.DocumentCloner=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,A=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,A=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw A}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=n(2),a=n(26),o=h(n(55)),s=n(4),u=n(5),l=h(n(15)),c=n(56);function h(e){return e&&e.__esModule?e:{default:e}}var d=t.DocumentCloner=function(){function e(t,n,r,i,A){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.referenceElement=t,this.scrolledElements=[],this.copyStyles=i,this.inlineImages=i,this.logger=r,this.options=n,this.renderer=A,this.resourceLoader=new o.default(n,r,window),this.pseudoContentData={counters:{},quoteDepth:0},this.documentElement=this.cloneNode(t.ownerDocument.documentElement)}return i(e,[{key:"inlineAllImages",value:function(e){var t=this;if(this.inlineImages&&e){var n=e.style;Promise.all((0,u.parseBackgroundImage)(n.backgroundImage).map((function(e){return"url"===e.method?t.resourceLoader.inlineImage(e.args[0]).then((function(e){return e&&"string"==typeof e.src?'url("'+e.src+'")':"none"})).catch((function(e){t.logger.log("Unable to load image",e)})):Promise.resolve(""+e.prefix+e.method+"("+e.args.join(",")+")")}))).then((function(e){e.length>1&&(n.backgroundColor=""),n.backgroundImage=e.join(",")})),e instanceof HTMLImageElement&&this.resourceLoader.inlineImage(e.src).then((function(t){if(t&&e instanceof HTMLImageElement&&e.parentNode){var n=e.parentNode,r=(0,s.copyCSSStyles)(e.style,t.cloneNode(!1));n.replaceChild(r,e)}})).catch((function(e){t.logger.log("Unable to load image",e)}))}}},{key:"inlineFonts",value:function(e){var t=this;return Promise.all(Array.from(e.styleSheets).map((function(n){return n.href?fetch(n.href).then((function(e){return e.text()})).then((function(e){return p(e,n.href)})).catch((function(e){return t.logger.log("Unable to load stylesheet",e),[]})):f(n,e)}))).then((function(e){return e.reduce((function(e,t){return e.concat(t)}),[])})).then((function(e){return Promise.all(e.map((function(e){return fetch(e.formats[0].src).then((function(e){return e.blob()})).then((function(e){return new Promise((function(t,n){var r=new FileReader;r.onerror=n,r.onload=function(){var e=r.result;t(e)},r.readAsDataURL(e)}))})).then((function(t){return e.fontFace.setProperty("src",'url("'+t+'")'),"@font-face {"+e.fontFace.cssText+" "}))})))})).then((function(n){var r=e.createElement("style");r.textContent=n.join("\n"),t.documentElement.appendChild(r)}))}},{key:"createElementClone",value:function(e){var t=this;if(this.copyStyles&&e instanceof HTMLCanvasElement){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch(e){this.logger.log("Unable to clone canvas contents, canvas is tainted")}}if(e instanceof HTMLIFrameElement){var r=e.cloneNode(!1),i=b();r.setAttribute("data-html2canvas-internal-iframe-key",i);var a=(0,A.parseBounds)(e,0,0),o=a.width,u=a.height;return this.resourceLoader.cache[i]=T(e,this.options).then((function(e){return t.renderer(e,{async:t.options.async,allowTaint:t.options.allowTaint,backgroundColor:"#ffffff",canvas:null,imageTimeout:t.options.imageTimeout,logging:t.options.logging,proxy:t.options.proxy,removeContainer:t.options.removeContainer,scale:t.options.scale,foreignObjectRendering:t.options.foreignObjectRendering,useCORS:t.options.useCORS,target:new l.default,width:o,height:u,x:0,y:0,windowWidth:e.ownerDocument.defaultView.innerWidth,windowHeight:e.ownerDocument.defaultView.innerHeight,scrollX:e.ownerDocument.defaultView.pageXOffset,scrollY:e.ownerDocument.defaultView.pageYOffset},t.logger.child(i))})).then((function(t){return new Promise((function(n,i){var A=document.createElement("img");A.onload=function(){return n(t)},A.onerror=i,A.src=t.toDataURL(),r.parentNode&&r.parentNode.replaceChild((0,s.copyCSSStyles)(e.ownerDocument.defaultView.getComputedStyle(e),A),r)}))})),r}if(e instanceof HTMLStyleElement&&e.sheet&&e.sheet.cssRules){var c=[].slice.call(e.sheet.cssRules,0).reduce((function(e,n){try{return n&&n.cssText?e+n.cssText:e}catch(r){return t.logger.log("Unable to access cssText property",n.name),e}}),""),h=e.cloneNode(!1);return h.textContent=c,h}return e.cloneNode(!1)}},{key:"cloneNode",value:function(e){var t=e.nodeType===Node.TEXT_NODE?document.createTextNode(e.nodeValue):this.createElementClone(e),n=e.ownerDocument.defaultView,r=e instanceof n.HTMLElement?n.getComputedStyle(e):null,i=e instanceof n.HTMLElement?n.getComputedStyle(e,":before"):null,A=e instanceof n.HTMLElement?n.getComputedStyle(e,":after"):null;this.referenceElement===e&&t instanceof n.HTMLElement&&(this.clonedReferenceElement=t),t instanceof n.HTMLBodyElement&&w(t);for(var a=(0,c.parseCounterReset)(r,this.pseudoContentData),o=(0,c.resolvePseudoContent)(e,i,this.pseudoContentData),u=e.firstChild;u;u=u.nextSibling)u.nodeType===Node.ELEMENT_NODE&&("SCRIPT"===u.nodeName||u.hasAttribute("data-html2canvas-ignore")||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(u))||this.copyStyles&&"STYLE"===u.nodeName||t.appendChild(this.cloneNode(u));var l=(0,c.resolvePseudoContent)(e,A,this.pseudoContentData);if((0,c.popCounters)(a,this.pseudoContentData),e instanceof n.HTMLElement&&t instanceof n.HTMLElement)switch(i&&this.inlineAllImages(y(e,t,i,o,m)),A&&this.inlineAllImages(y(e,t,A,l,E)),!r||!this.copyStyles||e instanceof HTMLIFrameElement||(0,s.copyCSSStyles)(r,t),this.inlineAllImages(t),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([t,e.scrollLeft,e.scrollTop]),e.nodeName){case"CANVAS":this.copyStyles||g(e,t);break;case"TEXTAREA":case"SELECT":t.value=e.value}return t}}]),e}(),f=function(e,t){return(e.cssRules?Array.from(e.cssRules):[]).filter((function(e){return e.type===CSSRule.FONT_FACE_RULE})).map((function(e){for(var n=(0,u.parseBackgroundImage)(e.style.getPropertyValue("src")),r=[],i=0;i<n.length;i++)if("url"===n[i].method&&n[i+1]&&"format"===n[i+1].method){var A=t.createElement("a");A.href=n[i].args[0],t.body&&t.body.appendChild(A);var a={src:A.href,format:n[i+1].args[0]};r.push(a)}return{formats:r.filter((function(e){return/^woff/i.test(e.format)})),fontFace:e.style}})).filter((function(e){return e.formats.length}))},p=function(e,t){var n=document.implementation.createHTMLDocument(""),r=document.createElement("base");r.href=t;var i=document.createElement("style");return i.textContent=e,n.head&&n.head.appendChild(r),n.body&&n.body.appendChild(i),i.sheet?f(i.sheet,n):[]},g=function(e,t){try{if(t){t.width=e.width,t.height=e.height;var n=e.getContext("2d"),r=t.getContext("2d");n?r.putImageData(n.getImageData(0,0,e.width,e.height),0,0):r.drawImage(e,0,0)}}catch(e){}},y=function(e,t,n,r,i){if(n&&n.content&&"none"!==n.content&&"-moz-alt-content"!==n.content&&"none"!==n.display){var A=t.ownerDocument.createElement("html2canvaspseudoelement");if((0,s.copyCSSStyles)(n,A),r)for(var a=r.length,o=0;o<a;o++){var l=r[o];switch(l.type){case c.PSEUDO_CONTENT_ITEM_TYPE.IMAGE:var h=t.ownerDocument.createElement("img");h.src=(0,u.parseBackgroundImage)("url("+l.value+")")[0].args[0],h.style.opacity="1",A.appendChild(h);break;case c.PSEUDO_CONTENT_ITEM_TYPE.TEXT:A.appendChild(t.ownerDocument.createTextNode(l.value))}}return A.className=v+" "+B,t.className+=i===m?" "+v:" "+B,i===m?t.insertBefore(A,t.firstChild):t.appendChild(A),A}},m=":before",E=":after",v="___html2canvas___pseudoelement_before",B="___html2canvas___pseudoelement_after",w=function(e){k(e,"."+v+m+'{\n    content: "" !important;\n    display: none !important;\n}\n         .'+B+E+'{\n    content: "" !important;\n    display: none !important;\n}')},k=function(e,t){var n=e.ownerDocument.createElement("style");n.innerHTML=t,e.appendChild(n)},C=function(e){var t=r(e,3),n=t[0],i=t[1],A=t[2];n.scrollLeft=i,n.scrollTop=A},b=function(){return Math.ceil(Date.now()+1e7*Math.random()).toString(16)},S=/^data:text\/(.+);(base64)?,(.*)$/i,T=function(e,t){try{return Promise.resolve(e.contentWindow.document.documentElement)}catch(n){return t.proxy?(0,a.Proxy)(e.src,t).then((function(e){var t=e.match(S);return t?"base64"===t[2]?window.atob(decodeURIComponent(t[3])):decodeURIComponent(t[3]):Promise.reject()})).then((function(t){return M(e.ownerDocument,(0,A.parseBounds)(e,0,0)).then((function(e){var n=e.contentWindow.document;n.open(),n.write(t);var r=U(e).then((function(){return n.documentElement}));return n.close(),r}))})):Promise.reject()}},M=function(e,t){var n=e.createElement("iframe");return n.className="html2canvas-container",n.style.visibility="hidden",n.style.position="fixed",n.style.left="-10000px",n.style.top="0px",n.style.border="0",n.width=t.width.toString(),n.height=t.height.toString(),n.scrolling="no",n.setAttribute("data-html2canvas-ignore","true"),e.body?(e.body.appendChild(n),Promise.resolve(n)):Promise.reject("Body element not found in Document that is getting rendered")},U=function(e){var t=e.contentWindow,n=t.document;return new Promise((function(r,i){t.onload=e.onload=n.onreadystatechange=function(){var t=setInterval((function(){n.body.childNodes.length>0&&"complete"===n.readyState&&(clearInterval(t),r(e))}),50)}}))},Q=(t.cloneWindow=function(e,t,n,r,i,A){var a=new d(n,r,i,!1,A),o=e.defaultView.pageXOffset,s=e.defaultView.pageYOffset;return M(e,t).then((function(i){var A=i.contentWindow,u=A.document,l=U(i).then((function(){a.scrolledElements.forEach(C),A.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||A.scrollY===t.top&&A.scrollX===t.left||(u.documentElement.style.top=-t.top+"px",u.documentElement.style.left=-t.left+"px",u.documentElement.style.position="absolute");var o=Promise.resolve([i,a.clonedReferenceElement,a.resourceLoader]),s=r.onclone;return a.clonedReferenceElement instanceof A.HTMLElement||a.clonedReferenceElement instanceof e.defaultView.HTMLElement||a.clonedReferenceElement instanceof HTMLElement?"function"==typeof s?Promise.resolve().then((function(){return s(u)})).then((function(){return o})):o:Promise.reject("Error finding the "+n.nodeName+" in the cloned document")}));return u.open(),u.write(Q(document.doctype)+"<html></html>"),function(e,t,n){!e.defaultView||t===e.defaultView.pageXOffset&&n===e.defaultView.pageYOffset||e.defaultView.scrollTo(t,n)}(n.ownerDocument,o,s),u.replaceChild(u.adoptNode(a.documentElement),u.documentElement),u.close(),l}))},function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceStore=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=n(10),a=(r=A)&&r.__esModule?r:{default:r},o=n(26);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(t,n,r){s(this,e),this.options=t,this._window=r,this.origin=this.getOrigin(r.location.href),this.cache={},this.logger=n,this._index=0}return i(e,[{key:"loadImage",value:function(e){var t=this;if(this.hasResourceInCache(e))return e;if(g(e))return this.cache[e]=m(e,this.options.imageTimeout||0),e;if(!y(e)||a.default.SUPPORT_SVG_DRAWING){if(!0===this.options.allowTaint||f(e)||this.isSameOrigin(e))return this.addImage(e,e,!1);if(!this.isSameOrigin(e)){if("string"==typeof this.options.proxy)return this.cache[e]=(0,o.Proxy)(e,this.options).then((function(e){return m(e,t.options.imageTimeout||0)})),e;if(!0===this.options.useCORS&&a.default.SUPPORT_CORS_IMAGES)return this.addImage(e,e,!0)}}}},{key:"inlineImage",value:function(e){var t=this;return f(e)?m(e,this.options.imageTimeout||0):this.hasResourceInCache(e)?this.cache[e]:this.isSameOrigin(e)||"string"!=typeof this.options.proxy?this.xhrImage(e):this.cache[e]=(0,o.Proxy)(e,this.options).then((function(e){return m(e,t.options.imageTimeout||0)}))}},{key:"xhrImage",value:function(e){var t=this;return this.cache[e]=new Promise((function(n,r){var i=new XMLHttpRequest;if(i.onreadystatechange=function(){if(4===i.readyState)if(200!==i.status)r("Failed to fetch image "+e.substring(0,256)+" with status code "+i.status);else{var t=new FileReader;t.addEventListener("load",(function(){var e=t.result;n(e)}),!1),t.addEventListener("error",(function(e){return r(e)}),!1),t.readAsDataURL(i.response)}},i.responseType="blob",t.options.imageTimeout){var A=t.options.imageTimeout;i.timeout=A,i.ontimeout=function(){return r("Timed out ("+A+"ms) fetching "+e.substring(0,256))}}i.open("GET",e,!0),i.send()})).then((function(e){return m(e,t.options.imageTimeout||0)})),this.cache[e]}},{key:"loadCanvas",value:function(e){var t=String(this._index++);return this.cache[t]=Promise.resolve(e),t}},{key:"hasResourceInCache",value:function(e){return void 0!==this.cache[e]}},{key:"addImage",value:function(e,t,n){var r=this;this.logger.log("Added image "+e.substring(0,256));var i=function(e){return new Promise((function(i,A){var a=new Image;if(a.onload=function(){return i(a)},e&&!n||(a.crossOrigin="anonymous"),a.onerror=A,a.src=t,!0===a.complete&&setTimeout((function(){i(a)}),500),r.options.imageTimeout){var o=r.options.imageTimeout;setTimeout((function(){return A("Timed out ("+o+"ms) fetching "+t.substring(0,256))}),o)}}))};return this.cache[e]=p(t)&&!y(t)?a.default.SUPPORT_BASE64_DRAWING(t).then(i):i(!0),e}},{key:"isSameOrigin",value:function(e){return this.getOrigin(e)===this.origin}},{key:"getOrigin",value:function(e){var t=this._link||(this._link=this._window.document.createElement("a"));return t.href=e,t.href=t.href,t.protocol+t.hostname+t.port}},{key:"ready",value:function(){var e=this,t=Object.keys(this.cache),n=t.map((function(t){return e.cache[t].catch((function(t){return e.logger.log("Unable to load image",t),null}))}));return Promise.all(n).then((function(n){return e.logger.log("Finished loading "+n.length+" images",n),new l(t,n)}))}}]),e}();t.default=u;var l=t.ResourceStore=function(){function e(t,n){s(this,e),this._keys=t,this._resources=n}return i(e,[{key:"get",value:function(e){var t=this._keys.indexOf(e);return-1===t?null:this._resources[t]}}]),e}(),c=/^data:image\/svg\+xml/i,h=/^data:image\/.*;base64,/i,d=/^data:image\/.*/i,f=function(e){return d.test(e)},p=function(e){return h.test(e)},g=function(e){return"blob"===e.substr(0,4)},y=function(e){return"svg"===e.substr(-3).toLowerCase()||c.test(e)},m=function(e,t){return new Promise((function(n,r){var i=new Image;i.onload=function(){return n(i)},i.onerror=r,i.src=e,!0===i.complete&&setTimeout((function(){n(i)}),500),t&&setTimeout((function(){return r("Timed out ("+t+"ms) loading image")}),t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseContent=t.resolvePseudoContent=t.popCounters=t.parseCounterReset=t.TOKEN_TYPE=t.PSEUDO_CONTENT_ITEM_TYPE=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,A=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,A=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw A}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=n(14),A=n(8),a=t.PSEUDO_CONTENT_ITEM_TYPE={TEXT:0,IMAGE:1},o=t.TOKEN_TYPE={STRING:0,ATTRIBUTE:1,URL:2,COUNTER:3,COUNTERS:4,OPENQUOTE:5,CLOSEQUOTE:6},s=(t.parseCounterReset=function(e,t){if(!e||!e.counterReset||"none"===e.counterReset)return[];for(var n=[],i=e.counterReset.split(/\s*,\s*/),A=i.length,a=0;a<A;a++){var o=i[a].split(/\s+/),s=r(o,2),u=s[0],l=s[1];n.push(u);var c=t.counters[u];c||(c=t.counters[u]=[]),c.push(parseInt(l||0,10))}return n},t.popCounters=function(e,t){for(var n=e.length,r=0;r<n;r++)t.counters[e[r]].pop()},t.resolvePseudoContent=function(e,t,n){if(!t||!t.content||"none"===t.content||"-moz-alt-content"===t.content||"none"===t.display)return null;var i=s(t.content),A=i.length,u=[],h="",d=t.counterIncrement;if(d&&"none"!==d){var f=d.split(/\s+/),p=r(f,2),g=p[0],y=p[1],m=n.counters[g];m&&(m[m.length-1]+=void 0===y?1:parseInt(y,10))}for(var E=0;E<A;E++){var v=i[E];switch(v.type){case o.STRING:h+=v.value||"";break;case o.ATTRIBUTE:e instanceof HTMLElement&&v.value&&(h+=e.getAttribute(v.value)||"");break;case o.COUNTER:var B=n.counters[v.name||""];B&&(h+=c([B[B.length-1]],"",v.format));break;case o.COUNTERS:var w=n.counters[v.name||""];w&&(h+=c(w,v.glue,v.format));break;case o.OPENQUOTE:h+=l(t,!0,n.quoteDepth),n.quoteDepth++;break;case o.CLOSEQUOTE:n.quoteDepth--,h+=l(t,!1,n.quoteDepth);break;case o.URL:h&&(u.push({type:a.TEXT,value:h}),h=""),u.push({type:a.IMAGE,value:v.value||""})}}return h&&u.push({type:a.TEXT,value:h}),u},t.parseContent=function(e,t){if(t&&t[e])return t[e];for(var n=[],r=e.length,i=!1,A=!1,a=!1,s="",l="",c=[],h=0;h<r;h++){var d=e.charAt(h);switch(d){case"'":case'"':A?s+=d:(i=!i,a||i||(n.push({type:o.STRING,value:s}),s=""));break;case"\\":A?(s+=d,A=!1):A=!0;break;case"(":i?s+=d:(a=!0,l=s,s="",c=[]);break;case")":if(i)s+=d;else if(a){switch(s&&c.push(s),l){case"attr":c.length>0&&n.push({type:o.ATTRIBUTE,value:c[0]});break;case"counter":if(c.length>0){var f={type:o.COUNTER,name:c[0]};c.length>1&&(f.format=c[1]),n.push(f)}break;case"counters":if(c.length>0){var p={type:o.COUNTERS,name:c[0]};c.length>1&&(p.glue=c[1]),c.length>2&&(p.format=c[2]),n.push(p)}break;case"url":c.length>0&&n.push({type:o.URL,value:c[0]})}a=!1,s=""}break;case",":i?s+=d:a&&(c.push(s),s="");break;case" ":case"\t":i?s+=d:s&&(u(n,s),s="");break;default:s+=d}"\\"!==d&&(A=!1)}return s&&u(n,s),t&&(t[e]=n),n}),u=function(e,t){switch(t){case"open-quote":e.push({type:o.OPENQUOTE});break;case"close-quote":e.push({type:o.CLOSEQUOTE})}},l=function(e,t,n){var r=e.quotes?e.quotes.split(/\s+/):["'\"'","'\"'"],i=2*n;return i>=r.length&&(i=r.length-2),t||++i,r[i].replace(/^["']|["']$/g,"")},c=function(e,t,n){for(var r=e.length,a="",o=0;o<r;o++)o>0&&(a+=t||""),a+=(0,i.createCounterText)(e[o],(0,A.parseListStyleType)(n||"decimal"),!1);return a}}])},"object"===a(t)&&"object"===a(e)?e.exports=A():(r=[],void 0===(i="function"==typeof(n=A)?n.apply(t,r):n)||(e.exports=i))}).call(this,n(63)(e))},function(e,t){e.exports="varying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},function(e,t){e.exports="uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n    gl_FragColor = texture2D(tDiffuse, vUv);\n}\n"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(345);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(1)(!1)).push([e.i,".markup-frames-container{transform:translateZ(0);left:0;top:0;position:absolute}.markup-selection-frame-container{display:none}.markup-selection-frame-container.visible{display:block}.markup-selection-frame{transform:translateZ(0);position:absolute;pointer-events:none}.markup-selection-frame.fill{display:none;background-color:rgba(6,150,215,0.05)}.markup-selection-frame.fill.ios,.markup-selection-frame.border.ios{transform:translateZ(0);-webkit-transform:rotateZ(0deg)}.markup-selection-frame.fill.visible{display:block}.markup-selection-frame.border{background-color:rgba(6,150,215,0.6)}.markup-selection-frame.segment{display:none}.markup-selection-frame.segment.visible{display:block}.markup-anchor{transform:translateZ(0);display:none;position:absolute;background:#FFFFFF;box-shadow:0 0 0 1px rgba(107,120,127,0.7);pointer-events:none;border-radius:20px;z-index:1}.markup-anchor-fill.rectangle,.markup-anchor.rectangle{border-radius:0px}.markup-anchor-fill{display:none;width:100%;margin:1px;border-radius:20px;background:#0696D7}.markup-anchor-fill.visible{display:block}.markup-anchor.visible{display:flex}.rect-selector-frame{transform:translateZ(0);position:absolute;pointer-events:none;border:#222222 dashed 1px;border-radius:5px}.rect-selector-frame.visible{display:block}\n",""])},function(e,t,n){var r=n(347);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(1)(!1)).push([e.i,'.markup-links-container{transform:translateZ(0);left:0;top:0;position:absolute}.link{display:none;position:absolute;pointer-events:none;z-index:1}.link.visible{display:block}.link.transparent{opacity:0.3}.link-document-attachment{transform:translateZ(0);display:block;position:absolute;text-align:center;font-family:"Artifakt Element";background-color:#0696D7;border-radius:10.5px;color:white;cursor:pointer;font-size:13px;font-weight:500;line-height:19px;height:20px;width:40px}.link-document-attachment:before{font-family:"bimviewericon", sans-serif;content:"\\E911";font-size:11px;padding-right:4px}.link.selected .link-document-attachment{background-color:#0584BD}.link.hover .link-document-attachment{background-color:#38ABDF}.link.editable .link-document-attachment{outline:1px solid rgba(6,150,215,0.6)}\n',""])},function(e,t,n){var r=n(349);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(1)(!1)).push([e.i,".markup-text-container{left:0;top:0;width:100%;height:100%;position:absolute;pointer-events:none}.markup-text{will-change:contents;transform:translateZ(0);text-rendering:geometricPrecision;display:none;position:absolute;pointer-events:none;text-align:left;white-space:pre-wrap;overflow-wrap:break-word;word-wrap:break-word;outline:none;-webkit-user-select:none;user-select:none}.markup-text p{display:block;box-sizing:content-box;font-weight:inherit;font-size:inherit;font-family:inherit;font-style:inherit;word-wrap:inherit;white-space:inherit;line-height:inherit;text-rendering:geometricPrecision;-ms-text-size-adjust:100%;text-align:left;margin:0 0 0 0;padding:0 0 0 0;user-select:text}.markup-text.single-line br{display:none}.markup-text.visible{display:block}.markup-text-area{pointer-events:all;position:absolute;z-index:100}\n",""])},function(e,t){e.exports=function(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();return t.setSeconds(0,0),6e4*n+t.getTime()%6e4}},function(e,t,n){var r=n(0);e.exports=function(e,t,n,i){var A=r(e).getTime(),a=r(t).getTime(),o=r(n).getTime(),s=r(i).getTime();if(A>a||o>s)throw new Error("The start of the range cannot be after the end of the range");return A<s&&o<a}},function(e,t,n){var r=n(0);e.exports=function(e,t){if(!(t instanceof Array))throw new TypeError(toString.call(t)+" is not an instance of Array");var n,i,A=r(e).getTime();return t.forEach((function(e,t){var a=r(e),o=Math.abs(A-a.getTime());(void 0===n||o<i)&&(n=t,i=o)})),n}},function(e,t,n){var r=n(0);e.exports=function(e,t){if(!(t instanceof Array))throw new TypeError(toString.call(t)+" is not an instance of Array");var n,i,A=r(e).getTime();return t.forEach((function(e){var t=r(e),a=Math.abs(A-t.getTime());(void 0===n||a<i)&&(n=t,i=a)})),n}},function(e,t,n){var r=n(17),i=6e4,A=6048e5;e.exports=function(e,t){var n=r(e),a=r(t),o=n.getTime()-n.getTimezoneOffset()*i,s=a.getTime()-a.getTimezoneOffset()*i;return Math.round((o-s)/A)}},function(e,t,n){var r=n(74),i=n(0);e.exports=function(e,t){var n=i(e),A=i(t);return 4*(n.getFullYear()-A.getFullYear())+(r(n)-r(A))}},function(e,t,n){var r=n(35),i=6e4,A=6048e5;e.exports=function(e,t,n){var a=r(e,n),o=r(t,n),s=a.getTime()-a.getTimezoneOffset()*i,u=o.getTime()-o.getTimezoneOffset()*i;return Math.round((s-u)/A)}},function(e,t,n){var r=n(38),i=36e5;e.exports=function(e,t){var n=r(e,t)/i;return n>0?Math.floor(n):Math.ceil(n)}},function(e,t,n){var r=n(0),i=n(72),A=n(24),a=n(77);e.exports=function(e,t){var n=r(e),o=r(t),s=A(n,o),u=Math.abs(i(n,o));return n=a(n,s*u),s*(u-(A(n,o)===-s))}},function(e,t,n){var r=n(38),i=6e4;e.exports=function(e,t){var n=r(e,t)/i;return n>0?Math.floor(n):Math.ceil(n)}},function(e,t,n){var r=n(49);e.exports=function(e,t){var n=r(e,t)/3;return n>0?Math.floor(n):Math.ceil(n)}},function(e,t,n){var r=n(76);e.exports=function(e,t){var n=r(e,t)/7;return n>0?Math.floor(n):Math.ceil(n)}},function(e,t,n){var r=n(0),i=n(75),A=n(24);e.exports=function(e,t){var n=r(e),a=r(t),o=A(n,a),s=Math.abs(i(n,a));return n.setFullYear(n.getFullYear()-o*s),o*(s-(A(n,a)===-o))}},function(e,t){e.exports=function(){var e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};return{localize:function(t,n,r){var i;return r=r||{},i="string"==typeof e[t]?e[t]:1===n?e[t].one:e[t].other.replace("{{count}}",n),r.addSuffix?r.comparison>0?"in "+i:i+" ago":i}}}},function(e,t,n){var r=n(365);e.exports=function(){var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=["January","February","March","April","May","June","July","August","September","October","November","December"],n=["Su","Mo","Tu","We","Th","Fr","Sa"],i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],A=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["AM","PM"],o=["am","pm"],s=["a.m.","p.m."],u={MMM:function(t){return e[t.getMonth()]},MMMM:function(e){return t[e.getMonth()]},dd:function(e){return n[e.getDay()]},ddd:function(e){return i[e.getDay()]},dddd:function(e){return A[e.getDay()]},A:function(e){return e.getHours()/12>=1?a[1]:a[0]},a:function(e){return e.getHours()/12>=1?o[1]:o[0]},aa:function(e){return e.getHours()/12>=1?s[1]:s[0]}};return["M","D","DDD","d","Q","W"].forEach((function(e){u[e+"o"]=function(t,n){return function(e){var t=e%100;if(t>20||t<10)switch(t%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"}(n[e](t))}})),{formatters:u,formattingTokensRegExp:r(u)}}},function(e,t){var n=["M","MM","Q","D","DD","DDD","DDDD","d","E","W","WW","YY","YYYY","GG","GGGG","H","HH","h","hh","m","mm","s","ss","S","SS","SSS","Z","ZZ","X","x"];e.exports=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);var i=n.concat(t).sort().reverse();return new RegExp("(\\[[^\\[]*\\])|(\\\\)?("+i.join("|")+"|.)","g")}},function(e,t,n){var r=n(48),i=n(0),A=n(50),a=n(51),o=1440,s=43200,u=525600;e.exports=function(e,t,n){var l=n||{},c=r(e,t),h=l.locale,d=a.distanceInWords.localize;h&&h.distanceInWords&&h.distanceInWords.localize&&(d=h.distanceInWords.localize);var f,p,g,y={addSuffix:Boolean(l.addSuffix),comparison:c};c>0?(f=i(e),p=i(t)):(f=i(t),p=i(e));var m=Math[l.partialMethod?String(l.partialMethod):"floor"],E=A(p,f),v=p.getTimezoneOffset()-f.getTimezoneOffset(),B=m(E/60)-v;if("s"===(g=l.unit?String(l.unit):B<1?"s":B<60?"m":B<o?"h":B<s?"d":B<u?"M":"Y"))return d("xSeconds",E,y);if("m"===g)return d("xMinutes",B,y);if("h"===g)return d("xHours",m(B/60),y);if("d"===g)return d("xDays",m(B/o),y);if("M"===g)return d("xMonths",m(B/s),y);if("Y"===g)return d("xYears",m(B/u),y);throw new Error("Unknown unit: "+g)}},function(e,t,n){var r=n(78);e.exports=function(e,t){return r(Date.now(),e,t)}},function(e,t,n){var r=n(0);e.exports=function(e,t,n){var i=r(e),A=void 0!==n?n:1,a=r(t).getTime();if(i.getTime()>a)throw new Error("The first date cannot be after the second date");var o=[],s=i;for(s.setHours(0,0,0,0);s.getTime()<=a;)o.push(r(s)),s.setDate(s.getDate()+A);return o}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e);return t.setMinutes(59,59,999),t}},function(e,t,n){var r=n(79);e.exports=function(e){return r(e,{weekStartsOn:1})}},function(e,t,n){var r=n(16),i=n(17);e.exports=function(e){var t=r(e),n=new Date(0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);var A=i(n);return A.setMilliseconds(A.getMilliseconds()-1),A}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e);return t.setSeconds(59,999),t}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e),n=t.getMonth(),i=n-n%3+3;return t.setMonth(i,0),t.setHours(23,59,59,999),t}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e);return t.setMilliseconds(999),t}},function(e,t,n){var r=n(52);e.exports=function(){return r(new Date)}},function(e,t){e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r+1),i.setHours(23,59,59,999),i}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}},function(e,t){e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r-1),i.setHours(23,59,59,999),i}},function(e,t,n){var r=n(81),i=n(53),A=n(16),a=n(0),o=n(83),s=n(51);var u={M:function(e){return e.getMonth()+1},MM:function(e){return h(e.getMonth()+1,2)},Q:function(e){return Math.ceil((e.getMonth()+1)/3)},D:function(e){return e.getDate()},DD:function(e){return h(e.getDate(),2)},DDD:function(e){return r(e)},DDDD:function(e){return h(r(e),3)},d:function(e){return e.getDay()},E:function(e){return e.getDay()||7},W:function(e){return i(e)},WW:function(e){return h(i(e),2)},YY:function(e){return h(e.getFullYear(),4).substr(2)},YYYY:function(e){return h(e.getFullYear(),4)},GG:function(e){return String(A(e)).substr(2)},GGGG:function(e){return A(e)},H:function(e){return e.getHours()},HH:function(e){return h(e.getHours(),2)},h:function(e){var t=e.getHours();return 0===t?12:t>12?t%12:t},hh:function(e){return h(u.h(e),2)},m:function(e){return e.getMinutes()},mm:function(e){return h(e.getMinutes(),2)},s:function(e){return e.getSeconds()},ss:function(e){return h(e.getSeconds(),2)},S:function(e){return Math.floor(e.getMilliseconds()/100)},SS:function(e){return h(Math.floor(e.getMilliseconds()/10),2)},SSS:function(e){return h(e.getMilliseconds(),3)},Z:function(e){return c(e.getTimezoneOffset(),":")},ZZ:function(e){return c(e.getTimezoneOffset())},X:function(e){return Math.floor(e.getTime()/1e3)},x:function(e){return e.getTime()}};function l(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|]$/g,""):e.replace(/\\/g,"")}function c(e,t){t=t||"";var n=e>0?"-":"+",r=Math.abs(e),i=r%60;return n+h(Math.floor(r/60),2)+t+h(i,2)}function h(e,t){for(var n=Math.abs(e).toString();n.length<t;)n="0"+n;return n}e.exports=function(e,t,n){var r=t?String(t):"YYYY-MM-DDTHH:mm:ss.SSSZ",i=(n||{}).locale,A=s.format.formatters,c=s.format.formattingTokensRegExp;i&&i.format&&i.format.formatters&&(A=i.format.formatters,i.format.formattingTokensRegExp&&(c=i.format.formattingTokensRegExp));var h=a(e);return o(h)?function(e,t,n){var r,i,A=e.match(n),a=A.length;for(r=0;r<a;r++)i=t[A[r]]||u[A[r]],A[r]=i||l(A[r]);return function(e){for(var t="",n=0;n<a;n++)A[n]instanceof Function?t+=A[n](e,u):t+=A[n];return t}}(r,A,c)(h):"Invalid Date"}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getDate()}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getDay()}},function(e,t,n){var r=n(84);e.exports=function(e){return r(e)?366:365}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getHours()}},function(e,t,n){var r=n(23),i=n(47),A=6048e5;e.exports=function(e){var t=r(e),n=r(i(t,60)).valueOf()-t.valueOf();return Math.round(n/A)}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getMilliseconds()}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getMinutes()}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getMonth()}},function(e,t,n){var r=n(0),i=864e5;e.exports=function(e,t,n,A){var a=r(e).getTime(),o=r(t).getTime(),s=r(n).getTime(),u=r(A).getTime();if(a>o||s>u)throw new Error("The start of the range cannot be after the end of the range");if(!(a<u&&s<o))return 0;var l=(u>o?o:u)-(s<a?a:s);return Math.ceil(l/i)}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getSeconds()}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getTime()}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getFullYear()}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()>i.getTime()}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()<i.getTime()}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(0);e.exports=function(e){return 1===r(e).getDate()}},function(e,t,n){var r=n(0);e.exports=function(e){return 5===r(e).getDay()}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getTime()>(new Date).getTime()}},function(e,t,n){var r=n(0),i=n(52),A=n(80);e.exports=function(e){var t=r(e);return i(t).getTime()===A(t).getTime()}},function(e,t,n){var r=n(0);e.exports=function(e){return 1===r(e).getDay()}},function(e,t,n){var r=n(0);e.exports=function(e){return r(e).getTime()<(new Date).getTime()}},function(e,t,n){var r=n(18);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(0);e.exports=function(e){return 6===r(e).getDay()}},function(e,t,n){var r=n(0);e.exports=function(e){return 0===r(e).getDay()}},function(e,t,n){var r=n(86);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(88);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(89);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(90);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(92);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(93);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(95);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(54);e.exports=function(e,t){return r(new Date,e,t)}},function(e,t,n){var r=n(97);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(0);e.exports=function(e){return 4===r(e).getDay()}},function(e,t,n){var r=n(18);e.exports=function(e){return r(e).getTime()===r(new Date).getTime()}},function(e,t,n){var r=n(18);e.exports=function(e){var t=new Date;return t.setDate(t.getDate()+1),r(e).getTime()===r(t).getTime()}},function(e,t,n){var r=n(0);e.exports=function(e){return 2===r(e).getDay()}},function(e,t,n){var r=n(0);e.exports=function(e){return 3===r(e).getDay()}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e).getDay();return 0===t||6===t}},function(e,t,n){var r=n(0);e.exports=function(e,t,n){var i=r(e).getTime(),A=r(t).getTime(),a=r(n).getTime();if(A>a)throw new Error("The start of the range cannot be after the end of the range");return i>=A&&i<=a}},function(e,t,n){var r=n(18);e.exports=function(e){var t=new Date;return t.setDate(t.getDate()-1),r(e).getTime()===r(t).getTime()}},function(e,t,n){var r=n(98);e.exports=function(e){return r(e,{weekStartsOn:1})}},function(e,t,n){var r=n(16),i=n(17);e.exports=function(e){var t=r(e),n=new Date(0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);var A=i(n);return A.setDate(A.getDate()-1),A}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e),n=t.getMonth(),i=n-n%3+3;return t.setMonth(i,0),t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(0);e.exports=function(){var e=Array.prototype.slice.call(arguments).map((function(e){return r(e)})),t=Math.max.apply(null,e);return new Date(t)}},function(e,t,n){var r=n(0);e.exports=function(){var e=Array.prototype.slice.call(arguments).map((function(e){return r(e)})),t=Math.min.apply(null,e);return new Date(t)}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setDate(i),n}},function(e,t,n){var r=n(0),i=n(21);e.exports=function(e,t,n){var A=n&&Number(n.weekStartsOn)||0,a=r(e),o=Number(t),s=a.getDay();return i(a,((o%7+7)%7<A?7:0)+o-s)}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setMonth(0),n.setDate(i),n}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setHours(i),n}},function(e,t,n){var r=n(0),i=n(21),A=n(85);e.exports=function(e,t){var n=r(e),a=Number(t),o=A(n);return i(n,a-o)}},function(e,t,n){var r=n(0),i=n(53);e.exports=function(e,t){var n=r(e),A=Number(t),a=i(n)-A;return n.setDate(n.getDate()-7*a),n}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setMilliseconds(i),n}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setMinutes(i),n}},function(e,t,n){var r=n(0),i=n(99);e.exports=function(e,t){var n=r(e),A=Number(t)-(Math.floor(n.getMonth()/3)+1);return i(n,n.getMonth()+3*A)}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setSeconds(i),n}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setFullYear(i),n}},function(e,t,n){var r=n(0);e.exports=function(e){var t=r(e);return t.setDate(1),t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(18);e.exports=function(){return r(new Date)}},function(e,t){e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r+1),i.setHours(0,0,0,0),i}},function(e,t){e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r-1),i.setHours(0,0,0,0),i}},function(e,t,n){var r=n(21);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(65);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(22);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(68);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(37);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(69);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(70);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(47);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(71);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r,i,A=n(100),a=n(101),o=0,s=0;e.exports=function(e,t,n){var u=t&&n||0,l=t||[],c=(e=e||{}).node||r,h=void 0!==e.clockseq?e.clockseq:i;if(null==c||null==h){var d=A();null==c&&(c=r=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==h&&(h=i=16383&(d[6]<<8|d[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:s+1,g=f-o+(p-s)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||f>o)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=f,s=p,i=h;var y=(1e4*(268435455&(f+=122192928e5))+p)%4294967296;l[u++]=y>>>24&255,l[u++]=y>>>16&255,l[u++]=y>>>8&255,l[u++]=255&y;var m=f/4294967296*1e4&268435455;l[u++]=m>>>8&255,l[u++]=255&m,l[u++]=m>>>24&15|16,l[u++]=m>>>16&255,l[u++]=h>>>8|128,l[u++]=255&h;for(var E=0;E<6;++E)l[u+E]=c[E];return t||a(l)}},function(e,t,n){var r=n(100),i=n(101);e.exports=function(e,t,n){var A=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[A+o]=a[o];return t||i(a)}},,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"COLORS",(function(){return o})),n.d(r,"DEFAULT_COLORS",(function(){return s})),n.d(r,"DEFAULT_FILL_COLORS",(function(){return u})),n.d(r,"STYLE_PROPERTIES",(function(){return l})),n.d(r,"FONT_SIZES",(function(){return c})),n.d(r,"MESHLINE_PATH_START",(function(){return h})),n.d(r,"MESHLINE_PATH_END",(function(){return d})),n.d(r,"MESHLINE_PATH_DEFAULT",(function(){return f})),n.d(r,"MESHLINE_PATH_ROUND_CAP",(function(){return p})),n.d(r,"MESHLINE_PATH_FLAT_CAP",(function(){return g})),n.d(r,"MARKUP_TYPE_ARROW",(function(){return y})),n.d(r,"MARKUP_TYPE_RECTANGLE",(function(){return m})),n.d(r,"MARKUP_TYPE_CIRCLE",(function(){return E})),n.d(r,"MARKUP_TYPE_CLOUD",(function(){return v})),n.d(r,"MARKUP_TYPE_FREEHAND",(function(){return B})),n.d(r,"MARKUP_TYPE_HIGHLIGHT",(function(){return w})),n.d(r,"MARKUP_TYPE_POLYLINE",(function(){return k})),n.d(r,"MARKUP_TYPE_POLYCLOUD",(function(){return C})),n.d(r,"MARKUP_TYPE_TEXT",(function(){return b})),n.d(r,"MARKUP_TYPE_CALLOUT",(function(){return S})),n.d(r,"MARKUP_TYPE_ARROW_CALLOUT",(function(){return T})),n.d(r,"MARKUP_TYPE_ARROW_CLOUD_CALLOUT",(function(){return M})),n.d(r,"MARKUP_TYPE_DIMENSION",(function(){return U})),n.d(r,"MARKUP_TYPE_LINE",(function(){return Q})),n.d(r,"RECT_SELECTOR",(function(){return x})),n.d(r,"MARKUP_STATUS_SAVE_FAILED",(function(){return F})),n.d(r,"MARKUP_STATUS_SAVE_SUCCEED",(function(){return _})),n.d(r,"MARKUP_STATUS_SAVING",(function(){return H})),n.d(r,"MARKUP_STATUS_DELETING",(function(){return L})),n.d(r,"MARKUP_STATUS_DELETE_SUCCEED",(function(){return I})),n.d(r,"MARKUP_STATUS_DELETE_FAILED",(function(){return D})),n.d(r,"MARKUP_STATUS_CREATED",(function(){return O})),n.d(r,"MARKUP_STATUS_OPEN",(function(){return R})),n.d(r,"MARKUP_STATUS_PRIVATE",(function(){return N})),n.d(r,"MARKUP_STATUS_PUBLISHED",(function(){return P})),n.d(r,"MARKUP_STATUS_PUBLISHING",(function(){return K})),n.d(r,"MARKUP_STATUS_CLOSED",(function(){return V})),n.d(r,"MARKUP_STATUS_ARCHIVED",(function(){return j})),n.d(r,"MARKUP_STATUS_ARCHIVING",(function(){return G})),n.d(r,"MARKUP_ATTACHMENT_LOADING",(function(){return z})),n.d(r,"MARKUP_ATTACHMENT_SAVING",(function(){return Y})),n.d(r,"MARKUP_ATTACHMENT_SAVE_SUCCEED",(function(){return W})),n.d(r,"MARKUP_ATTACHMENT_SAVE_FAILED",(function(){return X})),n.d(r,"MARKUP_ATTACHMENT_RENAMING",(function(){return J})),n.d(r,"MARKUP_ATTACHMENT_DELETEING",(function(){return q})),n.d(r,"ATTACHMENT_DATA_TYPE_BINARY",(function(){return Z})),n.d(r,"ATTACHMENT_DATA_TYPE_TEXT",(function(){return $})),n.d(r,"MARKUP_RESOURCE_TYPE_SVG",(function(){return ee})),n.d(r,"MARKUP_RESOURCE_TYPE_SCREEN_CAPTURE",(function(){return te})),n.d(r,"DEFAULT_STATUSES_TO_LOAD",(function(){return ne})),n.d(r,"MARKUP_SUPPORT_GUID_EXT",(function(){return re})),n.d(r,"LINK_TYPE_ATTACHMENTS",(function(){return ie})),n.d(r,"LINK_TYPE_DOCUMENT_ATTACHMENT",(function(){return Ae})),n.d(r,"DEFAULT_MARKUP",(function(){return ae})),n.d(r,"DEFAULT_COLOR",(function(){return oe})),n.d(r,"DEFAULT_FONT_COLOR",(function(){return se})),n.d(r,"DEFAULT_FILL_COLOR",(function(){return ue})),n.d(r,"DEFAULT_THICKNESS",(function(){return le})),n.d(r,"DEFAULT_OPACITY",(function(){return ce})),n.d(r,"DEFAULT_HIGHLIGHT_OPACITY",(function(){return he})),n.d(r,"DEFAULT_FILL_OPACITY",(function(){return de})),n.d(r,"DEFAULT_STROKE_IN_MM",(function(){return fe})),n.d(r,"DEFAULT_FONT_SIZE_IN_PIXELS",(function(){return pe})),n.d(r,"DEFAULT_FONT_SIZE_IN_MM",(function(){return ge})),n.d(r,"DEFAULT_FONT_WEIGHT",(function(){return ye})),n.d(r,"DEFAULT_FONT_FAMILY",(function(){return me})),n.d(r,"DEFAULT_FONT_STYLE",(function(){return Ee})),n.d(r,"SUB_MENU_VISIBLE_CLASS",(function(){return ve})),n.d(r,"ARROW_TIP_LENGTH",(function(){return we})),n.d(r,"EPSILON",(function(){return ke})),n.d(r,"TOUCH_RADIUS",(function(){return Ce})),n.d(r,"ANCHOR_RADIUS",(function(){return be})),n.d(r,"MIN_CHANGE_DISTANCE",(function(){return Se})),n.d(r,"SNAP_DISTANCE",(function(){return Te})),n.d(r,"MIN_FREEHAND_POINT_DISTANCE",(function(){return Me})),n.d(r,"MIN_ANGLE_CHANGE",(function(){return Ue})),n.d(r,"ROTATION_ANCHOR_DISTANCE",(function(){return Qe})),n.d(r,"ROTATION_SNAP_DEGREES",(function(){return xe})),n.d(r,"PASTE_OFFSET",(function(){return Fe})),n.d(r,"ARROW_MOVE_OFFSET",(function(){return _e})),n.d(r,"CONTEXTUAL_MENU_OFFSET",(function(){return He})),n.d(r,"LINK_POSITION_OFFSET",(function(){return Le})),n.d(r,"LINK_ICON_SIZE",(function(){return Ie})),n.d(r,"SELECTION_ZOOM_MARGIN",(function(){return De})),n.d(r,"MAX_THICKNESS",(function(){return Oe})),n.d(r,"PERSPECTIVE_MODE_SCALE",(function(){return Re})),n.d(r,"FRAME_SIZE_SCALE",(function(){return Ne})),n.d(r,"BOUNDING_BOX_MARGIN",(function(){return Pe})),n.d(r,"HIT_AREA_MARGIN",(function(){return Ke})),n.d(r,"TEXT_DEBOUNCE",(function(){return Ve})),n.d(r,"DIMENSION_TIP_LENGTH",(function(){return je})),n.d(r,"DIMENSION_THICKNESS_FACTOR",(function(){return Ge})),n.d(r,"DIMENSION_FONT_SIZE_FACTOR",(function(){return ze})),n.d(r,"DISABLED_OPACITY",(function(){return Ye})),n.d(r,"MOBILE_GESTURES_MIN_THRESHOLD_TIME",(function(){return We})),n.d(r,"SCREEN_MARGIN",(function(){return Xe})),n.d(r,"TEXT_LENGTH_LIMIT",(function(){return Je})),n.d(r,"MINIMUM_THUMBNAIL_SIZE",(function(){return qe})),n.d(r,"WORLD_3D_SIZE",(function(){return Ze})),n.d(r,"MAX_NORMA_PERCENTAGE",(function(){return $e})),n.d(r,"MAX_NORMA_TEXT_PERCENTAGE",(function(){return et})),n.d(r,"NORMA_3D",(function(){return tt})),n.d(r,"NORMA_TEXT_3D",(function(){return nt})),n.d(r,"POINT_SIZE_IN_MM",(function(){return rt})),n.d(r,"TIMEOUT_TO_SELECT_AFTER_DRAWEND",(function(){return it})),n.d(r,"MARKUP_CREATION_CURSORS",(function(){return At})),n.d(r,"MARKUP_ERRORS",(function(){return at}));var i,A={MARKUP_SESSION_START:"markup.session.start",MARKUP_SESSION_END:"markup.session.end",MARKUP_TOOL_ENABLED_CHANGED:"markup.tool.enabled.changed",MARKUP_REMOVED:"markup.removed",MARKUP_DRAWING_START:"markup.drawing.start",MARKUP_DRAWING_END:"markup.drawing.end",MARKUP_DRAWING_CANCEL:"markup.drawing.cancel",MARKUP_EDIT_START:"markup.edit.start",MARKUP_EDIT_END:"markup.edit.end",MARKUP_SELECTED:"markup.selected",MARKUP_DESELECTED:"markup.deselected",MARKUP_ENABLE_EDIT:"markup.enable.edit",MARKUP_DISABLE_EDIT:"markup.disable.edit",MARKUP_DIRTY:"markup.dirty",MARKUP_VISIBILITY_CHANGED:"markup.visibility.changed",MARKUP_VIEW_ENTERED:"markup.view.entered",MARKUP_VIEW_EXITED:"markup.view.exited",TEXT_EDITING_STARTED:"text.editing.started",TEXT_EDITING_ENDED:"text.editing.ended",LAYER_DIRTY:"layer.dirty",LAYER_SELECTED:"layer.selected",LAYER_DESELECTED:"layer.deselected",LAYER_SELECTED_FROM_DIFFERENT_SHEET:"layer.selected.from.different.sheet",LAYER_EDITED_FROM_DIFFERENT_SHEET:"layer.edited.from.different.sheet",LAYER_DELETE:"layer.delete",LAYER_DELETED:"layer.deleted",LAYER_PUBLISH:"layer.publish",LAYER_ARCHIVE:"layer.archive",LAYER_SYNCING:"layer.syncing",LAYER_SYNCED:"layer.synced",LAYER_READY_TO_SAVE:"layer.ready.to.save",LAYER_CREATED:"layer.created",DOCUMENT_ATTACHMENT_CREATION_START:"document.attachment.creation.start",DOCUMENT_ATTACHMENT_RENAME:"document.attachment.rename",DOCUMENT_ATTACHMENT_DELETE:"document.attachment.delete",LAYER_FETCHED:"layer.fetched",LAYER_RESOURCE_FETCHED:"layer.resource.fetched",LAYER_THUMBNAIL_FETCHED:"layer.thumbnail.fetched",LAYER_METADATA_FETCHED:"layer.metadata.fetched",ATTACHMENT_THUMBNAIL_LOADED:"attachment.thumbnail.loaded",ALL_MARKUPS_LOADED:"all.markups.loaded",PROJECT_USERS_FETCHED:"project.users.fetched",LINK_DIRTY:"link.dirty",LINK_SELECTED:"link.selected",LINK_DESELECTED:"link.deselected",LINK_SYNCED:"link.synced",LINK_SYNCING:"link.syncing",LINK_REMOVED:"link.removed",LINK_RENDERED:"link.rendered",FILTER_CHANGED:"filter.changed",BUTTON_DOWN:"button.down",MARKUP_CREATION_TYPE_CHANGED:"markup.creation.type.changed",MARKUP_STYLE_PROPERTY_CHANGED:"markup.style.property.changed",LAYER_DISCARD_PRESSED:"layer.discard.pressed",LAYER_PUBLISH_PRESSED:"layer.publish.pressed",LAYER_ARCHIVE_PRESSED:"layer.archive.pressed",LAYER_DELETE_PRESSED:"layer.delete.pressed",LAYER_DELETE_EMPTY_PRESSED:"layer.delete.empty.pressed",EXIT_VIEWER_PRESSED:"exit.viewer.pressed",RECT_SELECTOR_UPDATED:"rect.selector.updated",CALIBRATION_REQUIRED:"calibration.required"};function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o={RED:"#FF0000",GREEN:"#00F72C",BLUE:"#103FFB",ORANGE:"#FF9224",YELLOW:"#FEF935",CYAN:"#03FCFE",WHITE:"#FFFFFF",BLACK:"#000000",PINK:"#FF4CFC",PURPLE:"#922890",NO_COLOR:"-1"},s=[{color:o.RED,label:"Red"},{color:o.BLUE,label:"Blue"},{color:o.PURPLE,label:"Purple"},{color:o.YELLOW,label:"Yellow"},{color:o.ORANGE,label:"Orange"},{color:o.CYAN,label:"Cyan"},{color:o.PINK,label:"Pink"},{color:o.GREEN,label:"Green"},{color:o.BLACK,label:"Black"},{color:o.WHITE,label:"White"}],u=[{color:o.RED,label:"Red"},{color:o.BLUE,label:"Blue"},{color:o.PURPLE,label:"Purple"},{color:o.YELLOW,label:"Yellow"},{color:o.ORANGE,label:"Orange"},{color:o.CYAN,label:"Cyan"},{color:o.PINK,label:"Pink"},{color:o.GREEN,label:"Green"},{color:o.NO_COLOR,label:"No Fill"},{color:o.BLACK,label:"Black"},{color:o.WHITE,label:"White"}],l={COLOR:"stroke-color",FILL_COLOR:"fill-color",THICKNESS:"stroke-width",OPACITY:"stroke-opacity",FILL_OPACITY:"fill-opacity",FONT_SIZE:"font-size",FONT_WEIGHT:"font-weight",FONT_FAMILY:"font-family",FONT_STYLE:"font-style",FONT_COLOR:"font-color",STROKE_LINEJOIN:"stroke-linejoin"},c=[10,12,14,16,18,20,24,28,32,36,40,44,48,52,58,64,70,76,82,88,94,100],h=1,d=2,f=1,p=2,g=3,y="arrow",m="rectangle",E="ellipse",v="cloud",B="freehand",w="highlight",k="polyline",C="polycloud",b="label",S="callout",T="simple-arrow-callout",M="arrow-cloud-callout",U="dimension",Q="line",x="selector",F="save_failed",_="save_success",H="markup_saving",L="deleting",I="delete_success",D="delete_failed",O="created",R="open",N="private",P="published",K="publishing",V="closed",j="archived",G="archiving",z="attachment_loading",Y="attachment_saving",W="attachment_save_success",X="attachment_save_failed",J="attachment_renaming",q="attachment_deleting",Z="binary",$="text",ee="svg",te="screencapture",ne=[N,P,j].join(","),re=["dwfx","rvt","dwf"],ie="attachments",Ae="document",ae=B,oe=o.RED,se=o.RED,ue=o.NO_COLOR,le=10,ce=1,he=.5,de=.5,fe=.1,pe=36,ge=10,ye="normal",me="Artifakt Element, Arial",Ee="normal",ve="subMenuVisible",Be="undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0),we=5,ke=1e-4,Ce=Be?34:4,be=4,Se=5,Te=20,Me=1,Ue=.05,Qe=Be?30:20,xe=45,Fe=20,_e=20,He=60,Le=10,Ie=20,De=.05,Oe=100,Re=1e3,Ne=20,Pe=4*window.devicePixelRatio+10,Ke=Ce+10,Ve=200,je=8,Ge=.4,ze=.6,Ye=.3,We=100,Xe=10,Je=3e3,qe=92,Ze=1e3,$e=5e-4,et=20*$e,tt=1,nt=20*tt,rt=.005,it=700,At=(a(i={},x,"cell"),a(i,b,"text"),a(i,S,"text"),i),at={MARKUP_SAVE_FAILED:"MARKUP_SAVE_FAILED",MARKUP_DELETE_FAILED:"MARKUP_DELETE_FAILED",MARKUP_PUBLISH_FAILED:"MARKUP_PUBLISH_FAILED",MARKUP_ARCHIVE_FAILED:"MARKUP_ARCHIVE_FAILED",MARKUP_ATTACHMENT_CREATE_FAILED:"MARKUP_ATTACHMENT_CREATE_FAILED",MARKUP_ATTACHMENT_DELETE_FAILED:"MARKUP_ATTACHMENT_DELETE_FAILED",MARKUP_ATTACHMENT_RENAME_FAILED:"MARKUP_ATTACHMENT_RENAME_FAILED",MARKUP_ATTACHMENT_UPDATE_FAILED:"MARKUP_ATTACHMENT_UPDATE_FAILED"},ot={radiansToDegrees:function(e){return e*(180/Math.PI)},degreesToRadians:function(e){return e*(Math.PI/180)},applyRotation:function(e,t,n,r){e instanceof Array||(e=[e]),e.forEach((function(e){e.sub(n),e.applyAxisAngle(r,t),e.add(n)}))},getSignedAngle:function(e,t,n){var r=e.angleTo(t),i=e.clone().cross(t).normalize();return r*(n.dot(i)>0?1:-1)},swapBoundingBoxY:function(e){var t=[e.min.y,e.max.y];return e.max.y=t[0],e.min.y=t[1],e}},st=ot,ut=n(11),lt={cloneDeep:function(e){return Object(ut.cloneDeep)(e)},findLast:function(e,t){return Object(ut.findLast)(e,t)},debounce:function(e,t,n){return Object(ut.debounce)(e,t,n)},remove:function(e,t){return Object(ut.remove)(e,t)}},ct=lt;function ht(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var dt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.actionManager=t}var t,n,r;return t=e,(n=[{key:"execute",value:function(){this.actionManager.execute(this)}},{key:"undo",value:function(){}},{key:"redo",value:function(){}}])&&ht(t.prototype,n),r&&ht(t,r),e}();function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gt(e,t){return!t||"object"!==ft(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mt(e,t){return(mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Et=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=gt(this,yt(t).call(this,e.actionManager))).markupsManager=e,i.markup=n,i.layer=r,i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mt(e,t)}(t,e),n=t,(r=[{key:"undo",value:function(){this.markupsManager.removeMarkupFromLayer(this.markup)}},{key:"redo",value:function(){this.markupsManager.addMarkupToLayer(this.markup,this.layer)}}])&&pt(n.prototype,r),i&&pt(n,i),t}(dt);function vt(e){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wt(e,t){return!t||"object"!==vt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kt(e){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ct(e,t){return(Ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bt=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=wt(this,kt(t).call(this,e.actionManager))).markupsManager=e,i.markup=n,i.layer=i.markup.layer,i.oldState=ct.cloneDeep(i.markup.getState()),i.newState=ct.cloneDeep(r),i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ct(e,t)}(t,e),n=t,(r=[{key:"undo",value:function(){this.markup.setState(this.oldState),this.markup.syncEditState()}},{key:"redo",value:function(){this.markup.setState(this.newState),this.markup.syncEditState()}}])&&Bt(n.prototype,r),i&&Bt(n,i),t}(dt);function St(e){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mt(e,t){return!t||"object"!==St(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qt(e,t){return(Qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xt=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Mt(this,Ut(t).call(this,e.actionManager))).markupsManager=e,r.markup=n,r.layer=r.markup.layer,r}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qt(e,t)}(t,e),n=t,(r=[{key:"undo",value:function(){this.markupsManager.addMarkupToLayer(this.markup,this.layer)}},{key:"redo",value:function(){this.markupsManager.removeMarkupFromLayer(this.markup)}}])&&Tt(n.prototype,r),i&&Tt(n,i),t}(dt),Ft=Autodesk.Viewing,_t=function(e,t){e&&Object.keys(e).forEach((function(n){var r=e[n];r&&t(r)}))},Ht=function(e,t,n){return!(!e||!t)&&(n=n||ke,e.distanceTo(t)<=n)},Lt=function(e){var t=[];return _t(e,(function(e){Array.isArray(e)?e.forEach((function(e){t.push(e)})):t.push(e)})),t},It=function(e,t,n){var r,i=new THREE.Vector3,A=new THREE.Vector3;return i.subVectors(t,e),A.subVectors(n,t),r=i.dot(A),i.subVectors(n,t),r=-r/i.dot(i),i.subVectors(n,t),i.multiplyScalar(r),i.add(t)},Dt=function(e,t){e instanceof Array||(e=[e]),e.forEach((function(e){e.x+=t.x,e.y+=t.y,e.z+=t.z}))},Ot=function(){var e=Ft.getGlobal().document,t=e.createElement("div");t.id="text-markup-measure-div",t.style.position="absolute",t.style.visibility="hidden",t.style.pointerEvents="none",t.style.textRendering="geometricPrecision",e.body.appendChild(t);var n={};return function(e,r){var i="".concat(e,"_").concat(r.fontWeight,"_").concat(r.fontSize,"_").concat(r.fontFamily,"_").concat(r.fontStyle,"_").concat(r.width);if(n[i])return n[i];t.innerText=e,t.style.fontWeight=r.fontWeight,t.style.fontSize=r.fontSize,t.style.fontFamily=r.fontFamily,t.style.fontStyle=r.fontStyle,t.style.overflowWrap=r.overflowWrap||"break-word",t.style.wordWrap=r.wordWrap||"break-word",t.style.whiteSpace=r.whiteSpace||"pre-wrap",t.style.width=r.width||(Autodesk.Viewing.isIE11?"auto":"unset"),t.style.lineHeight=r.lineHeight||1;var A=t.getBoundingClientRect(),a=A.width,o=A.height;return n[i]={width:a,height:o},n[i]}}(),Rt=function(e,t,n,r,i,A,a,o){var s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;o||(o=[]),e=e||0,t=t||0,n=n||0,r=r||0,i=i||0;var l=Math.abs(r-i);l>2*Math.PI&&(l-=2*Math.PI),!A&&r>i?l=2*Math.PI-l:A&&i>r&&(l=2*Math.PI-l),"number"!=typeof a&&(s=s||n,a=Math.max(6,2*Math.floor(6*Math.pow(s,1/3)*(l/Math.PI))));var c=l/(a=Math.max(a,3)),h=r;c*=A?-1:1;for(var d=0;d<a+1;d++){var f=e+Math.cos(h)*n,p=t+Math.sin(h)*n;o.push({x:f,y:p,z:0}),u&&(u.min.x=Math.min(u.min.x,f),u.min.y=Math.min(u.min.y,p),u.max.x=Math.max(u.max.x,f),u.max.y=Math.max(u.max.y,p)),h+=c}return o},Nt=function(e,t,n,r){var i=new THREE.Vector2(e[n].x+Math.cos(e[n].end)*t,e[n].y+Math.sin(e[n].end)*t),A=new THREE.Vector2(e[r].x+Math.cos(e[r].begin)*t,e[r].y+Math.sin(e[r].begin)*t),a=i.clone().sub(A),o=a.length(),s=i.clone().add(A).divideScalar(2);a.normalize();var u=Math.sqrt(Math.max(0,t*t-o/2*(o/2))),l=new THREE.Vector2(a.y,-a.x);l.multiplyScalar(u);var c=s.clone().add(l),h=Math.atan2(i.y-c.y,i.x-c.x),d=Math.atan2(A.y-c.y,A.x-c.x),f={x:c.x,y:c.y,begin:h,end:d};return e.splice(n+1,0,f),{newCircle:f,beginPoint:i,endPoint:A}},Pt=function(e,t,n){for(var r=0;r<n.length;r++){for(var i=null,A=0,a=0;a<e.length;a++)if(e[a]["isCurrentIntersection"+r])for(var o=0;o<e.length;o++){if(e[o]["isNextIntersection"+r])Math.sqrt((e[a].x-e[o].x)*(e[a].x-e[o].x)+(e[a].y-e[o].y)*(e[a].y-e[o].y))<2*t&&(e[a].hide=!0,null===i&&(i=a-1),e[o].hide=!0,A<o+1&&(A=o+1))}n[r].begin=i,n[r].end=A}},Kt=function(e,t,n){return t.splice(function(e,t,n){if(0===t.length)return-1;for(var r=0,i=t.length,A=Math.floor(i/2);i-r>1;){var a=n(t[A],e);if(0===a)return A;a>0?i=A:r=A,A=Math.floor(r+(i-r)/2)}return n(t[A],e)>0?A-1:A}(e,t,n)+1,0,e),t},Vt=function(e,t,n,r){var i={x:null,y:null,onLine1:!1,onLine2:!1,onBothLines:!1},A=(r.y-n.y)*(t.x-e.x)-(r.x-n.x)*(t.y-e.y);if(0===A)return i;var a=e.y-n.y,o=e.x-n.x,s=(r.x-n.x)*a-(r.y-n.y)*o,u=(t.x-e.x)*a-(t.y-e.y)*o;return a=s/A,o=u/A,i.x=e.x+a*(t.x-e.x),i.y=e.y+a*(t.y-e.y),a>0&&a<1&&(i.onLine1=!0),o>0&&o<1&&(i.onLine2=!0),i.onBothLines=i.onLine1&&i.onLine2,i},jt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.width,i=t.height,A=t.ctx,a=t.target,o=t.screenshotCamera,s=t.onRenderDone,u=n.markupLayer,l=e.getExtension("Autodesk.BIM360.Markups");if(l){var c=e.impl.getCanvasBoundingClientRect(),h=c.width,d=c.height,f=e.impl.glrenderer();f.pushViewport();var p=f.getPixelRatio();f.setPixelRatio(1),f.setViewport(0,0,r,i),l.renderer.onResize({width:r,height:i});var g,y,m=e.impl.is2d?o:l.renderer.markupsCamera,E=l.markupsManager.getVisibleLayers();u&&E.forEach((function(e){return e!==u&&e.setVisible(!1)}));var v=function(){u&&(g=u.isVisible(),y=u.isTransparent(),u.setVisible(!0),u.changeTransparency(!1))},B=function(){u&&(u.setVisible(g),u.changeTransparency(!y))};v(),l.renderer.render(a,m),B(),f.popViewport(),f.setPixelRatio(p),l.renderer.onResize({width:h,height:d});var w=A.targetToCanvas(a),k=w.canvas,C=r/h;l.renderer.textRenderer.renderTextToCanvas(k,m,C,v,B,s),u&&E.forEach((function(e){return e!==u&&e.setVisible(!0)}))}else s(A.targetToCanvas(a).canvas)},Gt=function(e,t,n){if(e.length<=2)return e;function r(e,t,n){var r=t.x,i=t.y,A=n.x-r,a=n.y-i;if(0!==A||0!==a){var o=((e.x-r)*A+(e.y-i)*a)/(A*A+a*a);o>1?(r=n.x,i=n.y):o>0&&(r+=A*o,i+=a*o)}return(A=e.x-r)*A+(a=e.y-i)*a}var i=void 0!==t?t*t:1;return e=function(e,t){var n=e.length-1,i=[e[0]];return function e(t,n,i,A,a){for(var o,s=A,u=n+1;u<i;u++){var l=r(t[u],t[n],t[i]);l>s&&(o=u,s=l)}s>A&&(o-n>1&&e(t,n,o,A,a),a.push(t[o]),i-o>1&&e(t,o,i,A,a))}(e,0,n,t,i),i.push(e[n]),i}(e=n?e:function(e,t){for(var n,r,i,A,a,o=e[0],s=[o],u=1,l=e.length;u<l;u++)n=e[u],i=o,A=void 0,a=void 0,A=(r=n).x-i.x,a=r.y-i.y,A*A+a*a>t&&(s.push(n),o=n);return o!==n&&s.push(n),s}(e,i),i)};function zt(e){var t=e.length;if(3===t)return!0;for(var n=0;n<t;n++)for(var r=e[n],i=e[(n+1)%t],A=n+2;A<t;A++){var a=e[A%t],o=e[(A+1)%t];if(o===r)break;if(Vt(r,i,a,o).onBothLines)return!1}return!0}function Yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wt=Autodesk.Viewing,Xt=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setGlobalManager(t.globalManager),this.markupsExtension=t,this.viewer=t.viewer,this.markup=n,this.options=r}var t,n,r;return t=e,(n=[{key:"getEditState",value:function(){return this.markup.getEditState()}},{key:"setEditState",value:function(e,t){this.markup.setEditState(e,t,this)}},{key:"getAnchors",value:function(){return this.getEditState().anchors}},{key:"updateEditState",value:function(e){this.setEditState(this.getEditState(),e)}},{key:"updateEditStateAnchors",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getEditState().anchors;this.updateEditState({anchors:e})}},{key:"handleCompensation",value:function(){if(this.markup.layer){var e=this.markup.getAnchors();this.prevCenter||(this.prevCenter=this.markup.center.clone());var t=this.markup.center.clone().sub(this.prevCenter);e.forEach((function(e){e.sub(t)})),t.applyMatrix4(this.markup.scaleMatrix);var n=this.markup.getRotation();if(0!==n){var r=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(t,n,new THREE.Vector3,r)}t.add(this.markup.editState.translation),this.updateEditState({anchors:e,translation:t}),this.prevCenter.copy(this.markup.center)}}},{key:"submitChanges",value:function(e){var t;if(this.markup.layer){if(this.markup.belongsToGroup())return void this.submitGroupUpdate(e);t=new bt(this.markupsExtension.markupsManager,this.markup,this.getEditState())}else{var n=this.markupsExtension.markupsManager.getActiveLayer();this.markup.syncState(),t=new Et(this.markupsExtension.markupsManager,this.markup,n)}t.isDuringEdit=e,t.execute()}},{key:"submitGroupUpdate",value:function(e){var t=this,n=this.markup.markupGroup.markups,r=this.markupsExtension.markupsManager.isActionGroupOpen();r||this.markupsExtension.markupsManager.openActionGroup(),n.forEach((function(r,i){var A=new bt(t.markupsExtension.markupsManager,r,r.getEditState());A.isDuringEdit=i<n.length-1||e,A.execute()})),r||this.markupsExtension.markupsManager.closeActionGroup()}},{key:"deleteMarkup",value:function(){new xt(this.markupsExtension.markupsManager,this.markup).execute()}},{key:"changeStyleProperty",value:function(e,t,n){var r=ct.cloneDeep(this.getEditState());r.style[e]=t,this.updateEditState({style:Object.assign({},r.style)}),n||(this.submitChanges(!0),this.editEnd(!0))}},{key:"snapPointToAxis",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!Ht(e,t)){var i=this.markupsExtension.renderer.worldToClient(e),A=this.markupsExtension.renderer.worldToClient(t),a=i.clone().sub(A).normalize(),o=st.getSignedAngle(this.markupsExtension.renderer.absoluteUpVec,a,this.markupsExtension.renderer.getCameraEyeVector()),s=o+st.degreesToRadians(r),u=st.degreesToRadians(n),l=Math.ceil((s-st.degreesToRadians(n/2))/u)*u,c=new THREE.Vector3(0,0,-1),h=i.clone();st.applyRotation(h,l-s,A,c);var d=h.clone().sub(A).normalize(),f=i.clone().sub(A).dot(d),p=A.add(d.multiplyScalar(f));e.copy(this.markupsExtension.renderer.clientToWorld(p))}}},{key:"getSnappedPosition",value:function(){return this.markupsExtension.markupsTool.isSnappingAllowed()?this.markupsExtension.markupsTool.getSnappedPosition():this.markupsExtension.markupsTool.lastMousePos}},{key:"didMouseMove",value:function(){return this.markupsExtension.markupsTool.mouseMoved}},{key:"getTouchRadiusWorld",value:function(){return this.markupsExtension.renderer.sizeFromClientToWorld(Ce)}},{key:"getMinChangeDistanceWorld",value:function(){return this.markupsExtension.renderer.sizeFromClientToWorld(Se)}},{key:"snapDistance",value:function(){return this.markupsExtension.renderer.sizeFromClientToWorld(Te)}},{key:"intersect",value:function(e){return null}},{key:"getCursor",value:function(){return"crosshair"}},{key:"isDragging",value:function(){return!1}},{key:"editStart",value:function(){this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_EDIT_START,markup:this.markup,handler:this})}},{key:"editEnd",value:function(e){this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_EDIT_END,markup:this.markup,isDuringEdit:e,handler:this})}},{key:"isSamePoint",value:function(e,t){return Ht(e,t,this.getMinChangeDistanceWorld())}},{key:"isSamePointClient",value:function(e,t){return Ht(e,t,Se)}},{key:"handleDoubleClick",value:function(e,t){}},{key:"handleButtonDown",value:function(e,t){}},{key:"handleButtonUp",value:function(e,t){}},{key:"handleKeyDown",value:function(e,t){}},{key:"handleKeyUp",value:function(e,t){}},{key:"handleMouseMove",value:function(e){}},{key:"handleGesture",value:function(e){}},{key:"handleResize",value:function(){}},{key:"destroy",value:function(){this.markupsExtension=null,this.viewer=null,this.markup=null}}])&&Yt(t.prototype,n),r&&Yt(t,r),e}();function Jt(e){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zt(e){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function en(e,t){return(en=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Wt.GlobalManagerMixin.call(Xt.prototype);var tn=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==Jt(t)&&"function"!=typeof t?$t(e):t}(this,Zt(t).call(this,e,null,r))).bounds=new THREE.Box3,n.markupsExtension.markupsManager.addEventListener(A.MARKUP_SESSION_END,n.clean.bind($t(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&en(e,t)}(t,e),n=t,(r=[{key:"handleMouseMove",value:function(e){var t=this;return!!(this.buttonDownPoint&&this.markupsExtension.markupsTool.dragging&&this.didMouseMove())&&(this.bounds.makeEmpty(),this.bounds.expandByVector(new THREE.Vector3(0,0,1/0)),this.bounds.expandByPoint(e),this.bounds.expandByPoint(this.buttonDownPoint),this.markupsExtension.markupsManager.getEnabledMarkups().filter((function(e){return!e.isSelected()})).forEach((function(e){var n=e.getWorldBoundingBox(!0);t.bounds.isIntersectionBox(n)&&e.setHover(!0)})),this.markupsExtension.markupsManager.dispatchEvent({type:A.RECT_SELECTOR_UPDATED,bounds:this.bounds}),!0)}},{key:"clean",value:function(){this.buttonDownPoint=null,this.bounds.makeEmpty(),this.markupsExtension.markupsManager.dispatchEvent({type:A.RECT_SELECTOR_UPDATED,bounds:this.bounds})}},{key:"handleButtonDown",value:function(e,t){return this.clean(),this.buttonDownPoint=e,!0}},{key:"handleButtonUp",value:function(e,t){return this.selectMarkups(),this.clean(),!1}},{key:"selectMarkups",value:function(){var e=this;this.markupsExtension.markupsTool.shiftDown||this.markupsExtension.markupsManager.deselectAllMarkups(),this.markupsExtension.markupsManager.getEnabledMarkups().filter((function(e){return!e.isSelected()})).forEach((function(t){var n=t.getWorldBoundingBox(!0);e.bounds.isIntersectionBox(n)&&t.select()}))}}])&&qt(n.prototype,r),i&&qt(n,i),t}(Xt);function nn(e){return(nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function An(e,t){return!t||"object"!==nn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function an(e){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function on(e,t){return(on=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),An(this,an(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&on(e,t)}(t,e),n=t,(r=[{key:"getCursor",value:function(){return"pointer"}},{key:"intersect",value:function(e){return this.markup.intersect(e)}},{key:"handleMouseMove",value:function(e){if(this.markupsExtension.markupsTool.dragging||Autodesk.Viewing.isMobileDevice())return!1;var t=this.markup.intersect(e);return t&&(this.markup.layer===this.markupsExtension.markupsManager.getActiveLayer()?this.markup.setHover(!0):this.markup.layer.setHover(!0)),t}},{key:"handleDoubleClick",value:function(e,t){return!this.didMouseMove()&&!!this.markup.intersect(e)&&(this.markupsExtension.markupsManager.isMarkupSessionOpen()||this.markup.layer===this.markupsExtension.markupsManager.getActiveLayer()||this.markupsExtension.markupsManager.editLayer(this.markup.layer,!1,!1,!1),this.markupsExtension.markupsTool.shiftDown||this.markupsExtension.markupsTool.ctrlDown||this.markupsExtension.markupsManager.deselectAllMarkups([this.markup]),this.markup.select(),!0)}},{key:"handleButtonDown",value:function(e,t){return!1}},{key:"handleButtonUp",value:function(e,t){return!this.didMouseMove()&&!!this.markup.intersect(e)&&(this.markupsExtension.markupsManager.deselectAllLayers([this.markup.layer]),this.markupsExtension.markupsManager.selectLayer(this.markup.layer,!1,!1),this.markupsExtension.markupsManager.isMarkupSessionOpen()&&(this.markupsExtension.markupsTool.shiftDown||this.markupsExtension.markupsTool.ctrlDown||this.markupsExtension.markupsManager.deselectAllMarkups([this.markup]),this.markup.select()),!0)}}])&&rn(n.prototype,r),i&&rn(n,i),t}(Xt);function un(e){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cn(e,t){return!t||"object"!==un(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hn(e){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dn(e,t){return(dn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fn=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=cn(this,hn(t).call(this,e,n,i))).keyTranslation=new THREE.Vector3,r}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dn(e,t)}(t,e),n=t,i=[{key:"hasOneGroupInEdit",value:function(e){var t=0,n=0;return e.forEach((function(e){e.isGroupMarkup()?t++:e.belongsToGroup()||n++})),1===t&&0===n}}],(r=[{key:"handleMouseMove",value:function(e){return this.translating&&this.handleMouseTranslation(e),this.translating}},{key:"handleButtonDown",value:function(e,t){return!!this.translating||(this.translating=this.intersect(e),this.translating&&(this.lastTranslationPoint=e,this.buttonDownPos=e,this.editStart()),this.translating)}},{key:"handleButtonUp",value:function(e,t){if(this.translating){var n,r=this.markupsExtension.markupsManager.getInEditMarkups();return this.markupsExtension.markupsManager.openActionGroup(),Ht(e,this.lastTranslationPoint,this.getMinChangeDistanceWorld())?(this.cancelTransformEditing(),n=!1):(r.forEach((function(e,t){e.translationHandler&&e.translationHandler.submitChanges(t<r.length-1)})),this.editEnd(),n=!0),this.markupsExtension.markupsManager.closeActionGroup(),this.translating=!1,this.lastTranslationPoint=null,n}return!1}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:if(this.translating)return this.cancelTransformEditing(),!0;break;case Autodesk.Viewing.KeyCode.UP:return this.handleKeyTranslation(this.markupsExtension.renderer.getCameraUpVector()),!0;case Autodesk.Viewing.KeyCode.DOWN:return this.handleKeyTranslation(this.markupsExtension.renderer.getCameraUpVector().negate()),!0;case Autodesk.Viewing.KeyCode.RIGHT:return this.handleKeyTranslation(this.markupsExtension.renderer.getCameraRightVector()),!0;case Autodesk.Viewing.KeyCode.LEFT:return this.handleKeyTranslation(this.markupsExtension.renderer.getCameraRightVector().negate()),!0}return!1}},{key:"handleKeyUp",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.UP:case Autodesk.Viewing.KeyCode.DOWN:case Autodesk.Viewing.KeyCode.RIGHT:case Autodesk.Viewing.KeyCode.LEFT:return this.keyTranslation.set(0,0,0),this.submitChanges(e.isDuringEdit),!0}return!1}},{key:"handleDoubleClick",value:function(e,t){return this.translating}},{key:"getCursor",value:function(){return"move"}},{key:"cancelTransformEditing",value:function(){this.markupsExtension.markupsManager.getInEditMarkups().forEach((function(e){e.syncEditState()})),this.translating=!1,this.lastTranslationPoint=null,this.editEnd()}},{key:"handleMouseTranslation",value:function(e){var n=this;this.markupsExtension.markupsTool.shiftDown&&(e=e.clone(),this.snapPointToAxis(e,this.buttonDownPos,90));var r=e.clone().sub(this.lastTranslationPoint),i=this.markupsExtension.markupsManager.getInEditMarkups();t.hasOneGroupInEdit(i)?this.handleTranslation(this.markup,r):i.forEach((function(e){n.handleTranslation(e,r)}))}},{key:"handleKeyTranslation",value:function(e){var t=e.multiplyScalar(this.markupsExtension.renderer.multiplyByNormaStrokeWidth(_e));this.keyTranslation.add(t),this.handleTranslation(this.markup,this.keyTranslation)}},{key:"handleTranslation",value:function(e,t){if(e.translationHandler){var n=t.clone().add(e.state.translation);e.translationHandler.updateEditState({translation:n})}}},{key:"intersect",value:function(e){return this.markup.intersect(e)}},{key:"isDragging",value:function(){return this.translating}}])&&ln(n.prototype,r),i&&ln(n,i),t}(Xt);function pn(e){return(pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yn(e,t){return!t||"object"!==pn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mn(e){return(mn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yn(this,mn(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&En(e,t)}(t,e),n=t,(r=[{key:"handleMouseMove",value:function(e){return!!this.activeAnchor&&(e=this.getSnappedPosition(),this.markup.applyInverseRotation(e),this.markup.applyInverseScaleAndTranslation(e),this.markupsExtension.markupsTool.shiftDown&&this.snapAxis(e),this.updateActiveAnchor(e),!0)}},{key:"handleButtonDown",value:function(e,t){return!!this.activeAnchor||(this.activeAnchor=this.intersect(e),this.activeAnchor&&(this.originalAnchor=this.activeAnchor.clone(),this.editStart()),!!this.activeAnchor)}},{key:"handleButtonUp",value:function(e,t){return!!this.activeAnchor&&(e=this.getSnappedPosition(),this.markup.applyInverseRotation(e),this.markup.applyInverseScaleAndTranslation(e),this.markupsExtension.markupsTool.shiftDown&&this.snapAxis(e),this.updateActiveAnchor(e),Ht(this.activeAnchor,this.originalAnchor,this.getMinChangeDistanceWorld())?this.cancelAnchorEditing():(this.submitChanges(),this.editEnd()),this.activeAnchor=null,!0)}},{key:"handleKeyDown",value:function(e,t){if(this.activeAnchor)switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:return this.cancelAnchorEditing(),!0}return!1}},{key:"handleKeyUp",value:function(e,t){}},{key:"handleDoubleClick",value:function(e,t){}},{key:"updateActiveAnchor",value:function(e){this.markup.getAnchors(),this.activeAnchor.copy(e),this.updateEditStateAnchors(),this.handleCompensation()}},{key:"cancelAnchorEditing",value:function(){this.activeAnchor=null,this.markup.syncEditState(),this.updateEditStateAnchors(),this.editEnd()}},{key:"isDragging",value:function(){return!!this.activeAnchor}},{key:"snapAxis",value:function(e){var t=this,n=this.markup.getAnchors(),r=n.findIndex((function(e){return e===t.activeAnchor}));n[r-1]?this.snapPointToAxis(e,n[r-1],xe):n[r+1]&&this.snapPointToAxis(e,n[r+1],xe)}},{key:"intersect",value:function(e){var t=this;e=e.clone(),this.markup.applyInverseRotation(e),this.markup.applyInverseScaleAndTranslation(e);var n=this.markupsExtension.renderer.worldToClient(e);return this.markup.getAnchors().find((function(e){if(t.markup.isAnchorHandlingAllowed(e))return t.markupsExtension.renderer.worldToClient(e).distanceTo(n)<=Ce}))}},{key:"getCursor",value:function(){return this.activeAnchor?"grabbing":"grab"}}])&&gn(n.prototype,r),i&&gn(n,i),t}(Xt);function Bn(e){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kn(e,t){return!t||"object"!==Bn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cn(e){return(Cn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bn(e,t){return(bn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kn(this,Cn(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bn(e,t)}(t,e),n=t,(r=[{key:"handleMouseMove",value:function(e){return this.rotating&&this.handleRotation(e),this.rotating}},{key:"handleButtonDown",value:function(e,t){return this.rotating||(this.rotating=this.intersect(e),this.rotating&&(this.originalRotation=this.markup.getRotation(),this.handleRotation(e),this.editStart())),this.rotating}},{key:"handleButtonUp",value:function(e,t){return!!this.rotating&&(this.rotating=!1,Math.abs(this.originalRotation-this.markup.getRotation())<Ue?this.cancelTransformEditing():(this.submitChanges(),this.editEnd()),this.originalRotation=null,!0)}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:if(this.rotating)return this.cancelTransformEditing(),!0}return!1}},{key:"handleKeyUp",value:function(e,t){return!1}},{key:"handleDoubleClick",value:function(e,t){return this.rotating}},{key:"getCursor",value:function(){return"url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjAgMCAyMCAyMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT5tb3VzZSBjdXJzb3Ivcm90YXRlPC90aXRsZT4gICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+ICAgIDxkZWZzPiAgICAgICAgPHBhdGggZD0iTTMsOCBMMSw4IEw0LDQgTDcsOCBMNSw4IEM1LDEwLjQ4NTI4MTQgNy41MTQ3MTg2MywxMyAxMCwxMyBDMTIuNDg1MjgxNCwxMyAxNSwxMC40ODUyODE0IDE1LDggTDEzLDggTDE2LDQgTDE5LDggTDE3LDggQzE3LDExLjU4OTg1MDkgMTMuNTg5ODUwOSwxNSAxMCwxNSBDNi40MTAxNDkxMywxNSAzLDExLjU4OTg1MDkgMyw4IFoiIGlkPSJwYXRoLTEiPjwvcGF0aD4gICAgICAgIDxmaWx0ZXIgeD0iLTMzLjMlIiB5PSItNjkuNyUiIHdpZHRoPSIxNjYuNyUiIGhlaWdodD0iMTk3LjAlIiBmaWx0ZXJVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIGlkPSJmaWx0ZXItMiI+ICAgICAgICAgICAgPGZlTW9ycGhvbG9neSByYWRpdXM9IjEiIG9wZXJhdG9yPSJkaWxhdGUiIGluPSJTb3VyY2VBbHBoYSIgcmVzdWx0PSJzaGFkb3dTcHJlYWRPdXRlcjEiPjwvZmVNb3JwaG9sb2d5PiAgICAgICAgICAgIDxmZU9mZnNldCBkeD0iMCIgZHk9Ii0yIiBpbj0ic2hhZG93U3ByZWFkT3V0ZXIxIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMSI+PC9mZU9mZnNldD4gICAgICAgICAgICA8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxIiBpbj0ic2hhZG93T2Zmc2V0T3V0ZXIxIiByZXN1bHQ9InNoYWRvd0JsdXJPdXRlcjEiPjwvZmVHYXVzc2lhbkJsdXI+ICAgICAgICAgICAgPGZlQ29tcG9zaXRlIGluPSJzaGFkb3dCbHVyT3V0ZXIxIiBpbjI9IlNvdXJjZUFscGhhIiBvcGVyYXRvcj0ib3V0IiByZXN1bHQ9InNoYWRvd0JsdXJPdXRlcjEiPjwvZmVDb21wb3NpdGU+ICAgICAgICAgICAgPGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAgICAwIDAgMCAwIDAgICAwIDAgMCAwIDAgIDAgMCAwIDAuNSAwIiB0eXBlPSJtYXRyaXgiIGluPSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlQ29sb3JNYXRyaXg+ICAgICAgICA8L2ZpbHRlcj4gICAgPC9kZWZzPiAgICA8ZyBpZD0ibW91c2UtY3Vyc29yL3JvdGF0ZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+ICAgICAgICA8ZyBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuMDAwMDAwLCA5LjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTEwLjAwMDAwMCwgLTkuNTAwMDAwKSAiPiAgICAgICAgICAgIDx1c2UgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMSIgZmlsdGVyPSJ1cmwoI2ZpbHRlci0yKSIgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+ICAgICAgICAgICAgPHBhdGggc3Ryb2tlPSIjRkZGRkZGIiBzdHJva2Utd2lkdGg9IjEiIGQ9Ik0yLjUyMDExNDgzLDguNSBMMy40MjUyNjAwOGUtMTIsOC41IEw0LDMuMTY2NjY2NjcgTDgsOC41IEw1LjUzODA0MjA3LDguNSBDNS44NDQ5MzkyOCwxMC41NDE1MjMyIDcuOTU3NDAyMDYsMTIuNSAxMCwxMi41IEMxMi4wNDI1OTc5LDEyLjUgMTQuMTU1MDYwNywxMC41NDE1MjMyIDE0LjQ2MTk1NzksOC41IEwxMiw4LjUgTDE2LDMuMTY2NjY2NjcgTDIwLDguNSBMMTcuNDc5ODg1Miw4LjUgQzE3LjE4NTI0NywxMi4xNzM1MTU3IDEzLjY5ODgwMSwxNS41IDEwLDE1LjUgQzYuMzAxMTk5MDIsMTUuNSAyLjgxNDc1MzAzLDEyLjE3MzUxNTcgMi41MjAxMTQ4Myw4LjUgWiIgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIj48L3BhdGg+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=) 10 10, auto"}},{key:"cancelTransformEditing",value:function(){this.markup.syncEditState(),this.rotating=!1,this.editEnd()}},{key:"handleRotation",value:function(e){var t=this.markupsExtension.renderer.worldToClient(e),n=this.markup.getClientCenter(),r=t.clone().sub(n).normalize(),i=st.getSignedAngle(r,this.markupsExtension.renderer.getCameraUpVector(),this.markupsExtension.renderer.getCameraEyeVector());if(this.markupsExtension.markupsTool.shiftDown){var A=st.degreesToRadians(xe);i=Math.ceil((i-st.degreesToRadians(xe/2))/A)*A}this.updateEditState({rotation:i})}},{key:"getRotationAnchor",value:function(){var e=this.markup.getClientBoundingBox(!0),t=e.center().add(new THREE.Vector3(0,Qe+e.size().y/2,0)),n=e.center(),r=this.markup.getRotation()+this.markupsExtension.renderer.getCameraRotation();return st.applyRotation(t,r,n,this.markupsExtension.renderer.absoluteEyeVec),t}},{key:"intersect",value:function(e){e=e.clone();var t=this.markupsExtension.renderer.worldToClient(e);return this.getRotationAnchor().distanceTo(t)<=Ce}},{key:"isDragging",value:function(){return this.rotating}}])&&wn(n.prototype,r),i&&wn(n,i),t}(Xt);function Tn(e){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Un(e,t){return!t||"object"!==Tn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qn(e){return(Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xn(e,t){return(xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Un(this,Qn(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xn(e,t)}(t,e),n=t,(r=[{key:"handleMouseMove",value:function(e){if(this.scaling){var t=e.clone();this.markup.applyInverseRotation(t),this.markup.applyInverseCameraRotation(t),this.handleScaling(t)}return this.scaling}},{key:"handleButtonDown",value:function(e,t){return this.scaling||(this.scaleAnchor=this.intersect(e),this.scaling=!!this.scaleAnchor,this.scaling&&(this.originalPoint=e.clone(),this.editStart())),this.scaling}},{key:"handleButtonUp",value:function(e,t){return!!this.scaling&&(this.scaleAnchor=null,this.scaling=!1,this.isSamePoint(e,this.originalPoint)?this.cancelTransformEditing():(this.submitChanges(),this.editEnd()),!0)}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:if(this.scaling)return this.cancelTransformEditing(),!0}return!1}},{key:"handleDoubleClick",value:function(e,t){return this.scaling}},{key:"getCursor",value:function(){if(this.cursor&&this.scaling)return this.cursor;var e=this.markup.getClientCenter(),t=this.lastIntersectPoint.clone().sub(e).normalize(),n=new THREE.Vector3(1,0,0),r=this.lastIntersectPoint.y<e.y?1:-1,i=st.radiansToDegrees(t.angleTo(n))*r,A=45*Math.ceil((i-22.5)/45);switch(this.cursor=null,A){case 180:case-180:case 0:this.cursor="ew-resize";break;case 90:case-90:this.cursor="ns-resize";break;case 135:case-45:this.cursor="nwse-resize";break;case-135:case 45:this.cursor="nesw-resize"}return this.cursor}},{key:"cancelTransformEditing",value:function(){this.markup.syncEditState(),this.scaleAnchor=null,this.scaling=!1,this.editEnd()}},{key:"handleScaling",value:function(e){var t=this,n=this.markupsExtension.renderer.worldToClient(e);this.originalBoundingBox=st.swapBoundingBoxY(this.markup.getWorldBoundingBox().clone()),this.scaleAnchor.axisList.forEach((function(e){var r=t.getAnchorPosByAxisList([e],!1),i=n.clone().sub(e.clone().multiplyScalar(t.markup.getMarginSize()));t.resize(i,r,e)})),this.updateTranslation()}},{key:"updateTranslation",value:function(){var e=this.scaleAnchor.axisList.reduce((function(e,t){return e.clone().add(t)})),t=st.swapBoundingBoxY(this.markup.getWorldBoundingBox().clone()).size().sub(this.originalBoundingBox.size()).multiply(e).multiplyScalar(.5),n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(t,this.markup.getRotation(),new THREE.Vector3,n);var r=t.add(this.markup.editState.translation);this.updateEditState({translation:r}),this.originalBoundingBox=st.swapBoundingBoxY(this.markup.getWorldBoundingBox().clone())}},{key:"resize",value:function(e,t,n,r){var i=t.clone().add(n),A=It(e,t,i),a=this.markup.getClientBoundingBox(!1),o=this.getOppositePoint(t,a),s=A.clone().sub(o),u=n.clone().multiply(s),l=a.size().multiply(n).length(),c=s.length();if(r||!(c<this.markup.getMinimumSize())){if(!r&&u.x+u.y<0){var h=o.clone().add(n);return this.resize(h,t,n,!0),this.updateTranslation(),n.negate(),this.applyReflection(n),void this.resize(e,h,n,!0)}var d=c/l-1,f=(this.markupsExtension.markupsTool.shiftDown?new THREE.Vector3(1,1,0):new THREE.Vector3(Math.abs(n.x),Math.abs(n.y),Math.abs(n.z))).clone().multiplyScalar(d).addScalar(1).clone().multiply(this.markup.editState.scale);this.updateEditState({scale:f})}}},{key:"intersect",value:function(e){var t=this.getScaleAnchors(),n=e.clone();this.markup.applyInverseRotation(n),this.markup.applyInverseCameraRotation(n);var r=this.markupsExtension.renderer.worldToClient(n);return this.lastIntersectPoint=r,t.find((function(e){return e.pos.distanceTo(r)<=Ce}))}},{key:"isDragging",value:function(){return this.scaling}},{key:"getOppositePoint",value:function(e,t){var n=t.center(),r=e.clone().distanceTo(n),i=e.clone().sub(n).normalize();return e.clone().sub(i.multiplyScalar(2*r))}},{key:"applyReflection",value:function(e){var t=new THREE.Vector3(1,1,1).sub(e.clone().multiply(e).multiplyScalar(2)),n=this.markup.editState.scale.clone();n.multiply(t),this.updateEditState({scale:n})}},{key:"getScaleAnchors",value:function(){return this.getEditState().anchors.length<2?[]:this.options.onlyHorizontal?[this.getEastAnchor(),this.getWestAnchor()]:[this.getEastAnchor(),this.getWestAnchor(),this.getNorthAnchor(),this.getSouthAnchor(),this.getNorthWestAnchor(),this.getSouthWestAnchor(),this.getNorthEastAnchor(),this.getSouthEastAnchor()]}},{key:"getAnchorPosByAxisList",value:function(e,t){var n=this.markup.getClientBoundingBox(t),r=n.center();return e.forEach((function(e){var t=e.clone().multiply(n.size().multiplyScalar(.5));r.add(t)})),r}},{key:"getAnchor",value:function(e,t){return{pos:this.getAnchorPosByAxisList(e,!this.markup.belongsToGroup()),axisList:e,id:t}}},{key:"getNorthAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,1,0)],"n")}},{key:"getSouthAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,-1,0)],"s")}},{key:"getEastAnchor",value:function(){return this.getAnchor([new THREE.Vector3(1,0,0)],"e")}},{key:"getWestAnchor",value:function(){return this.getAnchor([new THREE.Vector3(-1,0,0)],"w")}},{key:"getNorthWestAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,1,0),new THREE.Vector3(-1,0,0)],"nw")}},{key:"getSouthWestAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,-1,0),new THREE.Vector3(-1,0,0)],"sw")}},{key:"getNorthEastAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,1,0),new THREE.Vector3(1,0,0)],"ne")}},{key:"getSouthEastAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,-1,0),new THREE.Vector3(1,0,0)],"se")}}])&&Mn(n.prototype,r),i&&Mn(n,i),t}(Xt);function _n(e){return(_n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ln(e,t){return!t||"object"!==_n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function In(e){return(In=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dn(e,t){return(Dn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var On=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ln(this,In(t).call(this))).undoStack=[],e.redoStack=[],e.isGroupOpen=!1,e.nextActionId=0,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dn(e,t)}(t,Autodesk.Viewing.EventDispatcher),n=t,(r=[{key:"execute",value:function(e){this.clearStack(this.redoStack),e.id=this.nextActionId,this.nextActionId+=1,e.redo(),this.isGroupOpen?this.group.push(e):this.undoStack.push(e),e.trigger=t.EXECUTE,this.notify(e)}},{key:"undo",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(0!==this.undoStack.length)if(this.isGroupOpen)console.warn("Cannot undo while action group is open!");else{var n=this.undoStack.pop();if(e&&this.redoStack.push(n),n instanceof dt)n.undo();else for(var r=n.length-1;r>=0;r--)n[r].undo();n.trigger=t.UNDO,this.notify(n)}}},{key:"redo",value:function(){if(0!==this.redoStack.length)if(this.isGroupOpen)console.warn("Cannot redo while action group is open!");else{var e=this.redoStack.pop();if(this.undoStack.push(e),e instanceof dt)e.redo();else for(var n=0;n<e.length;n++)e[n].redo();e.trigger=t.REDO,this.notify(e)}}},{key:"clear",value:function(){this.clearStack(this.undoStack),this.clearStack(this.redoStack),this.isGroupOpen=!1,this.group=[],this.notify([])}},{key:"clearStack",value:function(e){e.splice(0,e.length)}},{key:"isUndoStackEmpty",value:function(){return 0===this.undoStack.length}},{key:"isRedoStackEmpty",value:function(){return 0===this.redoStack.length}},{key:"notify",value:function(e){e=e instanceof dt?[e]:e,this.dispatchEvent({type:t.HISTORY_CHANGED_EVENT,actionGroup:e,hasUndo:!this.isUndoStackEmpty(),hasRedo:!this.isRedoStackEmpty()})}},{key:"openActionGroup",value:function(){this.isGroupOpen?console.warn("Cannot open a new action group while another one is still open"):(this.group=[],this.undoStack.push(this.group),this.isGroupOpen=!0)}},{key:"closeActionGroup",value:function(){0===this.group.length&&this.undoStack.pop(),this.isGroupOpen=!1}}])&&Hn(n.prototype,r),i&&Hn(n,i),t}();On.HISTORY_CHANGED_EVENT="action-manager.history.changed.event",On.UNDO="action-manager.undo",On.REDO="action-manager.redo",On.EXECUTE="action-manager.execute";var Rn=n(219),Nn=n.n(Rn);function Pn(e){return(Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vn(e){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gn(e,t){return(Gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zn=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=function(e,t){return!t||"object"!==Pn(t)&&"function"!=typeof t?jn(e):t}(this,Vn(t).call(this,e,n,r))).polyFillIE(),i.textboxActive=!1,i.submitChangesDebounced=ct.debounce(i.options.submitChanges||i.submitChanges,Ve),Autodesk.Viewing.isIOSDevice()&&(i.onMarkupEditEnabledBinded=i.onMarkupEditEnabled.bind(jn(i)),i.onMarkupEditDisabledBinded=i.onMarkupEditDisabled.bind(jn(i)),i.onMarkupEditStartBinded=i.onMarkupEditStart.bind(jn(i)),i.onMarkupEditEndBinded=i.onMarkupEditEnd.bind(jn(i)),i.onTouchEndBinded=i.onTouchEnd.bind(jn(i)),i.markupsExtension.markupsManager.addEventListener(A.MARKUP_ENABLE_EDIT,i.onMarkupEditEnabledBinded),i.markupsExtension.markupsManager.addEventListener(A.MARKUP_DISABLE_EDIT,i.onMarkupEditDisabledBinded)),i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gn(e,t)}(t,e),n=t,(r=[{key:"intersect",value:function(e){if(!this.markup.isTextMarkup())return!1;e=e.clone(),this.markup.applyInverseRotation(e),this.markup.applyInverseCameraRotation(e);var t=this.markupsExtension.renderer.worldToClient(e);return this.markup.getClientBoundingBox(!0).containsPoint(t)}},{key:"updateCaretPosition",value:function(){var e=this.markupsExtension.renderer.textRenderer.getLabel(this.markup),t=this.getUpdatedCaretPosition(e);0===t.start&&0===t.end||(this.lastCaretPosition=t)}},{key:"getCursor",value:function(){return"pointer"}},{key:"handleDoubleClick",value:function(e,t){if(Autodesk.Viewing.isIOSDevice())return!1;if(this.intersect(e)){var n=this.markupsExtension.renderer.textRenderer.getLabel(this.markup);return this.lastCaretPosition={start:n.innerText.length,end:n.innerText.length},this.startTextEditing(),!0}return!1}},{key:"handleButtonDown",value:function(e){return this.textboxActive?(this.submitChangesDebounced.flush(),this.endTextEditing(),!0):this.isEmpty()}},{key:"handleButtonUp",value:function(e){return!!this.isEmpty()&&(this.onEmptyTextMarkup(),!0)}},{key:"isEmpty",value:function(){return""===this.markup.editState.text.trim()}},{key:"onEmptyTextMarkup",value:function(){this.options.onEmptyTextMarkup?(this.textboxActive=!1,this.options.onEmptyTextMarkup()):this.deleteEmptyTextMarkup()}},{key:"deleteEmptyTextMarkup",value:function(){this.textboxActive=!1,this.markupsExtension.markupsManager.actionManager.undo(),this.markupsExtension.markupsManager.deleteMarkup(this.markup)}},{key:"onCameraChanged",value:function(e){this.markupsExtension.renderer.textRenderer.getLabel(this.markup).focus()}},{key:"startTextEditing",value:function(e){var t=this,n=this.markupsExtension.renderer.textRenderer.getLabel(this.markup);if(this.label=n,n){this.textboxActive=!0,n.style.position="fixed",n.setAttribute("contenteditable",!0),n.style.webkitUserSelect="text",n.style.userSelect="text",n.style.pointerEvents="auto",n.setAttribute("spellcheck",!1),this.setCaretPosition(n),n.blur(),n.focus();var r=this.getDocument();e&&r.execCommand("selectAll",!1,null),this.onCameraChanged=function(){n.focus()};var i=Autodesk.Viewing.isSafari()||Autodesk.Viewing.isIOSDevice();this.onCameraChangedDebounced=ct.debounce(this.onCameraChanged,5),i&&this.markupsExtension.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedDebounced),this.onKeyDown=function(e){n.focus();var r=n.getBoundingClientRect(),A=t.markupsExtension.viewer.impl.getCanvasBoundingClientRect(),a=t.markup.getTextStyle(),o=Ot("AA",a),s=t.markupsExtension.renderer.getFontToWorldScale(),u=t.markupsExtension.renderer.sizeFromWorldToClient(s),l=function(){return r.bottom+o.height*u>A.bottom-30},c=t.getWindow();switch(e.keyCode){case Autodesk.Viewing.KeyCode.ESCAPE:t.submitChangesDebounced.flush(),t.endTextEditing(),t.textboxActive=!0;break;case Autodesk.Viewing.KeyCode.ENTER:i&&l()?e.preventDefault():t.options.singleLine?e.preventDefault():c.getSelection().anchorNode.firstChild&&"BR"===c.getSelection().anchorNode.firstChild.tagName||0===c.getSelection().anchorOffset?(e.preventDefault(),Autodesk.Viewing.isIE11&&(t.enterPressed=!0)):t.enterPressed=!0;break;case Autodesk.Viewing.KeyCode.BACKSPACE:t.backspacePressed=!0;break;default:i&&(function(){var e=t.getUpdatedCaretPosition(n),i=t.getWindow().getSelection().anchorNode.parentElement;i.value=i.innerText;var a=Nn()(i,e.end);return r.left+(a.left+o.width*u)>A.right-30}()?l()||t.options.singleLine?e.preventDefault():r.right<A.right?t.addNewline=!0:e.preventDefault():l()&&e.preventDefault())}var h=t.lastCaretPosition.end-t.lastCaretPosition.start;!e.metaKey&&e.keyCode>47&&n.innerText.length-h>Je&&e.preventDefault(),Autodesk.Viewing.isIE11&&t.onInput(!0)},this.onKeyUp=function(){t.onInput(!0)},this.onInput=function(e){n.innerText||(n.innerText=Autodesk.Viewing.isIE11?" ":String.fromCharCode(10)),t.lastCaretPosition=t.getUpdatedCaretPosition(n);var r=n.innerText;t.addNewline&&(r+="\r\n"),Autodesk.Viewing.isIE11&&!0===e&&(r=r.replace(/(\r\n){2,}/g,"\r\n"),t.enterPressed&&(r+="\r\n\r\n")),t.options.singleLine||t.expandBoundingBox(r),t.updateEditState({text:r}),t.submitChangesDebounced(),t.enterPressed=!1,t.addNewline=!1,t.backspacePressed=!1},this.onPaste=function(e){e.preventDefault();var r=t.getWindow(),i=t.getDocument(),A=e.clipboardData&&e.clipboardData.getData("text")||r.clipboardData&&r.clipboardData.getData&&r.clipboardData.getData("Text");if(A){var a=t.lastCaretPosition.end-t.lastCaretPosition.start,o=Je+a-n.innerText.length;if(A.length>o&&(A=A.substr(0,o)+"…"),Autodesk.Viewing.isIE11){var s=r.getSelection(),u=s.getRangeAt(0),l=i.createDocumentFragment();l.appendChild(i.createElement("br"));var c=i.createElement("span");c.innerText=A,l.appendChild(c),u.insertNode(l),u.selectNodeContents(c),s.removeAllRanges(),s.addRange(u),i.execCommand("ms-endUndoUnit",!1,null)}else i.execCommand("insertText",!1,A)}},this.onMouseWheel=function(e){var n=new MouseEvent(e.type,e);n.wheelDelta=e.wheelDelta,n.deltaY=e.deltaY,t.markupsExtension.viewer.toolController.domElement.dispatchEvent(n),n.defaultPrevented&&e.preventDefault()},this.onDOMMouseScroll=function(e){var n=new MouseEvent(e.type,e);n.wheelDelta=e.wheelDelta,n.deltaY=e.deltaY,t.markupsExtension.viewer.toolController.domElement.dispatchEvent(n),n.defaultPrevented&&e.preventDefault()},this.onMouseMove=function(e){var n=new MouseEvent(e.type,e);t.markupsExtension.viewer.toolController.domElement.dispatchEvent(n),n.defaultPrevented&&e.preventDefault()},n.addEventListener("keydown",this.onKeyDown),n.addEventListener("keypress",this.onKeyPress),n.addEventListener("input",this.onInput),n.addEventListener("paste",this.onPaste),Autodesk.Viewing.isIE11&&n.addEventListener("keyup",this.onKeyUp),n.addEventListener("mousewheel",this.onMouseWheel),n.addEventListener("DOMMouseScroll",this.onDOMMouseScroll),n.addEventListener("mousemove",this.onMouseMove),n.addEventListener("mouseup",(function(){setTimeout((function(){t.lastCaretPosition=t.getUpdatedCaretPosition(n)}),25)})),n.addEventListener("touchend",(function(){setTimeout((function(){t.lastCaretPosition=t.getUpdatedCaretPosition(n)}),25)})),this.onHistoryChangedBinded=this.onHistoryChanged.bind(this),this.endTextEditingBinded=this.endTextEditing.bind(this),this.onStyleChangedBinded=this.onStyleChanged.bind(this),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_DISABLE_EDIT,this.endTextEditingBinded,{once:!0}),this.markupsExtension.markupsManager.addEventListener(On.HISTORY_CHANGED_EVENT,this.onHistoryChangedBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_STYLE_PROPERTY_CHANGED,this.onStyleChangedBinded),this.markupsExtension.markupsManager.dispatchEvent({type:A.TEXT_EDITING_STARTED})}}},{key:"removeSelection",value:function(){this.getWindow().getSelection().removeAllRanges(),this.label.style.position="absolute",this.label.style.pointerEvents="none",this.label.setAttribute("contenteditable",!1),this.label.style.webkitUserSelect="none",this.label.style.userSelect="none"}},{key:"setCaretPosition",value:function(e){this.lastCaretPosition||(this.lastCaretPosition={start:0,end:e.innerText.length});var t=this.getWindow(),n=this.getDocument().createRange(),r=t.getSelection(),i=Math.min(this.lastCaretPosition.start,e.childNodes[0].length),A=Math.min(this.lastCaretPosition.end,e.childNodes[0].length);n.setStart(e.childNodes[0],i),n.setEnd(e.childNodes[0],A),r.removeAllRanges(),r.addRange(n)}},{key:"getUpdatedCaretPosition",value:function(e){var t,n,r={start:0,end:0},i=this.getWindow();return i.getSelection?(t=i.getSelection()).rangeCount&&((n=t.getRangeAt(0)).commonAncestorContainer.parentNode===e?r={start:n.startOffset,end:n.endOffset}:n.commonAncestorContainer.parentNode.parentNode===e&&(r={start:n.startOffset,end:n.endOffset})):r={start:e.innerText.length,end:e.innerText.length},r}},{key:"onHistoryChanged",value:function(e){var t=this;e.actionGroup.forEach((function(e){e.trigger!==On.UNDO&&e.trigger!==On.REDO||t.markupsExtension.renderer&&t.markupsExtension.renderer.textRenderer.getLabel(t.markup)&&t.endTextEditing()}))}},{key:"endTextEditing",value:function(){if(this.textboxActive&&this.markupsExtension.renderer){var e=this.markupsExtension.renderer.textRenderer.getLabel(this.markup);e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("input",this.onInput),e.removeEventListener("paste",this.onPaste),Autodesk.Viewing.isIE11&&e.removeEventListener("keyup",this.onKeyUp),e.removeEventListener("mousewheel",this.onMouseWheel),e.removeEventListener("DOMMouseScroll",this.onDOMMouseScroll),e.removeEventListener("mousemove",this.onMouseMove),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_DISABLE_EDIT,this.endTextEditingBinded),this.markupsExtension.markupsManager.removeEventListener(On.HISTORY_CHANGED_EVENT,this.onHistoryChangedBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_STYLE_PROPERTY_CHANGED,this.onStyleChangedBinded),this.markupsExtension.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedDebounced),this.getWindow().getSelection().removeAllRanges(),e.style.position="absolute",e.style.pointerEvents="none",e.blur(),e.setAttribute("contenteditable",!1),e.style.webkitUserSelect="none",e.style.userSelect="none",this.textboxActive=!1,this.isEmpty()?this.onEmptyTextMarkup():(this.markup.syncEditState(),this.editEnd()),this.markupsExtension.markupsManager.dispatchEvent({type:A.TEXT_EDITING_ENDED})}}},{key:"onStyleChanged",value:function(){this.textboxActive&&this.onCameraChanged()}},{key:"handleKeyDown",value:function(e,t){return!(!this.textboxActive||e.keyCode!==Autodesk.Viewing.KeyCode.ESCAPE||(this.isEmpty()&&this.onEmptyTextMarkup(),this.textboxActive=!1,0))}},{key:"expandBoundingBox",value:function(e){var t=this.getEditState(),n=t.translation,r=t.scale,i=this.markup.getTextStyle(),A=this.markup.getWorldBoundingBoxTextOnly().size(),a=this.markupsExtension.renderer.getFontToWorldScale(),o=this.markup.getTextWidthInFontScale().width;i.width="".concat(o,"px");var s=Ot(this.markup.editState.text,i),u=Ot(e,i);if((this.enterPressed||this.backspacePressed||this.addNewline)&&u.height!==s.height){var l=(u.height-s.height)*a;this.translateBoundingBox(l)}else if(u.height>s.height){i.width=null;var c=Ot("A",i).width*a;r.multiply(new THREE.Vector3((A.x+c)/A.x,1,1));var h=this.markup.getRotation(),d=new THREE.Vector3(c/2,0,0);if(0!==h){var f=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(d,h,new THREE.Vector3,f)}n.add(d),this.updateEditState({scale:r,translation:n})}}},{key:"translateBoundingBox",value:function(e){var t=this.getEditState().translation,n=this.markup.getBoundingBoxVerticalTranslation(e);t.add(n),this.updateEditState({translation:t})}},{key:"destroy",value:function(){this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_ENABLE_EDIT,this.onMarkupEditStartBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_EDIT_END,this.onMarkupEditEndBinded)}},{key:"polyFillIE",value:function(){var e=this.getWindow();try{return new e.MouseEvent("test"),!1}catch(e){}var t=this,n=function(e,n){var r=t.getWindow();n=n||{bubbles:!1,cancelable:!1};var i=t.getDocument().createEvent("MouseEvent");return i.initMouseEvent(e,n.bubbles,n.cancelable,r,0,n.screenX||0,n.screenY||0,n.clientX||0,n.clientY||0,!1,!1,!1,!1,0,null),i};n.prototype=Event.prototype,e.MouseEvent=n}},{key:"onMarkupEditEnabled",value:function(e){var t=this;e.markup===this.markup&&(this.markupsExtension.markupsManager.hasEventListener(A.MARKUP_EDIT_START,this.onMarkupEditStartBinded)||this.markupsExtension.markupsManager.addEventListener(A.MARKUP_EDIT_START,this.onMarkupEditStartBinded),this.markupsExtension.markupsManager.hasEventListener(A.MARKUP_EDIT_END,this.onMarkupEditEndBinded)||this.markupsExtension.markupsManager.addEventListener(A.MARKUP_EDIT_END,this.onMarkupEditEndBinded),setTimeout((function(){var e=t.markupsExtension.renderer.textRenderer.getLabel(t.markup);e&&(e.addEventListener("touchend",t.onTouchEndBinded),e.style.pointerEvents="auto")}),10))}},{key:"onTouchEnd",value:function(e){e.preventDefault(),e.stopPropagation(),this.startTextEditing()}},{key:"onMarkupEditDisabled",value:function(e){if(e.markup===this.markup){var t=this.markupsExtension.renderer.textRenderer.getLabel(this.markup);t&&(t.removeEventListener("touchend",this.onTouchEndBinded),t.style.pointerEvents="none")}}},{key:"onMarkupEditStart",value:function(e){this.textboxActive&&(this.textboxWasActive=!0),e.markup===this.markup&&e.handler instanceof Sn&&this.removeSelection()}},{key:"onMarkupEditEnd",value:function(e){e.handler instanceof t||e.markup===this.markup&&this.textboxWasActive&&e.handler instanceof Sn&&(this.textboxWasActive=!1,this.startTextEditing())}}])&&Kn(n.prototype,r),i&&Kn(n,i),t}(Xt);function Yn(e){return(Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xn(e,t){return!t||"object"!==Yn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jn(e){return(Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qn(e,t){return(qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zn=function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Xn(this,Jn(t).call(this,e,n,r))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qn(e,t)}(t,e),n=t,(r=[{key:"handleMouseMove",value:function(e){return this.translating&&this.handleMouseTranslation(e),this.translating}},{key:"handleButtonDown",value:function(e,t){if(!this.translating){if(this.translating=this.intersect(e),this.translating){var n=this.markup.getAnchors(),r=n[1].clone().sub(n[0]).normalize(),i=this.markupsExtension.renderer.getCameraEyeVector();this.normal=r.clone().cross(i).normalize(),this.editStart()}return this.translating}return!0}},{key:"getPointOnNormal",value:function(e){var t=this.markup.getAnchors(),n=t[0].clone().add(this.normal);return It(e,t[0],n)}},{key:"handleButtonUp",value:function(e,t){if(this.translating){var n=this.getPointOnNormal(e);return Ht(n,this.lastTranslationPoint,this.getMinChangeDistanceWorld())?this.cancelTransformEditing():this.lastTranslationPoint&&(this.submitChanges(),this.editEnd()),this.translating=!1,this.lastTranslationPoint=null,!0}return!1}},{key:"handleDoubleClick",value:function(e,t){return this.translating}},{key:"getCursor",value:function(){return"move"}},{key:"cancelTransformEditing",value:function(){this.markup.syncEditState(),this.translating=!1,this.lastTranslationPoint=null,this.editEnd()}},{key:"handleMouseTranslation",value:function(e){var t=this.getPointOnNormal(e);this.lastTranslationPoint||(this.lastTranslationPoint=t);var n=t.clone().sub(this.lastTranslationPoint).clone().add(this.markup.state.translation);this.updateEditState({translation:n})}},{key:"intersect",value:function(e){e=e.clone(),this.markup.applyInverseRotation(e);var t=this.markupsExtension.renderer.worldToClient(e);return this.markup.getClientBoundingBox(!0).containsPoint(t)}},{key:"isDragging",value:function(){return this.translating}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:if(this.translating)return this.cancelTransformEditing(),!0}return!1}}])&&Wn(n.prototype,r),i&&Wn(n,i),t}(Xt);function $n(e){return($n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tr(e,t){return!t||"object"!==$n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rr(e,t){return(rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ir=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=tr(this,nr(t).call(this,e,n,i))).onCreationStartCB=i.onCreationStart,r.onCreationEndCB=i.onCreationEnd,r}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rr(e,t)}(t,e),n=t,(r=[{key:"creationStart",value:function(){this.creationStarted=!0,this.onCreationStartCB?this.onCreationStartCB():(this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_DRAWING_START,markup:this.markup}),this.markupsExtension.markupsManager.deselectAllMarkups(),this.markupsExtension.markupsManager.deselectAllLinks(),this.editStart())}},{key:"fixInitialRotation",value:function(){var e,t=this;(this.markup.rotationHandler||this.markup.options.rotationNotAllowed)&&(e=t.markupsExtension.renderer.getCameraRotation(),Math.abs(e)>ke&&function(){for(var n=t.markupsExtension.renderer.getCameraEyeVector(),r=t.markupsExtension.markupsManager.actionManager;!r.isUndoStackEmpty();){var i=r.undoStack[r.undoStack.length-1];if(Array.isArray(i)&&(i=i[i.length-1]),i.markup!==t.markup)break;t.getEditState().anchors.forEach((function(r){st.applyRotation(r,e,t.markup.getWorldCenter(),n)})),t.prevCenter=t.markup.center.clone(),t.markup.setLocked(!0),t.updateEditStateAnchors(),t.updateEditState({rotation:-e}),t.markup.setLocked(!1),t.handleCompensation();var A=ct.cloneDeep(t.getEditState());if(i.markup.state=A,i.markup.editState=A,i.newState&&(i.newState=A),r.isRedoStackEmpty()||(r.redoStack[r.redoStack.length-1].oldState=A),r.isGroupOpen)break;r.undo()}for(;!r.isRedoStackEmpty();)r.redo()}())}},{key:"creationEnd",value:function(e){this.fixInitialRotation(),this.onCreationEndCB?this.onCreationEndCB(e):(this.markup.disableEdit(),this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_DRAWING_END,markup:this.markup}),this.markupsExtension.markupsManager.duringCreationMarkup=null,this.editEnd(),this.markup.complete())}},{key:"creationCancel",value:function(){this.markup.anchorHandler&&this.markup.anchorHandler.cancelAnchorEditing(),this.markup.disableEdit(),this.markup.remove(),this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_DRAWING_CANCEL,markup:this.markup}),this.markupsExtension.markupsManager.duringCreationMarkup=null,this.editEnd()}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:return this.creationCancel(),!0;case Autodesk.Viewing.KeyCode.ESCAPE:return this.onEscape()}return!1}},{key:"onEscape",value:function(){return this.creationCancel(),!0}}])&&er(n.prototype,r),i&&er(n,i),t}(Xt);function Ar(e){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function or(e,t){return!t||"object"!==Ar(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sr(e){return(sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ur(e,t){return(ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),or(this,sr(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ur(e,t)}(t,e),n=t,(r=[{key:"handleMouseMove",value:function(e){var t=this.getEditState().anchors;return t[0]&&(this.creationStarted||this.creationStart(),this.updateRectPoints(t,e)),!0}},{key:"updateRectPoints",value:function(e,t){this.markupsExtension.markupsTool.shiftDown&&this.snapPointToAxis(t,e[0],90,45);var n=this.markupsExtension.renderer.getCameraRightVector(),r=this.markupsExtension.renderer.getCameraUpVector();e[2]=t;var i=e[2].clone().sub(e[0]),A=i.dot(n);e[1]=e[0].clone().add(n.multiplyScalar(A));var a=i.dot(r);e[3]=e[0].clone().add(r.multiplyScalar(a)),this.updateEditStateAnchors()}},{key:"handleButtonDown",value:function(e,t){var n=this.getEditState().anchors;return n[0]||(n[0]=e,this.updateEditStateAnchors()),!0}},{key:"handleButtonUp",value:function(e,t){var n=this.getEditState().anchors;return n[1]?this.isSamePoint(e,n[0])?(this.creationCancel(),!1):(this.updateRectPoints(n,e),this.submitChanges(),this.creationEnd(e),!0):this.handleMouseMove(e,t)}}])&&ar(n.prototype,r),i&&ar(n,i),t}(ir);function cr(e){return(cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dr(e,t){return!t||"object"!==cr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fr(e){return(fr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pr(e,t){return(pr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var gr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),dr(this,fr(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pr(e,t)}(t,e),n=t,(r=[{key:"handleMouseMove",value:function(e){var t=this.getEditState().anchors;if(this.creationStarted||this.creationStart(),t.length>0){this.popTemporaryPoint(),this.markupsExtension.markupsTool.shiftDown&&t.length>0&&this.snapPointToAxis(e,t[t.length-1],xe);var n=this.isClosingLoop(e);n||(t.push(e),this.needPop=!0),this.updateEditState({anchors:t,closed:n})}return!0}},{key:"handleButtonDown",value:function(e,t){var n=this.getEditState().anchors;return 0===n.length&&(n.push(e),this.updateEditStateAnchors()),!0}},{key:"handleButtonUp",value:function(e,t){var n=this.getEditState().anchors;this.creationStarted||this.creationStart(),this.popTemporaryPoint();var r=this.isClosingLoop(e);return(r||this.isNewLocation(e))&&(this.markupsExtension.markupsTool.shiftDown&&n.length>0&&this.snapPointToAxis(e,n[n.length-1],xe),r||n.push(e),this.updateEditState({anchors:n,closed:r}),n.length>1&&this.submitChanges(),r&&this.creationEnd(e)),!0}},{key:"beforeCreationEnd",value:function(){return!0}},{key:"handleDoubleClick",value:function(e,t){return this.getEditState().anchors.length>=this.getMinimumPoints()?(this.popTemporaryPoint(),this.beforeCreationEnd(),this.creationEnd(e)):this.markupsExtension.markupsManager.getMarkupById(this.markup.id)?this.deleteMarkup():this.creationCancel(),!0}},{key:"getMinimumPoints",value:function(){return 2}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:var n=this.getEditState().anchors;return n.length>0&&(this.popTemporaryPoint(),n.pop(),this.updateEditStateAnchors(),n.length>1?this.submitChanges():this.markupsExtension.markupsManager.getMarkupById(this.markup.id)?this.deleteMarkup():this.creationCancel()),!0;case Autodesk.Viewing.KeyCode.ESCAPE:return this.onEscape()}return!1}},{key:"onEscape",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.getEditState(),n=t.anchors;return n.length>0&&(this.popTemporaryPoint(),n.length>=this.getMinimumPoints()?(e&&this.beforeCreationEnd(),this.creationEnd()):this.markupsExtension.markupsManager.getMarkupById(this.markup.id)?this.deleteMarkup():this.creationCancel(),!0)}},{key:"isClosingLoop",value:function(e){var t=this.getEditState().anchors;return t.length>2&&Ht(e,t[0],this.snapDistance())}},{key:"isNewLocation",value:function(e){var t=this.getEditState().anchors;return!(t.length>0&&this.isSamePoint(e,t[t.length-1]))}},{key:"popTemporaryPoint",value:function(){this.needPop&&(this.getEditState().anchors.pop(),this.needPop=!1,this.updateEditStateAnchors())}}])&&hr(n.prototype,r),i&&hr(n,i),t}(ir);function yr(e){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Er(e,t){return!t||"object"!==yr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vr(e){return(vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Br(e,t){return(Br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Er(this,vr(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Br(e,t)}(t,e),n=t,(r=[{key:"beforeCreationEnd",value:function(){this.updateEditState({closed:!0}),this.submitChanges()}},{key:"getMinimumPoints",value:function(){return 3}}])&&mr(n.prototype,r),i&&mr(n,i),t}(gr);function kr(e){return(kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function br(e,t){return!t||"object"!==kr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sr(e){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tr(e,t){return(Tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),br(this,Sr(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tr(e,t)}(t,e),n=t,(r=[{key:"handleMouseMove",value:function(e){return 1===this.getEditState().anchors.length&&this.creationStart(),this.addPoint(e),!0}},{key:"handleButtonDown",value:function(e,t){return this.addPoint(e),!0}},{key:"handleButtonUp",value:function(e,t){return this.addPoint(e),this.submitChanges(),this.creationEnd(e),!0}},{key:"addPoint",value:function(e){var t=this.getEditState().anchors;0!==t.length&&Ht(e,t[t.length-1],this.markupsExtension.renderer.sizeFromClientToWorld(Me))||(t.push(e),t=Gt(t,this.markupsExtension.renderer.sizeFromClientToWorld(.5),!0),this.updateEditStateAnchors(t))}},{key:"handleKeyDown",value:function(e,t){var n=this.getEditState().anchors;switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:return n.length>0&&this.creationCancel(),!0}return!1}}])&&Cr(n.prototype,r),i&&Cr(n,i),t}(ir);function Ur(e){return(Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xr(e,t){return!t||"object"!==Ur(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fr(e){return(Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _r(e,t){return(_r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hr=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=xr(this,Fr(t).call(this,e,n,i))).tailIndex=i.reverseHead?1:0,r.headIndex=i.reverseHead?0:1,r}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_r(e,t)}(t,e),n=t,(r=[{key:"handleMouseMove",value:function(e){var t=this.getEditState().anchors;return t[this.headIndex]||(t[this.headIndex]=t[this.tailIndex]),this.creationStarted||this.creationStart(),t[this.tailIndex]&&(this.markupsExtension.markupsTool.shiftDown&&this.snapPointToAxis(e,t[this.tailIndex],xe),t[this.headIndex]=e,this.updateEditStateAnchors()),!0}},{key:"handleButtonDown",value:function(e,t){var n=this.getEditState().anchors;return n[this.tailIndex]||(n[this.tailIndex]=e,this.updateEditStateAnchors()),!0}},{key:"handleButtonUp",value:function(e,t){var n=this.getEditState().anchors;return n[this.headIndex]?this.isSamePoint(e,n[this.tailIndex])?(this.creationCancel(),!1):(this.markupsExtension.markupsTool.shiftDown&&this.snapPointToAxis(e,n[this.tailIndex],xe),n[this.headIndex]=e,this.updateEditStateAnchors(),this.submitChanges(),this.creationEnd(e),!0):this.handleMouseMove(e,t)}}])&&Qr(n.prototype,r),i&&Qr(n,i),t}(ir);function Lr(e){return(Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dr(e,t){return!t||"object"!==Lr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Or(e){return(Or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rr(e,t){return(Rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Dr(this,Or(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rr(e,t)}(t,e),n=t,(r=[{key:"calculateAnchorsByCenterPoint",value:function(e){var t=this.getEditState(),n=t.anchors,r=t.text,i=this.markupsExtension.renderer.getCameraRightVector(),A=this.markupsExtension.renderer.getCameraUpVector(),a=this.markup.getTextStyle(),o=Ot(r,a),s=this.markupsExtension.renderer.getFontToWorldScale(),u=Math.ceil(o.width)*s,l=o.height*s;n[0]=e.clone().sub(A.clone().multiplyScalar(l/2)).sub(i.clone().multiplyScalar(u/2)),n[1]=n[0].clone().add(i.multiplyScalar(u)),n[2]=n[1].clone().add(A.clone().multiplyScalar(l)),n[3]=n[0].clone().add(A.clone().multiplyScalar(l))}},{key:"handleButtonDown",value:function(e,t){return!0}},{key:"handleButtonUp",value:function(e,t){return!this.didMouseMove()&&this.handleClick(e,t)}},{key:"handleClick",value:function(e,t){return this.calculateAnchorsByCenterPoint(e),this.creationStart(),this.updateEditStateAnchors(),this.submitChanges(),this.creationEnd(e),Autodesk.Viewing.isIOSDevice()||this.markup.textInputHandler.startTextEditing(!0),!0}}])&&Ir(n.prototype,r),i&&Ir(n,i),t}(ir);function Pr(e){return(Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vr(e,t){return!t||"object"!==Pr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jr(e,t,n){return(jr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gr(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Gr(e){return(Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zr(e,t){return(zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yr=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Vr(this,Gr(t).call(this,e,n,r))).measurement=new Autodesk.Viewing.MeasureCommon.Measurement(Autodesk.Viewing.MeasureCommon.MeasurementTypes.MEASUREMENT_DISTANCE),i.snapper=i.markupsExtension.markupsTool.snapper,i.viewer=i.markupsExtension.viewer,i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zr(e,t)}(t,e),n=t,(r=[{key:"getMeasureExtension",value:function(){return this.measureExtension||(this.measureExtension=this.markupsExtension.viewer.getExtension("Autodesk.Measure"),this.measureExtension||console.error("Measure extension not available!")),this.measureExtension}},{key:"handleMouseMove",value:function(e){var t=this.getEditState().anchors;return this.creationStarted||this.creationStart(),t[0]&&(this.markupsExtension.markupsTool.shiftDown&&this.viewer.impl.is2d&&this.snapPointToAxis(e,t[0],90),t[1]||this.updateViewportId(this.measurement.getPick(1).viewportIndex2d),this.pickSecondAnchor(e)),!0}},{key:"handleButtonDown",value:function(e,t){var n=this.getMeasureExtension();if((n.forceCalibrate||this.viewer.model.getData().isLeaflet||this.viewer.model.getData().isPdf)&&!n.calibrationTool.isCalibrated())return n.openCalibrationRequiredDialog("dimension"),this.markupsExtension.markupsManager.dispatchEvent({type:A.CALIBRATION_REQUIRED}),this.creationCancel(),!0;var r=this.getEditState().anchors;if(!r[0]){if(!this.snapper.isSnapped())return!1;this.snapper.copyResults(this.measurement.getPick(1));var i=Autodesk.Viewing.MeasureCommon.getSnapResultPosition(this.snapper.getSnapResult(),this.viewer);r[0]=this.markupsExtension.renderer.documentCameraToMarkupsCamera(i),this.updateEditStateAnchors()}return!0}},{key:"handleButtonUp",value:function(e,t){var n=this.getEditState().anchors;return n[1]?this.isSamePoint(e,n[0])?(this.creationCancel(),!1):(this.markupsExtension.markupsTool.shiftDown&&this.viewer.impl.is2d&&this.snapPointToAxis(e,n[0],90),!!this.pickSecondAnchor(e)&&(this.updateViewportId(),this.submitChanges(),this.creationEnd(e),this.markup.dimensionEditHandler&&this.markup.dimensionEditHandler.handleButtonDown(e,t),!0)):this.handleMouseMove(e,t)}},{key:"pickSecondAnchor",value:function(e){var t=this.getEditState().anchors;if(this.markupsExtension.markupsTool.shiftDown&&this.viewer.impl.is2d){var n=this.markupsExtension.renderer.worldToClient(e);this.snapper.onMouseMove({x:n.x,y:n.y})}var r=this.measurement.getPick(2),i=this.snapper.isSnapped();i?(this.snapper.copyResults(r),t[1]=Autodesk.Viewing.MeasureCommon.getSnapResultPosition(this.snapper.getSnapResult(),this.viewer)):(t[1]=e,r.geomType=Autodesk.Viewing.MeasureCommon.SnapType.SNAP_VERTEX,r.geomVertex=e,r.intersectPoint=e),Autodesk.Viewing.MeasureCommon.correctPerpendicularPicks(this.measurement.getPick(1),this.measurement.getPick(2),this.viewer,this.snapper)&&(t[1]=Autodesk.Viewing.MeasureCommon.getSnapResultPosition(this.measurement.getPick(2),this.viewer),this.snapper.indicator.render()),i&&(t[1]=this.markupsExtension.renderer.documentCameraToMarkupsCamera(t[1]));var A=i||this.viewer.impl.is2d?this.getDistance():"";return this.updateEditState({text:A,anchors:t}),i}},{key:"creationCancel",value:function(){jr(Gr(t.prototype),"creationCancel",this).call(this),this.updateViewportId()}},{key:"updateViewportId",value:function(e){this.viewer.model&&this.viewer.impl.is2d&&(e?(this.viewer.impl.updateViewportId(e),this.snapper.setViewportId(e)):(this.viewer.impl.updateViewportId(0),this.snapper.setViewportId(null)))}},{key:"getDistance",value:function(){var e=this.getMeasureExtension().sharedMeasureConfig;if(this.measurement.computeResult(this.measurement.picks,this.markupsExtension.viewer),this.markupsExtension.viewer.model&&this.measurement.distanceXYZ){var t=Autodesk.Viewing.Private.convertUnits(this.markupsExtension.viewer.model.getUnitString(),e.units,e.calibrationFactor,this.measurement.distanceXYZ);return Autodesk.Viewing.Private.formatValueWithUnits(t,e.units,3,e.precision)}return null}}])&&Kr(n.prototype,r),i&&Kr(n,i),t}(ir);function Wr(e){return(Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jr(e,t){return!t||"object"!==Wr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qr(e,t,n){return(qr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zr(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Zr(e){return(Zr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $r(e,t){return($r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ei(e){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ti(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ni(e,t){return!t||"object"!==ei(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ri(e){return(ri=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ii(e,t){return(ii=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ai=function(e){function t(e,n,r,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ni(this,ri(t).call(this,e,n,r,i))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ii(e,t)}(t,e),n=t,(r=[{key:"afterNextMarkupCreated",value:function(e){if(e===this.getTextIndex()){var t,n=this.getArrow(),r=this.getText(),i=r.getWorldBoundingBox(!0),A=r.editState.style[l.THICKNESS]/2,a=i.size().y/2-A,o=i.size().x/2-A,s=n.getHead(),u=n.getTail(),c=Math.atan2(s.y-u.y,s.x-u.x);switch(this.markup.getTextQuadrant(c)){case 1:t=new THREE.Vector3(0,a,0);break;case 2:t=new THREE.Vector3(-o,0,0);break;case 3:t=new THREE.Vector3(0,-a,0);break;case 4:t=new THREE.Vector3(o,0,0)}if(r.editState.frameType===v){var h=t.clone().negate(),d=this.markup.getVectorToClosestPointOnCloud(h);t.add(d)}r.creationHandler.updateEditState({translation:t}),r.creationHandler.submitChanges()}}},{key:"getArrowIndex",value:function(){throw new Error("getArrowIndex needs implementation")}},{key:"getTextIndex",value:function(){throw new Error("getTextIndex needs implementation")}},{key:"getArrow",value:function(){return this.markup.markups[this.getArrowIndex()]}},{key:"getText",value:function(){return this.markup.markups[this.getTextIndex()]}}])&&ti(n.prototype,r),i&&ti(n,i),t}(function(e){function t(e,n,r){var i,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Jr(this,Zr(t).call(this,e,n,r))).creationHandlers=[],i.currentStep=0,i.lastCompleted=-1,i.markup.markups=[];var a=[];i.markup.state.uuid?a=i.markup.state.componentsState.sort((function(e,t){return e.groupOrder-t.groupOrder})):i.markup.editState.uuid=THREE.Math.generateUUID(),i.markupClasses=A,i.numMarkups=A.length;for(var o=0;o<i.numMarkups;o++){var s=A[o].class,u=A[o].options||{};i._restoreFill(a[o],A[o],a);var l=o===A.length-1;u.onCreationEnd=function(e){i.onCreationEnd(e)},u.onCreationStart=function(){i.onCreationStart()};var c=i.markupsExtension.markupsManager.createMarkup(s,a[o],u);l||(c.selectWhenCompleted=function(){return!1}),c.markupGroup=i.markup,c.editState.groupId=i.markup.editState.uuid,c.editState.groupOrder=o,i.markup.markups.push(c),i.creationHandlers.push(c.creationHandler)}return delete i.markup.state.componentsState,i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$r(e,t)}(t,e),n=t,(r=[{key:"_restoreFill",value:function(e,t,n){if(e&&t.options.fillNotAllowed)for(var r=0;r<this.numMarkups;r++)if(!(t===this.markupClasses[r]||this.markupClasses[r].options&&this.markupClasses[r].options.fillNotAllowed)){e.style[l.FILL_OPACITY]=n[r].style[l.FILL_OPACITY],e.style[l.FILL_COLOR]=n[r].style[l.FILL_COLOR];break}}},{key:"handleMouseMove",value:function(e){return this.creationHandlers[this.currentStep].handleMouseMove(e)}},{key:"handleButtonDown",value:function(e,t){return this.creationHandlers[this.currentStep].handleButtonDown(e,t)}},{key:"handleButtonUp",value:function(e,t){return this.creationHandlers[this.currentStep].handleButtonUp(e,t)}},{key:"handleDoubleClick",value:function(e,t){return this.creationHandlers[this.currentStep].handleDoubleClick(e,t)}},{key:"creationCancel",value:function(){for(qr(Zr(t.prototype),"creationCancel",this).call(this),this.markupsExtension.markupsManager.closeActionGroup();this.currentStep-- >0;)this.markupsExtension.markupsManager.actionManager.undo(!1)}},{key:"onCreationStart",value:function(){0===this.currentStep&&(this.markupsExtension.markupsManager.openActionGroup(),this.creationStart()),this.markup.markups[this.currentStep].setVisible(!0),this.markup.markups[this.currentStep].enableEdit()}},{key:"closeGroup",value:function(){this.lastCompleted===this.currentStep&&this.markupsExtension.markupsManager.closeActionGroup(),this.lastCompleted=this.currentStep}},{key:"onCreationEnd",value:function(e){if(this.markup.markups[this.currentStep].disableEdit(),this.markup.markups[this.currentStep].complete(),this.currentStep===this.numMarkups-1)this.submitChanges(),this.creationEnd(e);else{var t=this.markup.markups[this.currentStep].getStartPointForNextMarkup();this.currentStep+=1,this.markupClasses[this.currentStep].options.requiresClick?this.creationHandlers[this.currentStep].handleClick(t):this.creationHandlers[this.currentStep].handleButtonDown(t),this.afterNextMarkupCreated(this.currentStep)}this.closeGroup()}},{key:"afterNextMarkupCreated",value:function(e){}}])&&Xr(n.prototype,r),i&&Xr(n,i),t}(ir));function ai(e){return(ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function si(e,t){return!t||"object"!==ai(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ui(e){return(ui=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function li(e,t){return(li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ci=function(e){function t(e,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),si(this,ui(t).call(this,e,n,r,[{class:y,options:{reverseHead:!0,tailHandlingNotAllowed:!0}},{class:S,options:{requiresClick:!0,rotationNotAllowed:!0,frameType:r.calloutFrameType?r.calloutFrameType:m}}]))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&li(e,t)}(t,e),n=t,(r=[{key:"getArrowIndex",value:function(){return 0}},{key:"getTextIndex",value:function(){return 1}}])&&oi(n.prototype,r),i&&oi(n,i),t}(Ai);function hi(e){return(hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function di(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fi(e,t){return!t||"object"!==hi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pi(e){return(pi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gi(e,t){return(gi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yi=function(e){function t(e,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fi(this,pi(t).call(this,e,n,r,[{class:v,options:{fillNotAllowed:!0,rotationNotAllowed:!0}},{class:y,options:{reverseHead:!0,headHandlingNotAllowed:!0,tailHandlingNotAllowed:!0}},{class:S,options:{requiresClick:!0,rotationNotAllowed:!0,frameType:r.calloutFrameType?r.calloutFrameType:m}}]))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gi(e,t)}(t,e),n=t,(r=[{key:"getArrowIndex",value:function(){return 1}},{key:"getTextIndex",value:function(){return 2}}])&&di(n.prototype,r),i&&di(n,i),t}(Ai);function mi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ei=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getCreationHandler",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};switch(e){case y:case Q:return new Hr(t,n,r);case m:case E:case v:return new lr(t,n,r);case B:case w:return new Mr(t,n,r);case C:return new wr(t,n,r);case k:return new gr(t,n,r);case S:return new Nr(t,n,r);case U:return new Yr(t,n,r);case T:return new ci(t,n,r);case M:return new yi(t,n,r)}throw new Error("".concat(e," creation handler does not exist"))}}],(n=null)&&mi(t.prototype,n),r&&mi(t,r),e}(),vi=n(220),Bi=n.n(vi),wi=n(221),ki=n.n(wi);function Ci(e){this.supportsInt32Index=e}function bi(e){function t(e,t){return void 0===e?t:e}THREE.Material.call(this),e=e||{},this.lineWidth=t(e.lineWidth,1),this.miter=t(e.miter,!0),this.color=t(e.color,new THREE.Color(16777215)),this.opacity=t(e.opacity,1),this.resolution=t(e.resolution,new THREE.Vector2(1,1));var n=new THREE.RawShaderMaterial({uniforms:{lineWidth:{type:"f",value:this.lineWidth},color:{type:"c",value:this.color},opacity:{type:"f",value:this.opacity},resolution:{type:"v2",value:this.resolution}},vertexShader:Bi.a,fragmentShader:ki.a,attributes:{previous:{type:"v2",value:new THREE.Vector2},next:{type:"v2",value:new THREE.Vector2},side:{type:"f",value:0},width:{type:"f",value:0},counters:{type:"f",value:0}}});return n.type="MeshLineMaterial",Autodesk.Viewing.isIE11&&(n.defines.IS_IE_11=1),this.miter&&(n.defines.MITER=1),delete e.lineWidth,delete e.color,delete e.opacity,delete e.resolution,delete e.miter,n.setValues(e),n}function Si(e,t,n,r,i,A){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.333,o=Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2)),s=a*o/(o+Math.sqrt(Math.pow(i-n,2)+Math.pow(A-r,2))),u=a-s;return[{x:n+s*(e-i),y:r+s*(t-A)},{x:n-u*(e-i),y:r-u*(t-A)}]}function Ti(e,t,n,r){var i=r*r,A=1-r,a=A*A,o=a*e.x;o+=2*A*r*t.x,o+=i*n.x;var s=a*e.y;return s+=2*A*r*t.y,{x:o,y:s+=i*n.y,z:0}}function Mi(e,t,n,r,i){var A=i*i,a=A*i,o=1-i,s=o*o,u=s*o,l=u*e.x;l+=3*s*i*t.x,l+=3*o*A*n.x,l+=a*r.x;var c=u*e.y;return c+=3*s*i*t.y,c+=3*o*A*n.y,{x:l,y:c+=a*r.y,z:0}}Ci.prototype.create=function(){this.geometry=new THREE.BufferGeometry},Ci.prototype.dispose=function(){if(this.geometry&&(this.geometry.dispose(),this.geometry=null),this.attributes){for(var e in this.attributes)delete this.attributes[e].array;this.attributes=null}this.positions=null,this.previous=null,this.next=null,this.side=null,this.width=null,this.counters=null,this.indices_array=null},Ci.prototype.setGeometry=function(e,t,n,r){var i=this;this.sourceGeo=e,Array.isArray(t)?(this.widthArray=t,this.widthCallback=function(e){return i.widthArray[e]}):this.widthCallback=t,this.sourceConnectivity=n||[],this.connectivity={},this.options=Object.assign({},{capType:g,joinType:g,useExactSize:!1},r),this.isClosed=!!this.options.isClosed,this.process()},Ci.prototype.isPointNear=function(){var e=new THREE.Vector3,t=new THREE.Vector3;function n(n){var r=e.x,i=e.y,A=t.x-r,a=t.y-i;if(0!==A||0!==a){var o=((n.x-r)*A+(n.y-i)*a)/(A*A+a*a);o>1?(r=t.x,i=t.y):o>0&&(r+=A*o,i+=a*o)}return(A=n.x-r)*A+(a=n.y-i)*a}return function(r,i,A){for(var a=0,o=this.numPoints-1;a<o;a++)if(this.connectivity[a]!==d&&(e.fromArray(this.positions,6*a).applyMatrix4(A),t.fromArray(this.positions,6*(a+1)).applyMatrix4(A),n(r)<i))return!0;return!1}}(),Ci.prototype.getPositionV3=function(e){var t=6*e;return[this.positions[t],this.positions[t+1],this.positions[t+2]]},Ci.prototype.initArrays=function(e){var t=this.options.useExactSize;if(!this.capacity||this.capacity<e||t&&this.capacity!==e){this.dispose();var n=t?e:Math.ceil(1.5*e);this.positions=new Float32Array(6*n),this.previous=new Float32Array(4*n),this.next=new Float32Array(4*n),this.side=new Float32Array(2*n),this.width=new Float32Array(2*n),this.counters=new Float32Array(2*n);var r=6*(n-1);this.indices_array=this.supportsInt32Index&&r>65535?new Uint32Array(r):new Uint16Array(r),this.capacity=n}this.numPoints=e},Ci.prototype.getWidth=function(e,t){return this.widthCallback?this.widthCallback(e,t):1},Ci.prototype.process=function(){var e=this,t=this.sourceGeo.length,n=Math.max(1,t-1),r=function(t,r,i,A){var a=e.sourceGeo[t];e.positions.set([a.x,a.y,a.z,a.x,a.y,a.z],6*r),e.counters.set([i,i],2*r),e.side.set([A,-A],2*r);var o=e.getWidth(t,t/n);e.width.set([o,o],2*r)},i=0,A=function(){e.attributes?(e.attributes.position.array=e.positions,e.attributes.position.needsUpdate=!0,e.attributes.previous.array=e.previous,e.attributes.previous.needsUpdate=!0,e.attributes.next.array=e.next,e.attributes.next.needsUpdate=!0,e.attributes.side.array=e.side,e.attributes.side.needsUpdate=!0,e.attributes.width.array=e.width,e.attributes.width.needsUpdate=!0,e.attributes.index.array=e.indices_array,e.attributes.index.needsUpdate=!0,e.attributes.counters.array=e.counters,e.attributes.counters.needsUpdate=!0):(e.create(),e.attributes={position:new THREE.BufferAttribute(e.positions,3),previous:new THREE.BufferAttribute(e.previous,2),next:new THREE.BufferAttribute(e.next,2),side:new THREE.BufferAttribute(e.side,1),width:new THREE.BufferAttribute(e.width,1),index:new THREE.BufferAttribute(e.indices_array,1),counters:new THREE.BufferAttribute(e.counters,1)},e.geometry.addAttribute("position",e.attributes.position),e.geometry.addAttribute("previous",e.attributes.previous),e.geometry.addAttribute("next",e.attributes.next),e.geometry.addAttribute("side",e.attributes.side),e.geometry.addAttribute("width",e.attributes.width),e.geometry.addAttribute("index",e.attributes.index),e.geometry.addAttribute("counters",e.attributes.counters))};if(0!==t){this.isClosed&&this.options.joinType!==p||(this.sourceConnectivity[0]=h,this.sourceConnectivity[t-1]=d);var a=t+this.sourceConnectivity.reduce((function(e){return e+1}),0);this.initArrays(a);for(var o=0,s=0;s<t;s++)if(this.sourceConnectivity[s]===h){var u=0!==s||this.isClosed?this.options.joinType:this.options.capType;this.connectivity[o]=h,r(s,o++,-1,u),r(s,o++,0,u)}else if(this.sourceConnectivity[s]===d){var l=s!==t-1||this.isClosed?this.options.joinType:this.options.capType;r(s,o++,1,l),this.connectivity[o]=d,r(s,o++,2,l)}else r(s,o++,s/n,f);!function(){var t;t=e.isClosed?e.getPositionV3(a-2):e.getPositionV3(0),e.previous.set([t[0],t[1],t[0],t[1]],0);for(var n=1;n<a;n++)t=e.connectivity[n]===h?e.getPositionV3(n):e.connectivity[n]===d?e.getPositionV3(n-2):e.getPositionV3(n-1),e.previous.set([t[0],t[1],t[0],t[1]],4*n)}(),function(){for(var t,n=0;n<a-1;n++)t=e.connectivity[n]===d?e.getPositionV3(n):e.connectivity[n]===h?e.getPositionV3(n+2):e.getPositionV3(n+1),e.next.set([t[0],t[1],t[0],t[1]],4*n);t=e.isClosed?e.getPositionV3(1):e.getPositionV3(a-1),e.next.set([t[0],t[1],t[0],t[1]],4*(a-1))}(),function(){for(var t=0;t<a-1;t++)if(e.connectivity[t]!==d){var n=2*t;e.indices_array.set([n,n+1,n+2,n+2,n+1,n+3],i),i+=6}}(),A(),this.geometry.offsets[0]={index:0,start:0,count:i}}else A()},bi.prototype=Object.create(THREE.Material.prototype),bi.prototype.constructor=bi,bi.prototype.copy=function(e){return THREE.Material.prototype.copy.call(this,e),this.lineWidth=e.lineWidth,this.color.copy(e.color),this.opacity=e.opacity,this.resolution.copy(e.resolution),this.miter=e.miter,this};var Ui=function(e){for(var t,n,r,i,A=0,a=1;a<e.length;a++)A+=(t=e[a],n=e[a-1],r=void 0,i=void 0,r=t.x-n.x,i=t.y-n.y,Math.sqrt(r*r+i*i));return A};function Qi(e,t,n,r,i,A){for(var a=Math.max(Math.round(Ui([e,t,n])/r),4),o=0;o<a;o++){var s=o/a,u=Ti(e,t,n,s);i.push(u),A&&A.push(e.width+s*s*(n.width-e.width))}}function xi(e,t,n,r,i,A,a){for(var o=Math.max(Math.round(Ui([e,t,n,r])/i),4),s=0;s<o;s++){var u=s/o,l=Mi(e,t,n,r,u);A.push(l),a&&a.push(e.width+u*u*u*(r.width-e.width))}}function Fi(e,t,n){if(e.length<3)return{anchors:e};for(var r=[],i=[],A=n?[]:null,a=e.length,o=0;o<a-2;o++)r=r.concat(Si(e[o].x,e[o].y,e[o+1].x,e[o+1].y,e[o+2].x,e[o+2].y));Qi(e[0],r[0],e[1],t,i,A);for(var s=1;s<a-3;s++)xi(e[s],r[2*s-1],r[2*s],e[s+1],t,i,A);return Qi(e[a-2],r[2*a-5],e[a-1],t,i,A),i.push(e[a-1]),A&&A.push(e[a-1].width),{anchors:i,widths:A}}function _i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Hi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.geoCache={}}var t,n,r;return t=e,r=[{key:"areAllAnchorsEqual",value:function(e){for(var t=e[0],n=1;n<e.length;n++)if(!e[n].equals(t))return!1;return!0}}],(n=[{key:"getStrokeGeometry",value:function(t){return this._isCacheSupported(t.type)?this._getCachedStrokeGeometry(t.type):e.areAllAnchorsEqual(t.editState.anchors)?this._createPointGeometry(t):this._createStrokeGeometry(t)}},{key:"getFillGeometry",value:function(e){switch(e.type){case v:case C:var t={innerGeometry:this._getFillInnerGeometryFromAnchors(e)};return e.meshLine.type!==E&&(t.arcGeometry=this._getFillCircleGeometry(e.meshLine.radius),t.fillGapGeometries=this._getFillingGapsGeometry(e)),t;case k:return this._getFillInnerGeometryFromAnchors(e);case E:return this._getFillCircleGeometry(.5,72);case m:return this._getFillRectangleGeometry();default:return null}}},{key:"_getFillingGapsGeometry",value:function(e){for(var t=[],n=0;n<e.meshLine.intersectionObjects.length;n++){var r=e.meshLine.intersectionObjects[n],i=r.beginPoint,A=r.endPoint,a=r.newCircle,o=r.anchorPoint,s=r.beginCircle,u=r.endCircle;if(!(i&&A&&o&&s&&u&&a))return null;var l=[];l.push(new THREE.Vector3(o.x,o.y,0)),l.push(new THREE.Vector3(s.x,s.y,0)),l.push(new THREE.Vector3(i.x,i.y,0)),l.push(new THREE.Vector3(a.x,a.y,0)),l.push(new THREE.Vector3(A.x,A.y,0)),l.push(new THREE.Vector3(u.x,u.y,0)),t.push(new THREE.ShapeGeometry(new THREE.Shape(l)))}return t}},{key:"_getFillCircleGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n="circle-fill|r:"+e+"|s:"+t;return this.geoCache[n]||(this.geoCache[n]=new THREE.CircleGeometry(e,t)),this.geoCache[n]}},{key:"_getFillRectangleGeometry",value:function(){return this.geoCache["rectangle-fill"]||(this.geoCache["rectangle-fill"]=new THREE.PlaneBufferGeometry(1,1,1,1)),this.geoCache["rectangle-fill"]}},{key:"_getFillInnerGeometryFromAnchors",value:function(e){if(e.meshLine.type===E)return this._getFillCircleGeometry(.5,10);var t=ct.cloneDeep(e.getAnchors());return this._centerAndScaleLocations(t,e.center,e.scaleMatrix),e.meshLine.type===v&&this._shiftAnchorsInsideBox(e,t,e.meshLine.radius),t.length>2?new THREE.ShapeGeometry(new THREE.Shape(t)):null}},{key:"_getCachedStrokeGeometry",value:function(e){var t=e;return this.geoCache[t]||(this.geoCache[t]=this._createCachedStrokeGeometry(e)),this.geoCache[t]}},{key:"_isCacheSupported",value:function(e){return[m,E].includes(e)}},{key:"isCachedGeometry",value:function(e){for(var t in this.geoCache)if(e===this.geoCache[t])return!0;return!1}},{key:"_createCachedStrokeGeometry",value:function(e){switch(e){case m:return this._createRectangleStrokeGeometry();case E:return this._createCircleStrokeGeometry();default:return null}}},{key:"_createStrokeGeometry",value:function(e){switch(e.type){case v:case C:var t=this._createCloudGeometry(e);return t||(t=this._getCachedStrokeGeometry(E)),t;case k:case Q:return this._createLineGeometry(e,179);case B:case w:return this._createLineGeometry(e,120);case y:return this._createArrowGeometry(e);case U:return this._createDimensionGeometry(e);default:return null}}},{key:"_createPointGeometry",value:function(e){var t,n;switch(e.type){case v:case C:case B:case w:t=p,n=rt*this.markupsExtension.renderer.mmToWorldUnitFactor;break;default:t=g,n=this.markupsExtension.renderer.getNormaStrokeWidth()}var r=[{x:0,y:0,z:0},{x:n,y:0,z:0}];return this._createMeshLine(r,e.type,e,null,{capType:t})}},{key:"_createMeshLine",value:function(e,t,n,r){var i,A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return n?(i=n.meshLine,A.useExactSize=n.completed):A.useExactSize=!0,i&&i.type===t||(i=new Ci(this.markupsExtension.renderer.supportsInt32Index())),i.type=t,i.setGeometry(e,a,r,A),i}},{key:"_createRectangleStrokeGeometry",value:function(){return this._createMeshLine([{x:-.5,y:-.5,z:0},{x:.5,y:-.5,z:0},{x:.5,y:.5,z:0},{x:-.5,y:.5,z:0},{x:-.5,y:-.5,z:0}],m,null,null,{isClosed:!0})}},{key:"_createCircleStrokeGeometry",value:function(){var e=Rt(0,0,.5,0,2*Math.PI,!1,72);return this._createMeshLine(e,E,null,null,{isClosed:!0})}},{key:"_centerAndScaleLocations",value:function(e,t,n){e.forEach((function(e){e.sub(t),e.applyMatrix4(n)}))}},{key:"_createLineGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:29,n=e.type===B||e.type===w,r=ct.cloneDeep(e.getEditState().anchors);this._centerAndScaleLocations(r,e.center,e.scaleMatrix);var i=[],A=null;if(e.editState.closed&&r.push(r[0]),n){var a=.5*e.markupsExtension.renderer.mmToWorldUnitFactor,o=!1,s=Fi(r,a,o);r=s.anchors,A=s.widths}for(var u=new THREE.Vector3,l=new THREE.Vector3,c=Math.cos(t*Math.PI/180),h=1;h<r.length-1;h++)u.copy(r[h-1]).sub(r[h]).normalize(),l.copy(r[h+1]).sub(r[h]).normalize(),l.dot(u)>c&&(r.splice(h,0,r[h]),A&&A.splice(h,0,A[h]),i[h]=d,h++);return e.editState.closed&&(u.copy(r[r.length-2]).sub(r[r.length-1]).normalize(),l.copy(r[1]).sub(r[0]).normalize(),l.dot(u)>c&&(r.push(r[0]),A&&A.push(A[0]))),this._createMeshLine(r,e.type,e,i,{capType:n?p:g,joinType:p,isClosed:e.editState.closed},A)}},{key:"_createArrowGeometry",value:function(e){var t=e.editState.style[l.THICKNESS],n=ct.cloneDeep(e.getEditState().anchors);n[0].sub(e.center),n[1].sub(e.center);var r=n[1].clone().sub(n[0]),i=this.markupsExtension.renderer.getCameraEyeVector(),A=Math.min(t*we,r.length()/2),a=[],o=A>t;if(o){var s=r.clone().normalize(),u=n[1].clone().sub(s.multiplyScalar(A)),c=st.degreesToRadians(30);n[2]=u.clone(),st.applyRotation(n[2],c,n[1],i),n[3]=n[1].clone(),n[4]=u.clone(),st.applyRotation(n[4],-c,n[1],i),a[1]=d,a[2]=h}var f=this._createMeshLine(n,e.type,e,a);return o&&(n[0].add(e.center),n[1].add(e.center),n[2].add(e.center),n[4].add(e.center),f.boundingPoints=[n[0],n[2],n[1],n[4]]),f}},{key:"_createDimensionGeometry",value:function(e){var t=e.editState.style[l.THICKNESS]*Ge,n=ct.cloneDeep(e.getEditState().anchors),r=[],i=[];function A(e,t){r=r.concat([e,t]),i=i.concat([h,d])}n[0].sub(e.center),n[1].sub(e.center),A(n[0],n[1]);var a=n[0].clone().sub(n[1]),o=this.markupsExtension.renderer.getCameraEyeVector(),s=a.clone().cross(o).normalize(),u=t*je,c=s.clone().multiplyScalar(u),f=st.degreesToRadians(45);return n[2]=n[0].clone().add(c),n[3]=n[0].clone().sub(c),st.applyRotation([n[2],n[3]],f,n[0],o),A(n[2],n[3]),n[4]=n[1].clone().add(c),n[5]=n[1].clone().sub(c),st.applyRotation([n[4],n[5]],f,n[1],o),A(n[4],n[5]),n[6]=n[0].clone(),e.applyInverseScaleAndTranslation(n[6]),Ht(n[6],n[0])||(n[7]=n[0].clone().sub(n[0].clone().sub(n[6]).normalize().multiplyScalar(u)),A(n[6],n[7])),n[8]=n[1].clone(),e.applyInverseScaleAndTranslation(n[8]),Ht(n[8],n[1])||(n[9]=n[1].clone().sub(n[1].clone().sub(n[8]).normalize().multiplyScalar(u)),A(n[8],n[9])),n[10]=n[0].clone().add(c),n[11]=n[0].clone().sub(c),A(n[10],n[11]),n[12]=n[1].clone().add(c),n[13]=n[1].clone().sub(c),A(n[12],n[13]),this._createMeshLine(r,e.type,e,i)}},{key:"_createCloudGeometry",value:function(e){var t=ct.cloneDeep(e.getEditState().anchors);(function(e,t){for(var n=0,r=0;r<e.length;r++){var i=e[r],A=e[(r+1)%e.length];n+=(A.x-i.x)*(A.y+i.y)}return n*t.scaleMatrix.elements[0]*t.scaleMatrix.elements[5]>0})(t,e)&&t.reverse();var n=this.getCloudMinimumRadius(e.editState.style[l.THICKNESS]),r=n/this.markupsExtension.renderer.mmToWorldUnitFactor;this._centerAndScaleLocations(t,e.center,e.scaleMatrix);var i,A=e.editState.closed;if(e.type===v){if(A=!0,!this._shiftAnchorsInsideBox(e,t,n))return null}else(i=new THREE.Box3).min.z=i.max.z=0;var a=function(e,t,n){for(var r=e.length,i=[],A=0;A<r;A++){var a=e[0===A?r-1:A-1],o=e[A],s=e[(A+1)%r];if(!o||!s)break;var u=Math.atan2(o.y-a.y,o.x-a.x),l={};l.p1=new THREE.Vector3(a.x+Math.cos(u-Math.PI/2)*t,a.y+Math.sin(u-Math.PI/2)*t,1),l.p2=new THREE.Vector3(o.x+Math.cos(u-Math.PI/2)*t,o.y+Math.sin(u-Math.PI/2)*t,1);var c=Math.atan2(s.y-o.y,s.x-o.x),h={};h.p1=new THREE.Vector3(o.x+Math.cos(c-Math.PI/2)*t,o.y+Math.sin(c-Math.PI/2)*t,1),h.p2=new THREE.Vector3(s.x+Math.cos(c-Math.PI/2)*t,s.y+Math.sin(c-Math.PI/2)*t,1);var d=Vt(l.p1,l.p2,h.p1,h.p2);if(d.onBothLines){var f=new THREE.Vector3(o.x-a.x,o.y-a.y,0),p=new THREE.Vector3(s.x-o.x,s.y-o.y,0);f.normalize(),p.normalize(),f.multiplyScalar(-1);var g=(new THREE.Vector3).crossVectors(f,p),y=Math.asin(g.z),m=f.dot(p);Math.atan2(y,m)<Math.PI/2&&(o["isCurrentIntersection"+i.length]=!0,s["isNextIntersection"+i.length]=!0,o.intersects=i,s.intersects=i,i.push(d))}}return i}(t,n),o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.8,A=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];function o(e,t,n){var r=t.x-e.x,i=t.y-e.y,A=.5*Math.sqrt(r*r+i*i)/n;A<-1&&(A=-1),A>1&&(A=1);var a=Math.atan2(i,r),o=Math.acos(A);return[a-o,Math.PI+a+o]}var s=[],u=2*t*i,l=n?e[e.length-1]:e[0];a=a||!n;for(var c=n?0:1;c<e.length;c++){var h=e[c],d=h.x-l.x,f=h.y-l.y,p=Math.sqrt(d*d+f*f);d/=p,f/=p;var g=0,y=0;n||(1===c?(p-=t,l.x+=d*t,l.y+=f*t,g=Math.atan2(f,d)+Math.PI):c===e.length-1&&(y=Math.atan2(f,d)));var m=u;if(a){var E=p/u+.5|0;E<1&&(E=1),m=p/E}for(var v=0;v+.1*m<p;v+=m){s.push({x:l.x+v*d,y:l.y+v*f,begin:g,end:y,isAnchor:0===v});for(var B=0;B<r.length;B++)s[s.length-1]["isNextIntersection"+B]=h["isNextIntersection"+B],s[s.length-1]["isCurrentIntersection"+B]=h["isCurrentIntersection"+B],h["isNextIntersection"+B]&&0===v&&(r[B].anchorPoint=s[s.length-1])}l=h}var w=st.degreesToRadians(A);l=s[s.length-1];for(var k=0;k<s.length;k++){var C=s[k],b=o(l,C,t);(n||0!==k)&&(l.end=b[0]+w,C.begin=b[1]),l=C}Pt(s,t,r);for(var S=r.length-1;S>-1;S--)if(s[r[S].begin]&&s[r[S].end]){r[S].beginCircle=s[r[S].begin],r[S].endCircle=s[r[S].end];var T=Nt(s,t,r[S].begin,r[S].end),M=T.newCircle,U=T.beginPoint,Q=T.endPoint;r[S].newCircle=M,r[S].beginPoint=U,r[S].endPoint=Q}return s=s.filter((function(e){return!e.hide}))}(t,n,A,a);if(0===o.length)return null;for(var s,u,c,f=[],g=[],y=0,m=0;m<o.length;m++){var E=o[m];E.isAnchor&&(s=E,u=void 0,c=void 0,(c=Math.abs(s.begin-s.end))>2*Math.PI&&(c-=2*Math.PI),!u&&s.begin>s.end?c=2*Math.PI-c:u&&s.end>s.begin&&(c=2*Math.PI-c),c>1.9*Math.PI&&(E.begin=E.end)),Rt(E.x,E.y,n,E.begin,E.end,!1,null,f,r,i);var B=f.length-y;g[y]=h,g[y+B-1]=d,y+=B}var w=this._createMeshLine(f,e.type,e,g,{capType:p,joinType:p});return w.arcs=o,w.radius=n,w.intersectionObjects=a,i&&(i.applyMatrix4(e.invScaleMatrix),i.translate(e.center),w.boundingPoints=[i.min.clone(),i.max.clone(),i.max.clone(),i.min.clone()],w.boundingPoints[1].y=i.min.y,w.boundingPoints[3].y=i.max.y),w}},{key:"_shiftAnchorsInsideBox",value:function(e,t,n){var r=t[0].clone().sub(t[1]).normalize(),i=t[2].clone().sub(t[1]).normalize(),A=t[0].distanceTo(t[1])/2;if(t[2].distanceTo(t[1])/2<n||A<n)return!1;for(var a=0;a<t.length;a++){var o=t[a],s=n*Math.sign(o.dot(i));o.sub(i.clone().multiplyScalar(s)),s=n*Math.sign(o.dot(r)),o.sub(r.clone().multiplyScalar(s))}return!0}},{key:"getCloudMinimumRadius",value:function(e){var t=this.markupsExtension.renderer.mmToWorldUnitFactor*(this.markupsExtension.viewer.impl.is2d?1:10);return Math.max(3*e,t)}},{key:"destroy",value:function(){for(var e in this.geoCache)this.geoCache[e].dispose();this.geoCache=null}}])&&_i(t.prototype,n),r&&_i(t,r),e}();function Li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ii(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Di=Autodesk.Viewing,Oi=function(){function e(t,n,r,i){var A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setGlobalManager(t.globalManager),this.id=n,this.type=r,this.options=A,this.markupsExtension=t,this.materialManager=this.markupsExtension.renderer.materialManager,this.layer=null,this.meshContainer=null,this.strokeMaterial=null,this.fillMaterial=null,this.center=new THREE.Vector3,this.matrix=new THREE.Matrix4,this.invMatrix=new THREE.Matrix4,this.scaleMatrix=new THREE.Matrix4,this.invScaleMatrix=new THREE.Matrix4,this.completed=!1,this.selected=!1,this.inEdit=!1,this.enabled=!0,this.transparent=!1,this.visible=!1,this.hover=!1,this.locked=!1,i?this.state=i:(this.state=this.getDefaultState(),this.state.anchors=this.getDefaultAnchors(),this.state.style=this.getDefaultStyle()),this.state.translation=this.state.translation||new THREE.Vector3,this.state.rotation=this.state.rotation||0,this.state.scale=this.state.scale||new THREE.Vector3(1,1,1),this.editState=ct.cloneDeep(this.state),this.updateMatrix(),this.registerSelectionHandler(),this.creationHandler=Ei.getCreationHandler(this.type,this.markupsExtension,this,A)}var t,n,r;return t=e,r=[{key:"createMesh",value:function(e,t){var n=new THREE.Mesh(e,t);return n.frustumCulled=!1,n}}],(n=[{key:"updateMatrix",value:function(){this.scaleMatrix.makeScale(this.editState.scale.x,this.editState.scale.y,this.editState.scale.z),this.matrix.copy(this.scaleMatrix),this.matrix.setPosition(this.editState.translation),this.invMatrix.getInverse(this.matrix),this.invScaleMatrix.getInverse(this.scaleMatrix),this.updateCenter()}},{key:"updateCenter",value:function(){if(0!==this.editState.anchors.length){var e=(new THREE.Vector3).set(-1/0,-1/0,-1/0),t=(new THREE.Vector3).set(1/0,1/0,1/0);this.editState.anchors.forEach((function(n){e=e.max(n),t=t.min(n)})),this.center.x=(e.x+t.x)/2,this.center.y=(e.y+t.y)/2}}},{key:"getDefaultState",value:function(){return{}}},{key:"getDefaultAnchors",value:function(){return[]}},{key:"getDefaultStyle",value:function(){var e;return Li(e={},l.COLOR,this.markupsExtension.getStyleProperty(l.LAST_COLOR)),Li(e,l.FONT_SIZE,this.markupsExtension.getStyleProperty(l.FONT_SIZE)),Li(e,l.FONT_WEIGHT,this.markupsExtension.getStyleProperty(l.FONT_WEIGHT)),Li(e,l.FONT_FAMILY,this.markupsExtension.getStyleProperty(l.FONT_FAMILY)),Li(e,l.FONT_STYLE,this.markupsExtension.getStyleProperty(l.FONT_STYLE)),Li(e,l.FONT_COLOR,this.markupsExtension.getStyleProperty(l.FONT_COLOR)),Li(e,l.THICKNESS,this.markupsExtension.getStyleProperty(l.THICKNESS)),Li(e,l.FILL_OPACITY,this.markupsExtension.getStyleProperty(l.FILL_OPACITY)),Li(e,l.FILL_COLOR,this.markupsExtension.getStyleProperty(l.FILL_COLOR)),Li(e,l.OPACITY,this.markupsExtension.getStyleProperty(l.OPACITY)),e}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(e){this.state=ct.cloneDeep(e),this.rotatedBoundingBox=null,this.boundingBox=null}},{key:"getEditState",value:function(){return this.editState}},{key:"setEditState",value:function(e,t,n){var r=this.editState;this.editState=t?Object.assign({},e,t):ct.cloneDeep(e),this.updateMatrix(),this.rotatedBoundingBox=null,this.boundingBox=null,this.visible&&this.markupsExtension.renderer&&this.render(t),this.belongsToGroup()&&!this.isLocked()&&this.syncGroup(r,this.editState,t,n)}},{key:"isLocked",value:function(){return this.locked}},{key:"setLocked",value:function(e){this.locked=e}},{key:"render",value:function(e){this.meshContainer||(this.meshContainer=new THREE.Group,this.markupsExtension.renderer.addToScene(this))}},{key:"syncEditState",value:function(){this.setEditState(this.getState())}},{key:"syncState",value:function(){this.setState(this.getEditState())}},{key:"syncGroup",value:function(e,t,n,r){this.markupGroup.rotatedBoundingBox=null,this.markupGroup.boundingBox=null,n&&this.markupGroup.syncGroupMarkups(this,e,t,n,r)}},{key:"select",value:function(){this.layer&&!this.markupsExtension.permissionManager.canEditMarkup(this.layer.layerData)||(this.selected=!0,this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_SELECTED,markup:this}),this.enableEdit(),this.belongsToGroup()&&!this.markupGroup.locked&&this.markupGroup.select(this))}},{key:"deselect",value:function(){this.selected=!1,this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_DESELECTED,markup:this}),this.disableEdit()}},{key:"setVisible",value:function(e,t){(this.visible!==e||t)&&(this.visible=e,this.meshContainer&&(this.meshContainer.visible=e),this.markupsExtension.renderer&&(this.visible?this.render():this.markupsExtension.renderer.invalidate()),this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_VISIBILITY_CHANGED,markup:this,visible:e}))}},{key:"isVisible",value:function(){return this.visible}},{key:"isSelected",value:function(){return this.selected}},{key:"enableEdit",value:function(){this.inEdit=!0,this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_ENABLE_EDIT,markup:this}),this.setDirty()}},{key:"disableEdit",value:function(){this.inEdit=!1,this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_DISABLE_EDIT,markup:this}),this.setDirty()}},{key:"enable",value:function(){this.enabled=!0,this.changeTransparency(!1)}},{key:"disable",value:function(){this.enabled=!1,this.changeTransparency(!0)}},{key:"isEnabled",value:function(){return this.enabled}},{key:"changeTransparency",value:function(e){this.transparent!==e&&(this.transparent=e,this.visible&&this.markupsExtension.renderer&&this.render({style:{}}),this.setDirty())}},{key:"isTransparent",value:function(){return this.transparent}},{key:"setHover",value:function(e){this.hover!==e&&(this.hover=e,this.belongsToGroup()&&!this.markupGroup.locked&&this.markupGroup.setHover(e,this),this.setDirty())}},{key:"isHovered",value:function(){return this.hover}},{key:"isInEdit",value:function(){return this.inEdit}},{key:"setDirty",value:function(){this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_DIRTY,markup:this})}},{key:"isCompleted",value:function(){return this.completed}},{key:"complete",value:function(){this.completed=!0,this.selectWhenCompleted()?this.select():this.setDirty(),this.visible&&this.markupsExtension.renderer&&this.render(),this.markupsExtension.markupsManager.selectLayer(this.layer,!1,!1)}},{key:"selectWhenCompleted",value:function(){return!0}},{key:"registerAnchorHandler",value:function(e){this.anchorHandler=new vn(this.markupsExtension,this,e)}},{key:"registerTranslationHandler",value:function(e){this.translationHandler=new fn(this.markupsExtension,this,e)}},{key:"registerRotationHandler",value:function(e){this.rotationHandler=new Sn(this.markupsExtension,this,e)}},{key:"registerScaleHandler",value:function(e){this.scaleHandler=new Fn(this.markupsExtension,this,e)}},{key:"registerSelectionHandler",value:function(e){this.selectionHandler=new sn(this.markupsExtension,this,e)}},{key:"registerTextInputHandler",value:function(e){this.textInputHandler=new zn(this.markupsExtension,this,e)}},{key:"registerDimensionEditHandler",value:function(e){this.dimensionEditHandler=new Zn(this.markupsExtension,this,e)}},{key:"applyCameraRotation",value:function(e){var t=this.markupsExtension.renderer.getCameraRotation(),n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(e,t,this.getWorldCenter(),n)}},{key:"applyInverseCameraRotation",value:function(e){var t=this.markupsExtension.renderer.getCameraRotation(),n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(e,-t,this.getWorldCenter(),n)}},{key:"applyInverseRotation",value:function(e){var t=this.getRotation();if(0!==t){var n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(e,-t,this.getWorldCenter(),n)}}},{key:"applyRotation",value:function(e){var t=this.getRotation();if(0!==t){var n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(e,t,this.getWorldCenter(),n)}}},{key:"applyRotationForAnchors",value:function(e){var t=this.getRotation();if(0!==t){var n=this.markupsExtension.renderer.getCameraEyeVector(),r=this.getWorldCenter();e.forEach((function(e){st.applyRotation(e,t,r,n)}))}}},{key:"applyScaleAndTranslation",value:function(e){e.sub(this.center),e.applyMatrix4(this.matrix),e.add(this.center)}},{key:"applyInverseScaleAndTranslation",value:function(e){e.sub(this.center),e.applyMatrix4(this.invMatrix),e.add(this.center)}},{key:"calculateWorldBoundingBox",value:function(e){var t,n=this,r=new THREE.Box3;(t=this.meshLine&&this.meshLine.boundingPoints?ct.cloneDeep(this.meshLine.boundingPoints):ct.cloneDeep(this.editState.anchors)).forEach((function(e){n.applyScaleAndTranslation(e)})),e&&this.applyRotationForAnchors(t),t.forEach((function(e){r.expandByPoint(e)}));var i=this.editState.style[l.THICKNESS]/2;return r.expandByVector(new THREE.Vector3(i,i,0)),r}},{key:"getWorldBoundingBox",value:function(e){return e?(this.rotatedBoundingBox||(this.rotatedBoundingBox=this.calculateWorldBoundingBox(e)),this.rotatedBoundingBox):(this.boundingBox||(this.boundingBox=this.calculateWorldBoundingBox(e)),this.boundingBox)}},{key:"getClientBoundingBox",value:function(e,t){var n=this.getWorldBoundingBox(t).clone();n.min=this.markupsExtension.renderer.worldToClient(n.min),n.max=this.markupsExtension.renderer.worldToClient(n.max);var r=this.markupsExtension.renderer.getCameraEyeVector(),i=n.center(),A=this.markupsExtension.renderer.getCameraRotation();if(st.applyRotation(n.min,A,i,r),st.applyRotation(n.max,A,i,r),st.swapBoundingBoxY(n),e){var a=this.getMarginSize();n.expandByVector(new THREE.Vector3(a,a,0))}return n.min.z=0,n.max.z=0,n}},{key:"getMarginSize",value:function(){return Pe}},{key:"getMinimumSize",value:function(){return Math.max(this.markupsExtension.renderer.sizeFromWorldToClient(this.editState.style[l.THICKNESS]),this.getMarginSize())}},{key:"getCenter",value:function(){return this.center}},{key:"setPosition",value:function(){var e=this.center.clone().add(this.editState.translation);this.meshContainer.position.copy(e)}},{key:"setRotation",value:function(){this.meshContainer.rotation.z=this.editState.rotation*this.markupsExtension.renderer.getCameraEyeVector().z}},{key:"getWorldCenter",value:function(){return this.center.clone().add(this.editState.translation)}},{key:"getClientCenter",value:function(){return this.markupsExtension.renderer.worldToClient(this.getWorldCenter())}},{key:"getRotation",value:function(){return this.editState.rotation}},{key:"getScale",value:function(){return this.editState.scale}},{key:"getAnchors",value:function(){return this.editState.anchors}},{key:"isAnchorHandlingAllowed",value:function(e){return!0}},{key:"getTail",value:function(){return this.editState.anchors[this.editState.anchors.length-1]}},{key:"getHead",value:function(){return this.editState.anchors[0]}},{key:"getStartPointForNextMarkup",value:function(){return new THREE.Vector3}},{key:"intersect",value:function(e){var t=e.clone();this.applyInverseRotation(t);var n=this.markupsExtension.renderer.worldToClient(t),r=this.getClientBoundingBox(!0),i=this.markupsExtension.renderer.getCameraEyeVector(),A=this.markupsExtension.renderer.getCameraRotation();st.applyRotation(n,A,r.center(),i),n.z=0;var a=r.containsPoint(n);if(!a||this.isTextMarkup())return a;if(this.hasFill()&&this.fillMesh&&this.markupsExtension.renderer.raycaster.intersectObject(this.fillMesh).length>0)return!0;var o=this.strokeMaterial.uniforms.lineWidth.value/2;return o+=this.markupsExtension.renderer.sizeFromClientToWorld(Ke),this.meshLine.isPointNear(e,o*o,this.meshContainer.matrixWorld)}},{key:"isGroupMarkup",value:function(){return!1}},{key:"belongsToGroup",value:function(){return!!this.markupGroup}},{key:"isTextMarkup",value:function(){return!1}},{key:"isGeometricMarkup",value:function(){return!0}},{key:"isWithFillMarkup",value:function(){return!1}},{key:"isPoint",value:function(){return this.editState.anchors.length<2||Hi.areAllAnchorsEqual(this.editState.anchors)}},{key:"hasFill",value:function(){return this.isWithFillMarkup()&&!this.options.fillNotAllowed&&this.editState.style[l.FILL_OPACITY]>0&&this.editState.style[l.FILL_COLOR]!==o.NO_COLOR}},{key:"needsMiter",value:function(){return!0}},{key:"showPath",value:function(){return!1}},{key:"hasThicknessChanged",value:function(){return this.strokeMaterial&&this.strokeMaterial.uniforms.lineWidth.value!==this.editState.style[l.THICKNESS]}},{key:"removeFill",value:function(){this.fillMaterial&&(this.materialManager.removeMaterial(this.fillMaterial),this.fillMaterial=null),this.fillMesh&&(this.meshContainer.remove(this.fillMesh),this.fillMesh=null)}},{key:"remove",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.markupsExtension.renderer&&(this.strokeMaterial&&(this.materialManager.removeMaterial(this.strokeMaterial),this.strokeMaterial=null),this.strokeMesh&&(this.meshContainer.remove(this.strokeMesh),this.strokeMesh=null),this.meshLine&&!this.markupsExtension.renderer.geometryManager.isCachedGeometry(this.meshLine)&&(this.meshLine.dispose(),this.meshLine=null),this.fillMaterial&&(this.materialManager.removeMaterial(this.fillMaterial),this.fillMaterial=null),this.fillMesh&&(this.markupsExtension.renderer.geometryManager.isCachedGeometry(this.fillMesh.geometry)||this.fillMesh.traverse((function(e){e.geometry&&e.geometry.dispose()})),this.meshContainer.remove(this.fillMesh),this.fillMesh=null),this.meshContainer&&(this.markupsExtension.renderer.removeFromScene(this),this.meshContainer=null),e&&this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_REMOVED,markup:this}))}},{key:"destroy",value:function(){this.anchorHandler&&(this.anchorHandler.destroy(),this.anchorHandler=null),this.translationHandler&&(this.translationHandler.destroy(),this.translationHandler=null),this.rotationHandler&&(this.rotationHandler.destroy(),this.rotationHandler=null),this.scaleHandler&&(this.scaleHandler.destroy(),this.scaleHandler=null),this.selectionHandler&&(this.selectionHandler.destroy(),this.selectionHandler=null),this.textInputHandler&&(this.textInputHandler.destroy(),this.textInputHandler=null),this.markupsExtension=null,this.state=null,this.editState=null,this.layer=null}}])&&Ii(t.prototype,n),r&&Ii(t,r),e}();function Ri(e){return(Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ni(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pi(e,t){return!t||"object"!==Ri(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ki(e,t,n){return(Ki="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vi(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Vi(e){return(Vi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ji(e,t){return(ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Di.GlobalManagerMixin.call(Oi.prototype),Oi.singleClickMarkup=!1,Oi.withSnappingMarkup=!1,Oi.useTimerBeforeSelection=!1;var Gi=function(e){function t(e,n,r,i){var A,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(A=Pi(this,Vi(t).call(this,e,n,r,i,a))).registerTranslationHandler(),A.registerAnchorHandler(),A}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ji(e,t)}(t,e),n=t,(r=[{key:"createLine",value:function(){this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Oi.createMesh(this.meshLine.geometry,this.strokeMaterial),this.setPosition(),this.meshContainer.add(this.strokeMesh)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;Ki(Vi(t.prototype),"render",this).call(this);var n=e.anchors;if(n&&n.length>1&&this.createLine(),this.strokeMesh){if(e.style){var r=this.hasThicknessChanged(),i=this.materialManager.editMaterial(this.strokeMaterial,this,!1);i&&(this.strokeMaterial=i,this.strokeMesh.material=i,r&&this.createLine())}e.translation&&this.setPosition(),this.markupsExtension.renderer.invalidate()}}}])&&Ni(n.prototype,r),i&&Ni(n,i),t}(Oi);function zi(e){return(zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wi(e,t){return!t||"object"!==zi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xi(e){return(Xi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ji(e,t){return(Ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Gi.withSnappingMarkup=!0;var qi=function(e){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wi(this,Xi(t).call(this,e,n,y,r,i))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ji(e,t)}(t,e),n=t,(r=[{key:"getTail",value:function(){return this.editState.anchors[0]}},{key:"getHead",value:function(){return this.editState.anchors[1]}},{key:"getStartPointForNextMarkup",value:function(){return this.getTail().clone()}},{key:"isAnchorHandlingAllowed",value:function(e){return!(this.options.headHandlingNotAllowed&&e===this.getHead()||this.options.tailHandlingNotAllowed&&e===this.getTail())}}])&&Yi(n.prototype,r),i&&Yi(n,i),t}(Gi);function Zi(e){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eA(e,t){return!t||"object"!==Zi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tA(e,t,n){return(tA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nA(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function nA(e){return(nA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rA(e,t){return(rA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iA=function(e){function t(e,n,r){var i,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=eA(this,nA(t).call(this,e,n,k,r,A))).registerTranslationHandler(),i.registerAnchorHandler(),i.registerRotationHandler(),i.registerScaleHandler(),i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rA(e,t)}(t,e),n=t,(r=[{key:"getDefaultState",value:function(){return{closed:!1}}},{key:"createPolyline",value:function(){if(this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.fillMesh&&(this.meshContainer.remove(this.fillMesh),this.fillMesh=null),this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Oi.createMesh(this.meshLine.geometry,this.strokeMaterial),this.hasFill()&&!this.isPoint()&&zt(this.editState.anchors)){this.fillMaterial||(this.fillMaterial=this.materialManager.addMaterial(this,!0));var e=this.markupsExtension.renderer.geometryManager.getFillGeometry(this);e&&(this.fillMesh=Oi.createMesh(e,this.fillMaterial),this.meshContainer.add(this.fillMesh))}this.meshContainer.add(this.strokeMesh),this.setPosition(),this.setRotation()}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;tA(nA(t.prototype),"render",this).call(this);var n=e.anchors;if((n&&n.length>0||this.editState.anchors.length>0&&e.scale)&&this.createPolyline(),this.strokeMesh){if(e.style){var r=this.materialManager.editMaterial(this.strokeMaterial,this,!1);r&&(this.strokeMaterial=r,this.strokeMesh.material=r);var i=!1;if(this.hasFill())if(this.fillMesh){var A=this.materialManager.editMaterial(this.fillMaterial,this,!0);A&&(this.fillMaterial=A,this.fillMesh.material=A)}else i=!0;else this.removeFill();i&&this.createPolyline()}e.translation&&this.setPosition(),void 0!==e.rotation&&this.setRotation(),this.markupsExtension.renderer.invalidate()}}},{key:"isWithFillMarkup",value:function(){return this.editState.closed}},{key:"showPath",value:function(){return!0}}])&&$i(n.prototype,r),i&&$i(n,i),t}(Oi);function AA(e){return(AA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oA(e,t){return!t||"object"!==AA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sA(e,t,n){return(sA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uA(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function uA(e){return(uA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lA(e,t){return(lA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}iA.withSnappingMarkup=!0;var cA=function(e){function t(e,n,r){var i,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=oA(this,uA(t).call(this,e,n,C,r,A))).registerTranslationHandler(),i.registerAnchorHandler(),i.registerRotationHandler(),i.registerScaleHandler(),i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lA(e,t)}(t,e),n=t,(r=[{key:"getDefaultState",value:function(){return{closed:!1}}},{key:"needsMiter",value:function(){return!1}},{key:"createCloud",value:function(){if(this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.fillMesh&&(this.meshContainer.remove(this.fillMesh),this.fillMesh=null),this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.meshLine.type===E){var e=this.markupsExtension.renderer.getNormaStrokeWidth();this.meshContainer.scale.x=e,this.meshContainer.scale.y=e}else this.meshContainer.scale.x=1,this.meshContainer.scale.y=1;this.strokeMesh=Oi.createMesh(this.meshLine.geometry,this.strokeMaterial),this.hasFill()&&!this.isPoint()&&zt(this.editState.anchors)&&this.createFillMesh(),this.meshContainer.add(this.strokeMesh),this.setPosition(),this.setRotation()}},{key:"createFillMesh",value:function(){var e=this,t=this.markupsExtension.renderer.geometryManager.getFillGeometry(this);t.innerGeometry&&(this.fillMaterial||(this.fillMaterial=this.materialManager.addMaterial(this,!0)),this.fillMesh=Oi.createMesh(t.innerGeometry,this.fillMaterial),this.meshContainer.add(this.fillMesh),t.arcGeometry&&this.meshLine.arcs.forEach((function(n){var r=Oi.createMesh(t.arcGeometry,e.fillMaterial);e.fillMesh.add(r),r.position.x=n.x,r.position.y=n.y})),t.fillGapGeometries&&t.fillGapGeometries.forEach((function(t){var n=Oi.createMesh(t,e.fillMaterial);e.fillMesh.add(n)})))}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;sA(uA(t.prototype),"render",this).call(this);var n=e.anchors;if((n&&n.length>0||this.editState.anchors.length>0&&e.scale)&&this.createCloud(),this.strokeMesh){if(e.style){var r=this.hasThicknessChanged(),i=this.materialManager.editMaterial(this.strokeMaterial,this,!1);if(i&&(this.strokeMaterial=i,this.strokeMesh.material=i),this.hasFill())if(this.fillMesh){var A=this.materialManager.editMaterial(this.fillMaterial,this,!0);A&&(this.fillMaterial=A,this.fillMesh.traverse((function(e){return e.material=A})))}else r=!0;else this.removeFill();r&&this.createCloud()}e.translation&&this.setPosition(),void 0!==e.rotation&&this.setRotation(),this.markupsExtension.renderer.invalidate()}}},{key:"showPath",value:function(){return!0}},{key:"isWithFillMarkup",value:function(){return this.editState.closed}}])&&aA(n.prototype,r),i&&aA(n,i),t}(Oi);function hA(e){return(hA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fA(e,t){return!t||"object"!==hA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pA(e,t,n){return(pA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gA(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function gA(e){return(gA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yA(e,t){return(yA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}cA.withSnappingMarkup=!0;var mA=function(e){function t(e,n,r,i){var A,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(A=fA(this,gA(t).call(this,e,n,r,i,a))).width=0,A.height=0,A.registerTranslationHandler(),A.registerRotationHandler(),A.registerScaleHandler(),A}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yA(e,t)}(t,e),n=t,(r=[{key:"setSize",value:function(){var e=this.markupsExtension.renderer.getNormaStrokeWidth();this.meshContainer.scale.x=Math.max(Math.abs(this.width*this.editState.scale.x),e)*Math.sign(this.editState.scale.x),this.meshContainer.scale.y=Math.max(Math.abs(this.height*this.editState.scale.y),e)*Math.sign(this.editState.scale.y)}},{key:"createShape",value:function(e){this.strokeMesh||(this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Oi.createMesh(this.meshLine.geometry,this.strokeMaterial),this.meshContainer.add(this.strokeMesh),this.meshContainer.rotation.z=-this.markupsExtension.renderer.getCameraRotation()*this.markupsExtension.renderer.getCameraEyeVector().z),!this.fillMesh&&this.hasFill()&&this.createFill(),this.width=e[0].distanceTo(e[1]),this.height=e[2].distanceTo(e[1]),this.setPosition(),this.setSize()}},{key:"createFill",value:function(){this.fillGeometry=this.markupsExtension.renderer.geometryManager.getFillGeometry(this),this.fillGeometry&&(this.fillMaterial||(this.fillMaterial=this.materialManager.addMaterial(this,!0)),this.fillMesh=Oi.createMesh(this.fillGeometry,this.fillMaterial),this.meshContainer.add(this.fillMesh),this.meshContainer.add(this.strokeMesh))}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;pA(gA(t.prototype),"render",this).call(this);var n=e.anchors;if(n&&n.length>1&&this.createShape(n),this.strokeMesh){if(e.style){var r=this.materialManager.editMaterial(this.strokeMaterial,this,!1);if(r&&(this.strokeMaterial=r,this.strokeMesh.material=r),this.hasFill())if(this.fillMesh){var i=this.materialManager.editMaterial(this.fillMaterial,this,!0);i&&(this.fillMaterial=i,this.fillMesh.material=i)}else this.createFill();else this.removeFill()}e.translation&&this.setPosition(),void 0!==e.rotation&&this.setRotation(),e.scale&&this.setSize(),this.markupsExtension.renderer.invalidate()}}},{key:"isWithFillMarkup",value:function(){return!0}}])&&dA(n.prototype,r),i&&dA(n,i),t}(Oi);function EA(e){return(EA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BA(e,t){return!t||"object"!==EA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wA(e){return(wA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kA(e,t){return(kA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CA=function(e){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),BA(this,wA(t).call(this,e,n,m,r,i))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kA(e,t)}(t,e),n=t,(r=[{key:"isWithFillMarkup",value:function(){return!0}}])&&vA(n.prototype,r),i&&vA(n,i),t}(mA);function bA(e){return(bA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TA(e,t){return!t||"object"!==bA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function MA(e){return(MA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function UA(e,t){return(UA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var QA=function(e){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),TA(this,MA(t).call(this,e,n,E,r,i))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UA(e,t)}(t,e),n=t,(r=[{key:"isWithFillMarkup",value:function(){return!0}},{key:"needsMiter",value:function(){return!1}}])&&SA(n.prototype,r),i&&SA(n,i),t}(mA);function xA(e){return(xA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _A(e,t){return!t||"object"!==xA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HA(e,t,n){return(HA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=LA(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function LA(e){return(LA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IA(e,t){return(IA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var DA=function(e){function t(e,n,r){var i,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=_A(this,LA(t).call(this,e,n,v,r,A))).registerTranslationHandler(),A.rotationNotAllowed||i.registerRotationHandler(),i.registerScaleHandler(),i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IA(e,t)}(t,e),n=t,(r=[{key:"createCloud",value:function(){if(this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.fillMesh&&(this.meshContainer.remove(this.fillMesh),this.fillMesh=null),this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Oi.createMesh(this.meshLine.geometry,this.strokeMaterial),this.hasFill()&&!this.isPoint()&&this.createFillMesh(),this.meshContainer.add(this.strokeMesh),this.meshLine.type===E){var e=this.editState.anchors[0].distanceTo(this.editState.anchors[1]),t=this.editState.anchors[2].distanceTo(this.editState.anchors[1]),n=this.markupsExtension.renderer.getNormaStrokeWidth();this.meshContainer.scale.x=Math.max(Math.abs(e*this.editState.scale.x),n)*Math.sign(this.editState.scale.x),this.meshContainer.scale.y=Math.max(Math.abs(t*this.editState.scale.y),n)*Math.sign(this.editState.scale.y),this.isCompleted()?this.setRotation():this.meshContainer.rotation.z=-this.markupsExtension.renderer.getCameraRotation()*this.markupsExtension.renderer.getCameraEyeVector().z}else this.meshContainer.scale.x=1,this.meshContainer.scale.y=1,this.setRotation();this.setPosition()}},{key:"createFillMesh",value:function(){var e=this,t=this.markupsExtension.renderer.geometryManager.getFillGeometry(this);t.innerGeometry&&(this.fillMaterial||(this.fillMaterial=this.materialManager.addMaterial(this,!0)),this.fillMesh=Oi.createMesh(t.innerGeometry,this.fillMaterial),this.meshContainer.add(this.fillMesh),t.arcGeometry&&this.meshLine.arcs.forEach((function(n){var r=Oi.createMesh(t.arcGeometry,e.fillMaterial);e.fillMesh.add(r),r.position.x=n.x,r.position.y=n.y})))}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;HA(LA(t.prototype),"render",this).call(this);var n=e.anchors;if((n&&n.length>1||this.editState.anchors.length>1&&e.scale)&&this.createCloud(),this.strokeMesh){if(e.style){var r=this.hasThicknessChanged(),i=this.materialManager.editMaterial(this.strokeMaterial,this,!1);if(i&&(this.strokeMaterial=i,this.strokeMesh.material=i),this.hasFill())if(this.fillMesh){var A=this.materialManager.editMaterial(this.fillMaterial,this,!0);A&&(this.fillMaterial=A,this.fillMesh.traverse((function(e){return e.material=A})))}else r=!0;else this.removeFill();r&&this.createCloud()}e.translation&&this.setPosition(),void 0!==e.rotation&&this.setRotation(),this.markupsExtension.renderer.invalidate()}}},{key:"isWithFillMarkup",value:function(){return!0}},{key:"needsMiter",value:function(){return!1}}])&&FA(n.prototype,r),i&&FA(n,i),t}(Oi);function OA(e){return(OA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NA(e,t){return!t||"object"!==OA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function PA(e,t,n){return(PA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KA(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function KA(e){return(KA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VA(e,t){return(VA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}DA.withSnappingMarkup=!0;var jA=function(e){function t(e,n,r,i){var A,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(A=NA(this,KA(t).call(this,e,n,r,i,a))).registerTranslationHandler(),A.registerRotationHandler(),A.registerScaleHandler(),A}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VA(e,t)}(t,e),n=t,(r=[{key:"selectWhenCompleted",value:function(){return!1}},{key:"needsMiter",value:function(){return!0}},{key:"createPen",value:function(){this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Oi.createMesh(this.meshLine.geometry,this.strokeMaterial),this.meshContainer.add(this.strokeMesh),this.setPosition(),this.setRotation()}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;PA(KA(t.prototype),"render",this).call(this);var n=e.anchors;if((n&&n.length>0||this.editState.anchors.length>0&&e.scale)&&this.createPen(),this.strokeMesh){if(e.style){var r=this.materialManager.editMaterial(this.strokeMaterial,this,!1);r&&(this.strokeMaterial=r,this.strokeMesh.material=r)}e.translation&&this.setPosition(),void 0!==e.rotation&&this.setRotation(),this.markupsExtension.renderer.invalidate()}}}])&&RA(n.prototype,r),i&&RA(n,i),t}(Oi);function GA(e){return(GA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zA(e,t){return!t||"object"!==GA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function YA(e){return(YA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function WA(e,t){return(WA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}jA.singleClickMarkup=!0,jA.useTimerBeforeSelection=!0;var XA=function(e){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),zA(this,YA(t).call(this,e,n,B,r,i))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WA(e,t)}(t,e),t}(jA);function JA(e){return(JA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ZA(e,t){return!t||"object"!==JA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $A(e,t,n){return($A="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ea(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ea(e){return(ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ta(e,t){return(ta=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var na=function(e){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ZA(this,ea(t).call(this,e,n,w,r,i))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ta(e,t)}(t,e),n=t,(r=[{key:"getDefaultStyle",value:function(){var e=$A(ea(t.prototype),"getDefaultStyle",this).call(this);return e[l.OPACITY]=he,e}}])&&qA(n.prototype,r),i&&qA(n,i),t}(jA);function ra(e){return(ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ia(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Aa(e,t){return!t||"object"!==ra(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aa(e,t,n){return(aa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oa(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function oa(e){return(oa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sa(e,t){return(sa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ua=function(e){function t(e,n,r){var i,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Aa(this,oa(t).call(this,e,n,S,r,A))).registerTranslationHandler(),i.registerScaleHandler({onlyHorizontal:!0}),i.registerTextInputHandler(),A.rotationNotAllowed||i.registerRotationHandler(),i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sa(e,t)}(t,e),n=t,(r=[{key:"getDefaultState",value:function(){return{text:"Default Text",isFrameUsed:!0,frameType:this.options.frameType?this.options.frameType:m}}},{key:"shouldRenderFrame",value:function(){return this.editState.isFrameUsed||this.hasFill()}},{key:"setVisible",value:function(e,n){aa(oa(t.prototype),"setVisible",this).call(this,e,n),this.frameMarkup?this.frameMarkup.setVisible(e,n):this.shouldRenderFrame()&&e&&this.renderFrame()}},{key:"render",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState,this.markupsExtension.renderer.textRenderer.renderMarkup(this),this.shouldRenderFrame()?this.renderFrame():(this.removeFrame(),this.setDirty())}},{key:"renderFrame",value:function(){this.frameMarkup||(this.frameMarkup=new Wa[this.editState.frameType](this.markupsExtension,this.id),this.frameMarkup.layer=this.layer,this.frameMarkup.transparent=this.isTransparent(),this.frameMarkup.editState.anchors=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]);var e=this.frameMarkup.editState;e.style[l.THICKNESS]=this.editState.style[l.THICKNESS],e.style[l.OPACITY]=this.editState.style[l.OPACITY],e.style[l.FILL_COLOR]=this.editState.style[l.FILL_COLOR],e.style[l.FILL_OPACITY]=this.editState.style[l.FILL_OPACITY],this.editState.isFrameUsed?(e.style[l.COLOR]=this.editState.style[l.COLOR],e.style[l.OPACITY]=1):(e.style[l.COLOR]=this.editState.style[l.FILL_COLOR],e.style[l.OPACITY]=this.editState.style[l.FILL_OPACITY]);var t=this.getWorldBoundingBox(),n=e.style[l.THICKNESS]/2;this.frameMarkup.editState.anchors[0].set(t.min.x+n,t.min.y+n,0),this.frameMarkup.editState.anchors[1].set(t.max.x-n,t.min.y+n,0),this.frameMarkup.editState.anchors[2].set(t.max.x-n,t.max.y-n,0),this.frameMarkup.editState.anchors[3].set(t.min.x+n,t.max.y-n,0),e.rotation=this.editState.rotation,this.frameMarkup.updateMatrix(),this.frameMarkup.render()}},{key:"removeFrame",value:function(){this.frameMarkup&&(this.frameMarkup.remove(!1),this.frameMarkup=null)}},{key:"remove",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.removeFrame(),aa(oa(t.prototype),"remove",this).call(this,e)}},{key:"changeTransparency",value:function(e){this.frameMarkup&&(this.frameMarkup.transparent=e),aa(oa(t.prototype),"changeTransparency",this).call(this,e)}},{key:"resetFrameBoundingBox",value:function(){this.frameMarkup&&(this.frameMarkup.rotatedBoundingBox=null,this.frameMarkup.boundingBox=null)}},{key:"setState",value:function(e){this.resetFrameBoundingBox(),aa(oa(t.prototype),"setState",this).call(this,e)}},{key:"setEditState",value:function(e,n,r){if(n&&n.style){var i=Object.assign({},e,n),A=this.markupsExtension.renderer.getFontToWorldScale(),a=this.getTextWidthInFontScale().width,s=this.getTextStyle(this.editState),u=this.getTextStyle(i);s.width="".concat(a,"px"),u.width="".concat(a,"px");var c=Ot(this.editState.text,s),h=Ot(i.text,u);if(h.height!==c.height){var d=(h.height-c.height)*A,f=this.getBoundingBoxVerticalTranslation(d);if(this.shouldRenderFrame()){var p=this.calculateFrameSize(this.editState.style[l.FONT_SIZE]),g=this.calculateFrameSize(i.style[l.FONT_SIZE])-p,y=new THREE.Vector3(g,-g,0);this._rotateTranslationVector(y),f.add(y)}if(n.translation)n.translation.add(f);else{var m=this.getEditState().translation;m.add(f),n.translation=m}}n.isFrameUsed=i.style[l.COLOR]!==o.NO_COLOR}this.resetFrameBoundingBox(),aa(oa(t.prototype),"setEditState",this).call(this,e,n,r)}},{key:"getTextWidthInFontScale",value:function(){var e=Autodesk.Viewing.isSafari()||Autodesk.Viewing.isIOSDevice(),t=this.markupsExtension.renderer.getFontToWorldScale(),n=this.getWorldBoundingBoxTextOnly().size().x/t;return{preciseWidth:n,width:e?n:Math.ceil(n)||1}}},{key:"getBoundingBoxVerticalTranslation",value:function(e){var t=new THREE.Vector3(0,-e/2,0);return this._rotateTranslationVector(t),t}},{key:"_rotateTranslationVector",value:function(e){var t=this.getRotation();if(0!==t){var n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(e,t,new THREE.Vector3,n)}}},{key:"_rotateBoundingBox",value:function(e){var t=this.getRotation();if(0===t)return e;var n=e.center(),r=e.size(),i=this.markupsExtension.renderer.getCameraEyeVector(),A=new THREE.Box3;return[e.min,e.min.clone().add(new THREE.Vector3(r.x,0,0)),e.max,e.min.clone().add(new THREE.Vector3(0,r.y,0))].forEach((function(e){st.applyRotation(e,t,n,i),A.expandByPoint(e)})),A}},{key:"_calculateWorldBoundingBoxText",value:function(){var e=this,t=new THREE.Box3,n=ct.cloneDeep(this.editState.anchors);n.forEach((function(t){e.applyScaleAndTranslation(t)})),n.forEach((function(e){t.expandByPoint(e)}));var r=t.center(),i=this.getTextStyle(),A=this.markupsExtension.renderer.getFontToWorldScale(),a=Ot("A",i);t.size().x<a.width*A&&(t.min.x=r.x,t.max.x=r.x,t.expandByVector(new THREE.Vector3(a.width*A/2,0,0)));var o=Math.ceil(t.size().x/A);return i.width="".concat(o,"px"),a=Ot(this.editState.text,i),t.min.y=r.y,t.max.y=r.y,t.expandByVector(new THREE.Vector3(0,a.height*A/2,0)),t}},{key:"calculateWorldBoundingBox",value:function(e){var t=this._calculateWorldBoundingBoxText();if(this.shouldRenderFrame()){var n=this.getWorldFrameSize();t.expandByVector(new THREE.Vector3(n,n,0))}return e?this._rotateBoundingBox(t):t}},{key:"calculateFrameSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.editState.style[l.THICKNESS],n=this.markupsExtension.renderer.getFontToWorldScale(),r=e*n/2;return this.editState.isFrameUsed?this.editState.frameType===v&&(t+=this.markupsExtension.renderer.geometryManager.getCloudMinimumRadius(t)/2):t=0,r+t}},{key:"getWorldFrameSize",value:function(){return this.calculateFrameSize(this.editState.style[l.FONT_SIZE])}},{key:"getClientFrameSize",value:function(){var e=this.getWorldFrameSize();return this.markupsExtension.renderer.sizeFromWorldToClient(e)}},{key:"getWorldBoundingBoxTextOnly",value:function(e){if(!this.shouldRenderFrame())return this.getWorldBoundingBox(e).clone();var t=this.getWorldBoundingBox(!1).clone(),n=this.getWorldFrameSize();return t.expandByVector(new THREE.Vector3(-n,-n,0)),e?this._rotateBoundingBox(t):t}},{key:"getClientBoundingBoxTextOnly",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getWorldBoundingBoxTextOnly(e);return n.min=this.markupsExtension.renderer.worldToClient(n.min),n.max=this.markupsExtension.renderer.worldToClient(n.max),t&&st.swapBoundingBoxY(n),n}},{key:"getTextStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getEditState(),t=e.style,n={};return n.color=t[l.FONT_COLOR],n.fontFamily=t[l.FONT_FAMILY],n.opacity=t[l.OPACITY]*(this.isTransparent()?Ye:1),n.fontSize="".concat(t[l.FONT_SIZE],"px"),n.fontWeight=t[l.FONT_WEIGHT],n.fontStyle=t[l.FONT_STYLE],n.whiteSpace=e.isSingleLine?"nowrap":"pre-wrap",n.lineHeight=1,n.backgroundColor=null,n}},{key:"getMinimumSize",value:function(){var e=aa(oa(t.prototype),"getMinimumSize",this).call(this),n=this.getTextStyle(),r=Ot("A",n),i=this.markupsExtension.renderer.getFontToWorldScale();return Math.max(this.markupsExtension.renderer.sizeFromWorldToClient(r.width*i+2*this.getWorldFrameSize()),e)}},{key:"isTextMarkup",value:function(){return!0}},{key:"isGeometricMarkup",value:function(){return!1}},{key:"isWithFillMarkup",value:function(){return!0}},{key:"getStartPointForNextMarkup",value:function(){return this.getWorldBoundingBox().center().clone()}}])&&ia(n.prototype,r),i&&ia(n,i),t}(Oi);function la(e){return(la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ca(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ha(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function da(e,t,n){return(da="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fa(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function fa(e){return(fa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pa(e,t){return(pa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}ua.singleClickMarkup=!0;var ga=function(e){function t(e,n,r){var i,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=function(e,t){return!t||"object"!==la(t)&&"function"!=typeof t?ha(e):t}(this,fa(t).call(this,e,n,U,r,A))).markupsExtension.viewer.impl.is2d&&i.registerDimensionEditHandler(),i.textMarkup=new ua(e,n),i.textMarkup.editState.isFrameUsed=!1,i.registerTextInputHandler({singleLine:!0,onEmptyTextMarkup:i.onEmptyTextMarkup.bind(ha(i)),submitChanges:i.onSubmitChanges.bind(ha(i))}),i.getTextStyle=i.textMarkup.getTextStyle.bind(i.textMarkup);var a=i.textInputHandler.editStart;i.textInputHandler.editStart=function(){a.bind(i.textInputHandler)(),i.onTextMarkupEditStart()};var o=i.textInputHandler.editEnd;return i.textInputHandler.editEnd=function(){o.bind(i.textInputHandler)(),i.onTextMarkupEditEnd()},i.textMarkup.textInputHandler=i.textInputHandler,i}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pa(e,t)}(t,e),n=t,(r=[{key:"setVisible",value:function(e,n){da(fa(t.prototype),"setVisible",this).call(this,e,n),this.textMarkup.setVisible(e,n)}},{key:"setState",value:function(e){da(fa(t.prototype),"setState",this).call(this,e),this.textMarkup.rotatedBoundingBox=null,this.textMarkup.boundingBox=null,this.textMarkup.resetFrameBoundingBox()}},{key:"setEditState",value:function(e,n,r){this.textMarkup.rotatedBoundingBox=null,this.textMarkup.boundingBox=null,this.textMarkup.resetFrameBoundingBox(),da(fa(t.prototype),"setEditState",this).call(this,e,n,r)}},{key:"createDimension",value:function(){this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.strokeMaterial||(this.editState.style[l.THICKNESS]*=Ge,this.strokeMaterial=this.materialManager.addMaterial(this,!1),this.editState.style[l.THICKNESS]/=Ge),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Oi.createMesh(this.meshLine.geometry,this.strokeMaterial),this.meshContainer.add(this.strokeMesh),this.setPosition()}},{key:"calculateWorldBoundingBox",value:function(e){var n=da(fa(t.prototype),"calculateWorldBoundingBox",this).call(this,e),r=this.textMarkup.calculateWorldBoundingBox(!0);return n.union(r)}},{key:"renderText",value:function(){var e=this.getEditState(),t=e.anchors,n=e.text,r=e.style,i=ct.cloneDeep(r);i[l.FONT_SIZE]*=ze,this.textMarkup.enabled=this.enabled,this.textMarkup.transparent=this.isTransparent(),this.textMarkup.editState.style=i,this.textMarkup.editState.text=n,this.textMarkup.editState.isSingleLine=!0;var A=t[0].clone().add(t[1]).multiplyScalar(.5);this.applyScaleAndTranslation(A),this.textMarkup.creationHandler.calculateAnchorsByCenterPoint(A);var a=this.markupsExtension.renderer.getCameraRotation(),o=this.markupsExtension.renderer.getCameraEyeVector(),s=this.textMarkup.editState.anchors;s.forEach((function(e){st.applyRotation(e,a,A,o)}));var u=st.getSignedAngle(this.markupsExtension.renderer.getCameraRightVector(),t[1].clone().sub(t[0]),this.markupsExtension.renderer.getCameraEyeVector());Math.abs(u)>Math.PI/2&&(u+=Math.PI),this.textMarkup.editState.rotation=u-a;var c=s[1].clone(),h=s[2].clone();st.applyRotation([c,h],this.textMarkup.editState.rotation,A,o);var d=this.editState.style[l.THICKNESS]*Ge*je,f=h.clone().sub(c),p=f.clone().normalize().multiplyScalar(d).add(f.multiplyScalar(.5));s.forEach((function(e){e.add(p)})),this.textMarkup.render()}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;da(fa(t.prototype),"render",this).call(this);var n=e.anchors;if(n&&n.length>1&&this.createDimension(),this.strokeMesh){if(e.style){this.editState.style[l.THICKNESS]*=Ge;var r=this.hasThicknessChanged(),i=this.materialManager.editMaterial(this.strokeMaterial,this,!1);this.editState.style[l.THICKNESS]/=Ge,i&&(this.strokeMaterial=i,this.strokeMesh.material=i,r&&this.createDimension())}e.translation&&(this.createDimension(),this.setPosition()),this.renderText(),this.markupsExtension.renderer.invalidate()}}},{key:"isTextMarkup",value:function(){return!0}},{key:"isWithFillMarkup",value:function(){return!0}},{key:"onEmptyTextMarkup",value:function(){this.markupsExtension.markupsManager.actionManager.undo();var e=this.creationHandler.getDistance();this.creationHandler.updateEditState({text:e}),this.creationHandler.submitChanges()}},{key:"onSubmitChanges",value:function(){this.textInputHandler.submitChanges(),this.hasChanges=!0}},{key:"remove",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.textMarkup.remove(!1),da(fa(t.prototype),"remove",this).call(this,e)}},{key:"onTextMarkupEditStart",value:function(){var e=this.textMarkup.editState.text;"("===e[0]&&")"===e[e.length-1]&&(e=e.slice(1,e.length-1)),this.hasChanges=!1,this.creationHandler.updateEditState({text:e})}},{key:"onTextMarkupEditEnd",value:function(){var e=this.textMarkup.editState.text;"("===e[0]&&")"===e[e.length-1]&&(e=e.slice(1,e.length-1)),""!==e&&(this.hasChanges?(this.markupsExtension.markupsManager.actionManager.undo(),this.creationHandler.updateEditState({text:"(".concat(e,")")}),this.creationHandler.submitChanges()):e!==this.creationHandler.getDistance()&&this.creationHandler.updateEditState({text:"(".concat(e,")")}))}}])&&ca(n.prototype,r),i&&ca(n,i),t}(Oi);function ya(e){return(ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ma(e,t){return!t||"object"!==ya(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ea(e){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function va(e,t){return(va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}ga.withSnappingMarkup=!0;var Ba=function(e){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ma(this,Ea(t).call(this,e,n,Q,r,i))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&va(e,t)}(t,e),t}(Gi);function wa(e){return(wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ka(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ca(e,t){return!t||"object"!==wa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ba(e,t,n){return(ba="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sa(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Sa(e){return(Sa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ta(e,t){return(Ta=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ma(e){return(Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ua(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qa(e){return(Qa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fa(e,t){return(Fa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _a=function(e){function t(e,n,r,i){var A,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(A=function(e,t){return!t||"object"!==Ma(t)&&"function"!=typeof t?xa(e):t}(this,Qa(t).call(this,e,n,r,i,a))).getTextMarkup().textInputHandler.onEmptyTextMarkup=A.onEmptyTextMarkup.bind(xa(A)),A}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fa(e,t)}(t,e),n=t,(r=[{key:"getArrowMarkup",value:function(){throw new Error("getArrowMarkup should be implemented")}},{key:"getTextMarkup",value:function(){throw new Error("getTextMarkup should be implemented")}},{key:"getShapeMarkup",value:function(){throw new Error("getShapeMarkup should be implemented")}},{key:"getQuadrant",value:function(e,t){var n=e.getWorldBoundingBox(!0),r=Math.atan2(n.size().y,n.size().x);return t>=-(Math.PI-r)&&t<-r?1:t>=-r&&t<r?2:t>=r&&t<Math.PI-r?3:4}},{key:"getTextQuadrant",value:function(e){return this.getQuadrant(this.getTextMarkup(),e)}},{key:"getShapeQuadrant",value:function(e){return this.getQuadrant(this.getShapeMarkup(),e)}},{key:"getVectorToClosestPointOnCloud",value:function(e){var t=this.getTextMarkup().frameMarkup.meshLine.sourceGeo,n=1/0,r=null;return t.forEach((function(t){var i=e.distanceToSquared(t);i<n&&(n=i,r=t)})),e.clone().sub(r)}},{key:"applyArrowTextConstraint",value:function(e){var t=this.getArrowMarkup(),n=this.getTextMarkup();if((e=e||t.getEditState()).anchors[0]&&e.anchors[1]){var r=n.getWorldBoundingBox(!0),i=r.center(),A=n.editState.style[l.THICKNESS]/2,a=r.size().y/2-A,o=r.size().x/2-A,s=e.anchors[0],u=e.anchors[1].clone();t.applyScaleAndTranslation(u);var c=Math.atan2(u.y-i.y,u.x-i.x);switch(this.getTextQuadrant(c)){case 1:s.set(i.x,i.y-a,0);break;case 2:s.set(i.x+o,i.y,0);break;case 3:s.set(i.x,i.y+a,0);break;case 4:s.set(i.x-o,i.y,0)}if(n.editState.frameType===v){var h=s.clone().sub(i),d=this.getVectorToClosestPointOnCloud(h).negate();s.add(d)}t.applyInverseScaleAndTranslation(s),t.creationHandler.updateEditStateAnchors()}}},{key:"applyShapeArrowConstraint",value:function(e){var t=this.getArrowMarkup(),n=this.getShapeMarkup();if((e=e||t.getEditState()).anchors[0]&&e.anchors[1]){var r=n.getWorldBoundingBox(!0),i=r.center(),A=r.size().y/2,a=r.size().x/2,o=e.anchors[1],s=e.anchors[0].clone();t.applyScaleAndTranslation(s);var u,l=s.x-i.x,c=s.y-i.y,h=Math.atan2(c,l),d=function(e){return e>0?1:-1};switch(this.getShapeQuadrant(h)){case 1:u=d(l)*a/3,o.set(i.x+u,i.y-A,0);break;case 2:u=d(c)*A/3,o.set(i.x+a,i.y+u,0);break;case 3:u=d(l)*a/3,o.set(i.x+u,i.y+A,0);break;case 4:u=d(c)*A/3,o.set(i.x-a,i.y+u,0)}t.applyInverseScaleAndTranslation(o),t.creationHandler.updateEditStateAnchors()}}},{key:"applyArrowConstraints",value:function(e){throw new Error("applyArrowTextConstraint must be implemented")}},{key:"applyConstraints",value:function(e,t,n){throw new Error("applyConstraints must be implemented")}},{key:"applyTranslation",value:function(e,t,n){var r=this;this.markups.forEach((function(i){if(i!==e&&i.isCompleted()){if(i.setLocked(!0),e.type===y){var A=n.translation.clone().sub(t.translation);A=i.editState.translation.clone().add(A),i.creationHandler.updateEditState({translation:A})}else r.applyArrowConstraints();i.setLocked(!1)}}))}},{key:"applyStyle",value:function(e,t,n,r){var i=this;this.markups.forEach((function(t){t!==e&&t.isCompleted()&&(t.setLocked(!0),t.creationHandler.updateEditState({style:r.style}),i.applyArrowConstraints(),t.setLocked(!1))}))}},{key:"applyScale",value:function(e,t,n){var r=this;this.markups.forEach((function(t){t!==e&&t.isCompleted()&&t.type===y&&(t.setLocked(!0),r.applyArrowConstraints(),t.setLocked(!1))}))}},{key:"applyTextChange",value:function(e,t,n){this.applyArrowConstraints()}},{key:"onEmptyTextMarkup",value:function(){this.markupsExtension.markupsManager.actionManager.undo();var e=this.getTextMarkup();e.creationHandler.updateEditState({text:e.getDefaultState().text}),e.creationHandler.submitChanges()}}])&&Ua(n.prototype,r),i&&Ua(n,i),t}(function(e){function t(e,n,r,i,A){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ca(this,Sa(t).call(this,e,n,r,i,A))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ta(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState}},{key:"intersect",value:function(e){return!1}},{key:"isGroupMarkup",value:function(){return!0}},{key:"select",value:function(e){this.selected=!0,this.enableEdit(),e&&(this.setLocked(!0),this.markups.forEach((function(t){return t!==e&&!t.isSelected()&&t.select()})),this.setLocked(!1)),this.setDirty()}},{key:"setHover",value:function(e,t){this.hover!==e&&(this.hover=e,t&&(this.setLocked(!0),this.markups.forEach((function(n){return n!==t&&n.isHovered()!==e&&n.setHover(e)})),this.setLocked(!1)),this.setDirty())}},{key:"calculateWorldBoundingBox",value:function(){var e=new THREE.Box3;return this.markups.forEach((function(t){var n=t.getWorldBoundingBox(!0);e.union(n)})),e}},{key:"remove",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.markups.forEach((function(t){return t.remove(e)})),ba(Sa(t.prototype),"remove",this).call(this,e)}},{key:"syncGroupMarkups",value:function(e,t,n,r,i){r.anchors&&this.applyConstraints(e,t,n),r.translation&&i instanceof fn&&0===i.keyTranslation.length()&&this.applyTranslation(e,t,n),r.scale&&i instanceof Fn&&this.applyScale(e,t,n),r.style&&this.applyStyle(e,t,n,r),r.text&&this.applyTextChange(e,t,n)}},{key:"applyConstraints",value:function(e,t,n){}},{key:"applyTranslation",value:function(e,t,n){}},{key:"applyStyle",value:function(e,t,n,r){}},{key:"applyScale",value:function(e,t,n){}},{key:"applyTextChange",value:function(e,t,n){}}])&&ka(n.prototype,r),i&&ka(n,i),t}(Oi));function Ha(e){return(Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function La(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ia(e,t){return!t||"object"!==Ha(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Da(e){return(Da=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oa(e,t){return(Oa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}_a.withSnappingMarkup=!0;var Ra=function(e){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ia(this,Da(t).call(this,e,n,T,r,i))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oa(e,t)}(t,e),n=t,(r=[{key:"getTextMarkup",value:function(){return this.markups[1]}},{key:"getArrowMarkup",value:function(){return this.markups[0]}},{key:"applyArrowConstraints",value:function(e){this.applyArrowTextConstraint(e)}},{key:"applyConstraints",value:function(e,t,n){var r=this;this.markups.forEach((function(t){t!==e&&t.isCompleted()&&e.type===y&&e.anchorHandler.activeAnchor===e.getHead()&&(e.setLocked(!0),r.applyArrowConstraints(n),e.setLocked(!1))}))}}])&&La(n.prototype,r),i&&La(n,i),t}(_a);function Na(e){return(Na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ka(e,t){return!t||"object"!==Na(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Va(e){return(Va=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ja(e,t){return(ja=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ga,za=function(e){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ka(this,Va(t).call(this,e,n,M,r,i))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ja(e,t)}(t,e),n=t,(r=[{key:"getTextMarkup",value:function(){return this.markups[2]}},{key:"getArrowMarkup",value:function(){return this.markups[1]}},{key:"getShapeMarkup",value:function(){return this.markups[0]}},{key:"applyArrowConstraints",value:function(e){this.applyArrowTextConstraint(e),this.applyShapeArrowConstraint(e)}},{key:"applyConstraints",value:function(e,t,n){var r=this;this.markups.forEach((function(t){t!==e&&t.isCompleted()&&e.type===y&&(e.setLocked(!0),t.type===v?r.applyShapeArrowConstraint(n):r.applyArrowTextConstraint(n),e.setLocked(!1))}))}}])&&Pa(n.prototype,r),i&&Pa(n,i),t}(_a);function Ya(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wa=(Ya(Ga={},y,qi),Ya(Ga,k,iA),Ya(Ga,C,cA),Ya(Ga,m,CA),Ya(Ga,E,QA),Ya(Ga,v,DA),Ya(Ga,B,XA),Ya(Ga,w,na),Ya(Ga,T,Ra),Ya(Ga,M,za),Ya(Ga,S,ua),Ya(Ga,b,ua),Ya(Ga,U,ga),Ya(Ga,Q,Ba),Ga);function Xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ja=Autodesk.Viewing,qa=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.setGlobalManager(t.globalManager),this.viewer=t.viewer,this.names=["markups"],this.isActive=!1,this.onCameraChangedBinded=this.onCameraChanged.bind(this),this.onEditStartBinded=this.onEditStart.bind(this),this.onEditEndBinded=this.onEditEnd.bind(this),this.onDrawEndBinded=this.onDrawEnd.bind(this),this.onCreationTypeChangedBinded=this.onCreationTypeChanged.bind(this),this.onSelectionChangedBinded=this.onSelectionChanged.bind(this),this.rectSelector=new tn(this.markupsExtension),this.lastDrawEndTime=-1/0}var t,n,r;return t=e,(n=[{key:"getNames",value:function(){return this.names}},{key:"getName",value:function(){return this.names[0]}},{key:"getPriority",value:function(){return this.markupsExtension.markupsManager.isMarkupSessionOpen()?200:60}},{key:"updateToolPriority",value:function(){this.markupsExtension.viewer.toolController.rearrangeByPriorities()}},{key:"intersectHandler",value:function(e,t){if(this.lastMousePos)for(var n=e.length-1;n>=0;n--){var r=e[n];if(r.isCompleted()){var i=r[t];if(i){var A=this.lastMousePos.clone();if(i.intersect(A)||i.isDragging())return i.getCursor()}}}return null}},{key:"getCursor",value:function(){var e=this.markupsExtension.markupsManager.getDuringCreationMarkup(!1),t=this.markupsExtension.markupsManager.getEnabledMarkups(),n=this.markupsExtension.markupsManager.getActiveLayer(),r=this.hasSelection(),i=null;if(this.markupsExtension.markupsManager.isMarkupSessionOpen()){var A=this.markupsExtension.markupsManager.getInEditMarkups(),a=n.getAllLinks();i=(i=(i=(i=(i=(i=(i=e&&e.creationHandler.getCursor())||this.intersectHandler(a,"anchorHandler"))||this.intersectHandler(A,"anchorHandler"))||this.intersectHandler(A,"scaleHandler"))||this.intersectHandler(A,"rotationHandler"))||this.intersectHandler(A,"translationHandler"))||this.intersectHandler(A,"dimensionEditHandler")}if(i=i||this.intersectHandler(t,"selectionHandler"),!this.markupsExtension.markupsManager.isMarkupSessionOpen()){var o=this.markupsExtension.markupsManager.getVisibleLinks();i=i||this.intersectHandler(o,"selectionHandler")}var s=this.markupsExtension.markupsManager.getMarkupCreationType();return i||s!==x||this.isRectSelectorActive()||(i="auto"),i=i||s&&(r&&!this.isRectSelectorActive()?"auto":At[s]||"crosshair")}},{key:"register",value:function(){this.snapper=new Autodesk.Viewing.Extensions.Snapping.Snapper(this.viewer,{markupMode:!0}),this.viewer.toolController.registerTool(this.snapper)}},{key:"deregister",value:function(){this.snapper&&(this.viewer.toolController.deregisterTool(this.snapper),this.snapper=null)}},{key:"activate",value:function(e){e!==this.getName()||this.isActive||(this.isActive=!0,this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_EDIT_START,this.onEditStartBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_EDIT_END,this.onEditEndBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_DRAWING_END,this.onDrawEndBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_CREATION_TYPE_CHANGED,this.onCreationTypeChangedBinded),this.addDocumentEventListener("selectionchange",this.onSelectionChangedBinded))}},{key:"deactivate",value:function(e){e===this.getName()&&this.isActive&&(this.isActive=!1,this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_EDIT_START,this.onEditStartBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_EDIT_END,this.onEditEndBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_DRAWING_END,this.onDrawEndBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_CREATION_TYPE_CHANGED,this.onCreationTypeChangedBinded),this.removeDocumentEventListener("selectionchange",this.onSelectionChangedBinded),this.onCreationTypeChanged())}},{key:"onSelectionChanged",value:function(){this.markupsExtension.markupsManager.getSelectedMarkups().forEach((function(e){e.isTextMarkup()&&e.isInEdit()&&e.textInputHandler.updateCaretPosition()}))}},{key:"eventToWorld",value:function(e){var t={x:e.canvasX,y:e.canvasY};return this.markupsExtension.renderer.clientToWorld(t)}},{key:"getSnappedPosition",value:function(){if(!this.lastSnapPoint)if(this.viewer.impl.is2d||this.isSnappingAllowed()){var e={x:this.originalEvent.canvasX,y:this.originalEvent.canvasY};if(this.snapper.onMouseMove(e),this.viewer.model.getData().isLeaflet||this.snapper.indicator.render(),this.snapper.isSnapped()){var t=Autodesk.Viewing.MeasureCommon.getSnapResultPosition(this.snapper.getSnapResult(),this.viewer);this.lastSnapPoint=this.markupsExtension.renderer.documentCameraToMarkupsCamera(t)}else this.lastSnapPoint=this.lastMousePos}else this.lastSnapPoint=this.lastMousePos;return this.lastSnapPoint.clone()}},{key:"applyHandler",value:function(e,t,n,r){for(var i=e.length-1;i>=0;i--){var A=e[i];if(A.isCompleted()){var a=A[t];if(a&&a[n](this.lastMousePos,r))return!0}}return!1}},{key:"isNavigationToolActive",value:function(){return this.viewer.getActiveNavigationTool()!==this.getName()}},{key:"isSnappingAllowed",value:function(){var e=this.markupsExtension.markupsManager.getMarkupCreationType();return e&&Wa[e].withSnappingMarkup&&(e===U||!this.viewer.model.getData().isLeaflet)}},{key:"isRectSelectorActive",value:function(){return this.markupsExtension.markupsManager.isMarkupSessionOpen()&&this.markupsExtension.markupsManager.getMarkupCreationType()===x}},{key:"hasSelection",value:function(){var e=this.markupsExtension.markupsManager.isMarkupSessionOpen();return this.markupsExtension.markupsManager.getSelectedMarkups().length>0||!e&&(this.markupsExtension.markupsManager.getSelectedLayers().length>0||this.markupsExtension.markupsManager.getSelectedLinks().length>0)}},{key:"handleMouseEvent",value:function(e,t,n,r){if(!this.markupsExtension.isToolEnabled())return!1;this.lastMousePos=this.eventToWorld(e),this.originalEvent=e,this.markupsExtension.renderer.updateRaycaster({x:e.canvasX,y:e.canvasY});var i,A,a=this.markupsExtension.markupsManager.getMarkupCreationType(),o=this.markupsExtension.markupsManager.isMarkupSessionOpen();if(!this.markupInEdit&&(!a||!Wa[a].useTimerBeforeSelection||Wa[a].useTimerBeforeSelection&&performance.now()-this.lastDrawEndTime>it)){var s=this.markupsExtension.markupsManager.getEnabledMarkups().filter((function(e){return!e.isSelected()}));i=i||this.applyHandler(s,"selectionHandler",n,t)}var u=this.markupsExtension.markupsManager.getActiveLayer();if(a&&(A=this.markupsExtension.markupsManager.getDuringCreationMarkup(!1))&&!A.isCompleted())if(i)A.creationHandler.creationCancel();else{var l=A.creationHandler.getSnappedPosition();i="handleMouseMove"===n&&!this.mouseMoved&&!A.creationHandler.creationStarted||A.creationHandler[n](l,t)}if(o){var c=u.getAllLinks();i=i||this.applyHandler(c,"anchorHandler",n,t);var h=this.markupsExtension.markupsManager.getInEditMarkups();i=(i=(i=(i=(i=(i=i||this.applyHandler(h,"scaleHandler",n,t))||this.applyHandler(h,"anchorHandler",n,t))||this.applyHandler(h,"rotationHandler",n,t))||this.applyHandler(h,"translationHandler",n,t))||this.applyHandler(h,"dimensionEditHandler",n,t))||this.applyHandler(h,"textInputHandler",n,t)}if(!i&&"handleMouseMove"===n&&this.isSnappingAllowed()&&this.getSnappedPosition(),this.isRectSelectorActive()&&(i=i||this.rectSelector[n](this.lastMousePos)),!o){var d=this.markupsExtension.markupsManager.getVisibleLinks();i=i||this.applyHandler(d,"selectionHandler",n,t)}if(!i&&("handleButtonUp"===n||"handleButtonDown"===n&&a&&Wa[a].singleClickMarkup)&&(!this.hasSelection()||this.shiftDown||this.mouseMoved||this.isRectSelectorActive()||(this.markupsExtension.markupsManager.deselectAllMarkups(),this.markupsExtension.markupsManager.deselectAllLinks(),o||this.markupsExtension.markupsManager.deselectAllLayers(null),i=!0)),!i&&r&&a&&!this.isNavigationToolActive()&&(A=this.markupsExtension.markupsManager.getDuringCreationMarkup(!0))){var f=A.creationHandler.getSnappedPosition();(i=A.creationHandler[n](f,t))||A.creationHandler.creationCancel()}return this.lastSnapPoint=null,i}},{key:"handleButtonDown",value:function(e,t){if(this.dragging=!0,this.buttonDownPos=new THREE.Vector2(e.canvasX,e.canvasY,0),this.mouseMoved=!1,this.buttonDownConsumed=!1,this.selectedOnDown=!1,this.panning=!Autodesk.Viewing.isMobileDevice()&&(this.isRightClick(e)||this.isMiddleClick(e)),this.panning)return!1;this.markupsExtension.markupsManager.dispatchEvent({type:A.BUTTON_DOWN}),this.buttonDownConsumed=this.handleMouseEvent(e,t,"handleButtonDown",!0);var n=this.markupsExtension.markupsManager.getSelectedMarkups();return this.selectedOnDown=n.length>0,this.buttonDownConsumed}},{key:"handleButtonUp",value:function(e,t){if(this.dragging=!1,this.buttonDownPos=null,this.buttonUpConsumed=!1,this.buttonUpCalled=!0,this.panning||this.mouseMoved&&!this.buttonDownConsumed)return this.panning=!1,this.mouseMoved=!1,!1;var n=this.handleMouseEvent(e,t,"handleButtonUp",!1),r=this.markupsExtension.markupsManager.getSelectedMarkups();if(!this.mouseMoved&&this.selectedOnDown&&!r[0]){var i=this.markupsExtension.markupsManager.getDuringCreationMarkup(!1);i&&i.creationHandler.creationCancel(),this.markupsExtension.markupsManager.deselectAllMarkups()}this.buttonUpConsumed=n;var A=this.mouseMoved;return this.mouseMoved=!1,n&&A||this.isRectSelectorActive()}},{key:"handleDoubleClick",value:function(e,t){var n=this.handleMouseEvent(e,t,"handleDoubleClick",!1),r=this.markupsExtension.markupsManager.isMarkupSessionOpen()&&this.markupsExtension.markupsManager.getMarkupCreationType();return n||r}},{key:"handleMouseMove",value:function(e){if(this.panning)return!1;this.buttonDownPos&&!this.mouseMoved&&(this.mouseMoved=new THREE.Vector2(e.canvasX,e.canvasY,0).distanceTo(this.buttonDownPos)>Se),this.markupsExtension.markupsManager.unhoverAllLayers(),this.markupsExtension.markupsManager.unhoverAllMarkups();var t=this.handleMouseEvent(e,null,"handleMouseMove",!1);return this.dragging&&t}},{key:"handleKeyDown",value:function(e,t){var n=this,r=this.markupsExtension.markupsManager.getInEditMarkups(),i=!1,a=this.markupsExtension.markupsManager.getDuringCreationMarkup(!1);if(a)i=a.creationHandler.handleKeyDown(e,t);else{var o;this.markupsExtension.markupsManager.openActionGroup();for(var s=r.length-1;s>=0;s--){var u=r[s];u&&u.isCompleted()&&((o=u.anchorHandler&&u.anchorHandler.handleKeyDown(e,t))||(o=u.textInputHandler&&u.textInputHandler.handleKeyDown(e,t)),o||(o=u.scaleHandler&&u.scaleHandler.handleKeyDown(e,t)),o||(o=u.rotationHandler&&u.rotationHandler.handleKeyDown(e,t)),o||(o=u.translationHandler&&u.translationHandler.handleKeyDown(e,t)),o||(o=u.dimensionEditHandler&&u.dimensionEditHandler.handleKeyDown(e,t)),o||(o=u.selectionHandler&&u.selectionHandler.handleKeyDown(e,t))),i=i||o}this.markupsExtension.markupsManager.closeActionGroup()}for(var l=this.markupsExtension.markupsManager.getVisibleLinks(),c=l.length-1;c>=0;c--){var h=l[c];i=(i=i||h.anchorHandler&&h.anchorHandler.handleKeyDown(e,t))||h.selectionHandler&&h.selectionHandler.handleKeyDown(e,t)}if(!i)switch(t){case Autodesk.Viewing.KeyCode.CONTROL:this.ctrlDown=!0;break;case Autodesk.Viewing.KeyCode.SHIFT:this.shiftDown=!0,i=!0;break;case Autodesk.Viewing.KeyCode.a:this.ctrlDown&&this.markupsExtension.markupsManager.isMarkupSessionOpen()&&(this.markupsExtension.markupsManager.getActiveLayer().selectAllMarkups(),i=!0);break;case Autodesk.Viewing.KeyCode.x:this.ctrlDown&&(this.markupsExtension.cut(),i=!0);break;case Autodesk.Viewing.KeyCode.c:this.ctrlDown&&(this.markupsExtension.copy(),i=!0);break;case Autodesk.Viewing.KeyCode.v:this.ctrlDown&&(this.markupsExtension.paste(),i=!0);break;case Autodesk.Viewing.KeyCode.d:this.ctrlDown&&(this.markupsExtension.copy(),this.markupsExtension.paste(),i=!0);break;case Autodesk.Viewing.KeyCode.z:this.ctrlDown&&!this.shiftDown?(this.markupsExtension.undo(),i=!0):this.ctrlDown&&this.shiftDown&&(this.markupsExtension.redo(),i=!0);break;case Autodesk.Viewing.KeyCode.y:this.ctrlDown&&(this.markupsExtension.redo(),i=!0);break;case Autodesk.Viewing.KeyCode.ESCAPE:this.markupsExtension.markupsManager.getSelectedMarkups().length>0?(this.markupsExtension.markupsManager.deselectAllMarkups(),i=!0):this.markupsExtension.markupsManager.isMarkupSessionOpen()?(this.markupsExtension.markupsManager.getActiveLayer().isEmpty()?this.markupsExtension.endMarkupSession(!1):this.markupsExtension.markupsManager.dispatchEvent({type:A.LAYER_DISCARD_PRESSED,onConfirmCB:function(){n.markupsExtension.endMarkupSession(!1)}}),i=!0):this.markupsExtension.markupsManager.getSelectedLayers().length>0&&(this.markupsExtension.markupsManager.deselectAllLayers(),i=!0);break;case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:this.markupsExtension.markupsManager.deleteInEditMarkups()}return i}},{key:"handleSingleClick",value:function(e,t){return this.buttonUpConsumed}},{key:"handleKeyUp",value:function(e,t){var n=this.markupsExtension.markupsManager.getInEditMarkups(),r=this.markupsExtension.markupsManager.getDuringCreationMarkup(!1);if(r)r.creationHandler.handleKeyUp(e,t);else{this.markupsExtension.markupsManager.openActionGroup();for(var i=n.length-1;i>=0;i--){var A=n[i];A&&A.isCompleted()&&(e.isDuringEdit=i<n.length-1,A.anchorHandler&&A.anchorHandler.handleKeyUp(e,t)||A.translationHandler&&A.translationHandler.handleKeyUp(e,t))}this.markupsExtension.markupsManager.closeActionGroup()}switch(t){case Autodesk.Viewing.KeyCode.CONTROL:this.ctrlDown=!1;break;case Autodesk.Viewing.KeyCode.SHIFT:this.shiftDown=!1}return!1}},{key:"onCameraChanged",value:function(){this.isSnappingAllowed()&&!this.viewer.model.getData().isLeaflet&&this.snapper.indicator.render()}},{key:"onCreationTypeChanged",value:function(){this.snapper.indicator.clearOverlays()}},{key:"onEditStart",value:function(){this.markupInEdit=!0,this.snapper.indicator.clearOverlays()}},{key:"onEditEnd",value:function(){this.markupInEdit=!1,this.snapper.indicator.clearOverlays()}},{key:"onDrawEnd",value:function(){this.lastDrawEndTime=performance.now()}},{key:"isMiddleClick",value:function(e){return Autodesk.Viewing.Private.isMiddleClick(e)}},{key:"isRightClick",value:function(e){return Autodesk.Viewing.Private.isRightClick(e,this.viewer.navigation)}},{key:"handleBlur",value:function(){this.ctrlDown=!1,this.shiftDown=!1}},{key:"handleSingleTap",value:function(e){var t=this.buttonUpConsumed;return this.buttonUpCalled||(this.handleButtonDown(e,0),t=this.handleButtonUp(e,0)||this.buttonUpConsumed),this.buttonUpCalled=!1,t}},{key:"handleDoubleTap",value:function(e){return this.handleDoubleClick(e,0)}},{key:"isNavigationJustEnded",value:function(){return this.navigationEndTime&&Date.now()-this.navigationEndTime<We}},{key:"handleGesture",value:function(e){var t;switch(e.type){case"dragstart":return!this.isNavigationJustEnded()&&this.handleButtonDown(e,0);case"dragmove":return!this.isNavigationJustEnded()&&this.handleMouseMove(e);case"dragend":return!this.isNavigationJustEnded()&&(t=this.handleButtonUp(e,0),this.buttonUpCalled=!1,t);case"pinchend":case"panend":this.navigationEndTime=Date.now()}return!1}}])&&Xa(t.prototype,n),r&&Xa(t,r),e}();function Za(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ja.GlobalManagerMixin.call(qa.prototype);var $a=Autodesk.Viewing,eo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t.viewer,this.setGlobalManager(t.globalManager),this.options=t.options,this.markupsExtension=t,this.createUI()}var t,n,r;return t=e,(n=[{key:"createUI",value:function(){var e=this.options.uiClasses;if(e){var t=this.getDocument();this.uiContainer=t.createElement("div"),this.uiContainer.id="MarkupsUI_Container",this.uiContainer.className="MarkupsUI_Container",this.viewer.container.appendChild(this.uiContainer);var n=e.ToolbarClass;this.toolbar=n&&new n(this.markupsExtension,this.uiContainer,this.viewer,this.options);var r=e.CreationToastClass;this.creationToast=r&&new r(this.markupsExtension,this.uiContainer,this.viewer,this.options);var i=e.ContextualMenuClass;this.contextualMenu=i&&new i(this.markupsExtension,this.uiContainer,this.viewer,this.options);var A=e.AttachmentsPreviewPanelClass;this.attachmentsPreviewPanel=A&&new A(this.markupsExtension,this.uiContainer,this.viewer,this.options);var a=e.MarkupsDialogModalsClass;if(this.MarkupsDialogModals=a&&new a(this.markupsExtension,this.uiContainer,this.viewer,this.options),this.viewer.impl.is2d){var o=e.MarkupsVisibilityButtonClass;this.markupsVisibilityButton=o&&new o(this.markupsExtension,this.uiContainer,this.viewer,this.options)}else{var s=e.ExitMarkupViewClass;this.exitMarkupView=s&&new s(this.markupsExtension,this.uiContainer,this.viewer,this.options)}this.registerEventListeners()}}},{key:"destroy",value:function(){this.toolbar&&(this.toolbar.destroy(),this.toolbar=null),this.creationToast&&(this.creationToast.destroy(),this.creationToast=null),this.contextualMenu&&(this.contextualMenu.destroy(),this.contextualMenu=null),this.attachmentsPreviewPanel&&(this.attachmentsPreviewPanel.destroy(),this.attachmentsPreviewPanel=null),this.markupsVisibilityButton&&(this.markupsVisibilityButton.destroy(),this.markupsVisibilityButton=null),this.exitMarkupView&&(this.exitMarkupView.destroy(),this.exitMarkupView=null),this.unregisterEventListeners(),this.uiContainer&&(this.viewer.container.removeChild(this.uiContainer),this.uiContainer=null),this.markupsExtension=null,this.viewer=null,this.options=null}},{key:"registerEventListeners",value:function(){this.onSessionStartBinded=this.onSessionStart.bind(this),this.onSessionEndBinded=this.onSessionEnd.bind(this),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_SESSION_START,this.onSessionStartBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_SESSION_END,this.onSessionEndBinded),this.markupsExtension.markupsManager.addEventListener(A.LAYER_SELECTED,this.onSessionStartBinded),this.markupsExtension.markupsManager.addEventListener(A.LAYER_DESELECTED,this.onSessionEndBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_CREATION_TYPE_CHANGED,this.onSessionStartBinded)}},{key:"unregisterEventListeners",value:function(){this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_SESSION_START,this.onSessionStartBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_SESSION_END,this.onSessionEndBinded),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_SELECTED,this.onSessionStartBinded),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_DESELECTED,this.onSessionEndBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_CREATION_TYPE_CHANGED,this.onSessionStartBinded)}},{key:"onSessionStart",value:function(){this.selectNavigationButton(null),this.viewer.impl.is2d&&this.handleNavButtonEvents(!0)}},{key:"onSessionEnd",value:function(){this.viewer.impl.is2d&&this.handleNavButtonEvents(!1),this.selectNavigationButton(this.markupsExtension.markupsManager.navigationToolBackup)}},{key:"getNavigationControls",value:function(){return this.viewer.getToolbar().getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID)._controls}},{key:"handleNavButtonEvents",value:function(e){var t=this;this.onNavButtonClickBinded=this.onNavButtonClick.bind(this);var n=this.getNavigationControls(),r=function(n){e?n.hasEventListener(Autodesk.Viewing.UI.Button.Event.CLICK,t.onNavButtonClickBinded)||n.addEventListener(Autodesk.Viewing.UI.Button.Event.CLICK,t.onNavButtonClickBinded):n.removeEventListener(Autodesk.Viewing.UI.Button.Event.CLICK,t.onNavButtonClickBinded)};n.forEach((function(e){r(e),e.subMenu&&e.subMenu._controls.forEach((function(e){r(e)}))}))}},{key:"onNavButtonClick",value:function(e){var t=this;this.getNavigationControls().forEach((function(n){n._id!==e.target._id?n.setState(Autodesk.Viewing.UI.Button.State.INACTIVE):n.getState()===Autodesk.Viewing.UI.Button.State.INACTIVE&&(t.markupsExtension.markupsManager.changeMarkupCreationType(null),n.setState(Autodesk.Viewing.UI.Button.State.ACTIVE),setTimeout((function(){t.markupsExtension.markupsManager.navigationToolBackup=t.viewer.getActiveNavigationTool()})))}))}},{key:"selectNavigationButton",value:function(e){var t=function(t){var n=-1!==t._id.toLowerCase().indexOf(e);t.setState(n?Autodesk.Viewing.UI.Button.State.ACTIVE:Autodesk.Viewing.UI.Button.State.INACTIVE)};this.getNavigationControls().forEach((function(e){t(e),e.subMenu&&e.subMenu._controls.forEach((function(e){t(e)}))}))}}])&&Za(t.prototype,n),r&&Za(t,r),e}();$a.GlobalManagerMixin.call(eo.prototype);var to={executeAfterExtensionLoaded:function(e,t,n){var r=e.getExtension(t);r?n(r):e.addEventListener(Autodesk.Viewing.EXTENSION_LOADED_EVENT,(function r(i){i.extensionId===t&&(e.removeEventListener(Autodesk.Viewing.EXTENSION_LOADED_EVENT,r),n(e.getExtension(t)))}))},executeAfterTransitionEnded:function(e,t){e.navigation.getRequestTransition()||e.navigation.getTransitionActive()?setTimeout((function(){e.navigation.getRequestTransition()||e.navigation.getTransitionActive()?e.addEventListener(Autodesk.Viewing.CAMERA_TRANSITION_COMPLETED,(function(){t()}),{once:!0}):t()}),1):t()},executeAfterGeometryLoaded:function(e,t){e.model&&e.model.isLoadDone()?t():e.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,t,{once:!0})}},no=to;function ro(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var io=function(){function e(t,n,r,i,A){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.guid=t,this.resources=n||[],this.attachments=r||[],this.status=i,this.metadata=A||{}}var t,n,r;return t=e,(n=[{key:"getSvgResource",value:function(){return this.resources[0]&&this.resources[0].data}},{key:"getScreenCaptureResource",value:function(){return this.resources[1]&&this.resources[1].data}},{key:"getLinksMetadata",value:function(){return this.metadata&&this.metadata.markup_metadata&&this.metadata.markup_metadata.links}},{key:"getMetadata",value:function(){return this.metadata}}])&&ro(t.prototype,n),r&&ro(t,r),e}();function Ao(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ao=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.viewer=t.viewer,this.link=n,this.link.syncEditState()}var t,n,r;return t=e,(n=[{key:"getEditState",value:function(){return this.link.getEditState()}},{key:"setEditState",value:function(e){this.link.setEditState(e)}},{key:"updateEditState",value:function(e){this.setEditState(Object.assign({},this.getEditState(),e))}},{key:"submitChanges",value:function(){new bt(this.markupsExtension.markupsManager,this.link,this.getEditState()).execute()}},{key:"isDragging",value:function(){return!1}},{key:"getTouchRadiusWorld",value:function(){return this.markupsExtension.renderer.sizeFromClientToWorld(Ce)}},{key:"getMinChangeDistanceWorld",value:function(){return this.markupsExtension.renderer.sizeFromClientToWorld(Se)}},{key:"didMouseMove",value:function(){return this.markupsExtension.markupsTool.mouseMoved}},{key:"handleDoubleClick",value:function(e,t){}},{key:"handleButtonDown",value:function(e,t){}},{key:"handleButtonUp",value:function(e,t){}},{key:"handleKeyDown",value:function(e,t){}},{key:"handleKeyUp",value:function(e,t){}},{key:"handleMouseMove",value:function(e){}},{key:"handleGesture",value:function(e){}},{key:"handleResize",value:function(){}},{key:"destroy",value:function(){this.markupsExtension=null,this.viewer=null,this.link=null}}])&&Ao(t.prototype,n),r&&Ao(t,r),e}();function oo(e){return(oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function so(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uo(e,t){return!t||"object"!==oo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lo(e){return(lo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function co(e,t){return(co=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ho=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),uo(this,lo(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&co(e,t)}(t,e),n=t,(r=[{key:"handleMouseMove",value:function(e){var t=this.grabbing||this.intersect(e);return this.link.setHover(t),!!this.grabbing&&(this.updatePosition(e),!0)}},{key:"handleButtonDown",value:function(e,t){return!!this.grabbing||(this.grabbing=this.intersect(e),this.grabbing&&(this.originalPosition=e.clone(),this.lastTranslationPoint=e),!!this.grabbing)}},{key:"handleButtonUp",value:function(e,t){return!!this.grabbing&&(this.updatePosition(e),Ht(e,this.originalPosition,this.getMinChangeDistanceWorld())?(this.cancelAnchorEditing(),!1):(this.submitChanges(),this.grabbing=!1,this.lastTranslationPoint=null,!0))}},{key:"handleKeyDown",value:function(e,t){if(this.grabbing)switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:return this.cancelAnchorEditing(),!0}return!1}},{key:"updateEditStatePosition",value:function(){this.updateEditState({position:this.getEditState().position})}},{key:"updatePosition",value:function(e){var t=e.clone().sub(this.lastTranslationPoint);this.link.editState.position||(this.link.editState.position=this.link.getLinkBasePosition()),Dt(this.link.editState.position,t),this.lastTranslationPoint=e,this.updateEditStatePosition()}},{key:"cancelAnchorEditing",value:function(){this.grabbing=!1,this.link.syncEditState(),this.updateEditStatePosition()}},{key:"isDragging",value:function(){return this.grabbing}},{key:"intersect",value:function(e){var t=this.markupsExtension.renderer.worldToClient(e);return this.link.getClientBoundingBox().containsPoint(t)}},{key:"getCursor",value:function(){return this.grabbing?"grabbing":"grab"}}])&&so(n.prototype,r),i&&so(n,i),t}(ao);function fo(e){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function po(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function go(e,t){return!t||"object"!==fo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yo(e){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mo(e,t){return(mo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Eo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),go(this,yo(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mo(e,t)}(t,e),n=t,(r=[{key:"intersect",value:function(e){var t=this.markupsExtension.renderer.worldToClient(e);return this.link.getClientBoundingBox().containsPoint(t)}},{key:"handleMouseMove",value:function(e){if(this.markupsExtension.markupsTool.dragging||Autodesk.Viewing.isMobileDevice())return!1;var t=this.intersect(e);return this.link.setHover(t),t&&this.link.layer.setHover(!0),t}},{key:"getCursor",value:function(){return"pointer"}},{key:"handleButtonUp",value:function(e,t){return!(this.didMouseMove()||!this.intersect(e)||(this.markupsExtension.markupsManager.deselectAllLinks(),this.markupsExtension.markupsManager.selectLink(this.link),0))}}])&&po(n.prototype,r),i&&po(n,i),t}(ao);function vo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Bo=function(){function e(t,n,r,i,A,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=n,this.guid=r,this.layer=i,this.type=A,this.markupsExtension=t,this.visible=!0,this.selected=!1,this.hover=!1,this.dirty=!1,a?this.state=a:(this.state=this.getDefaultState(),this.state.style=this.getDefaultStyle()),this.editState={},this.registerSelectionHandler(),this.registerAnchorHandler()}var t,n,r;return t=e,(n=[{key:"getDefaultState",value:function(){return{}}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(e){this.state=e}},{key:"getEditState",value:function(){return this.editState}},{key:"setEditState",value:function(e){this.editState=e,this.setDirty(!0)}},{key:"syncEditState",value:function(){this.setEditState(ct.cloneDeep(this.getState()))}},{key:"setDirty",value:function(e){this.dirty=e,e&&this.markupsExtension.markupsManager.dispatchEvent({type:A.LINK_DIRTY,link:this})}},{key:"isDirty",value:function(){return this.dirty}},{key:"isVisible",value:function(){return this.layer.isVisible()}},{key:"getLinkBasePosition",value:function(){var e=this.layer.getClientBoundingBox(!0),t=e.max.clone().setY(e.min.y),n=this.markupsExtension.renderer.getCameraUpVector(),r=this.markupsExtension.renderer.getCameraRightVector(),i=this.getClientBoundingBox().size(),A=n.multiplyScalar(this.markupsExtension.renderer.multiplyByNormaStrokeWidth(i.y/2)),a=r.multiplyScalar(this.markupsExtension.renderer.multiplyByNormaStrokeWidth(Le+i.x/2)),o=this.markupsExtension.renderer.getCameraEyeVector(),s=this.markupsExtension.renderer.getCameraRotation();return st.applyRotation(t,-s,e.center(),o),this.markupsExtension.renderer.clientToWorld(t).sub(A).add(a)}},{key:"getClientBoundingBox",value:function(){return this.markupsExtension.renderer.linksRenderer.getLinkBoundingBox(this)}},{key:"getPosition",value:function(){return this.editState.position?this.editState.position:this.getLinkBasePosition()}},{key:"select",value:function(){this.selected=!0,this.markupsExtension.markupsManager.dispatchEvent({type:A.LINK_SELECTED,link:this}),this.setDirty(!0)}},{key:"deselect",value:function(){this.selected=!1,this.markupsExtension.markupsManager.dispatchEvent({type:A.LINK_DESELECTED,link:this}),this.setDirty(!0)}},{key:"isSelected",value:function(){return this.selected}},{key:"setHover",value:function(e){this.hover!==e&&(this.hover=e,this.setDirty(!0))}},{key:"isHovered",value:function(){return this.hover}},{key:"isCompleted",value:function(){return!0}},{key:"registerSelectionHandler",value:function(){this.selectionHandler=new Eo(this.markupsExtension,this)}},{key:"registerAnchorHandler",value:function(){this.anchorHandler=new ho(this.markupsExtension,this)}},{key:"destroy",value:function(){this.translationHandler&&(this.translationHandler.destroy(),this.translationHandler=null),this.markupsExtension=null,this.state=null,this.editState=null}}])&&vo(t.prototype,n),r&&vo(t,r),e}();function wo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ko=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.id=n,this.layerData=!r||r instanceof io?r:new io(r.guid,r.resources,r.attachments,r.status,r.metadata),this.markups={},this.links={},this.selected=!1,this.visible=!1,this.transparent=!1,this.hover=!1}var t,n,r;return t=e,(n=[{key:"addMarkup",value:function(e){this.markups[e.id]=e,e.layer=this,e.setVisible(this.visible,!0)}},{key:"deleteMarkup",value:function(e){var t=e instanceof Oi?e.id:e;this.markups[t]?(e.deselect(),delete this.markups[t],e.remove(),e.layer=null,this.setDirty()):console.warn("deleteMarkup - markup does not exist")}},{key:"deleteAllMarkups",value:function(){var e=this;_t(this.markups,(function(t){e.deleteMarkup(t)}))}},{key:"getMarkupById",value:function(e){return this.markups[e]}},{key:"isEmpty",value:function(){return 0===Object.keys(this.markups).length}},{key:"addLink",value:function(e){this.links[e.id]=e}},{key:"deleteLink",value:function(e){var t=e instanceof Bo?e.id:e;this.links[t]?(this.markupsExtension.markupsManager.dispatchEvent({type:A.LINK_REMOVED,link:e}),delete this.links[t]):console.warn("deleteLink - markup does not exist")}},{key:"deleteAllLinks",value:function(){var e=this;_t(this.links,(function(t){e.deleteLink(t)}))}},{key:"getLinkById",value:function(e){return this.links[e]}},{key:"getClientBoundingBox",value:function(e){var t=this.getWorldBoundingBox();t.min=this.markupsExtension.renderer.worldToClient(t.min),t.max=this.markupsExtension.renderer.worldToClient(t.max);var n=this.markupsExtension.renderer.getCameraEyeVector(),r=t.center(),i=this.markupsExtension.renderer.getCameraRotation();if(st.applyRotation(t.min,i,r,n),st.applyRotation(t.max,i,r,n),st.swapBoundingBoxY(t),e){var A=this.getMarginSize();t.expandByVector(new THREE.Vector3(A,A,0))}return t.min.z=0,t.max.z=0,t}},{key:"getMarginSize",value:function(){return Pe}},{key:"getWorldBoundingBox",value:function(){var e=new THREE.Box3;return _t(this.markups,(function(t){var n=t.getWorldBoundingBox(!0);e.union(n)})),e}},{key:"getRotation",value:function(){return 0}},{key:"getAllMarkups",value:function(){return Lt(this.markups)}},{key:"getAllLinks",value:function(){return Lt(this.links)}},{key:"hasSingleMarkup",value:function(){return 1===this.getAllMarkups().length}},{key:"select",value:function(){this.selected=!0,this.markupsExtension.markupsManager.dispatchEvent({type:A.LAYER_SELECTED,layer:this}),this.setDirty()}},{key:"deselect",value:function(){this.selected=!1,this.markupsExtension.markupsManager.dispatchEvent({type:A.LAYER_DESELECTED,layer:this}),this.setDirty()}},{key:"isSelected",value:function(){return this.selected}},{key:"setHover",value:function(e){this.hover!==e&&(this.hover=e,this.getAllLinks().forEach((function(t){t.setHover(e)})),this.setDirty())}},{key:"isHovered",value:function(){return this.hover}},{key:"unhoverAllMarkups",value:function(){this.getAllMarkups().forEach((function(e){e.setHover(!1)}))}},{key:"setVisible",value:function(e){this.visible=e,_t(this.markups,(function(t){t.setVisible(e)})),this.setDirty()}},{key:"isVisible",value:function(){return this.visible}},{key:"setDirty",value:function(){this.markupsExtension.markupsManager.dispatchEvent({type:A.LAYER_DIRTY,layer:this})}},{key:"getGuid",value:function(){return this.layerData&&this.layerData.guid}},{key:"selectAllMarkups",value:function(){this.getAllMarkups().forEach((function(e){e.select()}))}},{key:"changeTransparency",value:function(e){this.transparent=e,this.getAllMarkups().forEach((function(t){t.changeTransparency(e)}))}},{key:"isTransparent",value:function(){return this.transparent}},{key:"enable",value:function(){this.getAllMarkups().forEach((function(e){e.enable()}))}},{key:"disable",value:function(){this.getAllMarkups().forEach((function(e){e.disable()}))}}])&&wo(t.prototype,n),r&&wo(t,r),e}();function Co(e){return(Co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bo(e,t){return!t||"object"!==Co(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function So(e){return(So=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function To(e,t){return(To=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mo,Uo,Qo,xo=(Qo=function(e){function t(e,n,r,i,A){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),bo(this,So(t).call(this,e,n,r,i,Ae,A))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&To(e,t)}(t,e),t}(Bo),(Uo=Ae)in(Mo={})?Object.defineProperty(Mo,Uo,{value:Qo,enumerable:!0,configurable:!0,writable:!0}):Mo[Uo]=Qo,Mo),Fo=function(e,t){e&&t&&("eye"in e&&(e.eye[0]=(Number(e.eye[0])+t.x).toString(),e.eye[1]=(Number(e.eye[1])+t.y).toString(),e.eye[2]=(Number(e.eye[2])+t.z).toString()),"target"in e&&(e.target[0]=(Number(e.target[0])+t.x).toString(),e.target[1]=(Number(e.target[1])+t.y).toString(),e.target[2]=(Number(e.target[2])+t.z).toString()),"pivotPoint"in e&&(e.pivotPoint[0]=(Number(e.pivotPoint[0])+t.x).toString(),e.pivotPoint[1]=(Number(e.pivotPoint[1])+t.y).toString(),e.pivotPoint[2]=(Number(e.pivotPoint[2])+t.z).toString()))},_o=function(e,t){var n=e.model,r=n?n.getData().globalOffset:null,i=t.metadata.markup_metadata;if(r){var A=JSON.parse(JSON.stringify(i)),a=A.viewport,o={x:-r.x,y:-r.y,z:-r.z};return Fo(a,o),A}return i},Ho=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};if(t){var i=_o(e,t);e.restoreState(i,null,n);var A=function(){var t=e.navigation.getCamera();e.navigation.updateCamera(),t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),e.impl.sceneUpdated(!0),r(!0)};n?A():no.executeAfterTransitionEnded(e,A);var a=function(){e.impl.sceneUpdated(!0)};e.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a,{once:!0})}else r(!1)},Lo=function(e,t,n,r){var i=t.model.getData().isPdf;if(t.model.getData().isLeaflet||i){var A,a;if(i)A=Autodesk.Viewing.PDFUtils.getLeafletLoadOptions(t),a=Autodesk.Viewing.PDFUtils.getLeafletBoundingBox(t);else{var o=t.model.getData();A=o.loadOptions.loadOptions,a=o.bbox}var s=A,u=s.texWidth,l=s.texHeight,c=u/(r.metadata.markup_metadata&&r.metadata.markup_metadata.originalDocumentResolution&&r.metadata.markup_metadata.originalDocumentResolution[0]||u),h=e.x/(u/c)*a.size().x,d=e.y/(l/c)*a.size().y,f=new THREE.Vector3(h,d,0),p=new THREE.Vector3(a.min.x,a.max.y,0);return f.add(p),i&&Autodesk.Viewing.PDFUtils.leafletToPdfWorld(t,f),f}if(n.documentCamera.isPerspective){var g=t.impl.getCanvasBoundingClientRect();e.x=e.x/Re*(.5*g.height)+.5*g.width,e.y=-e.y/Re*(.5*g.height)+.5*g.height,e=n.clientToWorld(e)}else{e.applyMatrix4(n.documentCamera.matrixWorld),e.sub(n.documentCamera.position);var y=t.model&&t.model.getData().globalOffset;y&&e.sub(y),e=n.documentCameraToMarkupsCamera(e)}return e},Io=function(e,t,n,r){var i=Lo(new THREE.Vector3,t,n,r),A=Lo(new THREE.Vector3(e,0,0),t,n,r);return i.distanceTo(A)},Do=function(e,t,n,r,i){var A=e.childNodes[0].childNodes[0],a=function(e){return A.getAttribute(e)||A.getAttribute(e.toLowerCase())},s=a("type")||"",u=i<5,c=n.model.getData().isLeaflet,h=n.model.getData().isPdf,d={style:{},anchors:[]},f={type:s,state:d},p=function(){for(var e=[],t=a("locations"),n=t&&t.split(" ")||"",r=0;r<n.length;r+=2){var i=new THREE.Vector3(parseFloat(n[r]),parseFloat(n[r+1]),0);e.push(i)}return e},g=function(e){var t=new THREE.Vector3,n=a(e);if(n){var r=n.split(" ");t.x=r[0]&&parseFloat(r[0])||0,t.y=r[1]&&parseFloat(r[1])||0,t.z=r[2]&&parseFloat(r[2])||0}return t},x=function(){return a("text")||""},F=a("groupId");F&&(d.groupId=F,d.groupOrder=parseFloat(a("groupOrder")));var _,H,L,I=a("uuid");switch(I&&(d.uuid=I),d.style=function(e){for(var t=Lt(l),n={},r=0;r<t.length;r++){var i=e.getAttribute(t[r]);if(i)switch(t[r]){case l.THICKNESS:n[t[r]]=parseFloat(i);break;case l.FONT_SIZE:case l.OPACITY:case l.FILL_OPACITY:n[t[r]]=parseFloat(i);break;case l.STROKE_LINEJOIN:break;case l.FONT_FAMILY:case l.FONT_STYLE:case l.FONT_WEIGHT:case l.COLOR:case l.FONT_COLOR:case l.FILL_COLOR:n[t[r]]=i}}return n[l.FONT_COLOR]||(n[l.FONT_COLOR]=n[l.COLOR]),n[l.FILL_COLOR]||(n[l.FILL_COLOR]=o.NO_COLOR),n[l.FILL_COLOR]===o.NO_COLOR&&(n[l.FILL_OPACITY]=de),n}(A),d.position=g("position"),d.rotation=(_=a("rotation"))&&parseFloat(_)||0,d.size=g("size"),n.impl.is2d||Ho(n,t,!0),s){case m:case v:case E:d.anchors[0]=new THREE.Vector3(-d.size.x/2,-d.size.y/2,0),d.anchors[1]=new THREE.Vector3(d.size.x/2,-d.size.y/2,0),d.anchors[2]=new THREE.Vector3(d.size.x/2,d.size.y/2,0),d.anchors[3]=new THREE.Vector3(-d.size.x/2,d.size.y/2,0),u&&s!==v&&(L=d.style[l.THICKNESS]/2,d.anchors[0].add(new THREE.Vector3(L,L,0)),d.anchors[1].add(new THREE.Vector3(-L,L,0)),d.anchors[2].add(new THREE.Vector3(-L,-L,0)),d.anchors[3].add(new THREE.Vector3(L,-L,0)));break;case y:case Q:d.anchors[0]=g("tail"),d.anchors[1]=g("head"),u&&(d.rotation=0);break;case b:case S:d.text=x(),d.isFrameUsed=!!parseInt(a("isFrameUsed"),10),d.frameType=a("frameType")||m,u&&(d.isFrameUsed||(d.style[l.FILL_OPACITY]=0)),d.anchors[0]=new THREE.Vector3(-d.size.x/2,-d.size.y/2,0),d.anchors[1]=new THREE.Vector3(d.size.x/2,-d.size.y/2,0),d.anchors[2]=new THREE.Vector3(d.size.x/2,d.size.y/2,0),d.anchors[3]=new THREE.Vector3(-d.size.x/2,d.size.y/2,0);break;case T:case M:break;case w:case B:d.anchors=p();break;case C:case k:d.anchors=p(),d.closed=function(){var t=e.childNodes[1]||"",n=!1;if("string"!=typeof t){var r=t.getAttribute("d").split(" ");"z"===r[r.length-1].toLowerCase()&&(n=!0)}return n}();break;case U:d.anchors[0]=g("firstAnchor"),d.anchors[1]=g("secondAnchor"),H=g("offset"),d.position.sub(H),d.translation=Lo(H,n,r,t).sub(Lo(new THREE.Vector3,n,r,t)),d.text=x(),u&&(d.style[l.THICKNESS]/=2),d.style[l.FONT_SIZE]/=ze,d.style[l.THICKNESS]/=Ge}return(u||c||h)&&function(){if(d.style.hasOwnProperty(l.FONT_SIZE)){var e=r.getFontToWorldScale();d.style[l.FONT_SIZE]/=e}}(),Dt(d.anchors,d.position),(u&&n.model.is3d()||c||h)&&(d.anchors.forEach((function(e){e.copy(Lo(e,n,r,t))})),d.style[l.THICKNESS]=Io(d.style[l.THICKNESS],n,r,t),d.style[l.FONT_SIZE]=Io(d.style[l.FONT_SIZE],n,r,t)),f},Oo=function(e,t,n,r){try{return JSON.parse(e)}catch(c){for(var i=function(e){var t;try{t=(new DOMParser).parseFromString(e,"text/xml").firstChild}catch(e){console.warn("stringToSvgNode failed to generate an HTMLElement from its string representation.")}return t}(e).childNodes,A=[],a=function(e){var t=e.getAttribute("data-model-version");return"string"==typeof t?parseFloat(t):0}(i[0].childNodes[0]),o=n.impl.is2d?null:n.getState(),s=0;s<i.length;s++){var u=i[s];if(u.childNodes[0].childNodes[0]){var l=Do(u,t,n,r,a);A.push(l)}}return o&&n.restoreState(o,null,!0),A}};function Ro(e){return(Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function No(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Po(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ko(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vo(e,t){return!t||"object"!==Ro(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jo(e){return(jo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Go(e,t){return(Go=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zo=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Vo(this,jo(t).call(this))).markupsExtension=e,n.actionManager=new On,n.registerEvents(),n.reset(),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Go(e,t)}(t,Autodesk.Viewing.EventDispatcher),n=t,(r=[{key:"registerEvents",value:function(){this.onHistoryChangedBinded=this.onHistoryChanged.bind(this),this.actionManager.addEventListener(On.HISTORY_CHANGED_EVENT,this.onHistoryChangedBinded),this.onAllMarkupsLoadedBinded=this.onAllMarkupsLoaded.bind(this),this.addEventListener(A.ALL_MARKUPS_LOADED,this.onAllMarkupsLoadedBinded),this.onMarkupLayerFetchedBinded=this.onMarkupLayerFetched.bind(this),this.addEventListener(A.LAYER_FETCHED,this.onMarkupLayerFetchedBinded),this.onMarkupResourceFetchedBinded=this.onMarkupResourceFetched.bind(this),this.addEventListener(A.LAYER_RESOURCE_FETCHED,this.onMarkupResourceFetchedBinded),this.onMarkupLinkSyncedBinded=this.onMarkupLinkSynced.bind(this),this.addEventListener(A.LINK_SYNCED,this.onMarkupLinkSyncedBinded),this.onLayerSyncedBinded=this.onLayerSynced.bind(this),this.addEventListener(A.LAYER_SYNCED,this.onLayerSyncedBinded),this.onLayerSyncingBinded=this.onLayerSyncing.bind(this),this.addEventListener(A.LAYER_SYNCING,this.onLayerSyncingBinded),this.onLayerSelectedBinded=this.onLayerSelected.bind(this),this.addEventListener(A.LAYER_SELECTED,this.onLayerSelectedBinded),this.onLayerDeselectedBinded=this.onLayerDeselected.bind(this),this.addEventListener(A.LAYER_DESELECTED,this.onLayerDeselectedBinded),this.onCalibrationEndedBinded=this.onCalibrationEnded.bind(this),this.markupsExtension.viewer.addEventListener(Autodesk.Viewing.MeasureCommon.Events.FINISHED_CALIBRATION_FOR_DIMENSION_EVENT,this.onCalibrationEndedBinded),this.onDrawingStartBinded=this.onDrawingStart.bind(this),this.addEventListener(A.MARKUP_DRAWING_START,this.onDrawingStartBinded),this.onDrawingEndBinded=this.onDrawingEnd.bind(this),this.addEventListener(A.MARKUP_DRAWING_END,this.onDrawingEndBinded),this.addEventListener(A.MARKUP_DRAWING_CANCEL,this.onDrawingEndBinded)}},{key:"unregisterEvents",value:function(){this.actionManager.removeEventListener(On.HISTORY_CHANGED_EVENT,this.onHistoryChangedBinded),this.removeEventListener(A.ALL_MARKUPS_LOADED,this.onAllMarkupsLoadedBinded),this.removeEventListener(A.LAYER_FETCHED,this.onMarkupLayerFetchedBinded),this.removeEventListener(A.LAYER_RESOURCE_FETCHED,this.onMarkupResourceFetchedBinded),this.removeEventListener(A.LINK_SYNCED,this.onMarkupLinkSyncedBinded),this.removeEventListener(A.LAYER_SYNCED,this.onLayerSyncedBinded),this.removeEventListener(A.LAYER_SYNCING,this.onLayerSyncingBinded),this.markupsExtension.viewer.removeEventListener(Autodesk.Viewing.MeasureCommon.Events.FINISHED_CALIBRATION_FOR_DIMENSION_EVENT,this.onCalibrationEndedBinded),this.removeEventListener(A.MARKUP_DRAWING_START,this.onDrawingStartBinded),this.removeEventListener(A.MARKUP_DRAWING_END,this.onDrawingEndBinded),this.removeEventListener(A.MARKUP_DRAWING_CANCEL,this.onDrawingEndBinded)}},{key:"createLayer",value:function(e){var t=new ko(this.markupsExtension,this.nextLayerId,e);return this.layers[t.id]=t,this.nextLayerId+=1,this.dispatchEvent({type:A.LAYER_CREATED}),t}},{key:"loadLayers",value:function(e,t,n){var r=this;n&&(this.removeAllLayers([this.getActiveLayer()]),this.markupsExtension.markupsCache&&this.markupsExtension.markupsCache.cleanCache()),(e=e instanceof Array?e:[e]).forEach((function(e){r.markupsExtension.markupsCache&&e.guid&&!r.markupsExtension.markupsCache.get(e.guid)&&r.markupsExtension.markupsCache.add(e.guid,e)}));var i=t?e:this.markupsExtension.filterManager.filterLayers(e);this.getLayersAsList().forEach((function(e){e!==r.getActiveLayer()&&-1===i.findIndex((function(t){return t.guid===e.getGuid()}))&&r.removeLayer(e)})),i.forEach((function(e){if(!r.getLayerByGuid(e.guid)){var t=r.createLayer(e);r.markupsExtension.viewer.impl.is2d&&(t.setVisible(!0),r.loadMarkupsToLayer(t)),r.loadLinksToLayer(t)}}))}},{key:"removeLayer",value:function(e){var t=e.id,n=this.layers[t];n?(this.isMarkupSessionOpen()&&n===this.getActiveLayer()?this.endMarkupSession(!1):this.markupsExtension.viewer.model&&this.markupsExtension.viewer.model.is3d()&&this.isInMarkupView()&&this.getVisibleLayers()[0]===n&&this.exitMarkupView(),this.deselectLayer(e),e.deleteAllMarkups(),e.deleteAllLinks(),e.setVisible(!1),this.dispatchEvent({type:A.LAYER_DELETED,layer:e}),delete this.layers[t]):console.warn("deleteLayer - layer does not exist")}},{key:"removeAllLayers",value:function(e){var t=this;this.getLayersAsList().forEach((function(n){e&&-1!==e.indexOf(n)||t.removeLayer(n)}))}},{key:"deleteLayer",value:function(e){this.dispatchEvent({type:A.LAYER_DELETE,layerData:e.layerData})}},{key:"getLayerById",value:function(e){return this.layers[e]}},{key:"getLayerByGuid",value:function(e){return null==e?null:this.getLayersAsList().find((function(t){return t.getGuid()===e}))}},{key:"addMarkupToLayer",value:function(e,t){return this.getLayerById(t.id)||(this.layers[t.id]=t),this.markupsExtension.markupsManager.getSelectedLayers().length>0&&!t.isSelected()&&e.changeTransparency(!0),(this.isMarkupSessionOpen()&&t!==this.getActiveLayer()||!this.isToolEnabled())&&e.disable(),t.addMarkup(e),!0}},{key:"addLinkToLayer",value:function(e,t){return this.getLayerById(t.id)||(this.layers[t.id]=t),t.addLink(e),!0}},{key:"createMarkup",value:function(e,t,n){var r=Wa[e];return r?new r(this.markupsExtension,this.nextMarkupId++,t,n):null}},{key:"createLink",value:function(e,t){var n=t.position?(new THREE.Vector3).copy(t.position):null;n&&this.markupsExtension.viewer.model.getData().isPdf&&Autodesk.Viewing.PDFUtils.leafletToPdfWorld(this.markupsExtension.viewer,n);var r=new xo[t.type](this.markupsExtension,this.nextLinkId,t.id,e,{position:n});return this.nextLinkId+=1,r}},{key:"onAllMarkupsLoaded",value:function(e){var t=e.amount;console.log("All markups have been loaded. Amount: "+t)}},{key:"onMarkupLayerFetched",value:function(e){var t=this,n=e.layerData;this.markupsExtension.filterManager.filterLayers([n]).forEach((function(e){var n=t.createLayer(e);t.markupsExtension.viewer.impl.is2d&&n.setVisible(!0)}))}},{key:"onMarkupResourceFetched",value:function(e){var t=e.layerData;if(this.markupsExtension.viewer.impl.is2d){var n=this.getLayerByGuid(t.guid);n&&this.loadMarkupsToLayer(n)}}},{key:"onMarkupLinkSynced",value:function(e){var t=e.documentAttachment,n=e.layerData,r=this.getLayerByGuid(n.guid);r&&(t&&t.status===q&&0===n.attachments.length&&r.deleteAllLinks(),this.loadLinksToLayer(r))}},{key:"onDrawingStart",value:function(){var e=this.getDuringCreationMarkup(!1);this.polySaveDisabled=e&&e.inEdit&&(e.type===k||e.type===C),this.dispatchEvent({type:A.LAYER_READY_TO_SAVE,readyToSave:this.getReadyToSave()})}},{key:"onDrawingEnd",value:function(){this.polySaveDisabled=!1,this.dispatchEvent({type:A.LAYER_READY_TO_SAVE,readyToSave:this.getReadyToSave()})}},{key:"getReadyToSave",value:function(){var e,t,n=this.getActiveLayer();n&&((e=n.isEmpty())||(t=n.getAllMarkups().some((function(e){return e.isTextMarkup()&&e.textInputHandler.isEmpty()}))));var r=this.markupsExtension.options.isMobileApp?!e:!e||e&&this.markupsExtension.permissionManager.canDeleteMarkup(n.layerData);return!(!n||!r||this.polySaveDisabled||t)}},{key:"removeMarkupFromLayer",value:function(e){var t=e.layer;return t?(this.duringCreationMarkup=null,e.deselect(),e.disableEdit(),t.deleteMarkup(e),!0):(console.warn("removeMarkupFromLayer - markup does not exist"),!1)}},{key:"getMarkupById",value:function(e){var t=null;return _t(this.layers,(function(n){var r=n.getMarkupById(e);r&&(t=r)})),t}},{key:"getSelectedMarkups",value:function(){return this.getMarkupsByProperty("selected",!0)}},{key:"getUnselectedMarkups",value:function(){return this.getMarkupsByProperty("selected",!1)}},{key:"getSelectedLayers",value:function(){return this.getLayersByProperty("selected",!0)}},{key:"getUnselectedLayers",value:function(){return this.getLayersByProperty("selected",!1)}},{key:"getSelectedLayer",value:function(){return this.getSelectedLayers()[0]}},{key:"getVisibleLayers",value:function(){return this.getLayersByProperty("visible",!0)}},{key:"getVisibleMarkups",value:function(){return this.getMarkupsByProperty("visible",!0)}},{key:"getEnabledMarkups",value:function(){return this.getMarkupsByProperty("enabled",!0).filter((function(e){return!e.layer||e.layer.isVisible()}))}},{key:"getDisabledMarkups",value:function(){return this.getMarkupsByProperty("enabled",!1)}},{key:"getVisibleLinks",value:function(){var e=this.getVisibleLayers(),t=[];return e.forEach((function(e){e.getAllLinks().forEach((function(e){t.push(e)}))})),t}},{key:"getDirtyLinks",value:function(){return this.getLinksByProperty("dirty",!0)}},{key:"getSelectedLinks",value:function(){return this.getLinksByProperty("selected",!0)}},{key:"getInEditMarkups",value:function(){var e=this.getMarkupsByProperty("inEdit",!0);return this.duringCreationMarkup&&-1===e.indexOf(this.duringCreationMarkup)&&e.push(this.duringCreationMarkup),e}},{key:"getMarkupsByProperty",value:function(e,t){var n=[];return _t(this.layers,(function(r){_t(r.markups,(function(r){r[e]===t&&n.push(r)}))})),n}},{key:"getLayersByProperty",value:function(e,t){var n=[];return _t(this.layers,(function(r){r[e]===t&&n.push(r)})),n}},{key:"getLinksByProperty",value:function(e,t){var n=[];return _t(this.layers,(function(r){_t(r.links,(function(r){r[e]===t&&n.push(r)}))})),n}},{key:"selectMarkup",value:function(e){(e=e instanceof Oi?e:this.getMarkupById(e))?e.select():console.warn("selectMarkup - markup does not exist")}},{key:"deselectMarkup",value:function(e){(e=e instanceof Oi?e:this.getMarkupById(e))?e.deselect():console.warn("selectMarkup - markup does not exist")}},{key:"deselectAllMarkups",value:function(e){this.getSelectedMarkups().forEach((function(t){e&&-1!==e.indexOf(t)||!t.isSelected()||t.deselect()}))}},{key:"unhoverAllLayers",value:function(){this.getLayersAsList().forEach((function(e){e.setHover(!1)}))}},{key:"unhoverAllMarkups",value:function(){this.getAllMarkups().forEach((function(e){e.setHover(!1)}))}},{key:"enableAllMarkups",value:function(){this.getAllMarkups().forEach((function(e){e.enable()}))}},{key:"disableAllMarkups",value:function(){this.getAllMarkups().forEach((function(e){e.disable()}))}},{key:"lockNavigation",value:function(){this.lockSettings||(this.lockSettings=this.markupsExtension.viewer.getNavigationLockSettings(),this.markupsExtension.viewer.setNavigationLockSettings({orbit:!1,pan:!1,zoom:!1,roll:!1,fov:!1,gotoview:!1,walk:!1}),this.markupsExtension.viewer.navigation.setIsLocked(!0)),this.dispatchEvent({type:A.MARKUP_VIEW_ENTERED})}},{key:"unlockNavigation",value:function(){this.lockSettings&&(this.markupsExtension.viewer.setNavigationLockSettings(this.lockSettings),this.markupsExtension.viewer.setNavigationLock(!1),this.markupsExtension.viewer.toolController.setIsLocked(!1),this.lockSettings=null)}},{key:"loadLayerIfHidden",value:function(e){var t=e instanceof ko?e:this.getLayerByGuid(e);if(!t&&this.markupsExtension.markupsCache){var n=this.markupsExtension.markupsCache.get(e);if(n)if(this.markupsExtension.filterManager.filterWithGUID&&!n.loadedByName){var r=n.metadata.markup_metadata.sheetGUID;this.markupsExtension.options.sheetGUID!==r&&(n=null)}else{var i=n.metadata.markup_metadata.sheetName;this.markupsExtension.options.sheetName!==i&&(n=null)}n&&(this.loadLayers([n],!0),t=this.getLayerByGuid(e))}return t}},{key:"selectLayer",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},a=this.loadLayerIfHidden(e),o=i.bind(this);if(a){var s=a.isSelected();if(this.deselectAllLayers([a]),this.exitMarkupView([a]),this.markupsExtension.viewer.impl.is2d){if(a.select(),t){var u={horizontal:this.markupsExtension.viewer.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN,vertical:this.markupsExtension.viewer.navigation.FIT_TO_VIEW_VERTICAL_MARGIN};this.markupsExtension.viewer.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN=De,this.markupsExtension.viewer.navigation.FIT_TO_VIEW_VERTICAL_MARGIN=De;var l=a.getWorldBoundingBox();this.markupsExtension.viewer.navigation.fitBounds(n,l),this.markupsExtension.viewer.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN=u.horizontal,this.markupsExtension.viewer.navigation.FIT_TO_VIEW_VERTICAL_MARGIN=u.vertical}o()}else this.loadMarkupsToLayer(a),a.select(),this.navigationToolBackup=this.markupsExtension.viewer.getActiveNavigationTool(),this.markupsExtension.viewer.setActiveNavigationTool(this.markupsExtension.markupsTool.getName()),Ho(this.markupsExtension.viewer,a.layerData,n||s,(function(){a.isSelected()&&(a.setVisible(!0),r.lockNavigation()),o()}))}else{this.dispatchEvent({type:A.LAYER_SELECTED_FROM_DIFFERENT_SHEET,layerGuid:e});var c=this.markupsExtension.cache;c.layerToSelect=this.loadRelevantSheet(e)}}},{key:"deselectLayer",value:function(e){(e=e instanceof ko?e:this.getLayerByGuid(e))?e.isSelected()&&(e.deselect(),e.layerData&&0===this.markupsExtension.filterManager.filterLayers([e.layerData]).length&&this.removeLayer(e)):console.warn("deselectLayer - layer does not exist")}},{key:"deselectAllLayers",value:function(e){var t=this;this.getSelectedLayers().forEach((function(n){e&&-1!==e.indexOf(n)||!n.isSelected()||t.deselectLayer(n)}))}},{key:"loadRelevantSheet",value:function(e){var t,n=this,r=function(t,r){for(var i=0;i<n.markupsExtension.sheetList.length;i++){var A=n.markupsExtension.sheetList[i].search(Po({},t,r))[0];if(A)return n.markupsExtension.options.loadDocumentCallback?n.markupsExtension.options.loadDocumentCallback(A):n.markupsExtension.viewer.loadDocumentNode(n.markupsExtension.viewer.model.getDocumentNode().getDocument(),A,{loadAsHidden:!1,applyRefPoint:!1,keepCurrentModels:!1}),e}return console.warn("loadRelevantSheet - Sheet not found (by ".concat(t,")")),null},i=function(){var e=A.metadata.markup_metadata.sheetName;if(e&&n.sheetName!==e)return A.loadedByName=!0,r("name",e)},A=this.markupsExtension.markupsCache.get(e);return A?this.markupsExtension.options.hasMultiSheet?this.markupsExtension.filterManager.filterWithGUID&&((t=A.metadata.markup_metadata.sheetGUID)&&n.sheetGUID!==t?r("guid",t):null)||i():void console.warn("loadRelevantSheet - Something weird just happened. This method shouldnt be called on Plans folder."):(console.warn("loadRelevantSheet - Cant find selected layer."),null)}},{key:"isInMarkupView",value:function(){var e=this.getVisibleLayers();return!this.isMarkupSessionOpen()&&e.length>0}},{key:"exitMarkupView",value:function(e){var t=this;if(!this.markupsExtension.viewer.impl.is2d&&this.isInMarkupView()){var n=this.getVisibleLayers();if(e&&(n=n.filter((function(t){return-1===e.indexOf(t)}))),0!==n.length){n.forEach((function(e){t.deselectLayer(e),e.setVisible(!1)})),this.unlockNavigation(),this.markupsExtension.viewer.setActiveNavigationTool(this.navigationToolBackup);var r=this.markupsExtension.viewer.getExtension("Autodesk.Section");r&&1===r.getSectionPlanes().length?r.setSectionFromPlane(null):this.markupsExtension.viewer.impl.setCutPlaneSet("__set_view",void 0),this.markupsExtension.markupsManager.dispatchEvent({type:A.MARKUP_VIEW_EXITED})}}}},{key:"changeAllLayersTransparency",value:function(e,t){this.markupsExtension.isToolEnabled()&&this.getLayersAsList().forEach((function(n){t&&-1!==t.indexOf(n)||n.changeTransparency(e)}))}},{key:"onLayerSynced",value:function(e){var t=e.layerData,n=e.layer;if(n=n||this.getLayerByGuid(t.guid)){if(!this.isMarkupSessionOpen()){n.enable();var r=this.getSelectedLayer();(r&&r!==n||!this.markupsExtension.isToolEnabled())&&n.changeTransparency(!0)}0===this.markupsExtension.filterManager.filterLayers([t]).length&&this.removeLayer(n)}this.markupsExtension.options.onMarkupsSyncCallback&&this.markupsExtension.options.onMarkupsSyncCallback({count:this.markupsExtension.markupsCache.length()})}},{key:"onLayerSyncing",value:function(e){var t=e.layerData,n=e.layer;(n=n||this.getLayerByGuid(t.guid))&&(this.markupsExtension.viewer.impl.is2d&&n.deselect(),n.disable())}},{key:"selectLink",value:function(e){e?e.select():console.warn("selectLink - link does not exist")}},{key:"deselectLink",value:function(e){e?e.deselect():console.warn("deselectLink - link does not exist")}},{key:"deselectAllLinks",value:function(){var e=this;this.getSelectedLinks().forEach((function(t){e.deselectLink(t)}))}},{key:"getDuringCreationMarkup",value:function(e){if(!this.duringCreationMarkup&&e){var t=this.getMarkupCreationType(),n=this.createMarkup(t);n&&(n.setVisible(!0),n.enableEdit(),this.duringCreationMarkup=n)}return this.duringCreationMarkup}},{key:"getActiveLayer",value:function(){return this.activeLayer}},{key:"setActiveLayer",value:function(e){e=e instanceof ko?e:this.getLayerById(e),this.activeLayer=e}},{key:"isMarkupSessionOpen",value:function(){return this.sessionOpen}},{key:"changeMarkupCreationType",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae;no.executeAfterTransitionEnded(this.markupsExtension.viewer,(function(){var n=e.markupsExtension.markupsManager.getDuringCreationMarkup(!1);n&&n.creationHandler.onEscape(),e.markupCreationType=t,e.markupsExtension.viewer.setActiveNavigationTool(t?e.markupsExtension.markupsTool.getName():e.navigationToolBackup),e.dispatchEvent({type:A.MARKUP_CREATION_TYPE_CHANGED,creationType:t}),t&&!e.isMarkupSessionOpen()&&t!==x&&e.startMarkupSession()}))}},{key:"getMarkupCreationType",value:function(){return this.markupCreationType}},{key:"setToolEnabled",value:function(e){var t=this;this.toolEnabled=e,e?this.enableAllMarkups():(this.deselectAllLayers(),this.deselectAllLinks(),this.disableAllMarkups()),(Autodesk.Viewing.isSafari()||Autodesk.Viewing.isIE11)&&setTimeout((function(){t.markupsExtension.markupsUI&&t.markupsExtension.markupsUI.toolbar.renderToolbar()}),1),this.dispatchEvent({type:A.MARKUP_TOOL_ENABLED_CHANGED,enable:e})}},{key:"isToolEnabled",value:function(){return this.toolEnabled}},{key:"startMarkupSession",value:function(e,t){return!!this.isToolEnabled()&&(this.deselectAllLayers(t&&[t]),this.exitMarkupView([t]),this.deselectAllLinks(),this.sessionOpen=!0,this.markupsExtension.markupsTool.updateToolPriority(),(t=t||this.createLayer()).setVisible(!0),this.setActiveLayer(t),this.navigationToolBackup=this.markupsExtension.viewer.getActiveNavigationTool(),this.markupsExtension.viewer.setActiveNavigationTool(this.markupsExtension.markupsTool.getName()),this.markupsExtension.viewer.impl.is2d||this.lockNavigation(),!e&&this.getMarkupCreationType()||this.changeMarkupCreationType(e),this.getAllMarkups().forEach((function(e){e.layer!==t&&e.disable()})),this.creationStatusType=this.markupsExtension.options.defaultMarkupStatus||N,this.contextMenu=this.markupsExtension.viewer.contextMenu,this.markupsExtension.viewer.setContextMenu(null),this.markupsExtension.viewer.impl.pauseHighlight(!0),this.markupsExtension.viewer.impl.disableSelection(!0),n=this.markupsExtension.viewer,(r=n.toolController.getTool("gestures"))&&(r.setGestureParameter("singletap","time",250),r.setGestureParameter("drag","threshold",0)),this.dispatchEvent({type:A.MARKUP_SESSION_START,layer:t}),!0);var n,r}},{key:"endMarkupSession",value:function(e){var t=this;if(this.isMarkupSessionOpen()){var n=this.getActiveLayer(),r=!1;if(e&&n.isEmpty()){if(n.layerData)return void this.dispatchEvent({type:A.LAYER_DELETE_EMPTY_PRESSED,onConfirmCB:function(){return t.deleteLayer(n)}});r=!0,e=!1}if(this.sessionOpen=!1,e||this.exitMarkupView(),this.markupsExtension.markupsTool&&this.markupsExtension.markupsTool.updateToolPriority(),this.changeMarkupCreationType(null),this.setActiveLayer(null),this.duringCreationMarkup&&this.duringCreationMarkup.creationHandler.creationCancel(),this.deselectAllMarkups(),this.enableAllMarkups(),this.unhoverAllMarkups(),!e)for(;!this.actionManager.isUndoStackEmpty();)this.undo();this.actionManager.clear();var i,a,o=n.isEmpty()||!e&&!n.getGuid();r?this.deleteLayer(n):o&&this.removeLayer(n),n.deselect(),this.markupsExtension.viewer.setContextMenu(this.contextMenu),this.markupsExtension.viewer.impl.pauseHighlight(!1),this.markupsExtension.viewer.impl.disableSelection(!1),i=this.markupsExtension.viewer,(a=i.toolController.getTool("gestures"))&&(a.restoreGestureParameterDefault("singletap","time"),a.restoreGestureParameterDefault("drag","threshold")),this.dispatchEvent({type:A.MARKUP_SESSION_END,layer:n,save:e})}}},{key:"editLayer",value:function(e,t,n,r){var i=this;if(this.isToolEnabled()){var a=this.loadLayerIfHidden(e);a?this.markupsExtension.permissionManager.canEditMarkup(a.layerData)?this.selectLayer(a,t,r,(function(){i.startMarkupSession(ae,a),n&&(Autodesk.Viewing.isMobileDevice()||a.selectAllMarkups())})):console.warn("editLayer - Cant edit layer, permissions not valid."):(this.dispatchEvent({type:A.LAYER_EDITED_FROM_DIFFERENT_SHEET,layerGuid:e}),this.markupsExtension.cache.layerToEdit=this.loadRelevantSheet(e))}}},{key:"onLayerSelected",value:function(e){var t=e.layer;this.changeAllLayersTransparency(!0,[t])}},{key:"onLayerDeselected",value:function(){this.getSelectedLayer()||this.changeAllLayersTransparency(!1)}},{key:"deleteMarkup",value:function(e){(e=e instanceof Oi?e:this.getMarkupById(e))?e.creationHandler.deleteMarkup():console.warn("deleteMarkup - markup does not exist")}},{key:"deleteInEditMarkups",value:function(){var e=this;this.markupsToDelete=this.getInEditMarkups(),this.openActionGroup(),this.markupsToDelete.forEach((function(t){e.deleteMarkup(t)})),this.closeActionGroup()}},{key:"undo",value:function(){this.duringCreationMarkup?this.duringCreationMarkup.creationHandler.onEscape(!1):this.actionManager.undo()}},{key:"redo",value:function(){this.actionManager.redo()}},{key:"isActionGroupOpen",value:function(){return this.actionManager.isGroupOpen}},{key:"openActionGroup",value:function(){this.actionManager.openActionGroup()}},{key:"closeActionGroup",value:function(){this.actionManager.closeActionGroup()}},{key:"copy",value:function(){this.markupsToCopy=this.getSelectedMarkups(),this.pasteOffset=1}},{key:"paste",value:function(){var e=this;this.deselectAllMarkups(),this.openActionGroup(),this.markupsToCopy.forEach((function(t){e.duplicateMarkup(t)})),this.closeActionGroup(),this.pasteOffset+=1}},{key:"cut",value:function(){this.copy(),this.deleteInEditMarkups()}},{key:"duplicateMarkup",value:function(e){var t=this,n=function(){var e=t.markupsExtension.renderer.getCameraRightVector(),n=t.markupsExtension.renderer.getCameraUpVector(),r=t.markupsExtension.renderer.multiplyByNormaStrokeWidth(Fe*t.pasteOffset);return e.sub(n).normalize().multiplyScalar(r)},r=function(e){e.completed=!0;var n=t.activeLayer?t.activeLayer:t.createLayer();new Et(t,e,n).execute()};if(e.translationHandler&&!e.belongsToGroup()){var i=ct.cloneDeep(e.getState()),A=n();i.translation.add(A);var a=this.createMarkup(e.type,i);r(a),a.select()}else if(e.isGroupMarkup()){var o=ct.cloneDeep(e.getState()),s=n();o.uuid=THREE.Math.generateUUID(),o.componentsState=e.markups.map((function(e){var t=ct.cloneDeep(e.getState());return t.translation.add(s),t}));var u=this.createMarkup(e.type,o);r(u),u.markups.forEach((function(e){return r(e)})),u.select()}}},{key:"loadMarkupsToLayer",value:function(e){var t=this,n=e.layerData&&e.layerData.getSvgResource();if(n&&e.isEmpty()){var r=function(n){n.completed=!0,t.addMarkupToLayer(n,e),n.setDirty()},i=Oo(n,e.layerData,this.markupsExtension.viewer,this.markupsExtension.renderer);i.forEach((function(e){if(!e.state.groupId){e.state.uuid&&(e.state.componentsState=i.filter((function(t){return e.state.uuid===t.state.groupId})).map((function(e){return e.state})));var n=t.createMarkup(e.type,e.state);n&&(r(n),n.isGroupMarkup()&&n.markups.forEach((function(e){return r(e)})))}}))}}},{key:"createLinkMetadata",value:function(e){var t=e.metadata;t.markup_metadata=t.markup_metadata||{},t.markup_metadata.links=t.markup_metadata.links||[],e.attachments.forEach((function(e){t.markup_metadata.links.some((function(t){return t.id===e.attributes.issue_id&&t.type===e.attributes.attachment_type}))||t.markup_metadata.links.push({id:e.attributes.issue_id,type:e.attributes.attachment_type,position:null})}))}},{key:"loadLinksToLayer",value:function(e){var t=this;this.createLinkMetadata(e.layerData);var n=e.layerData.getLinksMetadata();n&&n.forEach((function(n){if(!e.getAllLinks().find((function(e){return e.guid===n.id}))&&e.layerData.attachments.some((function(e){return e.attributes.issue_id===n.id}))){var r=t.createLink(e,n);t.addLinkToLayer(r,e),r.setDirty(!0)}}))}},{key:"changeStyleProperty",value:function(e,t,n){"string"==typeof t&&(t=o[t.toUpperCase()]||t),e===l.THICKNESS&&(t*=this.markupsExtension.renderer.getNormaStrokeWidth()),this.creationStyleProperties[e]=t,e===l.COLOR&&t!==o.NO_COLOR&&(this.creationStyleProperties[l.LAST_COLOR]=t),this.isMarkupSessionOpen()&&(this.openActionGroup(),this.getSelectedMarkups().forEach((function(r){r.creationHandler.changeStyleProperty(e,t,n)})),this.closeActionGroup()),this.dispatchEvent({type:A.MARKUP_STYLE_PROPERTY_CHANGED,styleProperty:e,value:t})}},{key:"getStyleProperty",value:function(e){return this.creationStyleProperties[e]}},{key:"onCalibrationEnded",value:function(){this.markupsExtension.setToolEnabled(!0),this.startMarkupSession(U)}},{key:"onHistoryChanged",value:function(e){e.actionGroup.forEach((function(e){e.markup.setDirty()})),this.dispatchEvent(e),this.dispatchEvent({type:A.LAYER_READY_TO_SAVE,readyToSave:this.getReadyToSave()})}},{key:"getLayersAsList",value:function(){return Lt(this.layers)}},{key:"getAllMarkups",value:function(){var e=[];return _t(this.layers,(function(t){e.push.apply(e,No(Lt(t.markups)))})),e}},{key:"generateScreenCapture",value:function(e){var t=this;return new Promise((function(n){setTimeout((function(){!function(e,t,n){var r,i=e.getExtension("Autodesk.BIM360.Markups");n&&e.impl.is2d&&(r=n.getWorldBoundingBox(),Autodesk.Viewing.ScreenShot.makeBoundsSquare(r));var A={bounds:r,margin:n?De:0,overlayRenderer:jt,overlayRendererExtraOptions:{markupLayer:n},getCropBounds:n&&function(e,t){r=n.getWorldBoundingBox(),Autodesk.Viewing.ScreenShot.makeBoundsSquare(r);var A=i.renderer.markupsCamera;e.impl.is2d&&(i.renderer.markupsCamera=t);var a=i.renderer.worldToClient(r.min),o=i.renderer.worldToClient(r.max);i.renderer.markupsCamera=A;var s=(new THREE.Box3).setFromPoints([a,o]);Autodesk.Viewing.ScreenShot.makeBoundsSquare(s,qe);var u=s.size().x;return s.expandByVector(new THREE.Vector3(u*De,u*De,0)),s}};Autodesk.Viewing.ScreenShot.getScreenShotAtScreenSize(e,t,A)}(t.markupsExtension.viewer,(function(e){n(e)}),e)}),100)}))}},{key:"changeCreationStatusType",value:function(e){this.creationStatusType=e}},{key:"getCreationStatusType",value:function(){return this.creationStatusType}},{key:"setDefaultCreationStyleProperties",value:function(){this.creationStyleProperties={},this.changeStyleProperty(l.LAST_COLOR,oe),this.changeStyleProperty(l.COLOR,oe),this.changeStyleProperty(l.FILL_COLOR,ue),this.changeStyleProperty(l.THICKNESS,le),this.changeStyleProperty(l.OPACITY,ce),this.changeStyleProperty(l.FILL_OPACITY,de),this.changeStyleProperty(l.FONT_SIZE,pe),this.changeStyleProperty(l.FONT_WEIGHT,ye),this.changeStyleProperty(l.FONT_FAMILY,me),this.changeStyleProperty(l.FONT_STYLE,Ee),this.changeStyleProperty(l.FONT_COLOR,se)}},{key:"reset",value:function(){this.nextMarkupId=0,this.nextLinkId=0,this.nextLayerId=0,this.sessionOpen=!1,this.layers={},this.selectedLayers=[],this.duringCreationMarkup=null,this.activeLayer=null,this.markupCreationType=null,this.markupsToCopy=[],this.pasteOffset=1,this.toolEnabled=!0,this.contextMenu=null,this.actionManager.clear(),this.creationStyleProperties={}}},{key:"destroy",value:function(){this.removeAllLayers(),this.unlockNavigation(),this.unregisterEvents(),this.reset(),this.clearListeners(),this.markupsExtension=null,this.actionManager=null}}])&&Ko(n.prototype,r),i&&Ko(n,i),t}();n(344);function Yo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wo=Autodesk.Viewing,Xo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.setGlobalManager(t.globalManager),this.viewer=this.markupsExtension.viewer,this.container=this.viewer.appendOrderedElementToViewer("markup-frames-container"),this.container.className="markup-frames-container",this.markupFrames={},this.layerFrames={},this.anchors={},this.segments={},this.rotationAxis=new THREE.Vector3(0,0,1),this.registerEventListeners()}var t,n,r;return t=e,(n=[{key:"registerEventListeners",value:function(){this.onMarkupDirtyBinded=this.onMarkupDirty.bind(this),this.onLayerDirtyBinded=this.onLayerDirty.bind(this),this.onLayerDeletedBinded=this.onLayerDeleted.bind(this),this.onMarkupRemovedBinded=this.onMarkupRemoved.bind(this),this.renderAllBinded=this.renderAll.bind(this),this.onRectSelectorUpdatedBinded=this.onRectSelectorUpdated.bind(this),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_DIRTY,this.onMarkupDirtyBinded),this.markupsExtension.markupsManager.addEventListener(A.LAYER_DIRTY,this.onLayerDirtyBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_REMOVED,this.onMarkupRemovedBinded),this.markupsExtension.markupsManager.addEventListener(A.LAYER_DELETED,this.onLayerDeletedBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_SESSION_START,this.renderAllBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_SESSION_END,this.renderAllBinded),this.markupsExtension.markupsManager.addEventListener(A.RECT_SELECTOR_UPDATED,this.onRectSelectorUpdatedBinded),this.viewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.renderAllBinded)}},{key:"unregisterEventListeners",value:function(){this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_DIRTY,this.onMarkupDirtyBinded),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_DIRTY,this.onLayerDirtyBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_REMOVED,this.onMarkupRemovedBinded),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_DELETED,this.onLayerDeletedBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_SESSION_START,this.renderAllBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_SESSION_END,this.renderAllBinded),this.markupsExtension.markupsManager.removeEventListener(A.RECT_SELECTOR_UPDATED,this.onRectSelectorUpdatedBinded),this.viewer.removeEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.renderAllBinded)}},{key:"renderAll",value:function(){var e=this.markupsExtension.markupsManager.getAllMarkups();this.renderMarkups(e);var t=this.markupsExtension.markupsManager.getLayersAsList();this.renderLayers(t)}},{key:"onMarkupDirty",value:function(e){var t=e.markup;this.renderMarkups([t])}},{key:"onLayerDirty",value:function(e){var t=e.layer;this.renderLayerSelectionFrame(t)}},{key:"renderLayers",value:function(e){var t=this;e.forEach((function(e){t.renderLayerSelectionFrame(e)}))}},{key:"renderMarkups",value:function(e){var t=this;e.forEach((function(e){e.belongsToGroup()||t.renderMarkupSelectionFrame(e),t.renderTransformAnchors(e),e.layer&&t.renderLayerSelectionFrame(e.layer)}))}},{key:"renderFrame",value:function(e,t,n){var r=this.getDocument();if(!e){(e=r.createElement("div")).className="markup-selection-frame-container",this.container.appendChild(e);var i=r.createElement("div");i.className="markup-selection-frame fill",i.style.width="".concat(Ne,"px"),i.style.height="".concat(Ne,"px"),Autodesk.Viewing.isIOSDevice()&&(i.className+=" ios"),e.appendChild(i),e.fillElement=i;for(var A=0;A<4;A++){var a=r.createElement("div");a.className="markup-selection-frame border",a.style.width="".concat(Ne,"px"),a.style.height="".concat(Ne,"px"),Autodesk.Viewing.isIOSDevice()&&(a.className+=" ios"),e.appendChild(a),e["border_".concat(A)]=a}}e.classList.contains("visible")||(e.classList.add("visible"),e.offsetHeight),n&&!e.fillElement.classList.contains("visible")?(e.fillElement.classList.add("visible"),e.fillElement.offsetHeight):!n&&e.fillElement.classList.contains("visible")&&(e.fillElement.classList.remove("visible"),e.fillElement.offsetHeight);var o=t.getClientBoundingBox(!0),s=o.center();s.x-=Ne/2,s.y-=Ne/2;var u=o.size(),l=st.radiansToDegrees(t.getRotation()+this.markupsExtension.renderer.getCameraRotation())||0;return n&&(e.fillElement.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px) rotate(").concat(l,"deg) scale(").concat(u.x/Ne,", ").concat(u.y/Ne,")")),e.border_0.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px) rotate(").concat(l,"deg) translate(0px, ").concat(u.y/2,"px) scale(").concat(u.x/Ne,", ").concat(1/Ne,")"),e.border_1.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px) rotate(").concat(l,"deg) translate(0px, ").concat(-u.y/2,"px) scale(").concat(u.x/Ne,", ").concat(1/Ne,")"),e.border_2.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px) rotate(").concat(l,"deg) translate(").concat(u.x/2,"px, 0px) scale(").concat(1/Ne,", ").concat(u.y/Ne,")"),e.border_3.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px) rotate(").concat(l,"deg) translate(").concat(-u.x/2,"px, 0px) scale(").concat(1/Ne,", ").concat(u.y/Ne,")"),e}},{key:"renderMarkupSelectionFrame",value:function(e){var t=this.markupFrames[e.id],n=e.isHovered(),r=e.isSelected();(r||n)&&e.layer?this.markupFrames[e.id]=this.renderFrame(t,e,r):t&&t.classList.contains("visible")&&(t.classList.remove("visible"),t.offsetHeight)}},{key:"renderLayerSelectionFrame",value:function(e){var t=this.layerFrames[e.id],n=e.isHovered(),r=e.isSelected(),i=e.isVisible();(r||n)&&i&&!this.markupsExtension.markupsManager.isMarkupSessionOpen()?this.layerFrames[e.id]=this.renderFrame(t,e,!1):t&&t.classList.contains("visible")&&(this.container.removeChild(t),delete this.layerFrames[e.id])}},{key:"_renderScaleAnchors",value:function(e){var t=this;if(e.scaleHandler)if(e.isInEdit()){var n=e.scaleHandler.getScaleAnchors(),r=e.getClientCenter();n.forEach((function(n,i){var A="".concat(e.id,"_scale_").concat(i),a=e.getRotation()+t.markupsExtension.renderer.getCameraRotation();st.applyRotation(n.pos,a,r,t.rotationAxis);var o=e.scaleHandler.isDragging()&&n.id===e.scaleHandler.scaleAnchor.id;t.createAnchorElement(A,n.pos,o,a,"rectangle")}))}else for(var i=0;i<8;i++){var A="".concat(e.id,"_scale_").concat(i);this.anchors[A]&&this.anchors[A].classList.contains("visible")&&this.anchors[A].classList.remove("visible")}}},{key:"_renderRotationAnchor",value:function(e){if(e.rotationHandler){var t="".concat(e.id,"_rotation_anchor");if(e.isInEdit()){var n=e.rotationHandler.getRotationAnchor(),r=e.rotationHandler.isDragging();this.createAnchorElement(t,n,r);var i=e.getClientBoundingBox(!0),A=i.center().add(new THREE.Vector3(0,i.size().y/2,0)),a=i.center(),o=e.getRotation()+this.markupsExtension.renderer.getCameraRotation();st.applyRotation(A,o,a,this.rotationAxis),this.createSegment(t,A,n)}else this.anchors[t]&&this.anchors[t].classList.contains("visible")&&(this.anchors[t].classList.remove("visible"),this.segments[t].classList.remove("visible"))}}},{key:"_renderAnchors",value:function(e){var t=this;if(e.anchorHandler){var n,r=function(e){var n=t.anchors[e];n&&n.classList.contains("visible")&&n.classList.remove("visible")},i=function(e){var n=t.segments[e];n&&n.classList.contains("visible")&&n.classList.remove("visible")},A="".concat(e.id,"_anchor"),a=e.anchorHandler.getAnchors();if(e.isInEdit()){for(var o=e.getClientCenter(),s=function(n){return e.applyScaleAndTranslation(n),n=t.markupsExtension.renderer.worldToClient(n),st.applyRotation(n,e.getRotation(),o,t.rotationAxis),n},u=null,l=null,c=0;c<a.length;c++){var h="".concat(A,"_").concat(c);l=s(a[c].clone());var d=a[c]===e.anchorHandler.activeAnchor;e.isAnchorHandlingAllowed(a[c])&&this.createAnchorElement(h,l,d),e.showPath()&&c>0&&this.createSegment(h,u,l),u=l}if(e.showPath()&&e.editState.closed){var f="".concat(A,"_").concat(a.length),p=s(a[0].clone());this.createSegment(f,l,p)}for(var g=(n=A,Object.keys(t.anchors).filter((function(e){return 0===e.indexOf(n)}))),y=function(e){return Object.keys(t.segments).filter((function(t){return 0===t.indexOf(e)}))}(A),m=a.length;m<g.length;m++)r("".concat(A,"_").concat(m));for(var E=e.editState.closed?y.length:y.length+1,v=a.length;v<E;v++)i("".concat(A,"_").concat(v))}else for(var B=0;B<=a.length;B++){var w="".concat(A,"_").concat(B);r(w),i(w)}}}},{key:"renderTransformAnchors",value:function(e){e.isCompleted()&&(this._renderScaleAnchors(e),this._renderRotationAnchor(e),this._renderAnchors(e))}},{key:"createAnchorElement",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",A=this.anchors[e],a=this.getDocument();if(!A){(A=a.createElement("div")).className="markup-anchor "+i;var o="".concat(2*be,"px");A.style.width=o,A.style.height=o,this.container.appendChild(A),this.anchors[e]=A;var s=a.createElement("div");s.className="markup-anchor-fill "+i,A.appendChild(s),A.anchorFill=s}A.classList.contains("visible")||A.classList.add("visible"),n&&!A.anchorFill.classList.contains("visible")?A.anchorFill.classList.add("visible"):!n&&A.anchorFill.classList.contains("visible")&&A.anchorFill.classList.remove("visible");var u=st.radiansToDegrees(r);A.style.transform="translate(".concat(t.x-be,"px, ").concat(t.y-be,"px) rotate(").concat(u,"deg)")}},{key:"createSegment",value:function(e,t,n){var r=this.segments[e],i=this.getDocument();r||((r=i.createElement("div")).className="markup-selection-frame segment border",r.style.width="".concat(Ne,"px"),r.style.height="".concat(Ne,"px"),this.container.appendChild(r),this.segments[e]=r),r.classList.contains("visible")||r.classList.add("visible");var A=t.clone().add(n).multiplyScalar(.5);A.x-=Ne/2,A.y-=Ne/2;var a=t.distanceTo(n),o=st.getSignedAngle(n.clone().sub(t),this.markupsExtension.renderer.getCameraUpVector(),this.markupsExtension.renderer.getCameraEyeVector());r.style.transform="translate(".concat(A.x,"px, ").concat(A.y,"px) rotate(").concat(st.radiansToDegrees(o+this.markupsExtension.renderer.getCameraRotation()),"deg) scale(").concat(1/Ne,", ").concat(a/Ne,")")}},{key:"onLayerDeleted",value:function(e){var t=e.layer.id,n=this.layerFrames[t];n&&this.container.removeChild(n),delete this.layerFrames[t]}},{key:"onMarkupRemoved",value:function(e){var t=e.markup,n=t.id,r=this.markupFrames[n];r&&this.container.removeChild(r),delete this.markupFrames[n],t.layer&&t.layer.isEmpty()&&this.onLayerDeleted(t)}},{key:"onRectSelectorUpdated",value:function(e){var t=e.bounds,n=this.getDocument();this.rectSelectorFrame||(this.rectSelectorFrame=n.createElement("div"),this.rectSelectorFrame.className="rect-selector-frame",this.container.appendChild(this.rectSelectorFrame));var r=!t.empty();r&&!this.rectSelectorFrame.classList.contains("visible")?(this.rectSelectorFrame.classList.add("visible"),this.rectSelectorFrame.offsetHeight):!r&&this.rectSelectorFrame.classList.contains("visible")&&(this.rectSelectorFrame.classList.remove("visible"),this.rectSelectorFrame.offsetHeight);var i=t.clone();i.min=this.markupsExtension.renderer.worldToClient(i.min),i.max=this.markupsExtension.renderer.worldToClient(i.max);var A=i.size();this.rectSelectorFrame.style.width="".concat(Math.abs(A.x),"px"),this.rectSelectorFrame.style.height="".concat(Math.abs(A.y),"px"),this.rectSelectorFrame.style.transformOrigin="top left",this.rectSelectorFrame.style.transform="translate(".concat(i.min.x,"px, ").concat(i.min.y,"px) scale(").concat(Math.sign(A.x),", ").concat(Math.sign(A.y),")")}},{key:"destroy",value:function(){var e=this;this.unregisterEventListeners(),_t(this.markupFrames,(function(t){e.container.removeChild(t)})),this.markupFrames=null,_t(this.layerFrames,(function(t){e.container.removeChild(t)})),this.layerFrames=null,_t(this.anchors,(function(t){e.container.removeChild(t)})),this.anchors=null,_t(this.segments,(function(t){e.container.removeChild(t)})),this.segments=null,this.markupsExtension=null,this.viewer=null}}])&&Yo(t.prototype,n),r&&Yo(t,r),e}();Wo.GlobalManagerMixin.call(Xo.prototype);n(346);function Jo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qo=Autodesk.Viewing,Zo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.setGlobalManager(t.globalManager),this.viewer=this.markupsExtension.viewer,this.container=this.viewer.appendOrderedElementToViewer("markup-links-container"),this.container.className="markup-links-container",this.links={},this.linksSizeCache={},this.registerEventListeners()}var t,n,r;return t=e,(n=[{key:"registerEventListeners",value:function(){this.onLinkDirtyBinded=this.onLinkDirty.bind(this),this.onMarkupDirtyBinded=this.onMarkupDirty.bind(this),this.renderAllLinksBinded=this.renderAllLinks.bind(this),this.onLinkDeletedBinded=this.onLinkDeleted.bind(this),this.markupsExtension.markupsManager.addEventListener(A.LINK_DIRTY,this.onLinkDirtyBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_DIRTY,this.onMarkupDirtyBinded),this.markupsExtension.markupsManager.addEventListener(A.LINK_SYNCED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.addEventListener(A.LINK_REMOVED,this.onLinkDeletedBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_SESSION_START,this.renderAllLinksBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_SESSION_END,this.renderAllLinksBinded),this.markupsExtension.markupsManager.addEventListener(A.LAYER_SELECTED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.addEventListener(A.LAYER_DESELECTED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_VIEW_EXITED,this.renderAllLinksBinded),this.viewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.renderAllLinksBinded)}},{key:"unregisterEventListeners",value:function(){this.markupsExtension.markupsManager.removeEventListener(A.LINK_DIRTY,this.onLinkDirtyBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_DIRTY,this.onMarkupDirtyBinded),this.markupsExtension.markupsManager.removeEventListener(A.LINK_SYNCED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.removeEventListener(A.LINK_REMOVED,this.onLinkDeletedBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_SESSION_START,this.renderAllLinksBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_SESSION_END,this.renderAllLinksBinded),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_SELECTED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_DESELECTED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_VIEW_EXITED,this.renderAllLinksBinded),this.viewer.removeEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.renderAllLinksBinded)}},{key:"onMarkupDirty",value:function(e){var t=this,n=e.markup;n.layer&&_t(n.layer.links,(function(e){t.renderLink(e)}))}},{key:"onLinkDirty",value:function(e){var t=e.link;this.renderLink(t)}},{key:"renderLink",value:function(e){if(!e.layer.isEmpty()){var t="".concat(e.layer.id,"_link_").concat(e.id);if(e.isVisible()){var n=e.isSelected(),r=e.isHovered(),i=this.markupsExtension.markupsManager.getActiveLayer()===e.layer,A=e.layer.layerData.attachments.length,a=this.markupsExtension.markupsManager.isMarkupSessionOpen()&&!i||this.markupsExtension.markupsManager.getSelectedLayers().length>0&&!e.layer.isSelected()||!this.markupsExtension.isToolEnabled();this.createLinkElement(t,e,n,i,r,A,a)}else this.links[t]&&this.links[t].classList.remove("visible");e.setDirty(!1)}}},{key:"renderAllLinks",value:function(){var e=this,t=this.markupsExtension.markupsManager.layers;_t(t,(function(t){_t(t.links,(function(t){e.renderLink(t)}))})),this.markupsExtension.markupsManager.dispatchEvent({type:A.LINK_RENDERED})}},{key:"createLinkElement",value:function(e,t,n,r,i,A,a){var o=this.links[e],s=this.getDocument();if(!o){(o=s.createElement("div")).className="link";var u=s.createElement("div");u.className="link-document-attachment",o.appendChild(u),this.container.appendChild(o),this.links[e]=o}o.classList.contains("visible")||o.classList.add("visible"),a&&!o.classList.contains("transparent")?o.classList.add("transparent"):!a&&o.classList.contains("transparent")&&o.classList.remove("transparent"),n&&!o.classList.contains("selected")?o.classList.add("selected"):!n&&o.classList.contains("selected")&&o.classList.remove("selected"),i&&!o.classList.contains("hover")?o.classList.add("hover"):!i&&o.classList.contains("hover")&&o.classList.remove("hover"),r&&!o.classList.contains("editable")?o.classList.add("editable"):!r&&o.classList.contains("editable")&&o.classList.remove("editable");var l=A>99?"99+":A;o.firstChild.innerText=l,this.linksSizeCache[l]||(this.linksSizeCache[l]=o.firstChild.getBoundingClientRect());var c=new THREE.Box3,h=new THREE.Vector3(this.linksSizeCache[l].width/2,this.linksSizeCache[l].height/2,0);c.expandByPoint(new THREE.Vector3),c.expandByVector(h),o.boundingBox=c;var d=t.getPosition(),f=this.markupsExtension.renderer.worldToClient(d);o.style.transform="translate(".concat(Math.round(f.x-this.linksSizeCache[l].width/2),"px, ").concat(Math.round(f.y-this.linksSizeCache[l].height/2),"px)"),c.makeEmpty(),c.expandByPoint(f),c.expandByVector(h)}},{key:"getLinkBoundingBox",value:function(e){var t="".concat(e.layer.id,"_link_").concat(e.id),n=this.links[t];return n?n.boundingBox:new THREE.Box3}},{key:"onLinkDeleted",value:function(e){var t=e.link,n="".concat(t.layer.id,"_link_").concat(t.id),r=this.links[n];r&&this.container.removeChild(r),delete this.links[n]}},{key:"destroy",value:function(){var e=this;this.unregisterEventListeners(),_t(this.links,(function(t){e.container.removeChild(t)})),this.links=null,this.markupsExtension=null,this.viewer=null}}])&&Jo(t.prototype,n),r&&Jo(t,r),e}();function $o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}qo.GlobalManagerMixin.call(Zo.prototype);var es=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.viewer=t.viewer,this.materials={}}var t,n,r;return t=e,(n=[{key:"_getHashName",value:function(e,t,n,r){var i=e;return n?(i+="|f",t[l.FILL_COLOR]&&(i+="|c"+t[l.FILL_COLOR]),void 0!==t[l.FILL_OPACITY]&&(i+="|o"+t[l.FILL_OPACITY]*(r?Ye:1))):(t[l.THICKNESS]&&(i+="|t"+t[l.THICKNESS]),t[l.COLOR]&&(i+="|c"+t[l.COLOR]),void 0!==t[l.OPACITY]&&(i+="|o"+t[l.OPACITY]*(r?Ye:1))),i}},{key:"_setResolution",value:function(e,t){e.uniforms&&e.uniforms.resolution&&e.uniforms.resolution.value.set(t.width,t.height)}},{key:"getMaterial",value:function(e,t,n){var r=this._getHashName(e,t,n);return this.materials[r]?this.materials[r]:null}},{key:"_setFillBlending",value:function(e){e.blending=e.opacity<1?THREE.NoBlending:THREE.NormalBlending}},{key:"_setStrokeBlending",value:function(e){e.uniforms.opacity.value<1?(e.blending=THREE.CustomBlending,e.blendDst=THREE.ZeroFactor,e.blendSrc=THREE.OneFactor,e.blendEquation=THREE.AddEquation,Autodesk.Viewing.isIE11||(e.blendEquationAlpha=THREE.MaxEquation)):e.blending=THREE.NormalBlending}},{key:"_createStrokeMaterial",value:function(e,t,n){var r=this.markupsExtension.renderer.getResolution(),i=new bi({color:new THREE.Color(e[l.COLOR]),opacity:e[l.OPACITY]*(n?Ye:1),resolution:new THREE.Vector2(r.width,r.height),lineWidth:e[l.THICKNESS],side:THREE.FrontSide,miter:t});return this._setStrokeBlending(i),i}},{key:"_createFillMaterial",value:function(e,t){var n={color:new THREE.Color(e[l.FILL_COLOR]),transparent:!0,opacity:e[l.FILL_OPACITY]*(t?Ye:1),side:THREE.DoubleSide,wireframe:!1},r=new THREE.MeshBasicMaterial(n);return this._setFillBlending(r),r}},{key:"_editStrokeMaterial",value:function(e,t,n){e.uniforms.color.value.setStyle(t[l.COLOR]),e.uniforms.lineWidth.value=t[l.THICKNESS],e.uniforms.opacity.value=t[l.OPACITY]*(n?Ye:1),this._setStrokeBlending(e)}},{key:"_editFillMaterial",value:function(e,t,n){e.color.setStyle(t[l.FILL_COLOR]),e.opacity=t[l.FILL_OPACITY]*(n?Ye:1),e.needsUpdate=!0,this._setFillBlending(e)}},{key:"hasThicknessChanged",value:function(e,t){return e&&t&&e.uniforms&&t.uniforms&&e.uniforms.lineWidth.value!==t.uniforms.lineWidth.value}},{key:"addMaterial",value:function(e,t){var n=e.type,r=e.editState.style,i=e.isTransparent(),A=this._getHashName(n,r,t,i);if(this.materials[A])this.materials[A].refCount++;else{var a=t?this._createFillMaterial(r,i):this._createStrokeMaterial(r,e.needsMiter(),i);a.depthWrite=!1,a.depthTest=!1,a.transparent=!0,a.refCount=1,a.name=A,this.materials[A]=a}return this.materials[A]}},{key:"removeMaterial",value:function(e){this.materials[e.name]?(e.refCount--,0===e.refCount&&(e.dispose(),e.needsUpdate=!0,delete this.materials[e.name])):console.error("Trying to remove a non-existing material")}},{key:"editMaterial",value:function(e,t,n){if(this.materials[e.name]){var r=t.type,i=t.editState.style,A=t.isTransparent(),a=this._getHashName(r,i,n,A);if(a!==e.name)return 1!==e.refCount||this.materials[a]?(this.removeMaterial(e),this.addMaterial(t,n)):(n?this._editFillMaterial(e,i,A):this._editStrokeMaterial(e,i,A),delete this.materials[e.name],e.name=a,this.materials[a]=e,e.needsUpdate=!0,e)}else console.error("Trying to edit a non-existing material")}},{key:"destroy",value:function(){for(var e in this.materials)this.materials[e].dispose(),this.materials[e].needsUpdate=!0;this.materials={}}},{key:"updateScreenSize",value:function(e){for(var t in this.materials)this._setResolution(this.materials[t],e)}}])&&$o(t.prototype,n),r&&$o(t,r),e}(),ts=n(222),ns=n.n(ts);n(348);function rs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var is=Autodesk.Viewing,As=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.setGlobalManager(t.globalManager),this.viewer=this.markupsExtension.viewer,this.container=this.viewer.appendOrderedElementToViewer("markup-text-container"),this.container.className="markup-text-container",this.labels={},this.textMarkups={},this.textSizeCache={},this.registerEventListeners()}var t,n,r;return t=e,(n=[{key:"registerEventListeners",value:function(){this.onMarkupRemovedBinded=this.onMarkupRemoved.bind(this),this.onCameraChangedBinded=this.onCameraChanged.bind(this),this.onMarkupVisibilityChangedBinded=this.onMarkupVisibilityChanged.bind(this),this.onResizeBinded=this.onResize.bind(this),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_VISIBILITY_CHANGED,this.onMarkupVisibilityChangedBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_REMOVED,this.onMarkupRemovedBinded),this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResizeBinded)}},{key:"unregisterEventListeners",value:function(){this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_VISIBILITY_CHANGED,this.onMarkupVisibilityChangedBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_REMOVED,this.onMarkupRemovedBinded),this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResizeBinded)}},{key:"onCameraChanged",value:function(){this.renderTextMarkups()}},{key:"onResize",value:function(){var e=this;this.viewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,(function(){e.onCameraChanged()}),{once:!0})}},{key:"renderTextMarkups",value:function(){var e=this;_t(this.textMarkups,(function(t){e.renderMarkup(t)}))}},{key:"updateLabelPositionAndSize",value:function(e,t){function n(t,n){e.styleCache[t]!==n&&(e.style[t]=n,e.styleCache[t]=n)}var r=t.getEditState().text,i=t.getTextStyle(),A=this.markupsExtension.renderer.getFontToWorldScale(),a=this.markupsExtension.renderer.sizeFromWorldToClient(A),o=t.getClientBoundingBoxTextOnly(),s=o.center(),u=o.size(),l=st.radiansToDegrees(t.getRotation()+this.markupsExtension.renderer.getCameraRotation());if(Autodesk.Viewing.isSafari()||Autodesk.Viewing.isIOSDevice()){var c=parseFloat(i.fontSize)*a,h=Math.floor(c)||1,d=c/h,f=u.x/d;i.width="".concat(f,"px"),i.fontSize="".concat(h,"px"),Object.keys(i).forEach((function(e){n(e,i[e])})),e.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px)\n                                    translate(-50%, -50%)\n                                    rotate(").concat(l,"deg)\n                                    scale(").concat(d,")")}else{var p=t.getTextWidthInFontScale(),g=p.preciseWidth,y=p.width;i.width="".concat(y,"px"),Object.keys(i).forEach((function(e){n(e,i[e])}));var m=(g-y)*a;e.style.transform="translate(".concat(s.x-m/2,"px, ").concat(s.y,"px)\n                                    translate(-50%, -50%)\n                                    rotate(").concat(l,"deg)\n                                    scale(").concat(a,")")}t.textInputHandler.textboxActive||(e.innerText=r||"")}},{key:"renderMarkup",value:function(e){if(e.editState.anchors[0]){var t=this.labels[e.id],n=this.getDocument();if(!t){(t=n.createElement("div")).className="markup-text",t.id=e.id;var r=e.getEditState().text;t.innerText=r||"",t.styleCache={},this.container.appendChild(t),this.labels[e.id]=t,this.textMarkups[e.id]=e}e.isVisible()&&!t.classList.contains("visible")?t.classList.add("visible"):!e.isVisible()&&t.classList.contains("visible")&&t.classList.remove("visible"),e.editState.isSingleLine&&!t.classList.contains("single-line")&&t.classList.add("single-line"),e.isVisible()&&this.updateLabelPositionAndSize(t,e)}}},{key:"getLabel",value:function(e){return this.labels[e.id]}},{key:"onMarkupVisibilityChanged",value:function(e){var t=e.markup;e.visible,t.type===S&&this.renderMarkup(t)}},{key:"onMarkupRemoved",value:function(e){var t=e.markup.id,n=this.labels[t];n&&this.container.removeChild(n),delete this.labels[t],delete this.textMarkups[t]}},{key:"isEmpty",value:function(){return 0===Object.keys(this.labels).length}},{key:"renderTextToCanvas",value:function(e,t,n,r,i,A){var a=this;if(this.isEmpty())A(e);else{var o={};Lt(this.textMarkups).forEach((function(e){e.isVisible()&&(o[e.id]=!0)}));var s={backgroundColor:null,logging:!1,scale:n,onclone:function(e){r();var n=a.markupsExtension.renderer.documentCamera,A=a.markupsExtension.renderer.markupsCamera;a.markupsExtension.renderer.documentCamera=t,a.markupsExtension.renderer.markupsCamera=t;for(var s=e.getElementsByClassName("markup-text-container")[0].children,u=0;u<s.length;u++){var l=s[u];if(o[l.id]){var c=a.textMarkups[l.id];l.classList.contains("visible")||l.classList.add("visible"),l.styleCache={},a.updateLabelPositionAndSize(l,c)}else l.classList.contains("visible")&&l.classList.remove("visible")}a.markupsExtension.renderer.documentCamera=n,a.markupsExtension.renderer.markupsCamera=A,i()}};ns()(this.container,s).then((function(t){var n=a.getDocument().createElement("canvas");n.width=t.width,n.height=t.height;var r=n.getContext("2d");r.translate(0,n.height),r.scale(1,-1),r.drawImage(t,0,0);var i=e.getContext("2d");i.globalCompositeOperation="source-over",i.drawImage(n,0,0),A(e)}))}}},{key:"destroy",value:function(){var e=this;this.unregisterEventListeners(),_t(this.labels,(function(t){e.container.removeChild(t)})),this.labels=null,this.textMarkups=null,this.textSizeCache=null,this.markupsExtension=null,this.viewer=null}}])&&rs(t.prototype,n),r&&rs(t,r),e}();is.GlobalManagerMixin.call(As.prototype);var as=n(30),os=n(223),ss=n.n(os),us=n(224),ls=n.n(us),cs={uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:ss.a,fragmentShader:ls.a},hs={worldToClient:function(e,t,n){var r=new THREE.Vector4(t.x,t.y,t.z,1);return r.applyMatrix4(n.matrixWorldInverse),r.applyMatrix4(n.projectionMatrix),r.w>0&&(r.x/=r.w,r.y/=r.w,r.z/=r.w),e.impl.viewportToClient(r.x,r.y)},getCameraEyeVector:function(e){return e.target.clone().sub(e.position).normalize()},getCameraRightVector:function(e){var t=hs.getCameraEyeVector(e);return(new THREE.Vector3).crossVectors(t,e.up).normalize()},getCameraUpVector:function(e){var t=hs.getCameraRightVector(e),n=hs.getCameraEyeVector(e);return(new THREE.Vector3).crossVectors(t,n).normalize()},getCameraRotation:function(e){return st.getSignedAngle(hs.getCameraUpVector(e),new THREE.Vector3(0,1,0),hs.getCameraEyeVector(e))}},ds=hs;function fs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ps=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.viewer=this.markupsExtension.viewer,this.viewer.impl.updateCameraMatrices(),this.viewer.navigation.updateCamera(),this.documentCamera=this.viewer.navigation.getCamera(),this.documentCamera.updateMatrixWorld(),this.documentCamera.matrixWorldInverse.getInverse(this.documentCamera.matrixWorld),this.textRenderer=new As(this.markupsExtension),this.frameRenderer=new Xo(this.markupsExtension),this.linksRenderer=new Zo(this.markupsExtension),this.materialManager=new es(this.markupsExtension),this.geometryManager=new Hi(this.markupsExtension),this.is3d=this.viewer.model.is3d(),this.raycaster=new THREE.Raycaster,this.size={width:this.viewer.canvas.clientWidth,height:this.viewer.canvas.clientHeight},this.is3d?(this.viewSize=Ze,this.markupsCamera=new THREE.OrthographicCamera(0,this.viewSize,this.viewSize,0,0,1),this.markupsCamera.position.set(0,0,1),this.markupsCamera.target=new THREE.Vector3(0,0,0)):this.markupsCamera=this.viewer.navigation.getCamera(),this.markups=[],this.glrenderer=this.viewer.impl.glrenderer(),this.copyPass=new as.a(cs),this.copyPass.material.depthWrite=!1,this.copyPass.material.depthTest=!1,this.copyPass.material.transparent=!0,this._tmpScene=new THREE.Scene,this._black=new THREE.Color(0,0,0),this.absoluteRightVec=new THREE.Vector3(1,0,0),this.absoluteUpVec=new THREE.Vector3(0,1,0),this.absoluteEyeVec=new THREE.Vector3(0,0,1),this.tmpMatrix=new THREE.Matrix4,this.frustum=new THREE.Frustum,this.setMMtoUnitConversion(),this.setNormaStrokeWidth(),this.setNormaTextSize(),this.registerEventListeners(),this.updateCameraAndMaterialParameters()}var t,n,r;return t=e,(n=[{key:"registerEventListeners",value:function(){this.onRenderBinded=this.onRender.bind(this),this.onResizeBinded=this.onResize.bind(this),this.invalidateBinded=this.invalidate.bind(this),this.onCameraChangedBinded=this.onCameraChanged.bind(this),this.viewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.onRenderBinded),this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResizeBinded),this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_REMOVED,this.invalidateBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_DRAWING_CANCEL,this.invalidateBinded)}},{key:"removeEventListeners",value:function(){this.viewer.removeEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.onRenderBinded),this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResizeBinded),this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_REMOVED,this.invalidateBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_DRAWING_CANCEL,this.invalidateBinded)}},{key:"onCameraChanged",value:function(){this.eyeVector=null,this.upVector=null,this.rightVector=null}},{key:"getResolution",value:function(){var e=this.glrenderer.getPixelRatio();return{width:this.size.width*e,height:this.size.height*e}}},{key:"supportsInt32Index",value:function(){return!!this.glrenderer.supportsElementIndexUint()}},{key:"disposeTmpTarget",value:function(){this._tmpTarget&&(this._tmpTarget.dispose(),this._tmpTarget=null)}},{key:"createTempRenderTarget",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getResolution();return this.disposeTmpTarget(),0!==e.width&&0!==e.height&&(this._tmpTarget=new THREE.WebGLRenderTarget(e.width,e.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1,depthBuffer:!1}),this._tmpTarget.generateMipmaps=!1,!0)}},{key:"onRender",value:function(){this.render()}},{key:"onResize",value:function(e){this.size.width=e.width,this.size.height=e.height,this.updateCameraAndMaterialParameters()}},{key:"updateCameraAndMaterialParameters",value:function(){if(this.is3d){var e=this.size.width/(this.size.height||1),t=this.viewSize*e,n=this.markupsCamera.right-t;this.markupsCamera.position.x+=n/2,this.markupsCamera.target.x+=n/2,this.markupsCamera.right=t,this.markupsCamera.updateProjectionMatrix(),this.markupsCamera.updateMatrixWorld(),this.markupsCamera.matrixWorldInverse.getInverse(this.markupsCamera.matrixWorld)}var r=this.getResolution();this._tmpTarget&&this.createTempRenderTarget(r),this.materialManager.updateScreenSize(r)}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.markupsCamera;this.tmpMatrix.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this.frustum.setFromMatrix(this.tmpMatrix);var r=function(t){var n=t.max,r=t.max.clone().setX(t.min.x),i=t.min,A=t.min.clone().setX(t.max.x);return e.frustum.containsPoint(n)||e.frustum.containsPoint(r)||e.frustum.containsPoint(i)||e.frustum.containsPoint(A)||e.frustum.intersectsBox(t)},i=function(e,t){return!(t.max.x<e.min.x||t.min.x>e.max.x||t.max.y<e.min.y||t.min.y>e.max.y)},A=[],a=[],o=[],s=function(){var r;0!==A.length&&((r=e._tmpScene).add.apply(r,A),e.glrenderer.render(e._tmpScene,n,t),e._tmpScene.children.length=0,A.length=0)},u=function(){var r;0!==a.length&&((r=e._tmpScene).add.apply(r,a),e.glrenderer.setClearColor(e._black,0),e.glrenderer.clearTarget(e._tmpTarget,!0,!1,!1),e.glrenderer.render(e._tmpScene,n,e._tmpTarget),e.copyPass.render(e.glrenderer,t,e._tmpTarget),e._tmpScene.children.length=0,a.length=0,o.length=0)};this.markups.forEach((function(l){var c=l.meshContainer;if(c.visible&&0!==c.children.length){if(!e.is3d){var h=l.getWorldBoundingBox(!0);if(!r(h))return}var d=l.fillMesh,f=l.strokeMesh,p=d&&d.material.opacity<1,g=f.material.uniforms.opacity.value<1;if(p||g){if(!e._tmpTarget&&!e.createTempRenderTarget())return;if(s(),!p&&d||!g)u(),e._tmpScene.add(c),c.remove(f),e.glrenderer.setClearColor(e._black,0),e.glrenderer.clearTarget(e._tmpTarget,!0,!1,!1),e.glrenderer.render(e._tmpScene,n,e._tmpTarget),e.copyPass.render(e.glrenderer,t,e._tmpTarget),c.remove(d),c.add(f),e.glrenderer.render(e._tmpScene,n,t),c.add(d),c.add(f),e._tmpScene.remove(c);else{var y=l.getWorldBoundingBox(!0);o.some((function(e){return(!l.isTransparent()||!e.isTransparent)&&i(y,e.bbox)}))&&u(),a.push(c),o.push({bbox:y,isTransparent:l.isTransparent()})}}else u(),A.push(c)}})),s(),u()}},{key:"getCameraEyeVector",value:function(){return this.eyeVector||(this.eyeVector=ds.getCameraEyeVector(this.markupsCamera)),this.eyeVector.clone()}},{key:"getCameraRightVector",value:function(){return this.rightVector||(this.rightVector=ds.getCameraRightVector(this.markupsCamera)),this.rightVector.clone()}},{key:"getCameraUpVector",value:function(){return this.upVector||(this.upVector=ds.getCameraUpVector(this.markupsCamera)),this.upVector.clone()}},{key:"getCameraRotation",value:function(){return ds.getCameraRotation(this.markupsCamera)}},{key:"worldToClient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.markupsCamera,n=this.viewer.navigation.getScreenViewport(),r=e.clone().project(t);return new THREE.Vector3((r.x+1)/2*n.width,(1-r.y)/2*n.height,0)}},{key:"clientToWorld",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.markupsCamera,n=this.viewer.navigation.getScreenViewport(),r=new THREE.Vector3;r.x=e.x/n.width*2-1,r.y=-(e.y/n.height*2-1);var i=r.unproject(t);return i.z=0,i}},{key:"sizeFromWorldToClient",value:function(e){var t=this.worldToClient(new THREE.Vector3),n=this.worldToClient(new THREE.Vector3(e,0,0));return t.distanceTo(n)}},{key:"sizeFromClientToWorld",value:function(e){var t=this.clientToWorld(new THREE.Vector3),n=this.clientToWorld(new THREE.Vector3(e,0,0));return t.distanceTo(n)}},{key:"multiplyByNormaStrokeWidth",value:function(e){return this.normaStrokeWidth*e}},{key:"documentCameraToMarkupsCamera",value:function(e){if(!this.is3d)return e.z=0,e;var t=this.worldToClient(e,this.documentCamera);return this.clientToWorld(t)}},{key:"_fromMMtoWorldUnits",value:function(e){if(this.is3d)return 1;var t=this.viewer.model,n=t.getMetadata("page_dimensions","page_units",null)||t.getMetadata("page_dimensions","model_units","mm");n=t.getUnitData(n.toLowerCase()).unitString;var r=Autodesk.Viewing.Private.convertUnits("mm",n,1,e);return t.getData().isLeaflet&&(r*=this.viewer.impl.getFitBounds(!0).size().x/t.getMetadata("page_dimensions","page_width")),r}},{key:"_calcNormaSize",value:function(e,t){var n=this.mmToWorldUnitFactor*e,r=this.viewer.impl.getFitBounds(!0),i=r.size().x,A=r.size().y,a=Math.sqrt(i*i+A*A);return n=Math.min(n,a*t)}},{key:"setMMtoUnitConversion",value:function(){this.mmToWorldUnitFactor=this._fromMMtoWorldUnits(1)}},{key:"setNormaStrokeWidth",value:function(){this.is3d?this.normaStrokeWidth=tt:this.normaStrokeWidth=this._calcNormaSize(fe,$e)}},{key:"setNormaTextSize",value:function(){this.is3d?this.normaTextSize=nt:this.normaTextSize=this._calcNormaSize(ge,et)}},{key:"getNormaStrokeWidth",value:function(){return this.normaStrokeWidth}},{key:"getFontToWorldScale",value:function(){return this.normaTextSize/pe}},{key:"addToScene",value:function(e){var t=function(e){return e.layer&&e.layer.layerData&&e.layer.layerData.metadata&&e.layer.layerData.metadata.created_at};t(e)?Kt(e,this.markups,(function(e,n){if(!t(e))return 1;var r=Date.parse(e.layer.layerData.metadata.created_at),i=Date.parse(n.layer.layerData.metadata.created_at);return r>i?1:r<i?-1:e.id>n.id?1:e.id<n.id?-1:0})):this.markups.push(e)}},{key:"removeFromScene",value:function(e){ct.remove(this.markups,(function(t){return t===e}))}},{key:"invalidate",value:function(){this.markupsExtension.viewer.impl.invalidate(!1,!1,!0)}},{key:"updateRaycaster",value:function(e){var t=this.viewer.navigation.getScreenViewport(),n=e.x/t.width*2-1,r=-e.y/t.height*2+1;this.raycaster.ray.origin.set(n,r,(this.markupsCamera.near+this.markupsCamera.far)/(this.markupsCamera.near-this.markupsCamera.far)).unproject(this.markupsCamera),this.raycaster.ray.direction.set(0,0,-1)}},{key:"destroy",value:function(){this.removeEventListeners(),this.frameRenderer&&(this.frameRenderer.destroy(),this.frameRenderer=null),this.linksRenderer&&(this.linksRenderer.destroy(),this.linksRenderer=null),this.textRenderer&&(this.textRenderer.destroy(),this.textRenderer=null),this.materialManager&&(this.materialManager.destroy(),this.materialManager=null),this.geometryManager&&(this.geometryManager.destroy(),this.geometryManager=null),this.disposeTmpTarget(),this.invalidate(),this.markupsExtension=null,this.viewer=null}}])&&fs(t.prototype,n),r&&fs(t,r),e}(),gs=n(34),ys={getModelExtension:function(e){var t=e&&e.toLowerCase().match(/\.([a-z0-9]+)(\?|$)/);return t?t[1]:null}},ms=ys;function Es(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var vs=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.options=n,this.filters=this.markupsExtension.cache.filters||this.getInitialFilters(),this.filterWithGUID=this.fileTypeSupportGUID(this.options.fileName)}var t,n,r;return t=e,(n=[{key:"getInitialFilters",value:function(){return{createdByFilter:[],createdAtStartFilter:null,createdAtEndFilter:null,showPrivateFilter:!0,showPublishedFilter:!0,showArchivedFilter:!1,toggleMarkupViewFilter:!0}}},{key:"updateFilters",value:function(e){this.markupsExtension.cache.filters=this.filters=Object.assign({},this.filters,e),this.markupsExtension.loadLayers(),this.markupsExtension.markupsManager.dispatchEvent({type:A.FILTER_CHANGED,filters:this.filters})}},{key:"filterLayers",value:function(e,t){var n=this;return!t&&this.filters.hideAllMarkups?[]:e.filter((function(e){return n.filterByVersion(e)&&n.filterBySheet(e,t&&n.filters.toggleMarkupViewFilter)&&n.filterByDate(e)&&n.filterPrivate(e)&&n.filterPublished(e)&&n.filterArchived(e)&&n.filterCreator(e)&&n.filterDeleted(e)}))}},{key:"fileTypeSupportGUID",value:function(e){var t=ms.getModelExtension(e);return!!t&&(t=t.toLowerCase(),re.includes(t))}},{key:"isDateInRange",value:function(e,t,n){var r=Object(gs.format)(e,"MM/DD/YYYY"),i=Object(gs.format)(t,"MM/DD/YYYY"),A=Object(gs.format)(n,"MM/DD/YYYY");return Object(gs.isWithinRange)(r,i,A)}},{key:"filterByDate",value:function(e){return!this.filters.createdAtStartFilter||!this.filters.createdAtEndFilter||this.isDateInRange(e.metadata.created_at,this.filters.createdAtStartFilter,this.filters.createdAtEndFilter)}},{key:"filterBySheet",value:function(e,t){if(t||!this.options.hasMultiSheet)return!0;var n=e.metadata.markup_metadata&&e.metadata.markup_metadata.sheetGUID,r=e.metadata.markup_metadata&&e.metadata.markup_metadata.sheetName;return this.filterWithGUID&&!e.loadedByName&&this.options.sheetGUID&&n?this.options.sheetGUID===n:!this.options.sheetName||!r||this.options.sheetName===r}},{key:"filterDeleted",value:function(e){return e.status!==I}},{key:"filterPrivate",value:function(e){return this.filters.showPrivateFilter||e.metadata.status!==N}},{key:"filterPublished",value:function(e){return this.filters.showPublishedFilter||e.metadata.status!==P}},{key:"filterArchived",value:function(e){return this.filters.showArchivedFilter||e.metadata.status!==j}},{key:"filterCreator",value:function(e){return!this.filters.createdByFilter||0===this.filters.createdByFilter.length||this.filters.createdByFilter.some((function(t){return e.metadata.created_by===t.value}))}},{key:"filterByVersion",value:function(e){var t=e.metadata.starting_version;return this.options.documentVersion>=t}},{key:"destroy",value:function(){this.filters=null,this.options=null}}])&&Es(t.prototype,n),r&&Es(t,r),e}();function Bs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ws=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t}var t,n,r;return t=e,(n=[{key:"canPublishMarkup",value:function(e){return!!(e&&e.guid&&!e.metadata.status!==P&&this.options.userId&&e.metadata.permitted_statuses&&-1!==e.metadata.permitted_statuses.indexOf(P))}},{key:"canArchiveMarkup",value:function(e){return!!(e&&e.guid&&!e.metadata.status!==j&&this.options.userId&&e.metadata.permitted_statuses&&-1!==e.metadata.permitted_statuses.indexOf(j))}},{key:"canEditMarkup",value:function(e){if(!e)return!0;if(!e.guid)return!1;var t=[N,P];return!(!this.options.userId||-1===t.indexOf(e.metadata.status))&&!(this.options.documentVersion<this.options.currentRawDocumentVersion)&&(this.options.isAdmin||this.options.userId===e.metadata.created_by)}},{key:"canDeleteMarkup",value:function(e){if(!e||!e.guid)return!1;var t=[R,N];return!(!this.options.userId||-1===t.indexOf(e.metadata.status))&&(this.options.isAdmin||this.options.userId===e.metadata.created_by)}},{key:"canEditMarkupAttachment",value:function(e,t){return!(!e||!e.guid)&&e.metadata.status!==V&&e.metadata.status!==j&&this.options.documentVersion===this.options.currentRawDocumentVersion&&!!this.options.userId&&(!!this.options.isAdmin||!t||t&&this.options.userId===t.attributes.created_by)}},{key:"canCreateMarkup",value:function(){return this.options.documentVersion===this.options.currentRawDocumentVersion}},{key:"destroy",value:function(){this.options=null}}])&&Bs(t.prototype,n),r&&Bs(t,r),e}();function ks(e){return(ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ss=Autodesk.Viewing.getGlobal(),Ts=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.registerEventListeners()}var t,n,r;return t=e,r=[{key:"send",value:function(e,t){var n=Ss.webkit&&Ss.webkit.messageHandlers.callbackHandler,r=n?function(e,t){n.postMessage({command:e,data:t})}:null,i=Ss.JSINTERFACE,A="object"===ks(t)?JSON.stringify(t):t;r?void 0!==A?r(e,A):r(e):i&&i[e]&&(void 0!==A?i[e](A):i[e]())}},{key:"correctPixelRatio",value:function(e){return Autodesk.Viewing.isAndroidDevice()&&(e.min.multiplyScalar(window.devicePixelRatio),e.max.multiplyScalar(window.devicePixelRatio)),e}}],(n=[{key:"registerEventListeners",value:function(){this.markupsExtension.markupsManager.addEventListener(A.LAYER_DESELECTED,this.onLayerDeselected),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_DESELECTED,this.onMarkupDeselected),this.markupsExtension.markupsManager.addEventListener(A.LAYER_SELECTED_FROM_DIFFERENT_SHEET,this.onLayerSelectedDifferentSheet),this.markupsExtension.markupsManager.addEventListener(A.LAYER_EDITED_FROM_DIFFERENT_SHEET,this.onLayerEditDifferentSheet),this.markupsExtension.markupsManager.addEventListener(On.HISTORY_CHANGED_EVENT,this.onHistoryChanged),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_SESSION_START,this.onMarkupSessionStart),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_SESSION_END,this.onMarkupSessionEnd),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_DRAWING_START,this.onMarkupDrawingStart),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_DRAWING_END,this.onMarkupDrawingEnd),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_DRAWING_CANCEL,this.onMarkupDrawingCancel),this.markupsExtension.markupsManager.addEventListener(A.LINK_SELECTED,this.onLinkSelected),this.markupsExtension.markupsManager.addEventListener(A.LINK_DESELECTED,this.onLinkDeselected),this.onLayerReadyToSaveChangedBinded=this.onLayerReadyToSaveChanged.bind(this),this.markupsExtension.markupsManager.addEventListener(A.LAYER_READY_TO_SAVE,this.onLayerReadyToSaveChangedBinded),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_VIEW_ENTERED,this.onMarkupViewEntered),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_VIEW_EXITED,this.onMarkupViewExited),this.markupsExtension.markupsManager.addEventListener(A.TEXT_EDITING_STARTED,this.onTextEditingStarted),this.markupsExtension.markupsManager.addEventListener(A.TEXT_EDITING_ENDED,this.onTextEditingEnded),this.updateContextualMenuBinded=this.updateContextualMenu.bind(this),this.hideContextualMenuBinded=this.hideContextualMenu.bind(this),this.updateContextualMenuDebouncedShort=ct.debounce(this.updateContextualMenuBinded,10),this.updateContextualMenuDebouncedLong=ct.debounce(this.updateContextualMenuBinded,200),this.markupsExtension.markupsManager.addEventListener(On.HISTORY_CHANGED_EVENT,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_SELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(A.LAYER_DIRTY,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(A.LAYER_SYNCED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(A.LAYER_SELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_EDIT_END,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_TOOL_ENABLED_CHANGED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(A.LAYER_DESELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_DESELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(A.MARKUP_EDIT_START,this.hideContextualMenuBinded),this.markupsExtension.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.updateContextualMenuDebouncedLong)}},{key:"unregisterEventListeners",value:function(){this.markupsExtension.markupsManager.removeEventListener(A.LAYER_DESELECTED,this.onLayerDeselected),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_DESELECTED,this.onMarkupDeselected),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_SELECTED_FROM_DIFFERENT_SHEET,this.onLayerSelectedDifferentSheet),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_EDITED_FROM_DIFFERENT_SHEET,this.onLayerEditDifferentSheet),this.markupsExtension.markupsManager.removeEventListener(On.HISTORY_CHANGED_EVENT,this.onHistoryChanged),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_SESSION_START,this.onMarkupSessionStart),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_SESSION_END,this.onMarkupSessionEnd),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_DRAWING_START,this.onMarkupDrawingStart),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_DRAWING_END,this.onMarkupDrawingEnd),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_DRAWING_CANCEL,this.onMarkupDrawingCancel),this.markupsExtension.markupsManager.removeEventListener(A.LINK_SELECTED,this.onLinkSelected),this.markupsExtension.markupsManager.removeEventListener(A.LINK_DESELECTED,this.onLinkDeselected),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_READY_TO_SAVE,this.onLayerReadyToSaveChangedBinded),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_VIEW_ENTERED,this.onMarkupViewEntered),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_VIEW_EXITED,this.onMarkupViewExited),this.markupsExtension.markupsManager.removeEventListener(A.TEXT_EDITING_STARTED,this.onTextEditingStarted),this.markupsExtension.markupsManager.removeEventListener(A.TEXT_EDITING_ENDED,this.onTextEditingEnded),this.markupsExtension.markupsManager.removeEventListener(On.HISTORY_CHANGED_EVENT,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_SELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_DIRTY,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_SYNCED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_SELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_EDIT_END,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_TOOL_ENABLED_CHANGED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(A.LAYER_DESELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_DESELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(A.MARKUP_EDIT_START,this.hideContextualMenuBinded),this.markupsExtension.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.updateContextualMenuDebouncedLong),this.updateContextualMenuDebouncedShort.cancel(),this.updateContextualMenuDebouncedLong.cancel()}},{key:"markupToolLoaded",value:function(){e.send("onMarkupToolLoaded")}},{key:"onMarkupSessionStart",value:function(){e.send("onMarkupSessionStart")}},{key:"onMarkupSessionEnd",value:function(){e.send("onMarkupSessionEnd")}},{key:"onMarkupDrawingStart",value:function(t){var n=t.markup;e.send("onMarkupDrawingStart",n.type)}},{key:"onMarkupDrawingEnd",value:function(t){var n=t.markup;e.send("onMarkupDrawingEnd",n.type)}},{key:"onMarkupDrawingCancel",value:function(t){var n=t.markup;e.send("onMarkupDrawingCancel",n.type)}},{key:"onLayerSelectedDifferentSheet",value:function(t){var n=t.layerGuid;e.send("onLayerSelectedDifferentSheet",n)}},{key:"onLayerEditDifferentSheet",value:function(t){var n=t.layerGuid;e.send("onLayerEditDifferentSheet",n)}},{key:"onLayerSelected",value:function(t){var n=t.layer,r=n.getGuid();if(r){var i={guid:r,boundingBox:e.correctPixelRatio(n.getClientBoundingBox(!0))};e.send("onLayerSelected",i)}}},{key:"onLayerDeselected",value:function(t){var n=t.layer.getGuid();n&&e.send("onLayerDeselected",n)}},{key:"onMarkupSelected",value:function(t){var n=t.markup,r={id:n.id,layerGuid:n.layer&&n.layer.getGuid()||"",type:n.type,style:n.editState.style,boundingBox:e.correctPixelRatio(n.getClientBoundingBox(!0,!0))};e.send("onMarkupSelected",r)}},{key:"onMarkupDeselected",value:function(t){var n=t.markup;e.send("onMarkupDeselected",n.id)}},{key:"onHistoryChanged",value:function(t){var n={enableUndo:t.hasUndo,enableRedo:t.hasRedo};e.send("onMarkupHistoryChanged",n)}},{key:"onLayerReadyToSaveChanged",value:function(t){var n=t.readyToSave;e.send("onLayerReadyToSaveChanged",n)}},{key:"postLayer",value:function(t,n,r){var i,A={metadata:t,resources:(i={},Cs(i,ee,n[0]),Cs(i,te,n[1]),i),requestId:r};e.send("onPostLayer",A)}},{key:"updateLayer",value:function(t,n,r,i){var A,a={originalGuid:t,metadata:n,resources:(A={},Cs(A,ee,r[0]),Cs(A,te,r[1]),A),requestId:i};e.send("onUpdateLayer",a)}},{key:"deleteLayer",value:function(t,n){var r={guid:t,requestId:n};e.send("onDeleteLayer",r)}},{key:"publishLayer",value:function(t,n){var r={guid:t,requestId:n};e.send("onPublishLayer",r)}},{key:"archiveLayer",value:function(t,n,r){var i={guid:t,closeVersion:n,requestId:r};e.send("onArchiveLayer",i)}},{key:"onLinkSelected",value:function(t){var n=t.link,r={type:n.type,layerGuid:n.layer.layerData.guid,boundingBox:n.getClientBoundingBox()};e.send("onLinkSelected",r)}},{key:"onLinkDeselected",value:function(t){var n=t.link,r={type:n.type,layerGuid:n.layer.layerData.guid};e.send("onLinkDeselected",r)}},{key:"updateContextualMenu",value:function(){if(!this.markupsExtension.markupsManager.getDuringCreationMarkup()){var e=this.markupsExtension.markupsManager.getSelectedMarkups()[0];if(e)return void this.onMarkupSelected({markup:e});if(!this.markupsExtension.markupsManager.isMarkupSessionOpen()){var t=this.markupsExtension.markupsManager.getSelectedLayer();if(t)return void this.onLayerSelected({layer:t})}}this.hideContextualMenu()}},{key:"hideContextualMenu",value:function(){e.send("onHideContextualMenu")}},{key:"onMarkupViewExited",value:function(){e.send("onMarkupViewExited")}},{key:"onMarkupViewEntered",value:function(){e.send("onMarkupViewEntered")}},{key:"onTextEditingStarted",value:function(){e.send("onTextEditingStarted")}},{key:"onTextEditingEnded",value:function(){e.send("onTextEditingEnded")}},{key:"destroy",value:function(){this.unregisterEventListeners(),this.iosSend=null,this.androidSend=null,this.send=null}}])&&bs(t.prototype,n),r&&bs(t,r),e}();function Ms(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Us=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache={},this.currentUrn="default"}var t,n,r;return t=e,(n=[{key:"setCurrentUrn",value:function(e){this.currentUrn=e,this.cache[e]=this.cache[e]||{}}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.currentUrn;this.cache[n][e]=t}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentUrn;delete this.cache[t][e]}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentUrn;return this.cache[t][e]}},{key:"getAsList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentUrn,n=[];return Object.keys(this.cache[t]).forEach((function(r){n.push(e.cache[t][r])})),n}},{key:"getCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentUrn;return this.cache[e]}},{key:"cleanCache",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentUrn;Object.keys(this.cache[t]).forEach((function(t){e.remove(t)}))}},{key:"length",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentUrn;return Object.keys(this.cache[e]).length}},{key:"isEmpty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentUrn;return 0===this.length(e)}}])&&Ms(t.prototype,n),r&&Ms(t,r),e}();function Qs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xs=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.options=n||{}}var t,n,r;return t=e,(n=[{key:"postLayer",value:function(e,t){return console.log("postLayer"),new Promise((function(e,t){}))}},{key:"publishLayer",value:function(e){return console.log("publishLayer"),new Promise((function(e,t){}))}},{key:"archiveLayer",value:function(e,t){return console.log("archiveLayer"),new Promise((function(e,t){}))}},{key:"updateLayer",value:function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2],console.log("updateLayer"),new Promise((function(e,t){}))}},{key:"deleteLayer",value:function(e){return console.log("deleteLayer"),new Promise((function(e,t){}))}},{key:"postDocumentAttachment",value:function(e,t){return console.log("postDocumentAttachment"),new Promise((function(e,t){}))}},{key:"deleteDocumentAttachment",value:function(e){return console.log("deleteDocumentAttachment"),new Promise((function(e,t){}))}},{key:"renameDocumentAttachment",value:function(e,t){return console.log("renameDocumentAttachment"),new Promise((function(e,t){}))}},{key:"requestMarkups",value:function(e,t,n,r){return console.log("requestMarkups"),new Promise((function(e,t){}))}},{key:"getAttachment",value:function(e,t,n){return console.log("getAttachment"),new Promise((function(e,t){}))}},{key:"cancelAllGet",value:function(){console.log("cancelAllGet")}}])&&Qs(t.prototype,n),r&&Qs(t,r),e}();function Fs(e){return(Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hs(e,t){return!t||"object"!==Fs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ls(e){return(Ls=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Is(e,t){return(Is=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ds=function(e){function t(e,n){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);(r=Hs(this,Ls(t).call(this,e,n))).issueType=r.ISSUES_TYPE.markup;var i=r.ENV_TABLE[n.env||"Development"];return r.ISSUE_SERVICE_URL=i.ISSUE_SERVICE,r.OBJECT_STORAGE_SERVICE_URL=i.OBJECT_STORAGE,r.maxPageLimit=200,r.xhrGetReq=[],r.headers=[{name:"x-ads-acm-namespace",value:r.options.acmNamespace},{name:"x-ads-acm-check-groups",value:"true"}],r.options.acmScopes&&r.headers.push({name:"x-ads-acm-scopes",value:r.options.acmScopes}),r}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Is(e,t)}(t,e),n=t,(r=[{key:"checkValidation",value:function(){var e=this.getAccessToken();return this.valid=!!e&&!!this.options.issueProject&&!!this.issueType,this.valid}},{key:"requestMarkups",value:function(e,t,n,r){if(!this.checkValidation())return Promise.reject("Service is unavailable.");e||(e=this.maxPageLimit),t||(t=0);var i=this;return new Promise((function(A,a){if(!i.options.documentUrn)return a();var o=[i.ISSUE_SERVICE_URL,"containers/",i.options.issueProject,i.issueType.endpoint].join("");o=[o,"?page[limit]="+e+"&page[offset]="+t].join(""),i.options.documentUrn&&(o=[o,"&filter[target_urn]=",encodeURIComponent(i.options.documentUrn)].join("")),o=[o,"&include=attachments"].join(""),r&&(o=[o,"&filter[status]=",r].join("")),o=[o,"&sort=-created_at"].join("");var s=i.getAjaxCallback((function(){i.removeXhr(u),A.apply(null,arguments)}),(function(){i.removeXhr(u),a.apply(null,arguments)})),u=i.createRequest(i,"GET",o,"application/vnd.api+json",s);i.injectHeaders(u,n),u.send(),i.addXhr(u)}))}},{key:"postMarkups",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var n=this;return new Promise((function(r,i){var A=[n.ISSUE_SERVICE_URL,"containers/",n.options.issueProject,n.issueType.endpoint].join(""),a=n.getAjaxCallback(r,i),o=n.createRequest(n,"POST",A,"application/vnd.api+json",a);n.injectHeaders(o,t);var s={data:{type:n.issueType.value,attributes:e}};o.send(JSON.stringify(s))})).then(n.parseResponse)}},{key:"fetchOSSBucketForAttachment",value:function(e){var t=this;return new Promise((function(n,r){t.fetchLocationForNewOssAttachment([],{onLoad:function(t){var i=t.currentTarget;if(201===i.status||200===i.status){var A=JSON.parse(i.responseText);e.ossPath=A.data.attributes.urn,n()}else r()},onError:function(){r()},onTimeout:function(){r()}})}))}},{key:"uploadAttachment",value:function(e){var t=this;return new Promise((function(n,r){var i=t.extractOssBucketAndId(e.ossPath),A=i[0],a=i[1];t.postAttachment(a,e.data,A,{onLoad:function(e){var t=e.currentTarget;200===t.status||201===t.status?n():r()},onError:function(){r()},onTimeout:function(){r()}})}))}},{key:"postLayer",value:function(e,t,n){var r=this;return function(){if(0===t.length)return Promise.resolve();var e=t.map((function(e){return r.fetchOSSBucketForAttachment(e)}));return Promise.all(e)}().then((function(){return function(){if(0===t.length)return Promise.resolve();var e=t.map((function(e){return r.uploadAttachment(e)}));return Promise.all(e)}()}),(function(){return Promise.reject()})).then((function(){return t.forEach((function(t){e.resource_urns[t.type]=t.ossPath})),n?r.updateLayer(n,e):r.postMarkups(e,[])})).catch((function(i){return t.forEach((function(t){e.resource_urns[t.type]=t.data})),e.tags.resourceEmbed=!0,n?r.updateLayer(n,e):r.postMarkups(e,[])}))}},{key:"parseResponse",value:function(e){try{var t=JSON.parse(e).data;return Promise.resolve(t)}catch(e){return Promise.reject(e)}}},{key:"publishLayer",value:function(e){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var t=this;return new Promise((function(n,r){var i=[t.ISSUE_SERVICE_URL,"containers/",t.options.issueProject,t.issueType.endpoint,"/",e].join(""),A=t.getAjaxCallback(n,r),a=t.createRequest(t,"PATCH",i,"application/vnd.api+json",A),o={data:{type:t.issueType.value,id:e,attributes:{status:P}}};a.send(JSON.stringify(o))})).then(t.parseResponse)}},{key:"archiveLayer",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var n=this;return new Promise((function(r,i){var A=[n.ISSUE_SERVICE_URL,"containers/",n.options.issueProject,n.issueType.endpoint,"/",e].join(""),a=n.getAjaxCallback(r,i),o=n.createRequest(n,"PATCH",A,"application/vnd.api+json",a),s={data:{type:n.issueType.value,id:e,attributes:{close_version:t,status:j}}};o.send(JSON.stringify(s))})).then(n.parseResponse)}},{key:"fetchLocationForNewOssAttachment",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var n=[this.ISSUE_SERVICE_URL,"containers/",this.options.issueProject,"/oss_objects"].join(""),r=this.createRequest(this,"POST",n,"application/vnd.api+json",t);return this.injectHeaders(r,e),r.send(JSON.stringify({data:{type:"oss_objects"}})),null}},{key:"getAttachment",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var n=this;return new Promise((function(r,i){var A=n.extractOssBucketAndId(e),a=[n.OBJECT_STORAGE_SERVICE_URL,"buckets/",A[0],"/objects/",A[1]].join(""),o=n.getAjaxCallback((function(){n.removeXhr(s),r.apply(null,arguments)}),(function(){n.removeXhr(s),i.apply(null,arguments)}),t),s=n.createRequest(n,"GET",a,null,o);n.injectHeaders(s,n.headers),t&&(s.responseType="arraybuffer"),s.send(),n.addXhr(s)}))}},{key:"postAttachment",value:function(e,t,n,r){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var i=[this.OBJECT_STORAGE_SERVICE_URL,"buckets/",n,"/objects/",e].join(""),A=this.createRequest(this,"PUT",i,"text/plain",r);return this.injectHeaders(A,this.headers),A.send(t),null}},{key:"updateLayer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!this.checkValidation())return Promise.reject("Service is unavailable.");var r=this;return new Promise((function(i,A){var a=[r.ISSUE_SERVICE_URL,"containers/",r.options.issueProject,r.issueType.endpoint,"/",e].join(""),o=r.getAjaxCallback(i,A),s=r.createRequest(r,"PATCH",a,"application/vnd.api+json",o);r.injectHeaders(s,n);var u={data:{type:r.issueType.value,id:e,attributes:t||{}}};s.send(JSON.stringify(u)),r.addXhr(s)})).then(r.parseResponse)}},{key:"deleteLayer",value:function(e){if(!this.checkValidation())return Promise.reject("Service is unavailable");var t=this;return new Promise((function(n,r){var i=[t.ISSUE_SERVICE_URL,"containers/",t.options.issueProject,t.ISSUES_TYPE.markup.endpoint+"/",e].join(""),A=t.getAjaxCallback(n,r);t.createRequest(t,"DELETE",i,"application/vnd.api+json",A).send()}))}},{key:"postDocumentAttachment",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var n=this;return new Promise((function(r,i){var A=[n.ISSUE_SERVICE_URL,"containers/",n.options.issueProject,n.ATTACHMENT.endpoint].join(""),a=n.getAjaxCallback(r,i),o=n.createRequest(n,"POST",A,"application/vnd.api+json",a);n.injectHeaders(o,t);var s={data:{type:n.ATTACHMENT.value,attributes:e.attributes}};o.send(JSON.stringify(s))})).then(n.parseResponse)}},{key:"deleteDocumentAttachment",value:function(e){if(!this.checkValidation())return Promise.reject("Service is unavailable");var t=this;return new Promise((function(n,r){var i=[t.ISSUE_SERVICE_URL,"containers/",t.options.issueProject,t.ATTACHMENT.endpoint+"/",e].join(""),A=t.getAjaxCallback(n,r);t.createRequest(t,"DELETE",i,"application/vnd.api+json",A).send()}))}},{key:"renameDocumentAttachment",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable");var n=this;return new Promise((function(r,i){var A=[n.ISSUE_SERVICE_URL,"containers/",n.options.issueProject,n.ATTACHMENT.endpoint+"/",e].join(""),a=n.getAjaxCallback(r,i),o=n.createRequest(n,"PATCH",A,"application/vnd.api+json",a),s={data:{type:n.ATTACHMENT.value,id:e,attributes:{name:t}}};o.send(JSON.stringify(s))})).then(n.parseResponse)}},{key:"extractOssBucketAndId",value:function(e){var t=e.split("/"),n=t[0].split(":");return t[0]=n[n.length-1],t}},{key:"cancelAllGet",value:function(){for(var e=this.xhrGetReq.length-1;e>=0;e--)this.xhrGetReq[e]&&this.xhrGetReq[e].abort();this.xhrGetReq=[]}},{key:"removeXhr",value:function(e){var t=this.xhrGetReq.indexOf(e);t>-1&&this.xhrGetReq.splice(t,1)}},{key:"addXhr",value:function(e){this.xhrGetReq.push(e)}},{key:"getAccessToken",value:function(){var e;if(this.markupsExtension.options.getAccessToken)return this.markupsExtension.options.getAccessToken((function(t,n){e=t})),e}},{key:"getAjaxCallback",value:function(e,t,n){return{onLoad:function(r){201===r.currentTarget.status||200===r.currentTarget.status||204===r.currentTarget.status?e(n?r.currentTarget.response:r.currentTarget.responseText):t()},onError:function(){t()},onTimeout:function(){t()},onAbort:function(){t()}}}},{key:"createRequest",value:function(e,t,n,r,i){var A=new XMLHttpRequest;A.open(t,n,!0),r&&A.setRequestHeader("Content-Type",r);var a=this.getAccessToken();return A.setRequestHeader("Access-Control-Allow-Origin","*"),A.setRequestHeader("Authorization","Bearer "+a),A.onload=i.onLoad,A.onerror=i.onError,A.ontimeout=i.onTimeout,A.onabort=i.onAbort,A}},{key:"injectHeaders",value:function(e,t){t&&t.forEach((function(t){e.setRequestHeader(t.name,t.value)}))}},{key:"ENV_TABLE",get:function(){return{Local:{ISSUE_SERVICE:"https://developer-dev.api.autodesk.com/issues-dev/v1/",OBJECT_STORAGE:"https://developer-dev.api.autodesk.com/oss/v2/"},Development:{ISSUE_SERVICE:"https://developer-stg.api.autodesk.com/issues-dev/v1/",OBJECT_STORAGE:"https://developer-stg.api.autodesk.com/oss/v2/"},Qa:{ISSUE_SERVICE:"https://developer-stg.api.autodesk.com/issues-qa/v1/",OBJECT_STORAGE:"https://developer-stg.api.autodesk.com/oss/v2/"},Staging:{ISSUE_SERVICE:"https://developer-stg.api.autodesk.com/issues-stg/v1/",OBJECT_STORAGE:"https://developer-stg.api.autodesk.com/oss/v2/"},Production:{ISSUE_SERVICE:"https://developer.api.autodesk.com/issues/v1/",OBJECT_STORAGE:"https://developer.api.autodesk.com/oss/v2/"}}}},{key:"ISSUES_TYPE",get:function(){return{issue:{value:"issues",endpoint:"/issues"},markup:{value:"markups",endpoint:"/markups"},area_markup:{value:"areas",endpoint:"/areas"},area_status:{value:"area_statuses",endpoint:"/area-statuses"}}}},{key:"ATTACHMENT",get:function(){return{value:"attachments",endpoint:"/attachments"}}}])&&_s(n.prototype,r),i&&_s(n,i),t}(xs),Os=n(8);function Rs(e){return(Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ns(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ps(e,t){return!t||"object"!==Rs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ks(e){return(Ks=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vs(e,t){return(Vs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var js=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Ps(this,Ks(t).call(this,e,n))).pendingRequests={},r}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vs(e,t)}(t,e),n=t,(r=[{key:"requestMarkups",value:function(){return this.markupsExtension.mobileCallbacks.markupToolLoaded(),new Promise((function(e,t){}))}},{key:"postLayer",value:function(e,t,n){var r=Object(Os.v4)();return n?this.markupsExtension.mobileCallbacks.updateLayer(n,e,t,r):this.markupsExtension.mobileCallbacks.postLayer(e,t,r),this.returnDelayedPromise(r)}},{key:"updateLayer",value:function(e,t){var n=Object(Os.v4)();return this.markupsExtension.mobileCallbacks.updateLayer(e,t),this.returnDelayedPromise(n)}},{key:"deleteLayer",value:function(e){var t=Object(Os.v4)();return this.markupsExtension.mobileCallbacks.deleteLayer(e,t),this.returnDelayedPromise(t)}},{key:"publishLayer",value:function(e){var t=Object(Os.v4)();return this.markupsExtension.mobileCallbacks.publishLayer(e,t),this.returnDelayedPromise(t)}},{key:"archiveLayer",value:function(e,t){var n=Object(Os.v4)();return this.markupsExtension.mobileCallbacks.archiveLayer(e,t,n),this.returnDelayedPromise(n)}},{key:"postDocumentAttachment",value:function(e,t){var n=Object(Os.v4)();return this.returnDelayedPromise(n)}},{key:"deleteDocumentAttachment",value:function(e){var t=Object(Os.v4)();return this.returnDelayedPromise(t)}},{key:"renameDocumentAttachment",value:function(e,t){var n=Object(Os.v4)();return this.returnDelayedPromise(n)}},{key:"cancelAllGet",value:function(){var e=this;Object.keys(this.pendingRequests).forEach((function(t){e.pendingRequests[t].reject(),delete e.pendingRequests[t]}))}},{key:"returnDelayedPromise",value:function(e){var t={},n=new Promise((function(e,n){t.resolve=e,t.reject=n}));return this.pendingRequests[e]=t,n}},{key:"onRequestCompleted",value:function(e,t,n){t?this.pendingRequests[n].resolve(e):this.pendingRequests[n].reject(),delete this.pendingRequests[n]}}])&&Ns(n.prototype,r),i&&Ns(n,i),t}(xs);function Gs(e){return(Gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var zs=function(e,t){delete e.scale,delete e.translation,t&&(delete e.style,delete e.position,delete e.size,delete e.rotation)},Ys=function(e,t){var n,r;if(t.model.getData().isPdf)Autodesk.Viewing.PDFUtils.pdfToLeafletWorld(t,e),n=Autodesk.Viewing.PDFUtils.getLeafletLoadOptions(t),r=Autodesk.Viewing.PDFUtils.getLeafletBoundingBox(t);else{var i=t.model.getData();n=i.loadOptions.loadOptions,r=i.bbox}var A=n,a=A.texWidth,o=A.texHeight,s=e,u=new THREE.Vector3(r.min.x,r.max.y,0);return s.sub(u),e.x=s.x*a/r.size().x,e.y=s.y*o/r.size().y,e},Ws=function(e,t){var n=Ys(new THREE.Vector3,t),r=Ys(new THREE.Vector3(e,0,0),t);return n.distanceTo(r)},Xs=function(e,t){return t.createElementNS("http://www.w3.org/2000/svg",e)},Js=function(e,t,n){var r=t.getDocument(),i=Xs("svg",r);!function(e,t,n){var r=n.createElementNS("http://www.w3.org/2000/svg","metadata"),i=n.createElement("markup_document");r.appendChild(i),i.setAttribute("data-model-version",t["data-model-version"]),e.insertBefore(r,e.firstChild)}(i,{"data-model-version":"5"},r);var A=Lt(e.markups),a=t.impl.is2d?null:t.getState(),s=t.model.getData().isLeaflet,u=t.model.getData().isPdf;return A.forEach((function(A){var a=ct.cloneDeep(A.getState());if(t.impl.is2d||Ho(t,e.layerData,!0),a.anchors.forEach((function(e){A.applyScaleAndTranslation(e),(s||u)&&e.copy(Ys(e,t))})),A.type!==y&&A.type!==U&&!A.isGroupMarkup()){var c;A.type===S?(a.isFrameUsed=a.isFrameUsed?1:0,c=A.getWorldBoundingBoxTextOnly()):c=A.getWorldBoundingBox();var h=c.size(),d=c.center();(s||u)&&(d.copy(Ys(d,t)),h.x=Ws(h.x,t),h.y=Ws(h.y,t)),a.size="".concat(h.x," ").concat(h.y),a.position="".concat(d.x," ").concat(d.y),Dt(a.anchors,d.clone().negate())}A.type===U&&((s||u)&&a.translation.copy(Ys(a.translation,t).sub(Ys(new THREE.Vector3,t))),a.offset="".concat(a.translation.x," ").concat(a.translation.y," ").concat(a.translation.z),a.style[l.FONT_SIZE]*=ze,a.style[l.THICKNESS]*=Ge),(s||u)&&(a.style[l.THICKNESS]=Ws(a.style[l.THICKNESS],t),a.style[l.FONT_SIZE]=Ws(a.style[l.FONT_SIZE],t),a.style[l.FONT_SIZE]*=n.getFontToWorldScale()),a.type=A.type,(a.style[l.FILL_COLOR]===o.NO_COLOR||A.options.fillNotAllowed)&&(a.style[l.FILL_OPACITY]=0,a.style[l.FILL_COLOR]=o.NO_COLOR),zs(a,A.isGroupMarkup()),function(e){var t={};switch(e.type){case m:case v:case E:break;case y:case Q:t.tail=e.anchors[0],t.head=e.anchors[1];break;case U:t.firstAnchor=e.anchors[0],t.secondAnchor=e.anchors[1];break;case w:case B:case C:case k:t.locations=e.anchors}e.anchors=t}(a);var f=function(e){var t={};return Object.keys(e).forEach((function(n){"object"!==Gs(e[n])||Array.isArray(e[n])?t[n]=e[n]:Object.keys(e[n]).forEach((function(r){t[r]=e[n][r]}))})),t}(a);!function(e){Object.keys(e).forEach((function(t){if(Array.isArray(e[t])){var n=e[t],r=[];n.forEach((function(e){r.push(e.x),r.push(e.y)})),e[t]=r.join(" ")}else if("object"===Gs(e[t])){var i=e[t],A=[];A.push(i.x),A.push(i.y),e[t]=A.join(" ")}}))}(f);var p=function(e,t){var n=Xs("g",t);n.setAttribute("cursor","inherit"),n.setAttribute("pointer-events","none");var r=Xs("path",t);return r.setAttribute("id","markup"),e?r.setAttribute("d","M 0 0 z"):r.setAttribute("d","M 0 0"),n.appendChild(r),n}(f.closed,r);!function(e,t,n){var r=n.createElementNS("http://www.w3.org/2000/svg","metadata"),i=n.createElement("markup_element");r.appendChild(i),Object.keys(t).forEach((function(e){i.setAttribute(e,t[e])})),e.insertBefore(r,e.firstChild)}(p,f,r),i.appendChild(p)})),a&&t.restoreState(a,null,!0),function(e){var t="";try{t=(new XMLSerializer).serializeToString(e)}catch(e){console.error("svgNodeToString failed to generate string representation of domNode.")}return t}(i)};function qs(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Zs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $s=at,eu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"reset",value:function(e){this.markupsExtension=e,this.markupsManager=e.markupsManager,this.markupsCache=e.markupsCache,this.viewer=e.viewer,this.options=this.markupsExtension.options,this.savingCounter=0;var t=e.options.isMobileApp,n=this.options.serviceClass||Ds;this.service=t?new js(this.markupsExtension,this.options):new n(this.markupsExtension,this.options),this.errorHandler=this.options.errorHandler||function(){},this.onSessionEndedBinded=this.onSessionEnded.bind(this),this.markupsManager.addEventListener(A.MARKUP_SESSION_END,this.onSessionEndedBinded),this.onLayerDeletedBinded=this.onLayerDeleted.bind(this),this.markupsManager.addEventListener(A.LAYER_DELETE,this.onLayerDeletedBinded),this.onDocumentAttachmentCreationStartBinded=this.onDocumentAttachmentCreationStart.bind(this),this.markupsManager.addEventListener(A.DOCUMENT_ATTACHMENT_CREATION_START,this.onDocumentAttachmentCreationStartBinded),this.renameDocumentAttachmentBinded=this.renameDocumentAttachment.bind(this),this.markupsManager.addEventListener(A.DOCUMENT_ATTACHMENT_RENAME,this.renameDocumentAttachmentBinded),this.deleteDocumentAttachmentBinded=this.deleteDocumentAttachment.bind(this),this.markupsManager.addEventListener(A.DOCUMENT_ATTACHMENT_DELETE,this.deleteDocumentAttachmentBinded),this.onPublishLayerBinded=this.onPublishLayer.bind(this),this.markupsManager.addEventListener(A.LAYER_PUBLISH,this.onPublishLayerBinded),this.onArchiveLayerBinded=this.onArchiveLayer.bind(this),this.markupsManager.addEventListener(A.LAYER_ARCHIVE,this.onArchiveLayerBinded)}},{key:"onSessionEnded",value:function(e){var t=e.layer;e.save&&!t.isEmpty()&&this.saveLayer(t)}},{key:"onLayerDeleted",value:function(e){var t=e.layerData;t&&this.deleteLayer(t)}},{key:"onPublishLayer",value:function(e){var t=e.layerData;t&&this.publishLayer(t)}},{key:"onArchiveLayer",value:function(e){var t=e.layerData;t&&this.archiveLayer(t)}},{key:"fetchMarkups",value:function(){var e=this,t=this.options.documentUrn;this.numOfMarkupsLoaded=0;var n=this.getMaxPageLimit(),r=0,i={layersData:[],relatedResources:[]},A=ne;(function t(){return e.requestMarkups(i,n,r,A).then((function(e){if(e&&e.nextReq)return r+=n,t()})).catch((function(e){console.warn("requestMarkups failed or canceled.")}))})().then((function(){return e.getMetadata(i,t)})).catch((function(e){return e}))}},{key:"requestMarkups",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ne;return this.service.requestMarkups(t,n,null,r).then((function(t){try{var n,r=JSON.parse(t);(n=e.layersData).push.apply(n,qs(r.data));var i,A=r.included;return A&&Array.isArray(A)&&(i=e.relatedResources).push.apply(i,qs(A)),Promise.resolve({nextReq:r.links.next})}catch(e){return Promise.reject(e)}}),(function(){return Promise.reject()}))}},{key:"getMetadata",value:function(e,t){var n=this,r=e.relatedResources,i=e.layersData,a=this.markupsExtension.filterManager.filterWithGUID?function(e){return e.attributes.markup_metadata.sheetGUID===n.options.sheetGUID}:function(e){return e.attributes.markup_metadata.sheetName===n.options.sheetName};return(i=ct.remove(i,a).concat(i)).forEach((function(e){var r=e.attributes;if(r.markup_metadata){var i=r.starting_version;if(!(n.options.documentVersion<i)){r.tags=r.tags||{};var a=function(e){return"true"===e||!0===e||1===e}(r.tags.resourceEmbed),o=n.markupsCache.get(e.id),s=o||new io;if(!o){s.guid=e.id,s.status=R,s.metadata=r,r.close_version>0&&(s.status=V);var u=r.resource_urns;if(u){var l=n.createEmptyResourceObject(ee,a,u);l&&s.resources.push(l);var c=n.createEmptyResourceObject(te,a,u);c&&s.resources.push(c)}n.markupsCache.add(s.guid,s,t)}n.notify({type:A.LAYER_FETCHED,layerData:s}),n.getAttachment(s)}}})),this.fetchedAllMarkups||this.numOfMarkupsLoaded!==this.markupsCache.length()||(this.fetchedAllMarkups=!0,this.notify({type:A.ALL_MARKUPS_LOADED,amount:this.numOfMarkupsLoaded})),this.getUserProfiles(),this.getProjectUsers(),this.getRevisions(),this.getAttachedDocumentData(r),this.notify({type:A.LAYER_METADATA_FETCHED}),Promise.resolve()}},{key:"notify",value:function(e){if(this.markupsManager)try{this.markupsManager.dispatchEvent(e)}catch(e){console.warn(e)}}},{key:"getAttachment",value:function(e){var t=this,n=e.resources.map((function(n){var r=null;if(n.data)return r={layerData:e,resourceType:n.type},t.onGetAttachment(r),Promise.resolve(r);var i=$===Z;return t.service.getAttachment(n.ossPath,i).then((function(i){return i?(n.data=i,r={layerData:e,resourceType:n.type},t.onGetAttachment(r),Promise.resolve(r)):Promise.resolve(null)})).catch((function(e){}))}));return Promise.all(n)}},{key:"onGetAttachment",value:function(e){var t=e.layerData,n=e.resourceType;n===ee&&(this.numOfMarkupsLoaded+=1,this.notify({type:A.LAYER_RESOURCE_FETCHED,layerData:t}),this.fetchedAllMarkups||this.numOfMarkupsLoaded!==this.markupsCache.length()||(this.fetchedAllMarkups=!0,this.notify({type:A.ALL_MARKUPS_LOADED,amount:this.numOfMarkupsLoaded}))),n===te&&this.notify({type:A.LAYER_THUMBNAIL_FETCHED,layerData:t})}},{key:"createEmptyResourceObject",value:function(e,t,n){if(n[e]){var r={type:e,data:null,id:null,ossPath:null};return t?r.data=n[e]:r.ossPath=n[e],r}return null}},{key:"getAttachedDocumentData",value:function(e){var t=this;if(e&&Array.isArray(e)&&0!==e.length&&this.options.getAttachedDocumentCallback){var n=this.markupsCache.getAsList(),r=e.filter((function(e){return n.some((function(t){return e.attributes&&e.type===ie&&t.guid===e.attributes.issue_id}))}));r.length>0&&this.options.getAttachedDocumentCallback(r,(function(e){n.forEach((function(n){var r;e&&((r=n.attachments).push.apply(r,qs(e.filter((function(e){return e.attributes.issue_id===n.guid&&-1===n.attachments.findIndex((function(t){return t.id===e.id}))})))),n.attachments.forEach((function(e){t.notify({type:A.LINK_SYNCED,layerData:n,documentAttachment:e})})))}))}))}}},{key:"getUserProfiles",value:function(){var e=this;this.options.getUserProfileCallback&&_t(this.markupsCache.getCache(),(function(t){var n=t.metadata.created_by;n&&!t.userName&&e.options.getUserProfileCallback(n,(function(n){n&&n.name&&(t.userName=n.name,e.notify({type:A.LAYER_METADATA_FETCHED}))}))}))}},{key:"getProjectUsers",value:function(){var e=this;this.options.getProjectUsersCallback&&(0,this.options.getProjectUsersCallback)((function(t){e.notify({type:A.PROJECT_USERS_FETCHED,users:t})}))}},{key:"getRevisions",value:function(){var e=this;this.options.getRevisionCallback&&this.options.getRevisionCallback(this.options.documentUrn,(function(t){_t(e.markupsCache.getCache(),(function(e){if(e&&e.metadata){var n=e.metadata.starting_version;e.metadata.tags.starting_revision=t[n]}})),e.notify({type:A.LAYER_METADATA_FETCHED})}))}},{key:"generateMarkupDescription",value:function(e){var t=[];return e.getAllMarkups().forEach((function(e){e.type!==b&&e.type!==S||t.push(e.state.text)})),t.join(".\n")}},{key:"generateMetadata",value:function(e,t){var n=this,r={};r.target_urn=this.options.documentUrn,r.starting_version=this.options.documentVersion,r.resource_urns={};var i=this.viewer.getState(),A=this.viewer.model?this.viewer.model.getData().globalOffset:null;if(r.markup_metadata=function(e,t,n){var r=JSON.parse(JSON.stringify(e));return t&&Fo(r.viewport,t),r.sheetGUID=n.sheetGUID,r.sheetName=n.sheetName,r}(i,A,this.options),r.markup_metadata.links=Lt(t.links).map((function(e){var t=e.state.position&&e.state.position.clone();return t&&n.markupsExtension.viewer.model.getData().isPdf&&Autodesk.Viewing.PDFUtils.pdfToLeafletWorld(n.markupsExtension.viewer,t),{id:e.guid,type:e.type,position:t}})),r.description=this.generateMarkupDescription(t),r.tags={starting_revision:this.options.documentRevision||this.options.documentVersion},this.options.collectionUrn&&(r.collection_urn=this.options.collectionUrn),this.options.userName&&(r.tags.userName=this.options.userName),r.status=e,this.viewer.model.getData().isLeaflet){var a=this.viewer.model.getData().loadOptions.loadOptions;r.markup_metadata.originalDocumentResolution=[a.texWidth,a.texHeight]}return r}},{key:"saveLayer",value:function(e){var t,n=this,r=this.options.documentUrn,i=!e.layerData,a="".concat(e.id,"_tmp"),o=i?new io:e.layerData,s=this.generateMetadata(i?this.markupsExtension.getCreationStatusType():o.metadata.status,e),u=[{type:ee,data:Js(e,this.markupsExtension.viewer,this.markupsExtension.renderer),id:null,ossPath:null},{type:te,data:null,id:null,ossPath:null}];o.status=H,o.originalCreationTime=i?(new Date).toISOString():s.created_at,e.layerData=o,i&&((t=ct.cloneDeep(o)).metadata=s,t.resources=u,this.markupsCache.add(a,t,r)),this.notify({type:A.LAYER_SYNCING,layerData:o,layer:e}),this.savingCounter++,this.markupsManager.generateScreenCapture(e).then((function(t){u[1].data=t,i||(o.resources=u),n.notify({type:A.LAYER_SYNCING,layerData:o,layer:e}),n.service.postLayer(s,u,i?void 0:e.getGuid()).then((function(e){var t=e.id;o.guid=t,o.metadata=e.attributes,o.resources=u,o.attachments=o.attachments||[],o.status=_,n.markupsCache.add(t,o,r),o.userName=o.metadata.tags.userName})).catch((function(){i?e.layerData=null:o.status=F,n.errorHandler(Autodesk.Viewing.i18n.translate("Failed to save markup"),$s.MARKUP_SAVE_FAILED),console.error("Failed to save markup",o)})).finally((function(){n.markupsCache.remove(a,r),n.notify({type:A.LAYER_SYNCED,layerData:o,layer:e}),n.savingCounter--}))})).catch((function(){n.savingCounter--}))}},{key:"onDocumentAttachmentCreationStart",value:function(e){var t=this,n=e.documentAttachments,r=e.layerData;if(0!==n.length)if(n.length>1)console.error("Dont save multiple attachments at a time.");else{n.forEach((function(e){e.attributes.issue_id=r.guid,e.attributes.attachment_type=Ae}));var i=n[0];this.notify({type:A.LINK_SYNCING,documentAttachment:i,layerData:r}),this.service.postDocumentAttachment(i).then((function(e){e&&e.attributes&&e.attributes.issue_id&&(i.attributes=e.attributes,i.id=e.id,r.attachments.splice(0,0,i),t.markupsManager.createLinkMetadata(r)),t.notify({type:A.LINK_SYNCED,documentAttachment:i,layerData:r})})).catch((function(e){t.notify({type:A.LINK_SYNCED,documentAttachment:i,layerData:r}),t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to create markup attachment"),$s.MARKUP_ATTACHMENT_CREATE_FAILED),console.error("Failed to create markup attachment")}))}}},{key:"deleteDocumentAttachment",value:function(e){var t=this,n=e.documentAttachment,r=e.layerData;n.status=q,this.notify({type:A.LINK_SYNCING,documentAttachment:n,layerData:r}),this.service.deleteDocumentAttachment(n.id).then((function(){var e=r.attachments,i=e.indexOf(n);i>-1&&e.splice(i,1),t.notify({type:A.LINK_SYNCED,documentAttachment:n,layerData:r})})).catch((function(e){t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to delete markup attachment"),$s.MARKUP_ATTACHMENT_DELETE_FAILED),t.notify({type:A.LINK_SYNCED,documentAttachment:n,layerData:r})}))}},{key:"renameDocumentAttachment",value:function(e){var t=this,n=e.documentAttachment,r=e.newName,i=e.layerData;n.status=J,n.tmpName=r,this.notify({type:A.LINK_SYNCING,documentAttachment:n,layerData:i}),this.service.renameDocumentAttachment(n.id,r).then((function(e){n.attributes=e.attributes,n.status=void 0,n.tmpName=void 0,t.notify({type:A.LINK_SYNCED,documentAttachment:n,layerData:i})})).catch((function(e){n.status=void 0,n.tmpName=void 0,t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to rename markup attachment"),$s.MARKUP_ATTACHMENT_RENAME_FAILED),t.notify({type:A.LINK_SYNCED,documentAttachment:n,layerData:i})}))}},{key:"updateLinkPosition",value:function(e,t,n){var r=this,i=n.clone();this.markupsExtension.viewer.model.getData().isPdf&&Autodesk.Viewing.PDFUtils.pdfToLeafletWorld(this.markupsExtension.viewer,i);var A={markup_metadata:{links:[{id:t,position:i}]}};return this.service.updateLayer(e,A).then((function(e){return Promise.resolve(e)}),(function(){return r.errorHandler(Autodesk.Viewing.i18n.translate("Failed to update markup attachment"),$s.MARKUP_ATTACHMENT_UPDATE_FAILED),Promise.reject("Failed to change the link position: "+t)}))}},{key:"deleteLayer",value:function(e){var t=this;e.guid||(e=this.markupsCache.get(e)),e.status=L,this.notify({type:A.LAYER_SYNCING,layerData:e});var n=this.options.documentUrn;return this.service.deleteLayer(e.guid).then((function(r){return t.markupsCache.remove(e.guid,n),e.status=I,t.notify({type:A.LAYER_SYNCED,layerData:e}),Promise.resolve(!0)}),(function(){return e.status=D,t.notify({type:A.LAYER_SYNCED,layerData:e}),t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to delete markup"),$s.MARKUP_DELETE_FAILED),Promise.reject("Failed to delete markup: "+e.guid)}))}},{key:"deleteAllLayers",value:function(){var e=this;this.markupsCache.getAsList().forEach((function(t){e.deleteLayer(t)}))}},{key:"publishLayer",value:function(e){var t=this;e.guid||(e=this.markupsCache.get(e));var n=e.status;e.status=K,this.notify({type:A.LAYER_SYNCING,layerData:e}),this.service.publishLayer(e.guid).then((function(r){return e.status=n,e.metadata=r.attributes,t.notify({type:A.LAYER_SYNCED,layerData:e}),Promise.resolve()})).catch((function(r){e.status=n,t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to publish markup"),$s.MARKUP_PUBLISH_FAILED),t.notify({type:A.LAYER_SYNCED,layerData:e})}))}},{key:"archiveLayer",value:function(e){var t=this;e.guid||(e=this.markupsCache.get(e));var n=e.status;e.status=G,this.notify({type:A.LAYER_SYNCING,layerData:e}),this.service.archiveLayer(e.guid,this.options.currentRawDocumentVersion).then((function(r){return e.status=n,e.metadata=r.attributes,t.notify({type:A.LAYER_SYNCED,layerData:e}),Promise.resolve()})).catch((function(r){e.status=n,t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to archive markup"),$s.MARKUP_ARCHIVE_FAILED),t.notify({type:A.LAYER_SYNCED,layerData:e})}))}},{key:"cancelRequests",value:function(){this.service.cancelAllGet()}},{key:"terminate",value:function(){this.cancelRequests(),this.markupsExtension=null,this.markupsManager=null,this.service=null}},{key:"getMaxPageLimit",value:function(){return this.service.maxPageLimit}}])&&Zs(t.prototype,n),r&&Zs(t,r),e}();function tu(e){return(tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nu(e,t,n,r,i,A,a){try{var o=e[A](a),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,i)}function ru(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iu(e){return(iu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Au(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function au(e,t){return(au=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"default",(function(){return su}));var ou=AutodeskNamespace("Autodesk.BIM360.Markups"),su=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==tu(t)&&"function"!=typeof t?Au(e):t}(this,iu(t).call(this,e,r))).viewer=e,n.options=r,n.cache=n.getCache(),n.onModelLoadedBinded=n.onModelLoaded.bind(Au(n)),n}var n,r,i,A,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&au(e,t)}(t,Autodesk.Viewing.Extension),n=t,(r=[{key:"onModelLoaded",value:function(e){if(this.viewer.model&&!this.initialized){this.initCache();var t=e.model.getDocumentNode();t?(this.sheetList=t.getRootNode().search({type:"geometry"}),this.options.sheetGUID=t.guid(),this.options.sheetName=t.name(),this.options.fileName=t.findViewableParent().name()):this.sheetList=[],this.markupsManager=new zo(this),this.filterManager=new vs(this,this.options),this.permissionManager=new ws(this.options),this.markupsTool=new qa(this),this.viewer.toolController.registerTool(this.markupsTool);var n=this.viewer.toolController.setIsLocked(!1);this.viewer.toolController.activateTool(this.markupsTool.getName()),this.viewer.toolController.setIsLocked(n),this.renderer=new ps(this),this.markupsManager.setDefaultCreationStyleProperties(),this.options.isMobileApp?this.mobileCallbacks=new Ts(this):(this.markupsUI=new eo(this),this.initMarkupsPanel()),this.initServiceOperator(),this.selectInitialLayer(),this.initialized=!0}}},{key:"initCache",value:function(){this.cache.hasOwnProperty("markupsCache")||(this.cache.markupsCache=new Us),this.markupsCache=this.cache.markupsCache,this.markupsCache.currentUrn!==this.options.documentUrn&&(this.cache.layerToSelect=null,this.cache.layerToEdit=null,this.cache.filters=null),this.cache.markupsCache.setCurrentUrn(this.options.documentUrn)}},{key:"initServiceOperator",value:function(){this.serviceOperator||(this.serviceOperator=new eu),this.serviceOperator.reset(this),this.serviceOperator.fetchMarkups()}},{key:"initMarkupsPanel",value:function(){this.options.panelContainer&&this.options.uiClasses&&this.options.uiClasses.MarkupPanelClass&&(this.cache.markupsPanel?this.cache.markupsPanel.reset(this):(this.cache.markupsPanel=new this.options.uiClasses.MarkupPanelClass,this.cache.markupsPanel.reset(this)))}},{key:"selectInitialLayer",value:function(){var e=this;setTimeout((function(){no.executeAfterTransitionEnded(e.viewer,(function(){e.cache.layerToSelect&&(e.selectLayer(e.cache.layerToSelect,!0,!0),e.cache.layerToSelect=null),e.cache.layerToEdit&&(e.editLayer(e.cache.layerToEdit,!0,!0,!0),e.cache.layerToEdit=null)}))}))}},{key:"load",value:(A=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.viewer.loadExtension("Autodesk.Snapping");case 2:return this.viewer.model?this.onModelLoaded({model:this.viewer.model}):this.viewer.addEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,this.onModelLoadedBinded),e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=A.apply(e,t);function a(e){nu(i,n,r,a,o,"next",e)}function o(e){nu(i,n,r,a,o,"throw",e)}a(void 0)}))},function(){return a.apply(this,arguments)})},{key:"unload",value:function(){return this.viewer.removeEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,this.onModelLoadedBinded),this.mobileCallbacks&&(this.mobileCallbacks.destroy(),this.mobileCallbacks=null),this.markupsUI&&(this.markupsUI.destroy(),this.markupsUI=null),this.renderer&&(this.renderer.destroy(),this.renderer=null),this.markupsTool&&(this.viewer.toolController.deregisterTool(this.markupsTool),this.markupsTool=null),this.markupsManager&&(this.markupsManager.destroy(),this.markupsManager=null),this.filterManager&&(this.filterManager.destroy(),this.filterManager=null),this.permissionManager&&(this.permissionManager.destroy(),this.permissionManager=null),this.serviceOperator&&(this.serviceOperator.terminate(),this.serviceOperator=null),this.markupsCache=null,this.initialized=!1,!0}},{key:"startMarkupSession",value:function(e,t){this.markupsManager.startMarkupSession(e,t)}},{key:"endMarkupSession",value:function(e){this.markupsManager.endMarkupSession(e)}},{key:"setToolEnabled",value:function(e){this.markupsManager.setToolEnabled(e)}},{key:"isToolEnabled",value:function(){return this.markupsManager.isToolEnabled()}},{key:"editLayer",value:function(e,t,n,r){this.markupsManager.editLayer(e,t,n,r)}},{key:"changeMarkupCreationType",value:function(e,t){(this.markupsManager.isMarkupSessionOpen()||t)&&this.markupsManager.changeMarkupCreationType(e)}},{key:"deleteMarkup",value:function(e){this.markupsManager.deleteMarkup(e)}},{key:"deleteInEditMarkups",value:function(){this.markupsManager.deleteInEditMarkups()}},{key:"undo",value:function(){this.markupsManager.undo()}},{key:"redo",value:function(){this.markupsManager.redo()}},{key:"copy",value:function(){this.markupsManager.copy()}},{key:"paste",value:function(){this.markupsManager.paste()}},{key:"cut",value:function(){this.markupsManager.cut()}},{key:"selectMarkup",value:function(e){this.markupsManager.selectMarkup(e)}},{key:"deselectMarkup",value:function(e){this.markupsManager.deselectMarkup(e)}},{key:"deselectAllMarkups",value:function(e){this.markupsManager.deselectAllMarkups(e)}},{key:"deselectAllLayers",value:function(e){this.markupsManager.deselectAllLayers(e)}},{key:"exitMarkupView",value:function(){this.markupsManager.exitMarkupView()}},{key:"getSelectedMarkups",value:function(){return this.markupsManager.getSelectedMarkups()}},{key:"getSelectedLayer",value:function(){return this.markupsManager.getSelectedLayer()}},{key:"getVisibleMarkups",value:function(){return this.markupsManager.getVisibleMarkups()}},{key:"selectLayer",value:function(e,t,n){this.markupsManager.selectLayer(e,t,n)}},{key:"deselectLayer",value:function(e){this.markupsManager.deselectLayer(e)}},{key:"getStyleProperty",value:function(e){return this.markupsManager.getStyleProperty(e)}},{key:"changeStyleProperty",value:function(e,t,n){this.markupsManager.changeStyleProperty(e,t,n)}},{key:"loadLayers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.markupsCache&&this.markupsCache.getAsList(),t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.markupsManager.loadLayers(e,t,n)}},{key:"removeLayer",value:function(e){this.markupsManager.removeLayer(e)}},{key:"changeCreationStatusType",value:function(e){this.markupsManager.changeCreationStatusType(e)}},{key:"getCreationStatusType",value:function(){return this.markupsManager.getCreationStatusType()}},{key:"updateFilters",value:function(e){this.filterManager.updateFilters(e)}}])&&ru(n.prototype,r),i&&ru(n,i),t}();Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.BIM360.Markups",su),ou.Constants=Object.assign({},r),ou.Events=Object.assign({},A),ou.markupsOverlayRenderer=jt}]);
//# sourceMappingURL=BimMarkups.min.js.map
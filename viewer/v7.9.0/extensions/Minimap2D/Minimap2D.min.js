/*!
 * LMV v7.9.0
 * 
 * Copyright 2019 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.Minimap2D=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=475)}({1:function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var o=(r=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),a=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[n].concat(a).concat([o]).join("\n")}var r;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(i[a]=!0)}for(o=0;o<e.length;o++){var r=e[o];"number"==typeof r[0]&&i[r[0]]||(n&&!r[2]?r[2]=n:n&&(r[2]="("+r[2]+") and ("+n+")"),t.push(r))}},t}},2:function(e,t,n){var i,o,a={},r=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=i.apply(this,arguments)),o}),s=function(e,t){return t?t.querySelector(e):document.querySelector(e)},u=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var i=s.call(this,e,n);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}}(),c=null,l=0,h=[],d=n(3);function m(e,t){for(var n=0;n<e.length;n++){var i=e[n],o=a[i.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](i.parts[r]);for(;r<i.parts.length;r++)o.parts.push(b(i.parts[r],t))}else{var s=[];for(r=0;r<i.parts.length;r++)s.push(b(i.parts[r],t));a[i.id]={id:i.id,refs:1,parts:s}}}}function f(e,t){for(var n=[],i={},o=0;o<e.length;o++){var a=e[o],r=t.base?a[0]+t.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};i[r]?i[r].parts.push(s):n.push(i[r]={id:r,parts:[s]})}return n}function v(e,t){var n=u(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=h[h.length-1];if("top"===e.insertAt)i?i.nextSibling?n.insertBefore(t,i.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),h.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=u(e.insertAt.before,n);n.insertBefore(t,o)}}function p(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=h.indexOf(e);t>=0&&h.splice(t,1)}function g(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var i=function(){0;return n.nc}();i&&(e.attrs.nonce=i)}return y(t,e.attrs),v(e,t),t}function y(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function b(e,t){var n,i,o,a;if(t.transform&&e.css){if(!(a="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=a}if(t.singleton){var r=l++;n=c||(c=g(t)),i=k.bind(null,n,r,!1),o=k.bind(null,n,r,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",y(t,e.attrs),v(e,t),t}(t),i=x.bind(null,n,t),o=function(){p(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(t),i=M.bind(null,n),o=function(){p(n)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=r()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=f(e,t);return m(n,t),function(e){for(var i=[],o=0;o<n.length;o++){var r=n[o];(s=a[r.id]).refs--,i.push(s)}e&&m(f(e,t),t);for(o=0;o<i.length;o++){var s;if(0===(s=i[o]).refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete a[s.id]}}}};var C,w=(C=[],function(e,t){return C[e]=t,C.filter(Boolean).join("\n")});function k(e,t,n,i){var o=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=w(t,o);else{var a=document.createTextNode(o),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(a,r[t]):e.appendChild(a)}}function M(e,t){var n=t.css,i=t.media;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function x(e,t,n){var i=n.css,o=n.sourceMap,a=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||a)&&(i=d(i)),o&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([i],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(r),s&&URL.revokeObjectURL(s)}},3:function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,i=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var o,a=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(o=0===a.indexOf("//")?a:0===a.indexOf("/")?n+a:i+a.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},454:function(e,t,n){var i=n(455);"string"==typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(2)(i,o);i.locals&&(e.exports=i.locals)},455:function(e,t,n){(e.exports=n(1)(!1)).push([e.i,".minimap-canvas-container{position:relative;margin:15px 5px 10px 5px}.minimap-canvas-base{position:absolute;left:0px;top:0px}.minimap-unavailable{color:#dbdbdb;margin:10px;text-align:center}\n",""])},475:function(e,t,n){"use strict";n.r(t);var i={small:100,medium:200,large:400},o=200,a=300;function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"large",n=e.docId,i=e.token;if(!n||!i)return Promise.reject({description:"No document or token for thumbnail",error:"thumbnail"});n.startsWith("urn:")&&(n=n.slice(4));var o,a,r=[Autodesk.Viewing.endpoint.getThumbnailApi(),n,"?type=",t];e.guid&&(o=r).push.apply(o,["&guid=",e.guid]);e.acmsession&&(a=r).push.apply(a,["&acmsession=",e.acmsession]);return r=r.join(""),new Promise((function(e,t){!function(e,t,n,i){var o=new XMLHttpRequest;o.open("GET",e,!0),o.setRequestHeader("Authorization","Bearer "+t),o.setRequestHeader("Content-Type","image/png"),o.responseType="blob";var a=function(e,t){return{onLoad:function(n){201===n.currentTarget.status||200===n.currentTarget.status||204===n.currentTarget.status?e(n.currentTarget.response):t(n.currentTarget.status)},onError:function(e){t(e)},onTimeout:function(){t()},onAbort:function(){t()}}}(n,i);o.onload=a.onLoad,o.onerror=a.onError,o.ontimeout=a.onTimeout,o.onabort=a.onAbort,o.send()}(r,i,e,t)}))}var s="minimap.resize";n(454);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=Autodesk.Viewing,f=function(e){function t(e,n,o){var a,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"large";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=l(this,h(t).call(this))).minimapSize=i[r];var s=Math.max(n,o);return a.widthFactor=n/s,a.heightFactor=o/s,a._initBackground(),a._initHighlight(),a._initContainer(),a.backgroundImgs=e,a.backgroundImg=new Image,a}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,Autodesk.Viewing.EventDispatcher),n=t,(o=[{key:"_initContainer",value:function(){var e=this.getDocument();this.canvasContainer=e.createElement("div"),this.canvasContainer.className="minimap-canvas-container",this.canvasContainer.appendChild(this.backgroundCanvas),this.canvasContainer.appendChild(this.highlightCanvas),this._updateCanvasContainerSize()}},{key:"_updateCanvasContainerSize",value:function(){this.canvasContainer.style.width=this.backgroundCanvas.width+"px",this.canvasContainer.style.height=this.backgroundCanvas.height+"px"}},{key:"_initBackground",value:function(){var e=this.getDocument();this.backgroundCanvas=e.createElement("canvas"),this.backgroundCanvas.className="minimap-canvas-base minimap-canvas-background"}},{key:"_initHighlight",value:function(){var e=this.getDocument();this.highlightCanvas=e.createElement("canvas"),this.highlightCanvas.className="minimap-canvas-base minimap-canvas-highlight"}},{key:"setSize",value:function(e){var t=this;return e="string"==typeof e?i[e]:e,new Promise((function(n,o){t.backgroundCanvas.width=t.highlightCanvas.width=Math.round(e*t.widthFactor),t.backgroundCanvas.height=t.highlightCanvas.height=Math.round(e*t.heightFactor),t._updateCanvasContainerSize();var a=Number.MAX_VALUE,r="large";for(var u in i)e<=i[u]&&i[u]<a&&t.backgroundImgs.hasOwnProperty(u)&&(r=u,a=i[u]);t.setBackground(r).then((function(){t.drawBackground(),n()})),t.minimapSize=e,t.fireEvent(s)}))}},{key:"setBackground",value:function(e){var t=this;return new Promise((function(n,i){t.backgroundImgs.hasOwnProperty(e)?t.backgroundImg.src!==t.backgroundImgs[e]?(t.backgroundImg.onload=function(){t.setBackgroundSourceSize(e),n()},t.backgroundImg.src=t.backgroundImgs[e]):n():i("thumbnail size not found")}))}},{key:"setBackgroundSourceSize",value:function(e){var t=i[e];this.backgroundWidth=Math.round(t*this.widthFactor),this.backgroundHeight=Math.round(t*this.heightFactor),this.backgroundOffsetX=(t-this.backgroundWidth)/2,this.backgroundOffsetY=(t-this.backgroundHeight)/2}},{key:"drawBackground",value:function(){var e=this.backgroundCanvas.getContext("2d");e.mozImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1,e.imageSmoothingEnabled=!1,e.drawImage(this.backgroundImg,this.backgroundOffsetX,this.backgroundOffsetY,this.backgroundWidth,this.backgroundHeight,0,0,this.backgroundCanvas.width,this.backgroundCanvas.height)}},{key:"drawHighlight",value:function(e,t){var n={x:Math.round(e.x),y:Math.round(t.y)},i=Math.round(Math.max(t.x-e.x,2)),o=Math.round(Math.max(e.y-t.y,2)),a=this.highlightCanvas.getContext("2d");a.clearRect(0,0,this.highlightCanvas.width,this.highlightCanvas.height),a.beginPath(),a.lineWidth="2",a.strokeStyle="#CC3B3B",a.fillStyle="rgba(204, 59, 59, 0.2)",a.rect(n.x,n.y,i,o),a.fill(),a.stroke()}},{key:"setVisibility",value:function(e){this.backgroundCanvas.style.visibility=e?"visible":"hidden",this.highlightCanvas.style.visibility=e?"visible":"hidden"}},{key:"addListenerToCanvas",value:function(e,t){this.highlightCanvas.addEventListener(e,t)}},{key:"removeListenerFromCanvas",value:function(e,t){this.highlightCanvas.removeEventListener(e,t)}},{key:"getBoundingClientRect",value:function(){return this.highlightCanvas.getBoundingClientRect()}},{key:"unload",value:function(){var e=this.getWindow(),t=e.URL||e.webkitURL;for(var n in this.backgroundImg=null,this.backgroundImgs)t.revokeObjectURL(this.backgroundImgs[n])}},{key:"width",get:function(){return this.highlightCanvas.width}},{key:"height",get:function(){return this.highlightCanvas.height}}])&&c(n.prototype,o),a&&c(n,a),t}();function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function g(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e,t,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}m.GlobalManagerMixin.call(f.prototype);var w=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=g(this,b(t).call(this,e,"MinimapPanel","Minimap",o))).container.style.left=n+"px",a.container.style.top=i+"px",a.container.classList.add("docking-panel-container-solid-color-b"),a.fadeIn="opacity 0.5s",a.fadeOut="opacity 0.1s",a.container.addEventListener("transitionend",(function(e){"0"===a.container.style.opacity&&(a.container.style.display="none")})),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(t,Autodesk.Viewing.UI.DockingPanel),n=t,(i=[{key:"_addNoMinimapElem",value:function(){var e=this.getDocument();this.noMinimapDiv=e.createElement("div"),this.noMinimapDiv.innerHTML=Autodesk.Viewing.i18n.translate("Minimap not available"),this.noMinimapDiv.className="minimap-unavailable",this.container.appendChild(this.noMinimapDiv)}},{key:"_removeNoMinimapElem",value:function(){this.container.contains(this.noMinimapDiv)&&this.container.removeChild(this.noMinimapDiv)}},{key:"initialize",value:function(){y(b(t.prototype),"initialize",this).call(this),this._addNoMinimapElem()}},{key:"appendElement",value:function(e){this._removeNoMinimapElem(),this.container.appendChild(e)}},{key:"addListenerToCloseButton",value:function(e){this.addEventListener(this.closer,"click",e,!1)}},{key:"_triggerReflow",value:function(){return this.container.offsetWidth}},{key:"_isVisible",value:function(){return"block"===this.container.style.display}},{key:"setVisible",value:function(e,t){t?this.setVisibleWithTransition(e):(this.container.style.display=e?"block":"none",this.container.style.opacity=e?"1":"0")}},{key:"setVisibleWithTransition",value:function(e){if(e){var t=this._isVisible();this.container.style.transition=this.fadeIn,this.container.style.display="block",t||(this.container.style.opacity="0",this._triggerReflow()),this.container.style.opacity="1"}else this.container.style.transition=this.fadeOut,this.container.style.opacity="0"}}])&&p(n.prototype,i),o&&p(n,o),t}(),k={isThumbnailValid:function(e){return k.getPredominantColorPercentage(e)<k.MAX_PREDOMINANT_COLOR_PERCENTAGE},getPredominantColorPercentage:function(e){for(var t=e.getContext("2d").getImageData(0,0,e.width,e.height).data,n={},i=0,o=t.length;i<o;i+=4){var a=k.rgba2hex(t[i],t[i+1],t[i+2],t[i+3]);n[a]=n.hasOwnProperty(a)?n[a]+1:1}return Object.keys(n).reduce((function(e,t){return n[t]>e?n[t]:e}),0)/(t.length/4)},rgba2hex:function(e,t,n,i){if(e>255||t>255||n>255||i>255)throw"Invalid color component";return(256+e).toString(16).substr(1)+((1<<24)+(t<<16)|n<<8|i).toString(16).substr(1)},MAX_PREDOMINANT_COLOR_PERCENTAGE:.97},M=k;function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function E(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"default",(function(){return O}));AutodeskNamespace("Autodesk.BIM360.Minimap");var O=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=E(this,B(t).call(this,e,i)))._isEnabled=!1,n.isMobile=Autodesk.Viewing.isMobileDevice(),n.initialSize=n.options.initialSize||null,n.wasInit=!1,n}var n,i,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,Autodesk.Viewing.Extension),n=t,(i=[{key:"setEnabled",value:function(e){this._isEnabled=e,this._isEnabled?this.wasInit?this.onCameraChange(!1):this.init():this._setVisibility(!1,!1)}},{key:"init",value:function(){var e=this;this.mouseDown=!1,this.mouseDownPos={x:null,y:null},this.isTransitionInactive=!0,this.panel=new w(this.viewer.container,10,10,{isMobile:this.isMobile,addFooter:!1}),this.panel.setGlobalManager(this.globalManager),this.modelBBox=this.viewer.model.getBoundingBox().clone(),this.modelStartPoint=this.modelBBox.min,this.modelWidth=this.modelBBox.max.x-this.modelBBox.min.x,this.modelHeight=this.modelBBox.max.y-this.modelBBox.min.y,this.epsX=.02*this.modelWidth,this.epsY=.02*this.modelHeight,this.prefetchThumbnails(["large","medium"]).then((function(){return e.wasInit?(e.createMinimapCanvas(),e.minimapCanvas.setSize(e.getInitialSize())):Promise.reject({description:"Load canceled",error:"cancel"})})).then((function(){if(!e.wasInit)return Promise.reject({description:"Load canceled",error:"cancel"});e.viewer.model.getData().isLeaflet||function(e){var t="";try{var n=e.model.getDocumentNode().getRootNode(),i="",o=!0,a=!1,r=void 0;try{for(var s,u=n.data.children[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value;if(c.name){i=c.name;break}}}catch(e){a=!0,r=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw r}}var l=i.lastIndexOf(".");l>-1&&(t=i.substr(l+1))}catch(e){console.log("Error getting model extension",e)}return t.toLowerCase()}(e.viewer).startsWith("rvt")||M.isThumbnailValid(e.minimapCanvas.backgroundCanvas)?e.panel.appendElement(e.minimapCanvas.canvasContainer):console.log("Invalid thumbnail!"),e.addListeners()})).catch((function(t){console.log("Minimap error: ",t.description),e.minimapCanvas||"cancel"===t.error||(e.createMinimapCanvas(),e.addListeners())})),this.wasInit=!0}},{key:"createMinimapCanvas",value:function(){var e=this;this.minimapCanvas=new f(this.backgroundImgs||{},this.modelWidth,this.modelHeight),this.minimapCanvas.setGlobalManager(this.globalManager),this.onCanvasResizeBinded=function(t){return e.onCanvasResize(t)},this.minimapCanvas.addEventListener(s,this.onCanvasResizeBinded)}},{key:"getInitialSize",value:function(){return null!==this.initialSize?Math.min(Math.max(this.initialSize,100),400):this.isMobile?o:a}},{key:"setSize",value:function(e){this.minimapCanvas?(e=Math.min(Math.max(e,100),400),this.minimapCanvas.setSize(e)):this.initialSize=e}},{key:"prefetchThumbnails",value:function(e){var t=this;this.backgroundImgs={};var n={docId:this.docId,guid:this.itemId,token:this.viewer.config.accessToken,acmsession:this.acmSessionId},i=e.map((function(e){return function(e,t,n){return r(e,t).then((function(e){var i=window.URL||window.webkitURL;n[t]=i.createObjectURL(e)}))}(n,e,t.backgroundImgs)}));return Promise.all(i)}},{key:"_isTouch",value:function(){return Autodesk.Viewing.isTouchDevice()}},{key:"addListeners",value:function(){var e=this;this.onMouseDownBinded=function(t){return e.onMouseDown(t)},this.onMouseMoveBinded=function(t){return e.onMouseMove(t)},this.onMouseUpBinded=function(t){return e.onMouseUp(t)},this._isTouch()&&(this.minimapCanvas.addListenerToCanvas("touchstart",this.onMouseDownBinded),this.minimapCanvas.addListenerToCanvas("touchmove",this.onMouseMoveBinded),this.minimapCanvas.addListenerToCanvas("touchend",this.onMouseUpBinded)),this.isMobile||(this.minimapCanvas.addListenerToCanvas("mousedown",this.onMouseDownBinded),this.minimapCanvas.addListenerToCanvas("mousemove",this.onMouseMoveBinded),this.minimapCanvas.addListenerToCanvas("mouseup",this.onMouseUpBinded),this.onMouseLeaveBinded=function(t){return e.onMouseLeave(t)},this.onMouseWheelBinded=function(t){return e.onMouseWheel(t)},this.minimapCanvas.addListenerToCanvas("mouseleave",this.onMouseLeaveBinded),this.minimapCanvas.addListenerToCanvas("mousewheel",this.onMouseWheelBinded),this.minimapCanvas.addListenerToCanvas("DOMMouseScroll",this.onMouseWheelBinded)),this.onCameraChangeBinded=function(t){return e.onCameraChange(!0)},this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),this.onCloseButtonBinded=function(){return e.onCloseButton()},this.panel.addListenerToCloseButton(this.onCloseButtonBinded)}},{key:"onCloseButton",value:function(){if(this.viewer.toolbar){var e=this.viewer.viewerSettingsPanel.getControl(this.minimapSettingsCheckboxId);e&&e.setChecked(!1)}this._isEnabled=!1}},{key:"onCanvasResize",value:function(){this.onCameraChange(!1)}},{key:"getCursorPositionOnCanvas",value:function(e){var t=this.minimapCanvas.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}},{key:"onMouseDown",value:function(e){"touchstart"===e.type&&(e.clientX=e.touches[0].clientX,e.clientY=e.touches[0].clientY),this.mouseDown=!0,this.mouseDownPos.x=e.clientX,this.mouseDownPos.y=e.clientY,this.onMinimapClicked(e,!1),this.isTransitionInactive=!1}},{key:"onMouseMove",value:function(e){this.mouseDown&&("touchmove"===e.type&&(e.clientX=e.touches[0].clientX,e.clientY=e.touches[0].clientY),(this.isTransitionInactive||Math.abs(this.mouseDownPos.x-e.clientX)>5||Math.abs(this.mouseDownPos.y-e.clientY)>5)&&(void 0!==this.viewer.autocam.elapsedTime&&(this.viewer.autocam.elapsedTime=this.viewer.autocam.shotParams.duration,this.isTransitionInactive=!0),this.onMinimapClicked(e,!0)))}},{key:"onMouseWheel",value:function(e){this.viewer.toolController.mousewheel(e)}},{key:"onMouseUp",value:function(e){this.resetMove()}},{key:"onMouseLeave",value:function(e){this.resetMove()}},{key:"resetMove",value:function(){this.mouseDown=!1,this.mouseDownPos.x=null,this.mouseDownPos.y=null}},{key:"onMinimapClicked",value:function(e,t){var n=this.minimapToModelCoords(this.getCursorPositionOnCanvas(e)),i=this.viewer.navigation.getTarget(),o=this.viewer.navigation.getPosition(),a=i.clone().sub(o),r=new THREE.Vector3(n.x,n.y,o.z),s=r.clone().add(a);t?this.viewer.navigation.setView(r,s):this.viewer.navigation.setRequestTransitionWithUp(!0,r,s,this.viewer.impl.camera.fov,this.viewer.impl.camera.up),this.viewer.navigation.setPivotPoint(s),this.viewer.navigation.setPivotSetFlag(!0)}},{key:"highlightCurrentArea",value:function(e,t){this.minimapCanvas.drawHighlight(e,t)}},{key:"modelToMinimapCoords",value:function(e){return{x:(e.x-this.modelStartPoint.x)*this.minimapCanvas.width/this.modelWidth,y:-(e.y-this.modelStartPoint.y-this.modelHeight)*this.minimapCanvas.height/this.modelHeight}}},{key:"minimapToModelCoords",value:function(e){return{x:e.x*this.modelWidth/this.minimapCanvas.width+this.modelStartPoint.x,y:-e.y*this.modelHeight/this.minimapCanvas.height+this.modelHeight+this.modelStartPoint.y}}},{key:"_setVisibility",value:function(e,t){this.panel&&this.panel.setVisible(this._isEnabled&&e,t)}},{key:"getViewableArea",value:function(){var e=this.modelBBox.clone(),t=this.viewer.impl.camera.left+this.viewer.impl.camera.position.x,n=this.viewer.impl.camera.right+this.viewer.impl.camera.position.x,i=this.viewer.impl.camera.bottom+this.viewer.impl.camera.position.y,o=this.viewer.impl.camera.top+this.viewer.impl.camera.position.y;return t>e.min.x+this.epsX&&(e.min.x=t),n<e.max.x-this.epsX&&(e.max.x=n),i>e.min.y+this.epsY&&(e.min.y=i),o<e.max.y-this.epsY&&(e.max.y=o),e}},{key:"addEnableCheckboxToSettings",value:function(){var e=this;this.viewer.prefs.add("showMinimap",!0,"2d"),this.setEnabled(this.viewer.prefs.showMinimap);var t=Autodesk.Viewing.Extensions.ViewerSettingTab.Navigation;this.viewer.viewerSettingsPanel.addLabel(t,"Minimap"),this.minimapSettingsCheckboxId=this.viewer.viewerSettingsPanel.addCheckbox(t,"Show minimap","Toggles availability of the Minimap",!0,(function(t){return e.setEnabled(t)}),"showMinimap")}},{key:"onToolbarCreated",value:function(){this.addEnableCheckboxToSettings()}},{key:"load",value:function(){if(!this.viewer.model)return!1;var e=this.viewer.model.getDocumentNode(),t=e&&e.getDocument();return!!t&&(this.itemId=e.guid(),this.acmSessionId=t.acmSessionId,this.docId=t.myPath,!0)}},{key:"onCameraChange",value:function(e){var t=this.getViewableArea(),n=!t.equals(this.modelBBox);this._setVisibility(n,e),n&&this.minimapCanvas&&this.highlightCurrentArea(this.modelToMinimapCoords(t.min),this.modelToMinimapCoords(t.max))}},{key:"destroyUI",value:function(){if(this.viewer.toolbar){var e=this.viewer.viewerSettingsPanel.getControl(this.minimapSettingsCheckboxId);e&&this.viewer.viewerSettingsPanel.removeCheckbox(e)}this.panel&&(this.panel.uninitialize(),this.panel=null)}},{key:"unload",value:function(){return this.minimapCanvas&&(this._isTouch()&&(this.minimapCanvas.removeListenerFromCanvas("touchstart",this.onMouseDownBinded),this.minimapCanvas.removeListenerFromCanvas("touchmove",this.onMouseMoveBinded),this.minimapCanvas.removeListenerFromCanvas("touchend",this.onMouseUpBinded)),this.isMobile||(this.minimapCanvas.removeListenerFromCanvas("mousedown",this.onMouseDownBinded),this.minimapCanvas.removeListenerFromCanvas("mousemove",this.onMouseMoveBinded),this.minimapCanvas.removeListenerFromCanvas("mouseup",this.onMouseUpBinded),this.minimapCanvas.removeListenerFromCanvas("mouseleave",this.onMouseLeaveBinded),this.minimapCanvas.removeListenerFromCanvas("mousewheel",this.onMouseWheelBinded),this.minimapCanvas.removeListenerFromCanvas("DOMMouseScroll",this.onMouseWheelBinded)),this.minimapCanvas.unload(),this.minimapCanvas=null),this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),this.destroyUI(),this.wasInit=!1,!0}}])&&S(n.prototype,i),u&&S(n,u),t}();Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.BIM360.Minimap",O)}});
//# sourceMappingURL=Minimap2D.min.js.map
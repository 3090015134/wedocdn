/*!
 * LMV v7.39.1
 * 
 * Copyright 2021 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.DataVisualization=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=665)}({0:function(t,e){t.exports=THREE},13:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},28:function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function r(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=a(t);if(e){var r=a(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}var c=function(){"use strict";function t(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};s(this,t),this.id=e,this.position=n,this.types=i,this.name=r,this.contextData=o,this.dbId=null}return h(t,[{key:"positionFromDBId",value:function(t,e){var n=t.getData().instanceTree,i=new THREE.Box3,r=new THREE.Box3,o=t.getFragmentList();this.dbId=e,n.enumNodeFragments(e,(function(t){o.getWorldBounds(t,r),i.union(r)}),!0),this.position=i.center()||this.position}}]),t}(),l=function(){"use strict";function t(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;s(this,t),"number"==typeof n&&(n=[n]),this.dbIds=n,this.shadingPoints=i||[],this.isLeaf=!0,this.fragIds=[],this.id=e,this.name=r}return h(t,[{key:"addPoint",value:function(t){this.shadingPoints.push(t)}},{key:"update",value:function(t){var e=this,n=t.getData().instanceTree,i=new Set(this.fragIds);this.dbIds.forEach((function(t){n.enumNodeFragments(t,(function(t){i.has(t)||e.fragIds.push(t)}))}))}}]),t}(),f=function(){"use strict";function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;s(this,t),this.id=e,this._children=[],this.isGroup=!0,this.name=n}return h(t,[{key:"addChild",value:function(t){this.children.push(t)}},{key:"update",value:function(t){this.children.forEach((function(e){return e.update(t)}))}},{key:"getLeafsById",value:function(t,e){e=e||[];for(var n=0;n<this.children.length;n++){var i=this.children[n];i.id===t?i.isLeaf?e.push(i):i.isGroup&&i.getChildLeafs(e):i.isGroup&&i.getLeafsById(t,e)}return e}},{key:"getNodeById",value:function(t){for(var e=0;e<this.children.length;e++){var n=this.children[e];if(n.id===t)return n;if(n.isGroup){var i=n.getNodeById(t);if(i)return i}}}},{key:"getChildLeafs",value:function(t){for(var e=0;e<this.children.length;e++){var n=this.children[e];n.isLeaf?t.push(n):n.isGroup&&n.getChildLeafs(t)}}},{key:"children",get:function(){return this._children}}]),t}(),d=function(t){"use strict";!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=r(n);function n(){return s(this,n),e.apply(this,arguments)}return h(n,[{key:"initialize",value:function(t){this.update(t)}}]),n}(f);t.exports={SurfaceShadingData:d,SurfaceShadingGroup:f,SurfaceShadingNode:l,SurfaceShadingPoint:c}},356:function(t,e,n){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var r=n(0),o=function(){"use strict";function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.meshCallback=e,this.dbIds=[],this.reset()}var e,n,o;return e=t,(n=[{key:"addPoint",value:function(t,e){this.vcount+1>65535&&(this.flushBuffer(),this.reset());var n=this.vcount;if(this.ib[n]=n,this.vb[3*n]=t.position.x,this.vb[3*n+1]=t.position.y,this.vb[3*n+2]=t.position.z,this.idb[3*n]=255&t.dbId,this.idb[3*n+1]=t.dbId>>8&255,this.idb[3*n+2]=t.dbId>>16&255,this.colorb[3*n]=255*t.color.r,this.colorb[3*n+1]=255*t.color.g,this.colorb[3*n+2]=255*t.color.b,e){var i=e.spriteUV(t.style.url);i&&(this.uv[4*n]=i.x,this.uv[4*n+1]=i.y,this.uv[4*n+2]=i.w,this.uv[4*n+3]=i.h)}this.flags[n]=0,this.dbIds.push(t.dbId),this.vcount++}},{key:"reset",value:function(){this.vcount=0,this.ib=new Uint16Array(65535),this.idb=new Uint8Array(196605),this.vb=new Float32Array(196605),this.colorb=new Uint8Array(196605),this.flags=new Uint8Array(65535),this.uv=new Float32Array(262140)}},{key:"flushBuffer",value:function(){var t=new r.BufferGeometry,e=new r.BufferAttribute(new Uint8Array(this.idb.slice(0,3*this.vcount)),3);e.bytesPerItem=1,e.normalize=!0;var n=new r.BufferAttribute(new Float32Array(this.vb.slice(0,3*this.vcount)),3);n.bytesPerItem=4;var i=new r.BufferAttribute(new Uint8Array(this.colorb.slice(0,3*this.vcount)),3);i.bytesPerItem=1,i.normalize=!0;var o=new r.BufferAttribute(new Uint16Array(this.ib.slice(0,this.vcount)),1),a=new r.BufferAttribute(new Float32Array(this.uv.slice(0,4*this.vcount)),4),s=new r.BufferAttribute(new Float32Array(this.flags.slice(0,this.vcount)),1);t.addAttribute("id",e),t.addAttribute("index",o),t.addAttribute("position",n),t.addAttribute("color",i),t.addAttribute("uvp",a),t.addAttribute("flagp",s),t.isPoints=!0,t.dbIds=this.dbIds.slice(0),this.dbIds.length=0,this.meshCallback&&this.meshCallback(t),this.vcount=0}}])&&i(e.prototype,n),o&&i(e,o),t}();t.exports={SpriteMeshBuilder:o}},357:function(t,e,n){"use strict";function i(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=u(t);if(e){var r=u(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function s(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=c(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function c(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function v(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}Object.defineProperty(e,"__esModule",{value:!0});var g,y=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5?arguments[5]:void 0;d(this,t),this.oversized=!1,this._rot=!1,this._allowRotation=void 0,this._dirty=0,this._width=e,this._height=n,this._x=i,this._y=r,this._data={},this._rot=o,this._allowRotation=a}return v(t,[{key:"area",value:function(){return this.width*this.height}},{key:"collide",value:function(t){return t.x<this.x+this.width&&t.x+t.width>this.x&&t.y<this.y+this.height&&t.y+t.height>this.y}},{key:"contain",value:function(t){return t.x>=this.x&&t.y>=this.y&&t.x+t.width<=this.x+this.width&&t.y+t.height<=this.y+this.height}},{key:"setDirty",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._dirty=t?this._dirty+1:0}},{key:"width",get:function(){return this._width},set:function(t){t!==this._width&&(this._width=t,this._dirty++)}},{key:"height",get:function(){return this._height},set:function(t){t!==this._height&&(this._height=t,this._dirty++)}},{key:"x",get:function(){return this._x},set:function(t){t!==this._x&&(this._x=t,this._dirty++)}},{key:"y",get:function(){return this._y},set:function(t){t!==this._y&&(this._y=t,this._dirty++)}},{key:"rot",get:function(){return this._rot},set:function(t){if(!1!==this._allowRotation&&this._rot!==t){var e=this.width;this.width=this.height,this.height=e,this._rot=t,this._dirty++}}},{key:"allowRotation",get:function(){return this._allowRotation},set:function(t){this._allowRotation!==t&&(this._allowRotation=t,this._dirty++)}},{key:"data",get:function(){return this._data},set:function(t){null!==t&&t!==this._data&&(this._data=t,"object"==f(t)&&t.hasOwnProperty("allowRotation")&&(this._allowRotation=t.allowRotation),this._dirty++)}},{key:"dirty",get:function(){return this._dirty>0}}],[{key:"Collide",value:function(t,e){return t.collide(e)}},{key:"Contain",value:function(t,e){return t.contain(e)}}]),t}(),m=function(){function t(){d(this,t),this._dirty=0}return v(t,[{key:"setDirty",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._dirty=t?this._dirty+1:0,!t){var e,n=h(this.rects);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.setDirty&&i.setDirty(!1)}}catch(t){n.e(t)}finally{n.f()}}}},{key:"dirty",get:function(){return this._dirty>0||this.rects.some((function(t){return t.dirty}))}}]),t}(),w=function(t){r(i,t);var n=a(i);function i(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{smart:!0,pot:!0,square:!0,allowRotation:!1,tag:!1,border:0,logic:e.PACKING_LOGIC.MAX_EDGE};return d(this,i),(t=n.call(this)).maxWidth=r,t.maxHeight=o,t.padding=a,t.options=s,t.freeRects=[],t.rects=[],t.verticalExpand=!1,t.width=t.options.smart?0:r,t.height=t.options.smart?0:o,t.border=t.options.border?t.options.border:0,t.freeRects.push(new y(t.maxWidth+t.padding-2*t.border,t.maxHeight+t.padding-2*t.border,t.border,t.border)),t.stage=new y(t.width,t.height),t}return v(i,[{key:"add",value:function(){var t,e;if(1===arguments.length){if("object"!=f(arguments.length<=0?void 0:arguments[0]))throw new Error("MacrectsBin.add(): Wrong parameters");var n=(e=arguments.length<=0?void 0:arguments[0]).data&&e.data.tag?e.data.tag:e.tag?e.tag:void 0;if(this.options.tag&&this.tag!==n)return}else{if(t=arguments.length>2?arguments.length<=2?void 0:arguments[2]:null,this.options.tag){if(t&&this.tag!==t.tag)return;if(!t&&this.tag)return}(e=new y(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1])).data=t,e.setDirty(!1)}var i=this.place(e);return i&&this.rects.push(i),i}},{key:"repack",value:function(){var t=[];this.reset(),this.rects.sort((function(t,e){var n=Math.max(e.width,e.height)-Math.max(t.width,t.height);return 0===n&&t.hash&&e.hash?t.hash>e.hash?-1:1:n}));var e,n=h(this.rects);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.place(i)||t.push(i)}}catch(t){n.e(t)}finally{n.f()}for(var r=0,o=t;r<o.length;r++){var a=o[r];this.rects.splice(this.rects.indexOf(a),1)}return t.length>0?t:void 0}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&(this.data&&delete this.data,this.tag&&delete this.tag,this.rects=[],e&&(this.options={smart:!0,pot:!0,square:!0,allowRotation:!1,tag:!1,border:0})),this.width=this.options.smart?0:this.maxWidth,this.height=this.options.smart?0:this.maxHeight,this.border=this.options.border?this.options.border:0,this.freeRects=[new y(this.maxWidth+this.padding-2*this.border,this.maxHeight+this.padding-2*this.border,this.border,this.border)],this.stage=new y(this.width,this.height),this._dirty=0}},{key:"place",value:function(t){var e=t.data&&t.data.tag?t.data.tag:t.tag?t.tag:void 0;if(!this.options.tag||this.tag===e){var n,i;if(i=t.hasOwnProperty("_allowRotation")&&void 0!==t.allowRotation?t.allowRotation:this.options.allowRotation,n=this.findNode(t.width+this.padding,t.height+this.padding,i)){this.updateBinSize(n);for(var r=this.freeRects.length,o=0;o<r;)this.splitNode(this.freeRects[o],n)&&(this.freeRects.splice(o,1),r--,o--),o++;return this.pruneFreeList(),this.verticalExpand=this.width>this.height,t.x=n.x,t.y=n.y,void 0===t.rot&&(t.rot=!1),t.rot=n.rot?!t.rot:t.rot,this._dirty++,t}if(this.verticalExpand){if(this.updateBinSize(new y(t.width+this.padding,t.height+this.padding,this.border,this.height+this.padding-this.border))||this.updateBinSize(new y(t.width+this.padding,t.height+this.padding,this.width+this.padding-this.border,this.border)))return this.place(t)}else if(this.updateBinSize(new y(t.width+this.padding,t.height+this.padding,this.width+this.padding-this.border,this.border))||this.updateBinSize(new y(t.width+this.padding,t.height+this.padding,this.border,this.height+this.padding-this.border)))return this.place(t)}}},{key:"findNode",value:function(t,n,i){var r,o,a,s=Number.MAX_VALUE;for(var u in this.freeRects)(o=this.freeRects[u]).width>=t&&o.height>=n&&(r=this.options.logic===e.PACKING_LOGIC.MAX_AREA?o.width*o.height-t*n:Math.min(o.width-t,o.height-n))<s&&(a=new y(t,n,o.x,o.y),s=r),i&&o.width>=n&&o.height>=t&&(r=this.options.logic===e.PACKING_LOGIC.MAX_AREA?o.width*o.height-n*t:Math.min(o.height-t,o.width-n))<s&&(a=new y(n,t,o.x,o.y,!0),s=r);return a}},{key:"splitNode",value:function(t,e){if(!t.collide(e))return!1;if(e.x<t.x+t.width&&e.x+e.width>t.x){if(e.y>t.y&&e.y<t.y+t.height){var n=new y(t.width,e.y-t.y,t.x,t.y);this.freeRects.push(n)}if(e.y+e.height<t.y+t.height){var i=new y(t.width,t.y+t.height-(e.y+e.height),t.x,e.y+e.height);this.freeRects.push(i)}}if(e.y<t.y+t.height&&e.y+e.height>t.y){if(e.x>t.x&&e.x<t.x+t.width){var r=new y(e.x-t.x,t.height,t.x,t.y);this.freeRects.push(r)}if(e.x+e.width<t.x+t.width){var o=new y(t.x+t.width-(e.x+e.width),t.height,e.x+e.width,t.y);this.freeRects.push(o)}}return!0}},{key:"pruneFreeList",value:function(){for(var t=0,e=0,n=this.freeRects.length;t<n;){e=t+1;for(var i=this.freeRects[t];e<n;){var r=this.freeRects[e];if(r.contain(i)){this.freeRects.splice(t,1),t--,n--;break}i.contain(r)&&(this.freeRects.splice(e,1),e--,n--),e++}t++}}},{key:"updateBinSize",value:function(t){if(!this.options.smart)return!1;if(this.stage.contain(t))return!1;var e=Math.max(this.width,t.x+t.width-this.padding+this.border),n=Math.max(this.height,t.y+t.height-this.padding+this.border);if(this.options.allowRotation){var i=Math.max(this.width,t.x+t.height-this.padding+this.border),r=Math.max(this.height,t.y+t.width-this.padding+this.border);i*r<e*n&&(e=i,n=r)}return this.options.pot&&(e=Math.pow(2,Math.ceil(Math.log(e)*Math.LOG2E)),n=Math.pow(2,Math.ceil(Math.log(n)*Math.LOG2E))),this.options.square&&(e=n=Math.max(e,n)),!(e>this.maxWidth+this.padding||n>this.maxHeight+this.padding||(this.expandFreeRects(e+this.padding,n+this.padding),this.width=this.stage.width=e,this.height=this.stage.height=n,0))}},{key:"expandFreeRects",value:function(t,e){var n=this;this.freeRects.forEach((function(i,r){i.x+i.width>=Math.min(n.width+n.padding-n.border,t)&&(i.width=t-i.x-n.border),i.y+i.height>=Math.min(n.height+n.padding-n.border,e)&&(i.height=e-i.y-n.border)}),this),this.freeRects.push(new y(t-this.width-this.padding,e-2*this.border,this.width+this.padding-this.border,this.border)),this.freeRects.push(new y(t-2*this.border,e-this.height-this.padding,this.border,this.height+this.padding-this.border)),this.freeRects=this.freeRects.filter((function(t){return!(t.width<=0||t.height<=0||t.x<n.border||t.y<n.border)})),this.pruneFreeList()}}]),i}(m),b=function(t){r(n,t);var e=a(n);function n(){var t;if(d(this,n),(t=e.call(this)).rects=[],1===arguments.length){if("object"!=f(arguments.length<=0?void 0:arguments[0]))throw new Error("OversizedElementBin: Wrong parameters");var i=arguments.length<=0?void 0:arguments[0];t.rects=[i],t.width=i.width,t.height=i.height,t.data=i.data,i.oversized=!0}else{t.width=arguments.length<=0?void 0:arguments[0],t.height=arguments.length<=1?void 0:arguments[1],t.data=arguments.length>2?arguments.length<=2?void 0:arguments[2]:null;var r=new y(t.width,t.height);r.oversized=!0,r.data=t.data,t.rects.push(r)}return t.freeRects=[],t.maxWidth=t.width,t.maxHeight=t.height,t.options={smart:!1,pot:!1,square:!1},s(t)}return v(n,[{key:"add",value:function(){}},{key:"reset",value:function(){}},{key:"repack",value:function(){}}]),n}(m),_=4096;(g=e.PACKING_LOGIC||(e.PACKING_LOGIC={}))[g.MAX_AREA=0]="MAX_AREA",g[g.MAX_EDGE=1]="MAX_EDGE";var E=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{smart:!0,pot:!0,square:!1,allowRotation:!1,tag:!1,border:0,logic:e.PACKING_LOGIC.MAX_EDGE};d(this,t),this.width=n,this.height=i,this.padding=r,this.options=o,this._currentBinIndex=0,this.bins=[]}return v(t,[{key:"add",value:function(){if(1===arguments.length){if("object"!=f(arguments.length<=0?void 0:arguments[0]))throw new Error("MacrectsPacker.add(): Wrong parameters");var t=arguments.length<=0?void 0:arguments[0];if(t.width>this.width||t.height>this.height)this.bins.push(new b(t));else{var e=this.bins.slice(this._currentBinIndex).find((function(e){return void 0!==e.add(t)}));if(!e){var n=new w(this.width,this.height,this.padding,this.options),i=t.data&&t.data.tag?t.data.tag:t.tag?t.tag:void 0;this.options.tag&&i&&(n.tag=i),n.add(t),this.bins.push(n)}}return t}var r=new y(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1]);if(arguments.length>2&&(r.data=arguments.length<=2?void 0:arguments[2]),r.width>this.width||r.height>this.height)this.bins.push(new b(r));else{var o=this.bins.slice(this._currentBinIndex).find((function(t){return void 0!==t.add(r)}));if(!o){var a=new w(this.width,this.height,this.padding,this.options);this.options.tag&&r.data.tag&&(a.tag=r.data.tag),a.add(r),this.bins.push(a)}}return r}},{key:"addArray",value:function(t){var e=this;this.sort(t,this.options.logic).forEach((function(t){return e.add(t)}))}},{key:"reset",value:function(){this.bins=[],this._currentBinIndex=0}},{key:"repack",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t){var e,n=[],r=h(this.bins);try{for(r.s();!(e=r.n()).done;){var o=e.value;if(o.dirty){var a=o.repack();a&&n.push.apply(n,i(a))}}}catch(t){r.e(t)}finally{r.f()}this.addArray(n)}else if(this.dirty){var s=this.rects;this.reset(),this.addArray(s)}}},{key:"next",value:function(){return this._currentBinIndex=this.bins.length,this._currentBinIndex}},{key:"load",value:function(t){var e=this;t.forEach((function(t,n){if(t.maxWidth>e.width||t.maxHeight>e.height)e.bins.push(new b(t.width,t.height,{}));else{var i=new w(e.width,e.height,e.padding,t.options);i.freeRects.splice(0),t.freeRects.forEach((function(t,e){i.freeRects.push(new y(t.width,t.height,t.x,t.y))})),i.width=t.width,i.height=t.height,t.tag&&(i.tag=t.tag),e.bins[n]=i}}),this)}},{key:"save",value:function(){var t=[];return this.bins.forEach((function(e){var n={width:e.width,height:e.height,maxWidth:e.maxWidth,maxHeight:e.maxHeight,freeRects:[],rects:[],options:e.options};e.tag&&(n=Object.assign(Object.assign({},n),{tag:e.tag})),e.freeRects.forEach((function(t){n.freeRects.push({x:t.x,y:t.y,width:t.width,height:t.height})})),t.push(n)})),t}},{key:"sort",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.PACKING_LOGIC.MAX_EDGE;return t.slice().sort((function(t,i){var r=n===e.PACKING_LOGIC.MAX_EDGE?Math.max(i.width,i.height)-Math.max(t.width,t.height):i.width*i.height-t.width*t.height;return 0===r&&t.hash&&i.hash?t.hash>i.hash?-1:1:r}))}},{key:"currentBinIndex",get:function(){return this._currentBinIndex}},{key:"dirty",get:function(){return this.bins.some((function(t){return t.dirty}))}},{key:"rects",get:function(){var t,e=[],n=h(this.bins);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.push.apply(e,i(r.rects))}}catch(t){n.e(t)}finally{n.f()}return e}}]),t}();e.Bin=m,e.MaxRectsBin=w,e.MaxRectsPacker=E,e.OversizedElementBin=b,e.Rectangle=y},358:function(t,e,n){var i,r,o;o=function(){var t,e={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},n=function(){var t=function(t){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)},n=e.defaultRadius;return t.prototype={_organiseData:function(t,e){var i=t[this._xField],r=t[this._yField],o=this._radi,a=this._data,s=this._max,u=this._min,h=t[this._valueField]||1,c=t.radius||this._cfgRadius||n;a[i]||(a[i]=[],o[i]=[]),a[i][r]?a[i][r]+=h:(a[i][r]=h,o[i][r]=c);var l=a[i][r];return l>s?(e?this.setDataMax(l):this._max=l,!1):l<u?(e?this.setDataMin(l):this._min=l,!1):{x:i,y:r,value:h,radius:c,min:u,max:s}},_unOrganizeData:function(){var t=[],e=this._data,n=this._radi;for(var i in e)for(var r in e[i])t.push({x:i,y:r,radius:n[i][r],value:e[i][r]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var t=arguments[0],e=t.length;e--;)this.addData.call(this,t[e]);else{var n=this._organiseData(arguments[0],!0);n&&(0===this._data.length&&(this._min=this._max=n.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[n]}))}return this},setData:function(t){var e=t.data,n=e.length;this._data=[],this._radi=[];for(var i=0;i<n;i++)this._organiseData(e[i],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),i=function(){var t=function(t){var e=t.gradient||t.defaultGradient,n=document.createElement("canvas"),i=n.getContext("2d");n.width=256,n.height=1;var r=i.createLinearGradient(0,0,256,1);for(var o in e)r.addColorStop(o,e[o]);return i.fillStyle=r,i.fillRect(0,0,256,1),i.getImageData(0,0,256,1).data},e=function(t,e){var n=document.createElement("canvas"),i=n.getContext("2d"),r=t,o=t;if(n.width=n.height=2*t,1==e)i.beginPath(),i.arc(r,o,t,0,2*Math.PI,!1),i.fillStyle="rgba(0,0,0,1)",i.fill();else{var a=i.createRadialGradient(r,o,t*e,r,o,t);a.addColorStop(0,"rgba(0,0,0,1)"),a.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=a,i.fillRect(0,0,2*t,2*t)}return n};function n(e){e.container;var n=this.shadowCanvas=document.createElement("canvas"),i=this.canvas=e.canvas||document.createElement("canvas"),r=(this._renderBoundaries=[1e4,1e4,0,0],{});i.className="heatmap-canvas",this._width=i.width=n.width=e.width||+r.width.replace(/px/,""),this._height=i.height=n.height=e.height||+r.height.replace(/px/,""),this.shadowCtx=n.getContext("2d"),this.ctx=i.getContext("2d"),i.style.cssText=n.style.cssText="position:absolute;left:0;top:0;",this._palette=t(e),this._templates={},this._setStyles(e)}return n.prototype={renderPartial:function(t){t.data.length>0&&(this._drawAlpha(t),this._colorize())},renderAll:function(t){this._clear(),t.data.length>0&&(this._drawAlpha(function(t){for(var e=[],n=t.min,i=t.max,r=t.radi,o=(t=t.data,Object.keys(t)),a=o.length;a--;)for(var s=o[a],u=Object.keys(t[s]),h=u.length;h--;){var c=u[h],l=t[s][c],f=r[s][c];e.push({x:s,y:c,value:l,radius:f})}return{min:n,max:i,data:e}}(t)),this._colorize())},_updateGradient:function(e){this._palette=t(e)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,e){this._width=t,this._height=e,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=e},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0==t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=t.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=t.height||this._height,this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var n=this._min=t.min,i=this._max=t.max,r=(t=t.data||[]).length,o=1-this._blur;r--;){var a,s=t[r],u=s.x,h=s.y,c=s.radius,l=Math.min(s.value,i),f=u-c,d=h-c,p=this.shadowCtx;this._templates[c]?a=this._templates[c]:this._templates[c]=a=e(c,o);var v=(l-n)/(i-n);p.globalAlpha=v<.01?.01:v,p.drawImage(a,f,d),f<this._renderBoundaries[0]&&(this._renderBoundaries[0]=f),d<this._renderBoundaries[1]&&(this._renderBoundaries[1]=d),f+2*c>this._renderBoundaries[2]&&(this._renderBoundaries[2]=f+2*c),d+2*c>this._renderBoundaries[3]&&(this._renderBoundaries[3]=d+2*c)}},_colorize:function(){var t=this._renderBoundaries[0],e=this._renderBoundaries[1],n=this._renderBoundaries[2]-t,i=this._renderBoundaries[3]-e,r=this._width,o=this._height,a=this._opacity,s=this._maxOpacity,u=this._minOpacity,h=this._useGradientOpacity;t<0&&(t=0),e<0&&(e=0),t+n>r&&(n=r-t),e+i>o&&(i=o-e);for(var c=this.shadowCtx.getImageData(t,e,n,i),l=c.data,f=l.length,d=this._palette,p=3;p<f;p+=4){var v,g=l[p],y=4*g;y&&(v=a>0?a:g<s?g<u?u:g:s,l[p-3]=d[y],l[p-2]=d[y+1],l[p-1]=d[y+2],l[p]=h?d[y+3]:v)}c.data=l,this.ctx.putImageData(c,t,e),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var e=this.shadowCtx.getImageData(t.x,t.y,1,1).data[3],n=this._max,i=this._min;return Math.abs(n-i)*(e/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},n}(),r=(t=!1,"canvas2d"===e.defaultRenderer&&(t=i),t),o=function(){for(var t={},e=arguments.length,n=0;n<e;n++){var i=arguments[n];for(var r in i)t[r]=i[r]}return t},a=function(){var t=function(){function t(){this.cStore={}}return t.prototype={on:function(t,e,n){var i=this.cStore;i[t]||(i[t]=[]),i[t].push((function(t){return e.call(n,t)}))},emit:function(t,e){var n=this.cStore;if(n[t])for(var i=n[t].length,r=0;r<i;r++)(0,n[t][r])(e)}},t}(),i=function(t){var e=t._renderer,n=t._coordinator,i=t._store;n.on("renderpartial",e.renderPartial,e),n.on("renderall",e.renderAll,e),n.on("extremachange",(function(e){t._config.onExtremaChange&&t._config.onExtremaChange({min:e.min,max:e.max,gradient:t._config.gradient||t._config.defaultGradient})})),i.setCoordinator(n)};function a(){var a=this._config=o(e,arguments[0]||{});if(this._coordinator=new t,a.plugin){var s=a.plugin;if(!e.plugins[s])throw new Error("Plugin '"+s+"' not found. Maybe it was not registered.");var u=e.plugins[s];this._renderer=new u.renderer(a),this._store=new u.store(a)}else this._renderer=new r(a),this._store=new n(a);i(this)}return a.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=o(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},a}();return{create:function(t){return new a(t)},register:function(t,n){e.plugins[t]=n}}},t.exports?t.exports=o():void 0===(r="function"==typeof(i=o)?i.call(e,n,e,t):i)||(t.exports=r)},36:function(t,e){t.exports={MOUSE_HOVERING:"DATAVIZ_OBJECT_HOVERING",MOUSE_CLICK:"DATAVIZ_OBJECT_CLICK"}},54:function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var u,h=[],c=!1,l=-1;function f(){c&&u&&(c=!1,u.length?h=u.concat(h):l=-1,h.length&&d())}function d(){if(!c){var t=s(f);c=!0;for(var e=h.length;e;){for(u=h,h=[];++l<e;)u&&u[l].run();l=-1,e=h.length}u=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new p(t,e)),1!==h.length||c||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=v,r.addListener=v,r.once=v,r.off=v,r.removeListener=v,r.removeAllListeners=v,r.emit=v,r.prependListener=v,r.prependOnceListener=v,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},646:function(t,e,n){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(r.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new o(r.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(647),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(13))},647:function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var i,r,o,a,s,u=1,h={},c=!1,l=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){p(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){p(t.data)},i=function(t){o.port2.postMessage(t)}):l&&"onreadystatechange"in l.createElement("script")?(r=l.documentElement,i=function(t){var e=l.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):i=function(t){setTimeout(p,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),i=function(e){t.postMessage(a+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return h[u]=r,i(u),u++},f.clearImmediate=d}function d(t){delete h[t]}function p(t){if(c)setTimeout(p,0,t);else{var e=h[t];if(e){c=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{d(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(13),n(54))},665:function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"ViewableStyle",(function(){return V})),n.d(i,"SpriteViewable",(function(){return U})),n.d(i,"CustomViewable",(function(){return L})),n.d(i,"ViewableData",(function(){return H})),n.d(i,"ViewableType",(function(){return N}));var r=n(36),o=n.n(r);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=f(t);if(e){var r=f(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=Autodesk.Viewing,p=d.GlobalManagerMixin,v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(a,t);var e,n,i,o=c(a);function a(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(this,a),(e=o.call(this)).names=["HyperionTool"],e.options=n,e.setGlobalManager(t.globalManager),e.viewer=t,e.delegate=n.delegate,e.init(),e.hoveringDbId=-1,e}return e=a,(n=[{key:"init",value:function(){var t=this,e=this.viewer.impl;this.activate=function(e){t.active=!0},this.deactivate=function(e){t.clearMarkedObject(t.markedFragments),t.active=!1},this.handleSingleClick=function(n,i){if(0===i){var o=e.clientToViewport(n.canvasX,n.canvasY),a=e.renderer().idAtPixel(o.x,o.y,[]),s=e.hitTestViewport(o,!1);if(console.log(s),0!=a)return t.markObject([a]),t.viewer.dispatchEvent({type:r.MOUSE_CLICK,dbId:a,originalEvent:n}),t.viewer.impl.invalidate(!1,!1,!0),!0;t.clearMarkedObject(t.markedFragments),t.viewer.impl.invalidate(!1,!1,!0)}return!1},this.handleDoubleClick=function(t,e){return!1},this.handleButtonDown=function(e){return t.buttonDown=!0,!1},this.handleButtonUp=function(e){return t.buttonDown=!1,!1},this.handleMouseMove=function(n){if(!t.buttonDown){var i=e.clientToViewport(n.canvasX,n.canvasY),o=e.renderer().idAtPixel(i.x,i.y,[],[e.renderer().getOverlayIdTarget()]);if(t.hoveringDbId!=o&&0!=o)return t.hoveringDbId=o,t.viewer.dispatchEvent({type:r.MOUSE_HOVERING,dbId:o,hovering:!0,originalEvent:n}),!0;t.hoveringDbId!=o&&(t.viewer.dispatchEvent({type:r.MOUSE_HOVERING,dbId:o,hovering:!1,originalEvent:n}),t.hoveringDbId=-1)}},this.markObject=function(e){e instanceof Array||(e=[e]);var n=new Set,i=t.delegate.dbId2Geometry;if(null!=i){e.map((function(t){return n.add(i[t])})),n=Array.from(n);var r=new Set(e);n.map((function(e){if(e&&e.attributes.id&&e.attributes.flagp){for(var n=e.attributes.flagp.array,i=e.attributes.uvp.array,o=e.attributes.color.array,a=e.attributes.id.array,s=0;s<a.length;s+=3){var u=a[s]+(a[s+1]<<8)+(a[s+2]<<16),h=s/3;n[h]=r.has(u)?1:0;var c=t.delegate.viewableData.getViewableUV(u,1==n[h]);c&&(i[4*h]=c.x,i[4*h+1]=c.y,i[4*h+2]=c.w,i[4*h+3]=c.h);var l=t.delegate.viewableData.getViewableColor(u,1==n[h]);l&&(o[3*h]=255*l.r,o[3*h+1]=255*l.g,o[3*h+2]=255*l.b)}e.attributes.flagp.needsUpdate=!0,e.attributes.uvp.needsUpdate=!0,e.attributes.color.needsUpdate=!0}})),t.markedFragments=n}},this.clearMarkedObject=function(e){(e=e||t.markedFragments)&&(e.map((function(e){if(e&&e.attributes.flagp){for(var n=e.attributes.flagp.array,i=e.attributes.uvp.array,r=e.attributes.color.array,o=e.attributes.id.array,a=0;a<o.length;a+=3){var s=o[a]+(o[a+1]<<8)+(o[a+2]<<16),u=a/3;n[u]=0;var h=t.delegate.viewableData.getViewableUV(s,!1);h&&(i[4*u]=h.x,i[4*u+1]=h.y,i[4*u+2]=h.w,i[4*u+3]=h.h);var c=t.delegate.viewableData.getViewableColor(s,!1);c&&(r[3*u]=255*c.r,r[3*u+1]=255*c.g,r[3*u+2]=255*c.b)}e.attributes.flagp.needsUpdate=!0,e.attributes.uvp.needsUpdate=!0,e.attributes.color.needsUpdate=!0}})),t.viewer.impl.invalidate(!1,!1,!0))},this.invalidateViewables=function(e,n){if(!e||!n)throw new Error("Parameters of 'invalidateViewables' are mandatory");e instanceof Array||(e=[e]);var i=t.sensorModel.getInstanceTree().fragList,r=i.geoms.geoms,o=new Set,a=i.fragments.dbId2fragId;e.map((function(t){return o.add(a[t])})),o=Array.from(o);var s=new Set(e),u=new Map,h=t.sensorModel.getData().fragments.viewableData;h.viewables.forEach((function(t){return u.set(t.dbId,t)}));var c=!1;o.map((function(t){for(var e=r[t],i=e.attributes.id.array,o=0;o<i.length;o+=3){var a=i[o]+(i[o+1]<<8)+(i[o+2]<<16);if(s.has(a)){var l=n(u.get(a));if(l){var f=o/3;if(l.position){var d=e.attributes.position.array;e.attributes.position.needsUpdate=!0,d[3*f+0]=l.position.x,d[3*f+1]=l.position.y,d[3*f+2]=l.position.z,c=!0}if(l.url){var p=h.getSpriteUV(l.url);if(p){var v=e.attributes.uvp.array;e.attributes.uvp.needsUpdate=!0,v[4*f+0]=p.x,v[4*f+1]=p.y,v[4*f+2]=p.w,v[4*f+3]=p.h,c=!0}}if(l.color){var g=e.attributes.color.array;e.attributes.color.needsUpdate=!0,g[3*f+0]=255*l.color.r,g[3*f+1]=255*l.color.g,g[3*f+2]=255*l.color.b,c=!0}if(void 0!==l.highlighted){var y=e.attributes.flagp.array;e.attributes.flagp.needsUpdate=!0,y[f]=l.highlighted?1:0,c=!0}}}}})),c&&t.viewer.impl.invalidate(!1,!1,!0)},this.invalidateViewablesDirect=function(e,n,i,r){if(!e||!n||!r)throw new Error("Parameters of 'invalidateViewables' are mandatory");e instanceof Array||(e=[e]);var o=new Set(e),a=new Map;i.viewables.forEach((function(t){return a.set(t.dbId,t)}));for(var s=!1,u=n[0].geometry,h=u.attributes.id.array,c=0;c<h.length;c+=3){var l=h[c]+(h[c+1]<<8)+(h[c+2]<<16);if(o.has(l)){var f=r(a.get(l));if(f){var d=c/3;if(f.position){var p=u.attributes.position.array;u.attributes.position.needsUpdate=!0,p[3*d+0]=f.position.x,p[3*d+1]=f.position.y,p[3*d+2]=f.position.z,s=!0}if(f.url){var v=i.getSpriteUV(f.url);if(v){var g=u.attributes.uvp.array;u.attributes.uvp.needsUpdate=!0,g[4*d+0]=v.x,g[4*d+1]=v.y,g[4*d+2]=v.w,g[4*d+3]=v.h,s=!0}}if(f.color){var y=u.attributes.color.array;u.attributes.color.needsUpdate=!0,y[3*d+0]=255*f.color.r,y[3*d+1]=255*f.color.g,y[3*d+2]=255*f.color.b,s=!0}if(void 0!==f.highlighted){var m=u.attributes.flagp.array;u.attributes.flagp.needsUpdate=!0,m[d]=f.highlighted?1:0,s=!0}}}}s&&t.viewer.impl.invalidate(!1,!1,!0)}}}])&&u(e.prototype,n),i&&u(e,i),a}(d.ToolInterface);p.call(v.prototype);var g=n(356),y=n(357),m=n(81),w=n.n(m);function b(t,e,n,i,r,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,r)}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var x=Autodesk.Viewing.Private,R=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1920,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1080,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;_(this,t),this.width=e,this.height=n,this.padding=i,this.spritesMap={},this.pending=[],this.images=[],this.logger=x.logger,this.packer=new y.MaxRectsPacker(this.width,this.height,this.padding,{smart:!0,pot:!1,square:!1,allowRotation:!1,tag:!1,border:0}),this.canvas=document.createElement("canvas"),this.hasContent=!1}var e,n,i,r,o;return e=t,(n=[{key:"addSprite",value:function(t){var e=this;if(null==this.spritesMap[t]){var n=w.a.defer(),i=new Image;i.crossOrigin="anonymous",i.onload=function(){e.images.push({url:t,image:i,width:i.width,height:i.height}),n.resolve()},i.onerror=function(t){e.logger.error(t),n.resolve()},i.src=t,this.spritesMap[t]=1,this.pending.push(n.promise)}}},{key:"finish",value:(r=regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.a.all(this.pending);case 2:e=this.canvas,this.packer.addArray(this.images),this.images.length=0,this.packer.bins.forEach((function(t){e.width=t.width,e.height=t.height;var i=e.getContext("2d");t.rects.forEach((function(t){t.image&&(i.drawImage(t.image,t.x,t.y),t.image=void 0,n.spritesMap[t.url]=t,t.url=void 0)}))}));case 6:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,i){var o=r.apply(t,e);function a(t){b(o,n,i,a,s,"next",t)}function s(t){b(o,n,i,a,s,"throw",t)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"spriteUV",value:function(t){var e=this.spritesMap[t];return e?{x:e.x/this.canvasWidth,y:e.y/this.canvasHeight,w:(e.x+e.width)/this.canvasWidth,h:(e.y+e.height)/this.canvasHeight}:{x:0,y:0,w:1,h:1}}},{key:"canvasWidth",get:function(){return this.canvas.width}},{key:"canvasHeight",get:function(){return this.canvas.height}}])&&E(e.prototype,n),i&&E(e,i),t}();function S(t,e,n,i,r,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,r)}function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=A(t);if(e){var r=A(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return O(this,n)}}function O(t,e){return!e||"object"!==T(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t){return function(t){if(Array.isArray(t))return C(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return C(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function D(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function j(t,e,n){return e&&P(t.prototype,e),n&&P(t,n),t}var N={SPRITE:1,GEOMETRY:2},V=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N.SPRITE,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new THREE.Color(16777215),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new THREE.Color(16777215),o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];D(this,t),this.type=e,this.color=n,this.url=i,this.highlightedColor=r,this.highlightedUrl=o,this.spriteUrls=new Set(a)}return j(t,[{key:"preloadSprite",value:function(t){this.spriteUrls.add(t)}},{key:"preloadedSprites",get:function(){return M(this.spriteUrls.values())}}]),t}(),L=function(){function t(e,n,i){D(this,t),this._style=n,this._position=e,this._dbId=i}return j(t,[{key:"style",get:function(){return this._style}},{key:"position",get:function(){return this._position}},{key:"dbId",get:function(){return this._dbId}}]),t}(),U=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}(n,t);var e=k(n);function n(t,i,r){return D(this,n),console.assert(i.type==N.SPRITE),e.call(this,t,i,r)}return j(n,[{key:"type",get:function(){return N.SPRITE}},{key:"color",get:function(){return this.style.color}},{key:"highlightedColor",get:function(){return this.style.highlightedColor}}]),n}(L),H=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};D(this,t),this._styleMap=new Map,this._viewablesMap=new Map,this._spriteAtlas=new R(e.atlasWidth||1920,e.atlasHeight||1080,2)}var e,n;return j(t,[{key:"addViewable",value:function(t){var e=this;if(t.type==N.SPRITE){var n=new Set;n.add(t.style.url),t.style.highlightedUrl&&n.add(t.style.highlightedUrl),t.style.preloadedSprites.forEach((function(t){return n.add(t)})),n.forEach((function(t){return e.spriteAtlas.addSprite(t)}))}this._viewablesMap.set(t.dbId,t)}},{key:"getSpriteUV",value:function(t){return this._spriteAtlas.spriteUV(t)}},{key:"getViewableUV",value:function(t,e){var n=this._viewablesMap.get(t).style;return e&&n.highlightedUrl?this._spriteAtlas.spriteUV(n.highlightedUrl):this._spriteAtlas.spriteUV(n.url)}},{key:"getViewableColor",value:function(t,e){var n=this._viewablesMap.get(t).style;return e?n.highlightedColor:n.color}},{key:"finish",value:(e=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._spriteAtlas.finish();case 2:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(t){S(o,i,r,a,s,"next",t)}function s(t){S(o,i,r,a,s,"throw",t)}a(void 0)}))},function(){return n.apply(this,arguments)})},{key:"viewables",get:function(){return M(this._viewablesMap.values())}},{key:"spriteAtlas",get:function(){return this._spriteAtlas}}]),t}(),B=n(28);function G(t,e,n,i,r,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,r)}function F(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){G(o,i,r,a,s,"next",t)}function s(t){G(o,i,r,a,s,"throw",t)}a(void 0)}))}}function z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Y(t,e,n){return e&&W(t.prototype,e),n&&W(t,n),t}var K=function(){function t(e,n,i){z(this,t),this._id=e,this._name=n,this._bounds=i,this._devices=[]}return Y(t,[{key:"addDevice",value:function(t){this._devices.push(t)}},{key:"info",set:function(t){this._info=t},get:function(){return this._info}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"bounds",get:function(){return this._bounds}},{key:"devices",get:function(){return this._devices}}]),t}(),X=function(){function t(){z(this,t)}return Y(t,[{key:"addRoomToLevel",value:function(t,e){this[t]||(this[t]=[]),this[t].push(e)}},{key:"getRoomsOnLevel",value:function(t,e){var n=this[t]||[];return e?n.filter((function(t){return t.devices.length>0})):n}}]),t}(),$=function(){function t(e){z(this,t),this.model=e,this.rooms=null}var e,n,i,r;return Y(t,[{key:"getImmediateChildNodesByName",value:function(t,e){var n=this.model.getInstanceTree(),i=[];return n&&(e=null==e?n.getRootId():e,n.enumNodeChildren(e,(function(e){n.getNodeName(e,!0)==t&&i.push(e)}),!1)),i}},{key:"getLevelRoomsMap",value:(r=F(regeneratorRuntime.mark((function t(){var e,n,i=this,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=r.length>0&&void 0!==r[0]&&r[0],this.levelRoomsMap){t.next=8;break}return n=new X,t.next=5,this.getRoomList();case 5:t.sent.forEach((function(t){var r=i.getLevel(t);e||(t.info=void 0),null!=r&&n.addRoomToLevel(r,t)})),this.levelRoomsMap=n;case 8:return t.abrupt("return",this.levelRoomsMap);case 9:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"getLevel",value:function(t){if(t&&t.info&&t.info.properties){var e=t.info.properties.find((function(t){return 20==t.type&&"Level"==t.attributeName}));return e?e.displayValue:void 0}}},{key:"getRoomList",value:(i=F(regeneratorRuntime.mark((function t(){var e,n,i,r,o,a,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.rooms){t.next=9;break}return e=this.getImmediateChildNodesByName("Rooms"),n=this.model,i=[],e&&e.length>0&&(r=e[0],(o=n.getInstanceTree())&&o.enumNodeChildren(r,(function(t){var e=o.getNodeName(t,!0),n=s.getRoomBounds(t);i.push(new K(t,e,n))}),!1)),a=i.map((function(t){return new Promise((function(e,i){n.getProperties2(t.id,(function(n){t.info=n,e(t)}),(function(n){e(t)}))}))})),t.next=8,Promise.all(a);case 8:this.rooms=i;case 9:return t.abrupt("return",this.rooms);case 10:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"getRoomBounds",value:function(t){var e=new THREE.Box3,n=new THREE.Box3,i=this.model.getInstanceTree(),r=this.model.getFragmentList();return i&&i.enumNodeFragments(t,(function(t){r.getWorldBounds(t,n),e.union(n)}),!0),e}},{key:"mapDevicesInRoom",value:(n=F(regeneratorRuntime.mark((function t(){var e,n,i,r,o,a,s=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:[],t.next=3,this.getRoomList();case 3:for(n=t.sent,e=e.slice(0),i=0;e.length>0&&i<n.length;i++)for(r=n[i],o=0;o<e.length;o++)a=e[o],this.roomGeomContainsPoint(r,a.position)&&(a.roomId=r.id,r.addDevice(a),e.splice(o,1),o--);case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"generateSurfaceShadingData",value:(e=F(regeneratorRuntime.mark((function t(){var e,n,i,r,o,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=a.length>0&&void 0!==a[0]?a[0]:[],n=a.length>1?a[1]:void 0){t.next=8;break}return t.next=5,this.getLevelRoomsMap();case 5:return n=t.sent,t.next=8,this.mapDevicesInRoom(e);case 8:for(o in i=new B.SurfaceShadingData,r=function(t){var e=n[t],r=new B.SurfaceShadingGroup(t);e.forEach((function(t){var e=new B.SurfaceShadingNode(t.name,t.id);t.devices.forEach((function(t){var n=t.deviceModel?t.deviceModel.id:t.type;e.addPoint(new B.SurfaceShadingPoint(t.id,t.position,t.sensorTypes,t.name,{styleId:n}))})),r.addChild(e)})),i.addChild(r)},n)r(o);return i.initialize(this.model),t.abrupt("return",i);case 13:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"roomGeomContainsPoint",value:function(t,e){return t.bounds&&t.bounds.containsPoint(e)}}]),t}();function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z(t,e){return(Z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function J(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=et(t);if(e){var r=et(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return tt(this,n)}}function tt(t,e){return!e||"object"!==q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function et(t){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var nt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Z(t,e)}(n,THREE.ShaderMaterial);var e=J(n);function n(t,i,r,o,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;Q(this,n);var u={sensors:{type:"v4v",value:[]},uStops:{type:"fv1",value:r},uColors:{type:"v3v",value:i}};t.forEach((function(t){u.sensors.value.push(t)}));var h=t.length,c=r.length,l="\n              varying vec4 worldCoord;\n              void main()\n              {\n                vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n                worldCoord = modelMatrix * vec4( position, 1.0 );\n                gl_Position = projectionMatrix * mvPosition;\n              }\n            ",f="\n            float lmap(float value, float inMin, float inMax, float outMin, float outMax)\n            {\n              return clamp(outMin + ((outMax - outMin) * (value - inMin)) / (inMax - inMin), outMin, outMax);\n            }\n\n            // Gradient with multiple colors in non-equal intervals\n            vec3 colormap(float x)\n            {\n              for (int i = 1; i < ".concat(c,"; i++) {\n                if (x <= uStops[i]) {\n                  float stopPct = lmap(x, uStops[i-1], uStops[i], 0.0, 1.0);\n                  return mix(uColors[i-1], uColors[i], stopPct);\n                }\n              }\n\n              // In case 'x' goes beyond upper bound.\n              return uColors[").concat(c," - 1];\n            }\n           "),d="\n          varying vec4 worldCoord;\n          const int sensorCount = ".concat(h,";\n          uniform vec4 sensors [sensorCount];\n          uniform vec3 uColors[5];   // 5 is the max number of gradient colors\n          uniform float uStops[5];\n          const float dotSize = 6.0;\n          const float h_var1 = 0.4;\n          const float h_var2 = 0.25;\n          const float two_pi = 2.0 * 3.1415927;\n          ").concat(f,"\n          vec2 get_pix(float angle){\n            float rad = radians(angle);\n            float c = cos(rad);\n            float s = sin(rad);\n            mat2 R = mat2(vec2(c, -s), vec2(s, c));\n            return R * gl_FragCoord.xy;\n          }\n\n          vec3 halftone(float tone, vec3 dotColor, vec3 backgroundColor){\n            vec2 u = get_pix(-45.0) / (dotSize);\n            float h = (h_var1 + h_var2 * cos(u.x*two_pi));\n            const float e = 0.05;\n            float gradient = smoothstep(-e, e, h - tone);\n            return mix(dotColor, backgroundColor, gradient);\n          }\n\n          void main( void ) {\n            vec3 fragPos = vec3(worldCoord.x, worldCoord.y, worldCoord.z);\n            const float maxConfidence = float(").concat(a,"); // in World Coordinates\n            float result = 0.0;\n            float sum = 0.0;\n            float wsum = 0.000001;\n            float minDist = ").concat(o?"99999":"999999999",".0;\n            bool found = false; // at exact location of the sensor\n            int validSensors = 0;\n            if (sensorCount > 1) {\n              for (int i=0; i < sensorCount; i++) {\n                float mydist = distance(fragPos, vec3(sensors[i][0], sensors[i][1], sensors[i][2]));\n                if (sensors[i][3] >= 0.0) {\n                  if (mydist < 0.00001) {\n                    result = sensors[i][3];\n                    found = true;\n                  } else {\n                    float w = (1.0 / (mydist * mydist").concat(o?" * mydist":"","));\n                    sum += (sensors[i][3] * w);\n                    wsum += w;\n                  }\n                  validSensors += 1;\n                  if (mydist < minDist) {\n                    minDist = mydist;\n                  }\n                }\n              }\n              if (validSensors == 0) {\n                result = -1.0;\n              } else if (!found) {\n                result = sum / wsum;\n              }\n            } else {\n              float mydist = distance(fragPos, vec3(sensors[0][0], sensors[0][1], sensors[0][2]));\n              result = sensors[0][3];\n              if(mydist < minDist){\n                minDist = mydist;\n              }\n            }\n\n            // Defaults without influence from any sensor\n            float confidence = 0.0;\n            vec3 sensorColor = vec3(0.5, 0.5, 0.5);\n\n            if (result >= 0.0) {\n              result = clamp(result, 0.0, 1.0);\n              confidence = 1.0 - clamp(minDist / maxConfidence, 0.0, 1.0);\n              sensorColor = colormap(result);\n            }\n\n            vec3 confidenceColor = halftone(clamp(confidence, 0.3, 0.9), vec3(0.7, 0.7, 0.7), vec3(1.0, 1.0, 1.0));\n            gl_FragColor = vec4(mix(confidenceColor, sensorColor, clamp(confidence, 0.0, 1.0)), ").concat(s,");\n          }\n        ");return e.call(this,{uniforms:u,vertexShader:l,fragmentShader:d,side:THREE.DoubleSide,depthTest:!0,depthWrite:!1})}return n}();function it(t){for(var e=[],n=1/(t-1),i=0;i<t;i++)e.push(n*i);return e}function rt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ot(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ot(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function at(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var st=Autodesk.Viewing.Private,ut=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewer=e,this.model=n,this.shadingData=i,this.sensorValueIndex=[],this.settings={},this.registerSensorColors("hatchPattern",[16777215,16777215]),this.registerSensorColors("__defaultSensor__",[255,65280,16776960,16711680])}var e,n,i;return e=t,(n=[{key:"removeShading",value:function(){this.viewer.impl.removeOverlayScene("DataVizSurfaceShading"),this.viewer.impl.invalidate(!1,!1,!0)}},{key:"cleanUp",value:function(){this.removeShading();for(var t=0;t<this.sensorValueIndex.length;t++)this.sensorValueIndex[t].heatmapMaterial.dispose();this.sensorValueIndex=[],this.hatchMaterial&&(this.hatchMaterial.dispose(),delete this.hatchMaterial)}},{key:"_createHatchMaterial",value:function(){var t=this.settings.hatchPattern;return new nt([new THREE.Vector4(9999999.9,9999999.9,9999999.9,-1)],t.colors,t.stops,!0,60,t.alpha)}},{key:"registerSensorColors",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.7;this.settings[t]={stops:it(e.length),colors:e.map((function(t){return new THREE.Color(t)})).map((function(t){return new THREE.Vector3(t.r,t.g,t.b)})),alpha:n}}},{key:"getSetting",value:function(t){return this.settings[t]?this.settings[t]:this.settings.__defaultSensor__}},{key:"render",value:function(t,e,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:160,o=[];t instanceof Array?t.forEach((function(t){return i.shadingData.getLeafsById(t,o)})):o=this.shadingData.getLeafsById(t);var a=this.model.getInstanceTree(),s=this.viewer.impl,u=this.sensorValueIndex;function h(t,e){return(t=t||[]).filter((function(t){return t.types&&t.types.includes(e)}))}function c(t,e){var n=a.fragList.getGeometry(t);if(n){var i=new THREE.Mesh(n,e),r=new THREE.Matrix4;a.fragList.getWorldMatrix(t,r),i.matrix.copy(r),i.matrixWorldNeedsUpdate=!0,i.matrixAutoUpdate=!1,i.frustumCulled=!1,s.addOverlay("DataVizSurfaceShading",i)}else st.logger.error("Geometry for the fragment is empty, FragId:",t)}s.createOverlayScene("DataVizSurfaceShading"),this.hatchMaterial||(this.hatchMaterial=this._createHatchMaterial());for(var l=function(t){var a=o[t],s=h(a.shadingPoints,e);a.fragIds.forEach((function(t){if(s.length>0){var o=[];s.forEach((function(t){var i=t.position,r=n(t,e),a=new THREE.Vector4(i.x,i.y,i.z,r);o.push(a)}));var h=i.getSetting(e),l=r;if(a.bounds){var f=a.bounds.max,d=a.bounds.min;l=f.x-d.x+(f.y-d.y)+(f.z-d.z)}var p=new nt(o,h.colors,h.stops,!0,l,h.alpha);u.push({shadingPoints:s,sensorType:e,heatmapMaterial:p}),c(t,p)}else c(t,i.hatchMaterial)}))},f=0;o&&f<o.length;f++)l(f)}},{key:"updateShading",value:function(t){for(var e=0;e<this.sensorValueIndex.length;e++){var n,i=this.sensorValueIndex[e],r=i.shadingPoints,o=i.sensorType,a=i.heatmapMaterial,s=[],u=rt(r);try{for(u.s();!(n=u.n()).done;){var h=n.value,c=h.position,l=t(h,o);s.push(new THREE.Vector4(c.x,c.y,c.z,l))}}catch(t){u.e(t)}finally{u.f()}a.uniforms.sensors.value=s}this.viewer.impl.invalidate(!1,!1,!0)}}])&&at(e.prototype,n),i&&at(e,i),t}(),ht=n(358),ct=n.n(ht);function lt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ft(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ft(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var vt=Autodesk.Viewing.Private,gt=function(){function t(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};dt(this,t);var o=r=Object.assign({width:1024,height:1024,slicingEnabled:!0,position:"middle",placePosition:"min"},r),a=o.width,s=o.height;this.options=r;var u=document.createElement("canvas");u.width=a,u.height=s,this.config={canvas:u,width:a,height:s,radius:20},this.model=n,this.viewer=e,this.shadingData=i;var h=new THREE.Texture(u,THREE.UVMapping);h.minFilter=THREE.LinearFilter,h.flipY=!1,this.material=new THREE.MeshBasicMaterial({map:h,depthTest:!0,depthWrite:!1,transparent:!0,side:THREE.DoubleSide}),this.gradientMap={}}var e,n,i;return e=t,(n=[{key:"_setup",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,i=this.model,r=this.shadingData,o=new THREE.Box3,a=i.getInstanceTree(),s=[],u={},h=[],c={},l=[];function f(t){return!(null==t.shadingPoints||t.shadingPoints&&0==t.shadingPoints.length||null==t.shadingPoints.find((function(t){return t.types.find((function(t){return t==e}))})))}this.gradientMap[e]&&(this.config.gradient=this.gradientMap[e]),this.config.radius=n,t.forEach((function(t){return r.getLeafsById(t,s)}));for(var d=0;d<s.length;d++)f(s[d])&&s[d].dbIds.forEach((function(t){if(a.getNodeBox(t,h),h[0]!=1/0){var e=new THREE.Box3(new THREE.Vector3(h[0],h[1],h[2]),new THREE.Vector3(h[3],h[4],h[5]));o.union(e),u[t]=e}}));var p=o.min.x,v=o.min.y,g=o.max.x-p,y=o.max.y-v,m=this.options,w=m.slicingEnabled,b=m.width,_=m.height;g>y?_=b/g*y:b=_/y*g,this.config.canvas.width=b,this.config.canvas.height=_,this.config.width=b,this.config.height=_,this.heatmapInstance=ct.a.create(this.config);for(var E=[],x=[],R=[],S=Autodesk.Viewing.Extensions.CompGeom,T=this.options.position,I=this.options.placePosition,k=i.getFragmentList(),O=0;O<s.length;O++){var A=s[O];if(f(A)){var M;w?function(){var t=new THREE.Vector3(0,0,1);new vt.VertexBufferBuilder(!1),M=[],A.dbIds.forEach((function(e){var n=u[e],i=(n.min.z+n.max.z)/2;"min"==T?i=n.min.z:"max"==T&&(i=n.max.z);var r=n[I].z,o=new THREE.Plane(t,-i),s=S.makePlaneBasis(o);a.enumNodeFragments(e,(function(t){var e=k.getVizmesh(t);e.geometry&&!e.geometry.is2d&&!e.geometry.isLines&&e.material.cutplanes&&S.xMeshPlane(o,e,M)}));var h=new THREE.Box3;S.convertToPlaneCoords(s,M,h);var c=new S.EdgeSet(M,h,1e-6*h.size().length());c.snapEdges(),c.sanitizeEdges(),c.stitchContours();var l=c.triangulate();if(l&&!l.triangulationFailed){for(var f=l.toPolygonMesh(),d=E.length/3,m=f.attributes.position.array,w=0,b=m.length;w<b;w+=3)E.push(m[w],m[w+1],r),x.push((m[w]-p)/g,(m[w+1]-v)/y);for(var _=f.attributes.index.array,O=0,A=_.length;O<A;O++)R.push(_[O]+d)}}))}():A.dbIds.forEach((function(t){var e=u[t];if(!e.empty()){var n=e.min,i=e.max,r=e[T],o=E.length/3;R.push(o,o+2,o+1,o,o+3,o+2),E.push(n.x,n.y,r.z,n.x,i.y,r.z,i.x,i.y,r.z,i.x,n.y,r.z),x.push((n.x-p)/g,(n.y-v)/y,(n.x-p)/g,(i.y-v)/y,(i.x-p)/g,(i.y-v)/y,(i.x-p)/g,(n.y-v)/y)}}));var C,D=lt(A.shadingPoints);try{for(D.s();!(C=D.n()).done;){var P=C.value,j={x:Math.round((P.position.x-p)/g*b),y:Math.round((P.position.y-v)/y*_),value:0};c[P.id]={data:j,shadingPoint:P},l.push(j)}}catch(t){D.e(t)}finally{D.f()}}}E=new Float32Array(E),x=new Float32Array(x),R=new Uint16Array(R);var N=new THREE.BufferGeometry,V=new THREE.BufferAttribute(E,3);V.bytesPerItem=4;var L=new THREE.BufferAttribute(x,2);L.bytesPerItem=4;var U=new THREE.BufferAttribute(R,1);N.addAttribute("index",U),N.addAttribute("position",V),N.addAttribute("uv",L),this.geometry=N;var H=this.viewer.impl;H.createOverlayScene("DataVizPlanarHeatmap");var B=new THREE.Mesh(N,this.material);H.addOverlay("DataVizPlanarHeatmap",B),this.totalBounds=o,this.pointDataMap=c,this.pointData=l,this.currentSensorType=e}},{key:"render",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200;this.geometry&&(this.geometry.dispose(),this.geometry=null),t=t instanceof Array?t:[t],this._setup(t,e,i),this.updateShading(n)}},{key:"updateShading",value:function(t){for(var e in this.pointDataMap){var n=this.pointDataMap[e];n.data.value=t(n.shadingPoint,this.currentSensorType,n.data)}var i={data:this.pointData,min:0,max:1};this.heatmapInstance.setData(i),this.material.map.needsUpdate=!0,this.viewer.impl.invalidate(!1,!1,!0)}},{key:"cleanUp",value:function(){this.removeShading(),this.geometry&&(this.geometry.dispose(),this.geometry=null),this.material&&(this.material.dispose(),this.material=null)}},{key:"removeShading",value:function(){this.viewer.impl.removeOverlayScene("DataVizPlanarHeatmap"),this.viewer.impl.invalidate(!1,!1,!0)}},{key:"registerSensorColors",value:function(t,e){for(var n,i,r,o={},a=e.length-1,s=0;s<e.length;s++)o[s/a]=(n=e[s],i=void 0,r=void 0,i=255&n,r=n>>8&255,"rgb(".concat(n>>16&255,", ").concat(r,", ").concat(i,")"));this.gradientMap[t]=o}}])&&pt(e.prototype,n),i&&pt(e,i),t}();function yt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var mt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewer=e,this._textures={},this._colors={},this._excluded=["__defaultMaterial__","__fadeMaterial__","__highlightMaterial__"]}var e,n,i;return e=t,(n=[{key:"show",value:function(){return this.hideTextures(),this.regen(),!0}},{key:"hide",value:function(){return this.showTextures(),this.regen(),!0}},{key:"regen",value:function(){this.viewer.refresh(!0)}},{key:"hideTextures",value:function(){var t=0===Object.keys(this._textures).length,e=new THREE.Color(1,1,1),n=this.viewer.impl.matman()._materials;for(var i in n)if(-1===this._excluded.indexOf(i)){var r=n[i];t&&(this._textures[i]=r.map,this._colors[i]=r.color),r.map=null,r.color=e,r.needsUpdate=!0}this.regen()}},{key:"showTextures",value:function(){if(Object.keys(this._textures).length>0){var t=this.viewer.impl.matman()._materials;for(var e in t)if(-1===this._excluded.indexOf(e)){var n=t[e],i=this._textures[e];i&&(n.map=i);var r=this._colors[e];r&&(n.color=r),n.needsUpdate=!0}}this.regen()}}])&&yt(e.prototype,n),i&&yt(e,i),t}();function wt(t){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bt(t,e,n,i,r,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(i,r)}function _t(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){bt(o,i,r,a,s,"next",t)}function s(t){bt(o,i,r,a,s,"throw",t)}a(void 0)}))}}function Et(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Rt(t,e){return(Rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function St(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=It(t);if(e){var r=It(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Tt(this,n)}}function Tt(t,e){return!e||"object"!==wt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function It(t){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kt="Autodesk.DataVisualization",Ot=AutodeskNamespace("Autodesk.DataVisualization.Core");Ot=Object.assign(Ot,i),Ot=Object.assign(Ot,o.a),(Ot=Object.assign(Ot,B)).LevelRoomsMap=X,Ot.ModelStructureInfo=$,Ot.SurfaceShading=ut,Ot.PlanarHeatmap=gt;var At=Autodesk.Viewing,Mt=At.Private,Ct=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rt(t,e)}(s,t);var e,n,i,r,o,a=St(s);function s(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Et(this,s),(e=a.call(this,t,n)).textureUtility=new mt(t);var i="IN ADDITION TO THE FORGE TERMS (INCLUDING WITHOUT LIMITATION, THOSE PERTAINING TO BETA SERVICES), THE FOLLOWING TERMS APPLY TO YOUR USE OF THESE PRIVATE TECH PREVIEW APIS:\nYOU HEREBY ACKNOWLEDGE AND AGREE THAT: (1) THESE PRIVATE TECH PREVIEW APIS (a) HAVE NOT BEEN FULLY TESTED AND MAY CONTAIN DEFECTS OR DEFICIENCIES THAT MAY OR MAY NOT BE CORRECTED BY AUTODESK, AND (b) ARE STILL IN DEVELOPMENT AND CONTINUOUSLY UPDATED, AND MAY UNDERGO SIGNIFICANT CHANGES PRIOR TO RELEASE OF THE CORRESPONDING GENERALLY AVAILABLE VERSION, WHICH VERSION MAY CONTAIN NONE, SOME OR ALL OF THE FEATURES OR FUNCTIONALITY THAT ARE CONTAINED IN THESE PRIVATE TECH PREVIEW APIS, AND (2) YOUR ACCESS TO AND/OR USE OF THESE PRIVATE TECH PREVIEW APIS AND ANY MATERIALS DERIVED THEREFROM (INCLUDING WITHOUT LIMITATION, REFERENCE APPLICATIONS) IS AT YOUR SOLE RISK AND NEITHER AUTODESK NOR ITS SUPPLIERS WILL BE LIABLE FOR ANY DAMAGES WHATSOEVER ARISING FROM OR RELATING TO YOUR USE OR INABILITY TO USE THESE PRIVATE TECH PREVIEW APIS OR DERIVATIVE MATERIALS. NOTWITHSTANDING THE FOREGOING, AUTODESK WILL HAVE NO OBLIGATION TO RELEASE OR MAKE AVAILABLE ANY PRODUCT OR ANY SERVICE BASED ON THESE PRIVATE TECH PREVIEW APIS AND/OR DERIVATIVE MATERIALS.";return!0!==n.useInternal?alert(i):console.warn(i),e}return e=s,(n=[{key:"load",value:(o=_t(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.tool=new v(this.viewer,{delegate:this}),this.viewer.toolController.registerTool(this.tool),this.activate(),this.datavizDotOverlay=this.viewer.impl.createOverlayScene("DataVizDots",null,null,null,!0,!0),this.deviceDepthOcclusion=!1,t.abrupt("return",!0);case 7:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"unload",value:function(){return this.viewer.toolController.deregisterTool(this.tool),this.removeSurfaceShading(),this.surfaceShading=null,this.deactivate(),!0}},{key:"activate",value:function(){return this.viewer.toolController.activateTool(this.tool.getName()),!0}},{key:"deactivate",value:function(){return this.viewer.toolController.deactivateTool(this.tool.getName()),this.removeSurfaceShading(),this.showTextures(),!0}},{key:"addViewables",value:function(t){var e=this,n=THREE.ImageUtils.loadTexture(t.spriteAtlas.canvas.toDataURL());n.minFilter=THREE.LinearFilter,n.maxFilter=THREE.LinearFilter,n.flipY=!1;var i=new THREE.PointCloudMaterial({size:t.spriteSize*this.getWindow().devicePixelRatio,map:n,vertexColors:THREE.VertexColors,alphaTest:.5,transparent:!0,occlusion:1,depthTest:!0,depthWrite:!0});i.skipMrtNormals=!0;var r=this.viewer.impl.renderer().getDepthTarget();r&&(i.uniforms={tDepthTest:{type:"t",value:r},tDepthResolution:{type:"v2",value:new THREE.Vector2(1/r.width,1/r.height)}}),i.defines=Object.assign(i.defines||{},{PARTICLE_FRAGMENT:1,USE_VERTEX_ID:1,DEPTH_OCCLUSION:this.deviceDepthOcclusion?1:0,PARTICLE_UV:1,PARTICLE_FLAGS:""});var o=this.viewer.impl;o.matman().addMaterial("point1",i,!0),this.pointMaterial=i,this.pointFragments=[],this.pointMeshes=[],this.viewableData=t,this.viewableData=t,this.dbId2Geometry={},this.viewer.addEventListener(At.VIEWER_RESIZE_EVENT,(function(){var t=e.viewer.impl.renderer().getDepthTarget();t&&(i.uniforms.tDepthTest.value=t,i.uniforms.tDepthResolution.value.set(1/t.width,1/t.height))}));var a=this,s=new g.SpriteMeshBuilder((function(t){t.dbIds.forEach((function(e){a.dbId2Geometry[e]=t}));var e=new THREE.Mesh(t,i);o.addOverlay("DataVizDots",e),a.pointMeshes.push(e),setTimeout((function(){o.invalidate(!1,!1,!0)}),16)}));t.viewables.map((function(e){e.position&&s.addPoint(e,t.spriteAtlas)})),s.flushBuffer()}},{key:"removeAllViewables",value:function(){if(this.pointMeshes&&this.pointMeshes.length>0){var t=this.viewer.impl;this.pointMeshes.forEach((function(e){t.removeOverlay("DataVizDots",e),e.geometry.dispose(),e.material.dispose()})),this.pointMeshes.length=0,t.invalidate(!1,!1,!0)}this.pointFragments=[]}},{key:"changeOcclusion",value:function(t){if(this.deviceDepthOcclusion!=t){this.deviceDepthOcclusion=t;var e=t?1:0;this.pointMaterial&&this.pointMaterial.program&&(this.pointMaterial.defines.DEPTH_OCCLUSION=e,this.pointMaterial.needsUpdate=!0),this.viewer.impl.invalidate(!1,!1,!0)}}},{key:"showHideViewables",value:function(t,e){this.changeOcclusion(e),this.pointMaterial.visible=t,this.pointMaterial.needsUpdate=!0,this.viewer.impl.invalidate(!1,!1,!0)}},{key:"highlightViewables",value:function(t){this.tool&&this.tool.markObject(t)}},{key:"clearHighlightedViewables",value:function(){this.tool&&this.tool.clearMarkedObject()}},{key:"invalidateViewables",value:function(t,e){this.tool&&this.tool.invalidateViewablesDirect(t,this.pointMeshes,this.viewableData,e)}},{key:"showTextures",value:function(){this.textureUtility.showTextures()}},{key:"hideTextures",value:function(){this.textureUtility.hideTextures()}},{key:"setupSurfaceShading",value:(r=_t(regeneratorRuntime.mark((function t(e,n){var i,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r.length>2&&void 0!==r[2]?r[2]:{},this.surfaceShading&&this.surfaceShading.cleanUp(),"PlanarHeatmap"!=i.type){t.next=8;break}return t.next=5,this.viewer.loadExtension("Autodesk.CompGeom");case 5:this.surfaceShading=new gt(this.viewer,e,n,i),t.next=9;break;case 8:this.surfaceShading=new ut(this.viewer,e,n);case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})},{key:"renderSurfaceShading",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:160;this.surfaceShading?this.surfaceShading.render(t,e,n,i):Mt.logger.error("Please call setupSurfaceShading first")}},{key:"updateSurfaceShading",value:function(t){this.surfaceShading?this.surfaceShading.updateShading(t):Mt.logger.error("Please call setupSurfaceShading first")}},{key:"registerSurfaceShadingColors",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.7;this.surfaceShading?this.surfaceShading.registerSensorColors(t,e,n):Mt.logger.error("Please call setupSurfaceShading first")}},{key:"removeSurfaceShading",value:function(){this.surfaceShading&&this.surfaceShading.removeShading()}}])&&xt(e.prototype,n),i&&xt(e,i),s}(At.Extension);At.theExtensionManager.registerExtension(kt,Ct)},81:function(t,e,n){(function(e,n){
/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(e){"use strict";"function"==typeof bootstrap?bootstrap("promise",e):t.exports=e()}((function(){"use strict";var t=!1;try{throw new Error}catch(e){t=!!e.stack}var i,r=E(),o=function(){},a=function(){var t={task:void 0,next:null},i=t,r=!1,o=void 0,s=!1,u=[];function h(){for(var e,n;t.next;)e=(t=t.next).task,t.task=void 0,(n=t.domain)&&(t.domain=void 0,n.enter()),c(e,n);for(;u.length;)c(e=u.pop());r=!1}function c(t,e){try{t()}catch(t){if(s)throw e&&e.exit(),setTimeout(h,0),e&&e.enter(),t;setTimeout((function(){throw t}),0)}e&&e.exit()}if(a=function(t){i=i.next={task:t,domain:s&&e.domain,next:null},r||(r=!0,o())},"object"==typeof e&&"[object process]"===e.toString()&&e.nextTick)s=!0,o=function(){e.nextTick(h)};else if("function"==typeof n)o="undefined"!=typeof window?n.bind(window,h):function(){n(h)};else if("undefined"!=typeof MessageChannel){var l=new MessageChannel;l.port1.onmessage=function(){o=f,l.port1.onmessage=h,h()};var f=function(){l.port2.postMessage(0)};o=function(){setTimeout(h,0),f()}}else o=function(){setTimeout(h,0)};return a.runAfter=function(t){u.push(t),r||(r=!0,o())},a}(),s=Function.call;function u(t){return function(){return s.apply(t,arguments)}}var h,c=u(Array.prototype.slice),l=u(Array.prototype.reduce||function(t,e){var n=0,i=this.length;if(1===arguments.length)for(;;){if(n in this){e=this[n++];break}if(++n>=i)throw new TypeError}for(;n<i;n++)n in this&&(e=t(e,this[n],n));return e}),f=u(Array.prototype.indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),d=u(Array.prototype.map||function(t,e){var n=this,i=[];return l(n,(function(r,o,a){i.push(t.call(e,o,a,n))}),void 0),i}),p=Object.create||function(t){function e(){}return e.prototype=t,new e},v=u(Object.prototype.hasOwnProperty),g=Object.keys||function(t){var e=[];for(var n in t)v(t,n)&&e.push(n);return e},y=u(Object.prototype.toString);function m(t){return"[object StopIteration]"===y(t)||t instanceof h}h="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};function w(e,n){if(t&&n.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf("From previous event:")){for(var i=[],r=n;r;r=r.source)r.stack&&i.unshift(r.stack);i.unshift(e.stack);var o=i.join("\nFrom previous event:\n");e.stack=function(t){for(var e=t.split("\n"),n=[],i=0;i<e.length;++i){var r=e[i];!_(r)&&(-1===(o=r).indexOf("(module.js:")&&-1===o.indexOf("(node.js:"))&&r&&n.push(r)}var o;return n.join("\n")}(o)}}function b(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var i=/.*@(.+):(\d+)$/.exec(t);return i?[i[1],Number(i[2])]:void 0}function _(t){var e=b(t);if(!e)return!1;var n=e[0],o=e[1];return n===i&&o>=r&&o<=K}function E(){if(t)try{throw new Error}catch(t){var e=t.stack.split("\n"),n=b(e[0].indexOf("@")>0?e[1]:e[2]);if(!n)return;return i=n[0],n[1]}}function x(t){return t instanceof I?t:M(t)?function(t){var e=R();return x.nextTick((function(){try{t.then(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}})),e.promise}(t):B(t)}function R(){var e,n=[],i=[],r=p(R.prototype),o=p(I.prototype);if(o.promiseDispatch=function(t,r,o){var a=c(arguments);n?(n.push(a),"when"===r&&o[1]&&i.push(o[1])):x.nextTick((function(){e.promiseDispatch.apply(e,a)}))},o.valueOf=function(){if(n)return o;var t=O(e);return A(t)&&(e=t),t},o.inspect=function(){return e?e.inspect():{state:"pending"}},x.longStackSupport&&t)try{throw new Error}catch(t){o.stack=t.stack.substring(t.stack.indexOf("\n")+1)}function a(t){e=t,o.source=t,l(n,(function(e,n){x.nextTick((function(){t.promiseDispatch.apply(t,n)}))}),void 0),n=void 0,i=void 0}return r.promise=o,r.resolve=function(t){e||a(x(t))},r.fulfill=function(t){e||a(B(t))},r.reject=function(t){e||a(H(t))},r.notify=function(t){e||l(i,(function(e,n){x.nextTick((function(){n(t)}))}),void 0)},r}function S(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=R();try{t(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}return e.promise}function T(t){return S((function(e,n){for(var i=0,r=t.length;i<r;i++)x(t[i]).then(e,n)}))}function I(t,e,n){void 0===e&&(e=function(t){return H(new Error("Promise does not support operation: "+t))}),void 0===n&&(n=function(){return{state:"unknown"}});var i=p(I.prototype);if(i.promiseDispatch=function(n,r,o){var a;try{a=t[r]?t[r].apply(i,o):e.call(i,r,o)}catch(t){a=H(t)}n&&n(a)},i.inspect=n,n){var r=n();"rejected"===r.state&&(i.exception=r.reason),i.valueOf=function(){var t=n();return"pending"===t.state||"rejected"===t.state?i:t.value}}return i}function k(t,e,n,i){return x(t).then(e,n,i)}function O(t){if(A(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function A(t){return t instanceof I}function M(t){return(e=t)===Object(e)&&"function"==typeof t.then;var e}x.resolve=x,x.nextTick=a,x.longStackSupport=!1,"object"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(x.longStackSupport=!0),x.defer=R,R.prototype.makeNodeResolver=function(){var t=this;return function(e,n){e?t.reject(e):arguments.length>2?t.resolve(c(arguments,1)):t.resolve(n)}},x.Promise=S,x.promise=S,S.race=T,S.all=z,S.reject=H,S.resolve=x,x.passByCopy=function(t){return t},I.prototype.passByCopy=function(){return this},x.join=function(t,e){return x(t).join(e)},I.prototype.join=function(t){return x([this,t]).spread((function(t,e){if(t===e)return t;throw new Error("Can't join: not the same: "+t+" "+e)}))},x.race=T,I.prototype.race=function(){return this.then(x.race)},x.makePromise=I,I.prototype.toString=function(){return"[object Promise]"},I.prototype.then=function(t,e,n){var i=this,r=R(),o=!1;return x.nextTick((function(){i.promiseDispatch((function(e){o||(o=!0,r.resolve(function(e){try{return"function"==typeof t?t(e):e}catch(t){return H(t)}}(e)))}),"when",[function(t){o||(o=!0,r.resolve(function(t){if("function"==typeof e){w(t,i);try{return e(t)}catch(t){return H(t)}}return H(t)}(t)))}])})),i.promiseDispatch(void 0,"when",[void 0,function(t){var e,i=!1;try{e=function(t){return"function"==typeof n?n(t):t}(t)}catch(t){if(i=!0,!x.onerror)throw t;x.onerror(t)}i||r.notify(e)}]),r.promise},x.tap=function(t,e){return x(t).tap(e)},I.prototype.tap=function(t){return t=x(t),this.then((function(e){return t.fcall(e).thenResolve(e)}))},x.when=k,I.prototype.thenResolve=function(t){return this.then((function(){return t}))},x.thenResolve=function(t,e){return x(t).thenResolve(e)},I.prototype.thenReject=function(t){return this.then((function(){throw t}))},x.thenReject=function(t,e){return x(t).thenReject(e)},x.nearer=O,x.isPromise=A,x.isPromiseAlike=M,x.isPending=function(t){return A(t)&&"pending"===t.inspect().state},I.prototype.isPending=function(){return"pending"===this.inspect().state},x.isFulfilled=function(t){return!A(t)||"fulfilled"===t.inspect().state},I.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},x.isRejected=function(t){return A(t)&&"rejected"===t.inspect().state},I.prototype.isRejected=function(){return"rejected"===this.inspect().state};var C,D,P,j=[],N=[],V=[],L=!0;function U(){j.length=0,N.length=0,L||(L=!0)}function H(t){var n=I({when:function(n){return n&&function(t){if(L){var n=f(N,t);-1!==n&&("object"==typeof e&&"function"==typeof e.emit&&x.nextTick.runAfter((function(){var i=f(V,t);-1!==i&&(e.emit("rejectionHandled",j[n],t),V.splice(i,1))})),N.splice(n,1),j.splice(n,1))}}(this),n?n(t):this}},(function(){return this}),(function(){return{state:"rejected",reason:t}}));return function(t,n){L&&("object"==typeof e&&"function"==typeof e.emit&&x.nextTick.runAfter((function(){-1!==f(N,t)&&(e.emit("unhandledRejection",n,t),V.push(t))})),N.push(t),n&&void 0!==n.stack?j.push(n.stack):j.push("(no stack) "+n))}(n,t),n}function B(t){return I({when:function(){return t},get:function(e){return t[e]},set:function(e,n){t[e]=n},delete:function(e){delete t[e]},post:function(e,n){return null==e?t.apply(void 0,n):t[e].apply(t,n)},apply:function(e,n){return t.apply(e,n)},keys:function(){return g(t)}},void 0,(function(){return{state:"fulfilled",value:t}}))}function G(t,e,n){return x(t).spread(e,n)}function F(t,e,n){return x(t).dispatch(e,n)}function z(t){return k(t,(function(t){var e=0,n=R();return l(t,(function(i,r,o){var a;A(r)&&"fulfilled"===(a=r.inspect()).state?t[o]=a.value:(++e,k(r,(function(i){t[o]=i,0==--e&&n.resolve(t)}),n.reject,(function(t){n.notify({index:o,value:t})})))}),void 0),0===e&&n.resolve(t),n.promise}))}function W(t){if(0===t.length)return x.resolve();var e=x.defer(),n=0;return l(t,(function(i,r,o){var a=t[o];n++,k(a,(function(t){e.resolve(t)}),(function(){0===--n&&e.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}),(function(t){e.notify({index:o,value:t})}))}),void 0),e.promise}function Y(t){return k(t,(function(t){return t=d(t,x),k(z(d(t,(function(t){return k(t,o,o)}))),(function(){return t}))}))}x.resetUnhandledRejections=U,x.getUnhandledReasons=function(){return j.slice()},x.stopUnhandledRejectionTracking=function(){U(),L=!1},U(),x.reject=H,x.fulfill=B,x.master=function(t){return I({isDef:function(){}},(function(e,n){return F(t,e,n)}),(function(){return x(t).inspect()}))},x.spread=G,I.prototype.spread=function(t,e){return this.all().then((function(e){return t.apply(void 0,e)}),e)},x.async=function(t){return function(){function e(t,e){var o;if("undefined"==typeof StopIteration){try{o=n[t](e)}catch(t){return H(t)}return o.done?x(o.value):k(o.value,i,r)}try{o=n[t](e)}catch(t){return m(t)?x(t.value):H(t)}return k(o,i,r)}var n=t.apply(this,arguments),i=e.bind(e,"next"),r=e.bind(e,"throw");return i()}},x.spawn=function(t){x.done(x.async(t)())},x.return=function(t){throw new h(t)},x.promised=function(t){return function(){return G([this,z(arguments)],(function(e,n){return t.apply(e,n)}))}},x.dispatch=F,I.prototype.dispatch=function(t,e){var n=this,i=R();return x.nextTick((function(){n.promiseDispatch(i.resolve,t,e)})),i.promise},x.get=function(t,e){return x(t).dispatch("get",[e])},I.prototype.get=function(t){return this.dispatch("get",[t])},x.set=function(t,e,n){return x(t).dispatch("set",[e,n])},I.prototype.set=function(t,e){return this.dispatch("set",[t,e])},x.del=x.delete=function(t,e){return x(t).dispatch("delete",[e])},I.prototype.del=I.prototype.delete=function(t){return this.dispatch("delete",[t])},x.mapply=x.post=function(t,e,n){return x(t).dispatch("post",[e,n])},I.prototype.mapply=I.prototype.post=function(t,e){return this.dispatch("post",[t,e])},x.send=x.mcall=x.invoke=function(t,e){return x(t).dispatch("post",[e,c(arguments,2)])},I.prototype.send=I.prototype.mcall=I.prototype.invoke=function(t){return this.dispatch("post",[t,c(arguments,1)])},x.fapply=function(t,e){return x(t).dispatch("apply",[void 0,e])},I.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},x.try=x.fcall=function(t){return x(t).dispatch("apply",[void 0,c(arguments,1)])},I.prototype.fcall=function(){return this.dispatch("apply",[void 0,c(arguments)])},x.fbind=function(t){var e=x(t),n=c(arguments,1);return function(){return e.dispatch("apply",[this,n.concat(c(arguments))])}},I.prototype.fbind=function(){var t=this,e=c(arguments);return function(){return t.dispatch("apply",[this,e.concat(c(arguments))])}},x.keys=function(t){return x(t).dispatch("keys",[])},I.prototype.keys=function(){return this.dispatch("keys",[])},x.all=z,I.prototype.all=function(){return z(this)},x.any=W,I.prototype.any=function(){return W(this)},x.allResolved=(C=Y,D="allResolved",P="allSettled",function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(D+" is deprecated, use "+P+" instead.",new Error("").stack),C.apply(C,arguments)}),I.prototype.allResolved=function(){return Y(this)},x.allSettled=function(t){return x(t).allSettled()},I.prototype.allSettled=function(){return this.then((function(t){return z(d(t,(function(t){function e(){return t.inspect()}return(t=x(t)).then(e,e)})))}))},x.fail=x.catch=function(t,e){return x(t).then(void 0,e)},I.prototype.fail=I.prototype.catch=function(t){return this.then(void 0,t)},x.progress=function(t,e){return x(t).then(void 0,void 0,e)},I.prototype.progress=function(t){return this.then(void 0,void 0,t)},x.fin=x.finally=function(t,e){return x(t).finally(e)},I.prototype.fin=I.prototype.finally=function(t){return t=x(t),this.then((function(e){return t.fcall().then((function(){return e}))}),(function(e){return t.fcall().then((function(){throw e}))}))},x.done=function(t,e,n,i){return x(t).done(e,n,i)},I.prototype.done=function(t,n,i){var r=function(t){x.nextTick((function(){if(w(t,o),!x.onerror)throw t;x.onerror(t)}))},o=t||n||i?this.then(t,n,i):this;"object"==typeof e&&e&&e.domain&&(r=e.domain.bind(r)),o.then(void 0,r)},x.timeout=function(t,e,n){return x(t).timeout(e,n)},I.prototype.timeout=function(t,e){var n=R(),i=setTimeout((function(){e&&"string"!=typeof e||((e=new Error(e||"Timed out after "+t+" ms")).code="ETIMEDOUT"),n.reject(e)}),t);return this.then((function(t){clearTimeout(i),n.resolve(t)}),(function(t){clearTimeout(i),n.reject(t)}),n.notify),n.promise},x.delay=function(t,e){return void 0===e&&(e=t,t=void 0),x(t).delay(e)},I.prototype.delay=function(t){return this.then((function(e){var n=R();return setTimeout((function(){n.resolve(e)}),t),n.promise}))},x.nfapply=function(t,e){return x(t).nfapply(e)},I.prototype.nfapply=function(t){var e=R(),n=c(t);return n.push(e.makeNodeResolver()),this.fapply(n).fail(e.reject),e.promise},x.nfcall=function(t){var e=c(arguments,1);return x(t).nfapply(e)},I.prototype.nfcall=function(){var t=c(arguments),e=R();return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},x.nfbind=x.denodeify=function(t){var e=c(arguments,1);return function(){var n=e.concat(c(arguments)),i=R();return n.push(i.makeNodeResolver()),x(t).fapply(n).fail(i.reject),i.promise}},I.prototype.nfbind=I.prototype.denodeify=function(){var t=c(arguments);return t.unshift(this),x.denodeify.apply(void 0,t)},x.nbind=function(t,e){var n=c(arguments,2);return function(){var i=n.concat(c(arguments)),r=R();function o(){return t.apply(e,arguments)}return i.push(r.makeNodeResolver()),x(o).fapply(i).fail(r.reject),r.promise}},I.prototype.nbind=function(){var t=c(arguments,0);return t.unshift(this),x.nbind.apply(void 0,t)},x.nmapply=x.npost=function(t,e,n){return x(t).npost(e,n)},I.prototype.nmapply=I.prototype.npost=function(t,e){var n=c(e||[]),i=R();return n.push(i.makeNodeResolver()),this.dispatch("post",[t,n]).fail(i.reject),i.promise},x.nsend=x.nmcall=x.ninvoke=function(t,e){var n=c(arguments,2),i=R();return n.push(i.makeNodeResolver()),x(t).dispatch("post",[e,n]).fail(i.reject),i.promise},I.prototype.nsend=I.prototype.nmcall=I.prototype.ninvoke=function(t){var e=c(arguments,1),n=R();return e.push(n.makeNodeResolver()),this.dispatch("post",[t,e]).fail(n.reject),n.promise},x.nodeify=function(t,e){return x(t).nodeify(e)},I.prototype.nodeify=function(t){if(!t)return this;this.then((function(e){x.nextTick((function(){t(null,e)}))}),(function(e){x.nextTick((function(){t(e)}))}))},x.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var K=E();return x}))}).call(this,n(54),n(646).setImmediate)}});
//# sourceMappingURL=DataVisualization.min.js.map
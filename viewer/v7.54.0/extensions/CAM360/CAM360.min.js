/*! For license information please see CAM360.min.js.LICENSE.txt */
(()=>{var e={d:(t,o)=>{for(var i in o)e.o(o,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:o[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t),e.d(t,{CAM360Extension:()=>s});var o=Autodesk.Viewing.Extensions;function i(e,t,i){o.ViewerModelStructurePanel.call(this,e,t,i),this.viewer=e,this.delegate=null,this.instanceTree=null,this.model=null,this.camNodes=[],this.camModelNodes=[],this.camSetupNodes=[],this.camStockNodes=[],this.camOperationNodes=[],this.camToolNodes=[],this.camFolderNodes=[]}function s(e,t){Autodesk.Viewing.Extension.call(this,e,t),this.name="cam360"}i.prototype=Object.create(o.ViewerModelStructurePanel.prototype),i.prototype.constructor=i,i.prototype.sortCamNodes=function(e,t){var o=this,i=[];e.enumNodeChildren(e.getRootId(),(function(e){i.push(e)}),!0),i.shift(),function e(){var s,n;i.length>0?(s=i.shift(),n=e,o.viewer.getProperties(s,(function(e){var t=function(e,t){for(var o=0;o<e.length;++o){var i=e[o];if("9429B915-D020-4CEB-971B-6ADD0A5D4BFA"===i.displayName)return i.displayValue}return null}(e.properties);t?("CAM_Setup"==t?o.camSetupNodes.push(s):"CAM_Operation"==t?o.camOperationNodes.push(s):"CAM_Tool"===t?o.camToolNodes.push(s):"CAM_Stock"===t?o.camStockNodes.push(s):"CAM_Folder"==t&&o.camFolderNodes.push(s),o.camNodes.push(s)):o.camModelNodes.push(s),n()}),(function(e,t,o){n()}))):t()}()},i.prototype.addModel=function(e){this.model=e,this.setVisible(!0),o.ViewerModelStructurePanel.prototype.addModel.call(this,e)},i.prototype.setInstanceTree=function(e,t){if(o.ViewerModelStructurePanel.prototype.setInstanceTree.call(this,e,t),t){this.delegate=e,this.instanceTree=t;var i=this;i.sortCamNodes(t,(function(){i.SetCAMNodeVisible(!1),i.setVisible(!0),i.ExpandSetupNodes(),i.resizeToContent()}))}},i.prototype.initialize=function(){o.ViewerModelStructurePanel.prototype.initialize.call(this);var e=this;this.viewer.model&&this.viewer.model.isLoadDone()||e.addEventListener(e.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,(function t(o){e.SetCAMNodeVisible(!1),e.removeEventListener(e.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,t)})),e.addEventListener(e.viewer,Autodesk.Viewing.SHOW_EVENT,(function(t){var o=t.nodeIdArray;if(o)for(var i=0;i<o.length;i++)e.setCamNodeVisibility(o[i])})),e.addEventListener(e.viewer,Autodesk.Viewing.SELECTION_CHANGED_EVENT,(function(t){var o=t.nodeArray;if(o)for(var i=0;i<o.length;i++)e.HideHightlightCAMNode(o[i])})),e.addEventListener(e.viewer,Autodesk.Viewing.ISOLATE_EVENT,(function(t){var o=t.nodeIdArray;if(o)if(0==o.length)e.SetModelVisible(),e.SetCAMNodeVisible(!0);else for(var i=0;i<o.length;i++)e.setCamNodeVisibility(o[i])}))},i.prototype.IsCAMNode=function(e){return-1!==this.camNodes.indexOf(e)},i.prototype.IsCAMSetupNode=function(e){return-1!==this.camSetupNodes.indexOf(e)},i.prototype.IsCAMStockNode=function(e){return-1!==this.camStockNodes.indexOf(e)},i.prototype.IsCAMToolNode=function(e){return-1!==this.camToolNodes.indexOf(e)},i.prototype.IsCAMOperationNode=function(e){return-1!==this.camOperationNodes.indexOf(e)},i.prototype.IsCAMFolderNode=function(e){return-1!==this.camFolderNodes.indexOf(e)},i.prototype.shouldInclude=function(e){return!this.IsCAMStockNode(e)},i.prototype.isGroupNode=function(e){return!this.IsCAMOperationNode(e)&&o.ViewerModelStructurePanel.prototype.isGroupNode.call(this,e)},i.prototype.setNodeVisibility=function(e,t){t?this.viewer.show(e):this.viewer.hide(e)},i.prototype.SetModelVisible=function(){if(this.camModelNodes)for(var e=0;e<this.camModelNodes.length;e++)this.setNodeVisibility(this.camModelNodes[e],!0)},i.prototype.SetCAMNodeVisible=function(e){if(this.camNodes){for(var t=0;t<this.camNodes.length;t++)this.setNodeVisibility(this.camNodes[t],e);this.SetToolNodeVisible(!1)}},i.prototype.SetToolNodeVisible=function(e){if(this.camToolNodes)for(var t=0;t<this.camToolNodes.length;t++)this.setNodeVisibility(this.camToolNodes[t],e)},i.prototype.HideHightlightNode=function(e){var t=this.viewer.impl,o=this;o.instanceTree.enumNodeFragments(e,(function(e){t.highlightFragment(o.model,e,!1,!0)}),!0)},i.prototype.HideHightlightCAMNode=function(e){var t=this.IsCAMSetupNode(e),o=this.IsCAMOperationNode(e),i=this.IsCAMFolderNode(e),s=this;s.instanceTree.enumNodeChildren(e,(function(e){t?s.IsCAMStockNode(e)||s.HideHightlightNode(e):o?s.IsCAMToolNode(e)&&s.HideHightlightNode(e):i&&s.HideHightlightNode(e)}),!1)},i.prototype.setCamNodeVisibility=function(e){var t=this.IsCAMSetupNode(e),o=this.IsCAMOperationNode(e),i=this.IsCAMFolderNode(e),s=this;t?this.instanceTree.enumNodeChildren(e,(function(e){var t=s.IsCAMStockNode(e);s.setNodeVisibility(e,t)})):o?this.instanceTree.enumNodeChildren(e,(function(e){s.IsCAMToolNode(e)&&s.setNodeVisibility(e,!1)})):i&&this.instanceTree.enumNodeChildren(e,(function(e){s.setNodeVisibility(e,!1)}))},i.prototype.onClick=function(e,t){o.ViewerModelStructurePanel.prototype.onClick.call(this,e,t),this.SetModelVisible(),this.setCamNodeVisibility(e),this.viewer.fitToView()},i.prototype.ExpandSetupNodes=function(){if(this.camSetupNodes)for(var e=0;e<this.camSetupNodes.length;e++)this.tree.setCollapsed(this.delegate,this.camSetupNodes[e],!1)},s.prototype=Object.create(Autodesk.Viewing.Extension.prototype),s.prototype.constructor=s,s.prototype.load=function(){var e=this.viewer,t=new i(this.viewer,"CAM Model Structure Loading",{});return this.viewer.getExtension("Autodesk.ModelStructure").setModelStructurePanel(t),e.hideLines(!1),e.setGhosting(!1),e.setQualityLevel(!1,!0),e.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,(function t(){e.impl.setLightPreset(0,!0),e.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,t)})),!0},s.prototype.unload=function(){this.viewer.getExtension("Autodesk.ModelStructure").restoreDefaultPanel()},s.prototype.activate=function(){return this.viewer.activateExtension("Autodesk.ModelStructure")},s.prototype.deactivate=function(){return this.viewer.deactivateExtension("Autodesk.ModelStructure")},s.prototype.isActive=function(){return this.viewer.isExtensionActive("Autodesk.ModelStructure")},Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.CAM360",s)})(),Autodesk.Extensions.CAM360=t})();
//# sourceMappingURL=CAM360.min.js.map
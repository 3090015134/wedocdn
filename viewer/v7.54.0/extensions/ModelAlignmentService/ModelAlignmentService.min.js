/*! For license information please see ModelAlignmentService.min.js.LICENSE.txt */
(()=>{var e={55877:(e,t,n)=>{var r=n(23570),o=n(71171),i=o;i.v1=r,i.v4=o,e.exports=i},45327:e=>{for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0,o=t;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},85217:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},23570:(e,t,n)=>{var r,o,i=n(85217),a=n(45327),u=0,s=0;e.exports=function(e,t,n){var c=t&&n||0,f=t||[],l=(e=e||{}).node||r,p=void 0!==e.clockseq?e.clockseq:o;if(null==l||null==p){var h=i();null==l&&(l=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==p&&(p=o=16383&(h[6]<<8|h[7]))}var v=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:s+1,d=v-u+(m-s)/1e4;if(d<0&&void 0===e.clockseq&&(p=p+1&16383),(d<0||v>u)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=v,s=m,o=p;var g=(1e4*(268435455&(v+=122192928e5))+m)%4294967296;f[c++]=g>>>24&255,f[c++]=g>>>16&255,f[c++]=g>>>8&255,f[c++]=255&g;var y=v/4294967296*1e4&268435455;f[c++]=y>>>8&255,f[c++]=255&y,f[c++]=y>>>24&15|16,f[c++]=y>>>16&255,f[c++]=p>>>8|128,f[c++]=255&p;for(var b=0;b<6;++b)f[c+b]=l[b];return t||a(f)}},71171:(e,t,n)=>{var r=n(85217),o=n(45327);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var u=0;u<16;++u)t[i+u]=a[u];return t||o(a)}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";function e(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(o,i){var a=t.apply(n,r);function u(t){e(a,o,i,u,s,"next",t)}function s(t){e(a,o,i,u,s,"throw",t)}u(void 0)}))}}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(r),n.d(r,{default:()=>Ue});var i=AutodeskNamespace("Autodesk.AlignmentService"),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r,i,a,u,s,c,f,l,p,h,v,m,d;return n=e,r=[{key:"isWorking",value:function(){return!0}},{key:"clearCache",value:function(){}},{key:"fetchItems",value:(d=t(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)})},{key:"loadTransform",value:(m=t(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)}))),function(e,t){return m.apply(this,arguments)})},{key:"getTransform",value:function(e,t){return null}},{key:"getIsLocked",value:function(e,t){return!1}},{key:"saveTransform",value:(v=t(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t,n){return v.apply(this,arguments)})},{key:"lockAlignment",value:(h=t(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},{key:"unlockAlignment",value:(p=t(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return p.apply(this,arguments)})},{key:"isAlignmentLocked",value:(l=t(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)})},{key:"saveRegion",value:(f=t(regeneratorRuntime.mark((function e(t,n,r,o,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o){return f.apply(this,arguments)})},{key:"loadRegion",value:(c=t(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"loadRegions",value:(s=t(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))),function(e,t){return s.apply(this,arguments)})},{key:"deleteRegion",value:(u=t(regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return u.apply(this,arguments)})},{key:"saveRelationship",value:(a=t(regeneratorRuntime.mark((function e(t,n,r,o,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o){return a.apply(this,arguments)})},{key:"getRelationships",value:(i=t(regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"deleteRelationship",value:function(e){}}],r&&o(n.prototype,r),e}();i.RelationshipEntityTypes={Model3D:"viewpart3d",Region:"viewpartregion2d"},i.RelationshipIdPrefix={Name:"viewablePart=",Region:"&region="};var u=n(55877);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,u,"next",e)}function u(e){c(i,r,o,a,u,"throw",e)}a(void 0)}))}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function v(e,t){return v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v(e,t)}function m(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var g=Autodesk.Viewing.Private,y="Autodesk.Viewing.ModelAlignment",b="transform",k="relationship",w="autodesk-construction-alignment",x="__",R=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return"".concat(y).concat(x).concat(e).concat(x).concat(t).concat(n.length?"".concat(x).concat(n):"")},I=function(e){return{transform:e?e.elements:null,isLocked:!1}},A=function(e,t,n){return"".concat(e,"?").concat(Autodesk.AlignmentService.RelationshipIdPrefix.Name).concat(t).concat(n?"".concat(Autodesk.AlignmentService.RelationshipIdPrefix.Region).concat(n):"")},P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(S,e);var t,n,r,o,i,a,s,c,p,y,x,P,O=(x=S,P=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(x);if(P){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function S(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.LocalStorage;return l(this,S),(e=O.call(this)).localStorage=t,e}return h(S,[{key:"getTransform",value:function(e,t){var n=this.loadItem(b,e,t);return(null==n?void 0:n.transform)||null}},{key:"getIsLocked",value:function(e,t){var n=this.loadItem(b,e,t);return Boolean(null==n?void 0:n.isLocked)}},{key:"loadTransform",value:(y=f(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.loadItem(b,t,n),e.abrupt("return",null==r?void 0:r.transform);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"saveTransform",value:(p=f(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=this.loadItem(b,t,n)||I()).transform=r,e.abrupt("return",this.saveItem(b,t,n,o));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"lockAlignment",value:(c=f(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=this.loadItem(b,t,n)||I()).isLocked=!0,e.abrupt("return",this.saveItem(b,t,n,r));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"isAlignmentLocked",value:(s=f(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getIsLocked(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"saveRegion",value:(a=f(regeneratorRuntime.mark((function e(t,n,r,o,i){var a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=this.loadItem(b,t,n)||I()).regions||(a.regions=[]),-1===(u=a.regions.findIndex((function(e){return e.regionId===r})))&&(u=a.regions.length),a.regions[u]={regionId:r,boundingBox:o,transform:i},e.abrupt("return",this.saveItem(b,t,n,a));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o){return a.apply(this,arguments)})},{key:"loadRegion",value:(i=f(regeneratorRuntime.mark((function e(t,n,r){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadRegions(t,n);case 2:return o=e.sent,i=o.find((function(e){return e.regionId===r})),e.abrupt("return",i||null);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"loadRegions",value:(o=f(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.loadItem(b,t,n),o=null==r?void 0:r.regions,e.abrupt("return",o||[]);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"deleteRegion",value:(r=f(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getRelationships(Autodesk.AlignmentService.RelationshipEntityTypes.Region,t,r,o),this.deleteRelationship(i.id),a=this.loadItem(b,n,r),u=null==a?void 0:a.regions){e.next=7;break}return console.warn("No regions to delete"),e.abrupt("return");case 7:region.length>1?(a.regions=u.filter((function(e){return e.regionId!==o})),this.saveItem(b,n,r,a)):this.deleteItem(b,n,r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n,o){return r.apply(this,arguments)})},{key:"saveRelationship",value:(n=f(regeneratorRuntime.mark((function e(t,n,r,o,i){var a,s,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=A(r,o,i),s=A(t,n),c=(0,u.v4)(),f={id:c,entities:[{domain:w,type:Autodesk.AlignmentService.RelationshipEntityTypes.Region,id:a},{domain:w,type:Autodesk.AlignmentService.RelationshipEntityTypes.Model3D,id:s}]},e.abrupt("return",this.saveItem(k,c,void 0,f));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r,o,i){return n.apply(this,arguments)})},{key:"getRelationships",value:(t=f(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,s,c,f,l,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=[],a=A(n,r,o),u=g.LocalStorage.getAllKeys(),s=0;s<u.length;s++)-1!==(c=u[s]).indexOf(k)&&(l=g.LocalStorage.getItem(c),(null==(p=l&&JSON.parse(l))||null===(f=p.entities)||void 0===f?void 0:f.some((function(e){return e.id===a&&e.type===t})))&&i.push(p));return e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)}))),function(e,n,r,o){return t.apply(this,arguments)})},{key:"deleteRelationship",value:function(e){this.deleteItem(k,e)}},{key:"loadItem",value:function(e,t,n){var r=R(e,t,n),o=this.localStorage.getItem(r),i=o&&JSON.parse(o);return(null==i?void 0:i.transform)&&(i.transform=new g.LmvMatrix4(!0).fromArray(i.transform)),(null==i?void 0:i.regions)&&(i.regions=i.regions.map((function(e){return e.transform&&(e.transform=new g.LmvMatrix4(!0).fromArray(e.transform)),e.boundingBox=(new THREE.Box2).set({x:e.boundingBox[0],y:e.boundingBox[1]},{x:e.boundingBox[2],y:e.boundingBox[3]}),e}))),i}},{key:"saveItem",value:function(e,t,n,r){var o,i;(null===(o=r)||void 0===o?void 0:o.transform)&&((r=Object.assign({},r)).transform=Array.from(r.transform.elements)),(null===(i=r)||void 0===i?void 0:i.regions)&&((r=Object.assign({},r)).regions=r.regions.map((function(e){var t=Object.assign({},e);return t.transform&&(t.transform=Array.from(t.transform.elements)),t.boundingBox=[t.boundingBox.min.x,t.boundingBox.min.y,t.boundingBox.max.x,t.boundingBox.max.y],t})));var a=R(e,t,n),u=JSON.stringify(r);return this.localStorage.setItem(a,u),!0}},{key:"deleteItem",value:function(e,t,n){var r=R(e,t,n);this.localStorage.removeItem(r)}}]),S}(a),O=function(){function e(){l(this,e),this.data={}}return h(e,[{key:"setItem",value:function(e,t){this.data[e]=t}},{key:"getItem",value:function(e){return this.data[e]}}]),e}();function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}a.ObjectLocalStorage=O;var T=Autodesk.Viewing.Private,E=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init(t)}var t,n;return t=e,(n=[{key:"init",value:function(e){this.checksum=void 0,this.transform=null,this.isLocked=!1,this.updatedAt=void 0,this.updatedBy=void 0,this.versionUrn=null==e?void 0:e.versionUrn,this.viewablePartId=null==e?void 0:e.viewablePartId,this.regions=void 0}},{key:"isDefaultState",value:function(){return!this.transform&&!this.isLocked&&!this.regions}},{key:"resetToDefaultState",value:function(){this.transform=null,this.isLocked=!1,this.regions=null}},{key:"createNew",value:function(e,t){return this.init(),this.versionUrn=e.versionUrn,this.viewablePartId=e.viewablePartId,this.transform=t,this}},{key:"load",value:function(e){return this.versionUrn=T.toUrlSafeBase64(e.versionUrn),this.viewablePartId=e.viewablePartId,e.regions&&(this.regions=e.regions.map((function(e){return e.transform&&(e.transform=new T.LmvMatrix4(!0).fromArray(e.transform)),e.boundingBox=(new THREE.Box2).set({x:e.boundingBox[0],y:e.boundingBox[1]},{x:e.boundingBox[2],y:e.boundingBox[3]}),e}))),this.checksum=e.checksum,this.isLocked=e.isLocked||!1,this.updatedAt=e.updatedAt,this.updatedBy=e.updatedBy,this.transform=Array.isArray(null==e?void 0:e.transform)?new T.LmvMatrix4(!0).fromArray(null==e?void 0:e.transform):null,this}},{key:"existsOnServer",value:function(){return Boolean(this.checksum)}},{key:"toObject",value:function(){return{checksum:this.checksum,isLocked:this.isLocked,transform:this.transform&&Array.from(this.transform.elements),regions:this.regions?this.regions.map((function(e){var t=Object.assign({},e);return t.transform&&(t.transform=Array.from(t.transform.elements)),t.boundingBox=[t.boundingBox.min.x,t.boundingBox.min.y,t.boundingBox.max.x,t.boundingBox.max.y],t})):void 0,versionUrn:T.fromUrlSafeBase64(this.versionUrn),viewablePartId:this.viewablePartId}}}])&&S(t.prototype,n),e}();function j(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function _(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){j(i,r,o,a,u,"next",e)}function u(e){j(i,r,o,a,u,"throw",e)}a(void 0)}))}}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._fetchItems=t,this.cache={},this.urnToRequestIndex={},this.pendingRequests=[null]}var t,n,r,o;return t=e,n=[{key:"clear",value:function(){this.cache={}}},{key:"fetchItems",value:(o=_(regeneratorRuntime.mark((function e(t){var n,r,o,i,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(e){return!a.cache[e.toString()]},(t=t.filter(n)).length){e.next=4;break}return e.abrupt("return");case 4:for(r=1;this.pendingRequests[r];)r++;return t.forEach((function(e){return a.urnToRequestIndex[e.toString()]=r})),o=this._fetchItems(t),this.pendingRequests[r]=o,e.next=11,o;case 11:i=e.sent,this.pendingRequests[r]=null,i&&t.forEach((function(e){var t=e.toString();a.cache[t]=i[t]})),t.forEach((function(e){delete a.urnToRequestIndex[e.toString()]}));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getCachedItem",value:function(e){var t=e.toString();return this.cache[t]}},{key:"getItem",value:(r=_(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getCachedItem(t))){e.next=3;break}return e.abrupt("return",n);case 3:if(r=t.toString(),!(o=this.urnToRequestIndex[r])){e.next=10;break}return e.next=8,this.pendingRequests[o];case 8:e.next=12;break;case 10:return e.next=12,this.fetchItems([t]);case 12:return e.abrupt("return",this.getCachedItem(t));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setItem",value:function(e,t){var n=e.toString();this.cache[n]=t}}],n&&B(t.prototype,n),e}();function U(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){U(i,r,o,a,u,"next",e)}function u(e){U(i,r,o,a,u,"throw",e)}a(void 0)}))}}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var M=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxAttempts=10,this.startDelay=100,this.growFactor=1.1}var t,n;return t=e,n=[{key:"getWaitingTime",value:function(e){return e?this.startDelay*Math.pow(this.growFactor,e-1):0}},{key:"run",value:function(e,t){var n=this;return new Promise((function(r){var o=0,i=function(){var a=C(regeneratorRuntime.mark((function a(){var u,s;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e();case 2:if(u=a.sent,!t(u)){a.next=5;break}return a.abrupt("return",r(u));case 5:if(!(++o>=n.maxAttempts)){a.next=8;break}return a.abrupt("return",r(u));case 8:s=n.getWaitingTime(o),window.setTimeout(i,s);case 10:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();i()}))}}],n&&q(t.prototype,n),e}(),D=function(){var e=C(regeneratorRuntime.mark((function e(t,n,r){var o,i,a,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=u.length>3&&void 0!==u[3]?u[3]:null,i={success:!1,data:null},e.next=4,t();case 4:return a=e.sent,e.next=7,new Promise((function(e){var t=new XMLHttpRequest;t.open(r,n,!0),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("accept","application/json"),t.setRequestHeader("Access-Control-Allow-Origin","*"),t.setRequestHeader("Authorization","Bearer "+a);var u=function(){e(i)};t.onload=function(){if(t.status<200||t.status>=300)u();else try{i.data=t.response?JSON.parse(t.response):null,i.success=!0,e(i)}catch(e){u()}},t.onerror=u,t.ontimeout=u,t.onabort=u,t.send(o&&JSON.stringify(o))}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),N=function(){var e=C(regeneratorRuntime.mark((function e(t,n,r,o){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(){return D(t,n,r,o)},a=function(e){return e.success},e.next=4,(new M).run(i,a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r,o){return e.apply(this,arguments)}}();function V(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function H(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){V(i,r,o,a,u,"next",e)}function u(e){V(i,r,o,a,u,"throw",e)}a(void 0)}))}}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t,n){return t&&W(e.prototype,t),n&&W(e,n),e}var Q=Autodesk.Viewing,z=Q.Private,G="default";function K(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var X=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;J(this,e),this.versionUrn=t,this.viewablePartId=n}return F(e,[{key:"toObject",value:function(){return{versionUrn:z.fromUrlSafeBase64(this.versionUrn),viewablePartId:this.viewablePartId||void 0}}},{key:"toString",value:function(){return"".concat(this.versionUrn).concat(this.viewablePartId?"__".concat(this.viewablePartId):"")}}],[{key:"fromUrns",value:function(t){return t&&t.map((function(t){return new e(t)}))}}]),e}(),Y=function(e){var t=Q.EnvironmentConfigurations[Q.getEnv()];return(t.UPSTREAM||t.ROOT)+"/construction/alignment"+("QA"===e?"-dev":"")},Z=function(){return Q.token.accessToken},$=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.projectId,r=t.getAccessToken,o=void 0===r?Z:r,i=t.docsEnv,a=void 0===i?"":i,u=t.serviceBaseUrl,s=void 0===u?Y(a):u,c=t.serviceVersion,f=void 0===c?"v1":c,l=t.onError,p=void 0===l?null:l;J(this,e),this.projectId=n,this.getAccessToken=o,this.onError=p,this.serviceUrl="".concat(s,"/").concat(f),this.itemsEndPoint="/projects/".concat(n,"/spaces/").concat(G,"/items"),this.url=this.serviceUrl+this.itemsEndPoint}var t,n,r,o,i;return F(e,[{key:"fetchItems",value:(i=H(regeneratorRuntime.mark((function e(t){var n,r,o,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},t.length){e.next=3;break}return e.abrupt("return",n);case 3:return r=K(t,20),o=r.map((function(e){return i._doBatchRequest(e,n)})),e.next=8,Promise.all(o);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"_doBatchRequest",value:(o=H(regeneratorRuntime.mark((function e(t,n){var r,o,i,a,u,s,c,f,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r={},o=0;o<t.length;o++)r[o]=t[o].toObject();return e.next=5,N(this.getAccessToken,this.url+":getBatch","POST",r);case 5:if((i=e.sent).success){e.next=9;break}return this.onError(),e.abrupt("return");case 9:if(a=i.data){e.next=13;break}return console.warn("Unepxected request response: items:getBatch should get an empty response"),e.abrupt("return");case 13:for(u=a.results,s=0;s<t.length;s++)c=new X(t[s].versionUrn,t[s].viewablePartId),f=c.toString(),l=u&&u[s],n[f]=l?(new E).load(l):new E(c);return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"saveItem",value:(r=H(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.toObject(),r=t.existsOnServer()?"PATCH":"POST",e.next=4,N(this.getAccessToken,this.url,r,n);case 4:if((o=e.sent).success){e.next=8;break}return this.onError(),e.abrupt("return",!1);case 8:return o.data?t.load(o.data):(t.checksum=void 0,"DELETE"==r||console.warn("Unexpected request result: POST or PATCH should always respond an update item state")),e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"deleteItem",value:(n=H(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.toObject(),e.next=3,N(this.getAccessToken,this.url,"DELETE",n);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setItemLocked",value:(t=H(regeneratorRuntime.mark((function e(t,n){var r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.toObject(),o={versionUrn:r.versionUrn,viewablePartId:r.viewablePartId},i=n?":lock":":unlock",e.next=5,N(this.getAccessToken,this.url+i,"PATCH",o);case 5:if((a=e.sent).success){e.next=9;break}return this.onError(),e.abrupt("return");case 9:t.load(a.data);case 10:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}();function ee(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function te(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ee(i,r,o,a,u,"next",e)}function u(e){ee(i,r,o,a,u,"throw",e)}a(void 0)}))}}function ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oe=Autodesk.Viewing,ie=function(e){var t=oe.EnvironmentConfigurations[oe.getEnv()];return(t.UPSTREAM||t.ROOT)+"/bim360/relationship"+("QA"===e?"-dev":"")},ae=function(){return oe.token.accessToken},ue=function(e,t,n){return"".concat(e,"?").concat(Autodesk.AlignmentService.RelationshipIdPrefix.Name).concat(encodeURIComponent(t)).concat(n?"".concat(Autodesk.AlignmentService.RelationshipIdPrefix.Region).concat(n):"")},se="autodesk-construction-alignment",ce=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.projectId,r=t.getAccessToken,o=void 0===r?ae:r,i=t.docsEnv,a=void 0===i?"":i,u=t.serviceBaseUrl,s=void 0===u?ie(a):u,c=t.serviceVersion,f=void 0===c?"v2":c,l=t.onError,p=void 0===l?null:l;ne(this,e),this.projectId=n,this.getAccessToken=o,this.onError=p,this.serviceUrl="".concat(s,"/").concat(f),this.itemsEndPoint="/containers/".concat(n,"/relationships"),this.url=this.serviceUrl+this.itemsEndPoint}var t,n,r,o,i;return t=e,n=[{key:"getRelationships",value:(i=te(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,s,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ue(n,r,o),u=encodeURIComponent(a),s=":search?domain=".concat(se,"&type=").concat(t,"&id=").concat(u),e.next=5,N(this.getAccessToken,this.url+s,"GET");case 5:if((c=e.sent).success){e.next=9;break}return this.onError(),e.abrupt("return",[]);case 9:if(f=null===(i=c.data)||void 0===i?void 0:i.relationships){e.next=13;break}return console.warn("Unepxected request response: relationships:search should get an empty array"),e.abrupt("return",[]);case 13:return f.forEach((function(e){e.entities.forEach((function(e){e.id=decodeURIComponent(e.id)}))})),e.abrupt("return",f);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"saveRelationship",value:(o=te(regeneratorRuntime.mark((function e(t,n,r,o,i){var a,u,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ue(r,o,i),u=ue(t,n),s={entities:[{domain:se,type:Autodesk.AlignmentService.RelationshipEntityTypes.Region,id:a},{domain:se,type:Autodesk.AlignmentService.RelationshipEntityTypes.Model3D,id:u}]},c=[s],e.next=6,N(this.getAccessToken,this.url,"PUT",c);case 6:if(e.sent.success){e.next=10;break}return this.onError(),e.abrupt("return",!1);case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,i){return o.apply(this,arguments)})},{key:"deleteRelationship",value:(r=te(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[t],e.next=4,N(this.getAccessToken,this.url+":delete","POST",n);case 4:if(e.sent.success){e.next=8;break}return this.onError(),e.abrupt("return");case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}],n&&re(t.prototype,n),e}();function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function le(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function pe(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){le(i,r,o,a,u,"next",e)}function u(e){le(i,r,o,a,u,"throw",e)}a(void 0)}))}}function he(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function me(e,t){return me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},me(e,t)}function de(e,t){return!t||"object"!==fe(t)&&"function"!=typeof t?ge(e):t}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ye(e){return ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ye(e)}var be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(k,e);var t,n,r,o,i,a,u,s,c,f,l,p,h,v,m,d,g,y,b=(g=k,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ye(g);if(y){var n=ye(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return de(this,e)});function k(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};he(this,k);var n=(e=b.call(this)).onError.bind(ge(e));t.onError=n,e.alignmentApi=new $(t),e.relationshipApi=new ce(t);var r=function(){var t=pe(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.alignmentApi.fetchItems(n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return e.cache=new L(r),e}return t=k,n=[{key:"fetchItems",value:(d=pe(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=X.fromUrns(t),e.next=3,this.cache.fetchItems(n);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getTransform",value:function(e,t){var n=new X(e,t),r=this.cache.getCachedItem(n);if(r)return r.transform?r.transform.clone():null}},{key:"getIsLocked",value:function(e,t){var n=new X(e,t),r=this.cache.getCachedItem(n);return r?Boolean(r.isLocked):void 0}},{key:"loadTransform",value:(m=pe(regeneratorRuntime.mark((function e(t,n){var r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new X(t,n),e.next=3,this.cache.getItem(o);case 3:return i=e.sent,e.abrupt("return",(null==i||null===(r=i.transform)||void 0===r?void 0:r.clone())||null);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"saveTransform",value:(v=pe(regeneratorRuntime.mark((function e(t,n,r){var o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new X(t,n),e.next=3,this.cache.getItem(i);case 3:if(a=e.sent,u=null===(o=a)||void 0===o?void 0:o.transform,s=r,!(!u&&!s||u&&s&&s.equals(u))){e.next=6;break}return e.abrupt("return",!0);case 6:return a?a.transform=r:(a=(new E).createNew(i,r),this.cache.setItem(i,a)),e.next=9,this.alignmentApi.saveItem(a);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}var u,s}),e,this)}))),function(e,t,n){return v.apply(this,arguments)})},{key:"lockAlignment",value:(h=pe(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new X(t,n),e.next=3,this.cache.getItem(r);case 3:if(!(o=e.sent).isLocked){e.next=6;break}return e.abrupt("return");case 6:if(o.existsOnServer()){e.next=10;break}return e.next=10,this.alignmentApi.saveItem(o);case 10:return e.next=12,this.alignmentApi.setItemLocked(o,!0);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"unlockAlignment",value:(p=pe(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new X(t,n),e.next=3,this.cache.getItem(r);case 3:if((o=e.sent)&&o.isLocked){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.alignmentApi.setItemLocked(o,!1);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"isAlignmentLocked",value:(l=pe(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new X(t,n),e.next=3,this.cache.getItem(r);case 3:return o=e.sent,e.abrupt("return",Boolean(null==o?void 0:o.isLocked));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"saveRegion",value:(f=pe(regeneratorRuntime.mark((function e(t,n,r,o,i){var a,u,s,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new X(t,n),e.next=3,this.cache.getItem(a);case 3:return(u=e.sent)||(u=(new E).createNew(a,i),this.cache.setItem(a,u)),u.regions=[],s=u.regions.slice(),-1===(c=u.regions.findIndex((function(e){return e.regionId===r})))&&(c=u.regions.length),u.regions[c]={regionId:r,boundingBox:o,transform:i},e.next=12,this.alignmentApi.saveItem(u);case 12:return(f=e.sent)||(u.regions=s),e.abrupt("return",f);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o){return f.apply(this,arguments)})},{key:"loadRegions",value:(c=pe(regeneratorRuntime.mark((function e(t,n){var r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new X(t,n),e.next=3,this.cache.getItem(r);case 3:return o=e.sent,i=null==o?void 0:o.regions,e.abrupt("return",i||[]);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"loadRegion",value:(s=pe(regeneratorRuntime.mark((function e(t,n,r){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadRegions(t,n);case 2:return o=e.sent,i=o.find((function(e){return e.regionId===r})),e.abrupt("return",i||null);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"deleteRegion",value:(u=pe(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,s,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new X(n,r),e.next=3,this.getRelationships(Autodesk.AlignmentService.RelationshipEntityTypes.Region,t,r,o);case 3:if((a=e.sent).length){e.next=6;break}throw"No relationship to delete";case 6:return e.prev=6,e.next=9,Promise.all(a.map((function(e){return c.deleteRelationship(e.id)})));case 9:e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(6),console.warn("Could not delete relationships"),e.t0;case 15:return e.next=17,this.cache.getItem(i);case 17:if(u=e.sent,s=null==u?void 0:u.regions){e.next=22;break}return console.warn("No regions to delete"),e.abrupt("return");case 22:if(!(s.length>1)){e.next=28;break}return u.regions=s.filter((function(e){return e.regionId!==o})),e.next=26,this.alignmentApi.saveItem(u);case 26:e.next=29;break;case 28:this.deleteItem(n,r);case 29:case"end":return e.stop()}}),e,this,[[6,11]])}))),function(e,t,n,r){return u.apply(this,arguments)})},{key:"getRelationships",value:(a=pe(regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.relationshipApi.getRelationships(t,n,r,o);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"saveRelationship",value:(i=pe(regeneratorRuntime.mark((function e(t,n,r,o,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.relationshipApi.saveRelationship(t,n,r,o,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o){return i.apply(this,arguments)})},{key:"deleteRelationship",value:(o=pe(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.relationshipApi.deleteRelationship(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"onError",value:function(){this.error=!0}},{key:"isWorking",value:function(){return!this.error}},{key:"clearCache",value:function(){this.cache.clear()}},{key:"deleteItem",value:(r=pe(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new X(t,n),e.next=3,this.cache.getItem(r);case 3:if((o=e.sent).existsOnServer()){e.next=6;break}return e.abrupt("return");case 6:if(!o.isLocked){e.next=9;break}return e.next=9,this.unlockAlignment(t,n);case 9:return this.cache.setItem(r,null),e.next=12,this.alignmentApi.deleteItem(r);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})}],n&&ve(t.prototype,n),k}(a);function ke(e){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ke(e)}function we(e,t,n,r,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,o)}function xe(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){we(i,r,o,a,u,"next",e)}function u(e){we(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ie(e,t,n){return Ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Oe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},Ie(e,t,n||e)}function Ae(e,t){return Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ae(e,t)}function Pe(e,t){return!t||"object"!==ke(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oe(e){return Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Oe(e)}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(c,e);var t,n,r,o,i,a,u,s=(a=c,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Oe(a);if(u){var n=Oe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Pe(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).items={},t}return t=c,n=[{key:"getTransform",value:function(e,t){var n=this.getOverrideTransform(e,t);return void 0!==n?n?n.clone():null:Ie(Oe(c.prototype),"getTransform",this).call(this,e,t)}},{key:"getIsLocked",value:function(e,t){return void 0!==this.getOverrideTransform(e,t)||Ie(Oe(c.prototype),"getIsLocked",this).call(this,e,t)}},{key:"isAlignmentLocked",value:(i=xe(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.getOverrideTransform(t,n)){e.next=3;break}return e.abrupt("return",!0);case 3:return e.next=5,Ie(Oe(c.prototype),"isAlignmentLocked",this).call(this,t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"loadTransform",value:(o=xe(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(r=this.getOverrideTransform(t,n))){e.next=3;break}return e.abrupt("return",r);case 3:return e.next=5,Ie(Oe(c.prototype),"loadTransform",this).call(this,t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"setOverrideTransforms",value:function(e){this.items=e}},{key:"clearRedundantOverrides",value:(r=xe(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object.keys(this.items),e.next=3,this.fetchItems(t);case 3:n={},t.forEach((function(e){var t=new X(e),o=r.cache.getCachedItem(t),i=r.items[e],a=o.checksum==i.checksum;(null===i.checksum&&null===i.transform&&null===o.transform?o.versionUrn==e:a)||(n[e]=i)})),this.items=n;case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getOverrideTransform",value:function(e,t){if(!t){var n=this.items[e];if(n)return n.transform?n.transform.clone():null}}}],n&&Re(t.prototype,n),c}(be);function Te(e){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Te(e)}function Ee(e,t){return Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ee(e,t)}function je(e,t){return!t||"object"!==Te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _e(e){return _e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_e(e)}var Be=Autodesk.Viewing,Le=AutodeskNamespace("Autodesk.ModelAlignmentService"),Ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=_e(t);if(n){var o=_e(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return je(this,e)});function o(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e,t)}return o}(Be.Extension);Be.theExtensionManager.registerExtension("Autodesk.ModelAlignmentService",Ue),Le.AlignmentService=a,Le.AlignmentServiceLS=P,Le.NucleusAlignmentAPI=$,Le.AlignmentServiceNucleus=be,Le.AlignmentServiceNucleusOverridable=Se})(),Autodesk.Extensions.ModelAlignmentService=r})();
//# sourceMappingURL=ModelAlignmentService.min.js.map
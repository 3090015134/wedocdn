/*!
 * LMV v7.32.0
 * 
 * Copyright 2020 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.BimMarkups=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=603)}([,,function(e,t,n){var r=n(442),i=n(66),a=/[T ]/,A=/:/,o=/^(\d{2})$/,s=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],u=/^(\d{4})/,c=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],l=/^-(\d{2})$/,h=/^-?(\d{3})$/,d=/^-?(\d{2})-?(\d{2})$/,f=/^-?W(\d{2})$/,p=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,y=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,v=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,m=/([Z+-].*)$/,E=/^(Z)$/,B=/^([+-])(\d{2})$/,w=/^([+-])(\d{2}):?(\d{2})$/;function k(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(i(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?2:Number(n);var C=function(e){var t,n={},r=e.split(a);A.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var i=m.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),b=function(e,t){var n,r=s[t],i=c[t];if(n=u.exec(e)||i.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=o.exec(e)||r.exec(e)){var A=n[1];return{year:100*parseInt(A,10),restDateString:e.slice(A.length)}}return{year:null}}(C.date,n),S=b.year,T=function(e,t){if(null===t)return null;var n,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=l.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=h.exec(e)){r=new Date(0);var A=parseInt(n[1],10);return r.setUTCFullYear(t,0,A),r}if(n=d.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var o=parseInt(n[2],10);return r.setUTCFullYear(t,i,o),r}if(n=f.exec(e))return a=parseInt(n[1],10)-1,k(t,a);if(n=p.exec(e)){a=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return k(t,a,s)}return null}(b.restDateString,S);if(T){var M,U=T.getTime(),Q=0;if(C.time&&(Q=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*36e5;if(t=y.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*36e5+6e4*r;if(t=v.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*36e5+6e4*r+1e3*i}return null}(C.time)),C.timezone)M=6e4*function(e){var t,n;if(t=E.exec(e))return 0;if(t=B.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=w.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(C.timezone);else{var x=U+Q,F=new Date(x);M=r(F);var _=new Date(x);_.setDate(F.getDate()+1);var H=r(_)-r(F);H>0&&(M+=H)}return new Date(U+Q+M)}return new Date(e)}},,function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(A=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(A))))+" */"),a=r.sources.map((function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"}));return[n].concat(a).concat([i]).join("\n")}var A;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var a=this[i][0];"number"==typeof a&&(r[a]=!0)}for(i=0;i<e.length;i++){var A=e[i];"number"==typeof A[0]&&r[A[0]]||(n&&!A[2]?A[2]=n:n&&(A[2]="("+A[2]+") and ("+n+")"),t.push(A))}},t}},function(e,t,n){var r,i,a={},A=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=r.apply(this,arguments)),i}),o=function(e,t){return t?t.querySelector(e):document.querySelector(e)},s=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=o.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),u=null,c=0,l=[],h=n(6);function d(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=a[r.id];if(i){i.refs++;for(var A=0;A<i.parts.length;A++)i.parts[A](r.parts[A]);for(;A<r.parts.length;A++)i.parts.push(m(r.parts[A],t))}else{var o=[];for(A=0;A<r.parts.length;A++)o.push(m(r.parts[A],t));a[r.id]={id:r.id,refs:1,parts:o}}}}function f(e,t){for(var n=[],r={},i=0;i<e.length;i++){var a=e[i],A=t.base?a[0]+t.base:a[0],o={css:a[1],media:a[2],sourceMap:a[3]};r[A]?r[A].parts.push(o):n.push(r[A]={id:A,parts:[o]})}return n}function p(e,t){var n=s(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=l[l.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),l.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=s(e.insertAt.before,n);n.insertBefore(t,i)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=l.indexOf(e);t>=0&&l.splice(t,1)}function y(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return v(t,e.attrs),p(e,t),t}function v(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function m(e,t){var n,r,i,a;if(t.transform&&e.css){if(!(a="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=a}if(t.singleton){var A=c++;n=u||(u=y(t)),r=w.bind(null,n,A,!1),i=w.bind(null,n,A,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",v(t,e.attrs),p(e,t),t}(t),r=C.bind(null,n,t),i=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=y(t),r=k.bind(null,n),i=function(){g(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=A()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=f(e,t);return d(n,t),function(e){for(var r=[],i=0;i<n.length;i++){var A=n[i];(o=a[A.id]).refs--,r.push(o)}e&&d(f(e,t),t);for(i=0;i<r.length;i++){var o;if(0===(o=r[i]).refs){for(var s=0;s<o.parts.length;s++)o.parts[s]();delete a[o.id]}}}};var E,B=(E=[],function(e,t){return E[e]=t,E.filter(Boolean).join("\n")});function w(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=B(t,i);else{var a=document.createTextNode(i),A=e.childNodes;A[t]&&e.removeChild(A[t]),A.length?e.insertBefore(a,A[t]):e.appendChild(a)}}function k(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function C(e,t,n){var r=n.css,i=n.sourceMap,a=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||a)&&(r=h(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var A=new Blob([r],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(A),o&&URL.revokeObjectURL(o)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var i,a=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(i=0===a.indexOf("//")?a:0===a.indexOf("/")?n+a:r+a.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},,,,,,function(e,t,n){var r=n(41),i=n(42),a=i;a.v1=r,a.v4=i,e.exports=a},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,function(e,t){(function(t){e.exports=t}).call(this,{})},,,,,,,function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},,function(e,t,n){(function(e,r){var i;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/**
                                                                                                                                                                                                                                                                                                                                                                                * @license
                                                                                                                                                                                                                                                                                                                                                                                * Lodash (Custom Build) <https://lodash.com/>
                                                                                                                                                                                                                                                                                                                                                                                * Build: `lodash include="cloneDeep,debounce,findLast,remove" exports="amd"`
                                                                                                                                                                                                                                                                                                                                                                                * Copyright JS Foundation and other contributors <https://js.foundation/>
                                                                                                                                                                                                                                                                                                                                                                                * Released under MIT license <https://lodash.com/license>
                                                                                                                                                                                                                                                                                                                                                                                * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
                                                                                                                                                                                                                                                                                                                                                                                * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
                                                                                                                                                                                                                                                                                                                                                                                */(function(){var A="[object Arguments]",o="[object Array]",s="[object Boolean]",u="[object Date]",c="[object Function]",l="[object GeneratorFunction]",h="[object Map]",d="[object Number]",f="[object Object]",p="[object RegExp]",g="[object Set]",y="[object String]",v="[object Symbol]",m="[object WeakMap]",E="[object DataView]",B="[object Float32Array]",w="[object Float64Array]",k="[object Int8Array]",C="[object Int16Array]",b="[object Int32Array]",S="[object Uint8Array]",T="[object Uint16Array]",M="[object Uint32Array]",U=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,x=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,F=/^\s+|\s+$/g,_=/\\(\\)?/g,H=/\w*$/,R=/^[-+]0x[0-9a-f]+$/i,L=/^0b[01]+$/i,D=/^\[object .+?Constructor\]$/,I=/^0o[0-7]+$/i,O=/^(?:0|[1-9]\d*)$/,N={};N[B]=N[w]=N[k]=N[C]=N[b]=N[S]=N["[object Uint8ClampedArray]"]=N[T]=N[M]=!0,N[A]=N[o]=N["[object ArrayBuffer]"]=N[s]=N[E]=N[u]=N["[object Error]"]=N[c]=N[h]=N[d]=N[f]=N[p]=N[g]=N[y]=N[m]=!1;var P={};P[A]=P[o]=P["[object ArrayBuffer]"]=P[E]=P[s]=P[u]=P[B]=P[w]=P[k]=P[C]=P[b]=P[h]=P[d]=P[f]=P[p]=P[g]=P[y]=P[v]=P[S]=P["[object Uint8ClampedArray]"]=P[T]=P[M]=!0,P["[object Error]"]=P[c]=P[m]=!1;var K=parseInt,V="object"==(void 0===e?"undefined":a(e))&&e&&e.Object===Object&&e,j="object"==("undefined"==typeof self?"undefined":a(self))&&self&&self.Object===Object&&self,G=V||j||Function("return this")(),z="object"==a(t)&&t&&!t.nodeType&&t,Y=z&&"object"==a(r)&&r&&!r.nodeType&&r,W=Y&&Y.exports===z,X=W&&V.process,J=function(){try{return X&&X.binding&&X.binding("util")}catch(e){}}(),q=J&&J.isMap,Z=J&&J.isSet,$=J&&J.isTypedArray;function ee(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function te(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function ne(e){return function(t){return e(t)}}function re(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function ie(e,t){return function(n){return e(t(n))}}function ae(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var Ae,oe=Array.prototype,se=Function.prototype,ue=Object.prototype,ce=G["__core-js_shared__"],le=se.toString,he=ue.hasOwnProperty,de=(Ae=/[^.]+$/.exec(ce&&ce.keys&&ce.keys.IE_PROTO||""))?"Symbol(src)_1."+Ae:"",fe=ue.toString,pe=RegExp("^"+le.call(he).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ge=W?G.Buffer:void 0,ye=G.Symbol,ve=G.Uint8Array,me=ge?ge.allocUnsafe:void 0,Ee=ie(Object.getPrototypeOf,Object),Be=Object.create,we=ue.propertyIsEnumerable,ke=oe.splice,Ce=ye?ye.toStringTag:void 0,be=function(){try{var e=wt(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Se=Object.getOwnPropertySymbols,Te=ge?ge.isBuffer:void 0,Me=ie(Object.keys,Object),Ue=Math.max,Qe=Math.min,xe=wt(G,"DataView"),Fe=wt(G,"Map"),_e=wt(G,"Promise"),He=wt(G,"Set"),Re=wt(G,"WeakMap"),Le=wt(Object,"create"),De=_t(xe),Ie=_t(Fe),Oe=_t(_e),Ne=_t(He),Pe=_t(Re),Ke=ye?ye.prototype:void 0,Ve=Ke?Ke.valueOf:void 0,je=Ke?Ke.toString:void 0;function Ge(){}var ze=function(){function e(){}return function(t){if(!Yt(t))return{};if(Be)return Be(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Ye(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function We(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Xe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Je(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Xe;++t<n;)this.add(e[t])}function qe(e){var t=this.__data__=new We(e);this.size=t.size}function Ze(e,t){var n=Kt(e),r=!n&&Pt(e),i=!n&&!r&&jt(e),a=!n&&!r&&!i&&Zt(e),A=n||r||i||a,o=A?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],s=o.length;for(var u in e)!t&&!he.call(e,u)||A&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||St(u,s))||o.push(u);return o}function $e(e,t,n){var r=e[t];he.call(e,t)&&Nt(r,n)&&(void 0!==n||t in e)||tt(e,t,n)}function et(e,t){for(var n=e.length;n--;)if(Nt(e[n][0],t))return n;return-1}function tt(e,t,n){"__proto__"==t&&be?be(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function nt(e,t,n,r,i,a){var o,m=1&t,U=2&t,Q=4&t;if(n&&(o=i?n(e,r,i,a):n(e)),void 0!==o)return o;if(!Yt(e))return e;var x=Kt(e);if(x){if(o=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&he.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!m)return function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(e,o)}else{var F=bt(e),_=F==c||F==l;if(jt(e))return function(e,t){if(t)return e.slice();var n=e.length,r=me?me(n):new e.constructor(n);return e.copy(r),r}(e,m);if(F==f||F==A||_&&!i){if(o=U||_?{}:function(e){return"function"!=typeof e.constructor||Mt(e)?{}:ze(Ee(e))}(e),!m)return U?function(e,t){return gt(e,Ct(e),t)}(e,function(e,t){return e&&gt(t,on(t),e)}(o,e)):function(e,t){return gt(e,kt(e),t)}(e,function(e,t){return e&&gt(t,An(t),e)}(o,e))}else{if(!P[F])return i?e:{};o=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return pt(e);case s:case u:return new r(+e);case E:return function(e,t){var n=t?pt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case B:case w:case k:case C:case b:case S:case"[object Uint8ClampedArray]":case T:case M:return function(e,t){var n=t?pt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,n);case h:return new r;case d:case y:return new r(e);case p:return function(e){var t=new e.constructor(e.source,H.exec(e));return t.lastIndex=e.lastIndex,t}(e);case g:return new r;case v:return i=e,Ve?Object(Ve.call(i)):{}}var i}(e,F,m)}}a||(a=new qe);var R=a.get(e);if(R)return R;if(a.set(e,o),Jt(e))return e.forEach((function(r){o.add(nt(r,t,n,r,e,a))})),o;if(Xt(e))return e.forEach((function(r,i){o.set(i,nt(r,t,n,i,e,a))})),o;var L=x?void 0:(Q?U?mt:vt:U?on:An)(e);return function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););}(L||e,(function(r,i){L&&(r=e[i=r]),$e(o,i,nt(r,t,n,i,e,a))})),o}function rt(e,t){for(var n=0,r=(t=ft(t,e)).length;null!=e&&n<r;)e=e[Ft(t[n++])];return n&&n==r?e:void 0}function it(e,t,n){var r=t(e);return Kt(e)?r:ee(r,n(e))}function at(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Ce&&Ce in Object(e)?function(e){var t=he.call(e,Ce),n=e[Ce];try{e[Ce]=void 0;var r=!0}catch(e){}var i=fe.call(e);r&&(t?e[Ce]=n:delete e[Ce]);return i}(e):function(e){return fe.call(e)}(e)}function At(e,t){return null!=e&&t in Object(e)}function ot(e){return Wt(e)&&at(e)==A}function st(e,t,n,r,i){return e===t||(null==e||null==t||!Wt(e)&&!Wt(t)?e!=e&&t!=t:function(e,t,n,r,i,a){var c=Kt(e),l=Kt(t),m=c?o:bt(e),B=l?o:bt(t),w=(m=m==A?f:m)==f,k=(B=B==A?f:B)==f,C=m==B;if(C&&jt(e)){if(!jt(t))return!1;c=!0,w=!1}if(C&&!w)return a||(a=new qe),c||Zt(e)?yt(e,t,n,r,i,a):function(e,t,n,r,i,a,A){switch(n){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new ve(e),new ve(t)));case s:case u:case d:return Nt(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case p:case y:return e==t+"";case h:var o=re;case g:var c=1&r;if(o||(o=ae),e.size!=t.size&&!c)return!1;var l=A.get(e);if(l)return l==t;r|=2,A.set(e,t);var f=yt(o(e),o(t),r,i,a,A);return A.delete(e),f;case v:if(Ve)return Ve.call(e)==Ve.call(t)}return!1}(e,t,m,n,r,i,a);if(!(1&n)){var b=w&&he.call(e,"__wrapped__"),S=k&&he.call(t,"__wrapped__");if(b||S){var T=b?e.value():e,M=S?t.value():t;return a||(a=new qe),i(T,M,n,r,a)}}if(!C)return!1;return a||(a=new qe),function(e,t,n,r,i,a){var A=1&n,o=vt(e),s=o.length,u=vt(t).length;if(s!=u&&!A)return!1;var c=s;for(;c--;){var l=o[c];if(!(A?l in t:he.call(t,l)))return!1}var h=a.get(e);if(h&&a.get(t))return h==t;var d=!0;a.set(e,t),a.set(t,e);var f=A;for(;++c<s;){l=o[c];var p=e[l],g=t[l];if(r)var y=A?r(g,p,l,t,e,a):r(p,g,l,e,t,a);if(!(void 0===y?p===g||i(p,g,n,r,a):y)){d=!1;break}f||(f="constructor"==l)}if(d&&!f){var v=e.constructor,m=t.constructor;v==m||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof m&&m instanceof m||(d=!1)}return a.delete(e),a.delete(t),d}(e,t,n,r,i,a)}(e,t,n,r,st,i))}function ut(e){return!(!Yt(e)||(t=e,de&&de in t))&&(Gt(e)?pe:D).test(_t(e));var t}function ct(e){return"function"==typeof e?e:null==e?sn:"object"==a(e)?Kt(e)?function(e,t){if(Tt(e)&&Ut(t))return Qt(Ft(e),t);return function(n){var r=rn(n,e);return void 0===r&&r===t?an(n,e):st(t,r,3)}}(e[0],e[1]):function(e){var t=function(e){var t=An(e),n=t.length;for(;n--;){var r=t[n],i=e[r];t[n]=[r,i,Ut(i)]}return t}(e);if(1==t.length&&t[0][2])return Qt(t[0][0],t[0][1]);return function(n){return n===e||function(e,t,n,r){var i=n.length,a=i,A=!r;if(null==e)return!a;for(e=Object(e);i--;){var o=n[i];if(A&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++i<a;){var s=(o=n[i])[0],u=e[s],c=o[1];if(A&&o[2]){if(void 0===u&&!(s in e))return!1}else{var l=new qe;if(r)var h=r(u,c,s,e,t,l);if(!(void 0===h?st(c,u,3,r,l):h))return!1}}return!0}(n,e,t)}}(e):cn(e)}function lt(e){if(!Yt(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Mt(e),n=[];for(var r in e)("constructor"!=r||!t&&he.call(e,r))&&n.push(r);return n}function ht(e){if("string"==typeof e)return e;if(Kt(e))return function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}(e,ht)+"";if(qt(e))return je?je.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function dt(e,t){return null==(e=function(e,t){return t.length<2?e:rt(e,function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(i);++r<i;)a[r]=e[r+t];return a}(t,0,-1))}(e,t=ft(t,e)))||delete e[Ft(Rt(t))]}function ft(e,t){return Kt(e)?e:Tt(e,t)?[e]:xt(nn(e))}function pt(e){var t=new e.constructor(e.byteLength);return new ve(t).set(new ve(e)),t}function gt(e,t,n,r){var i=!n;n||(n={});for(var a=-1,A=t.length;++a<A;){var o=t[a],s=r?r(n[o],e[o],o,n,e):void 0;void 0===s&&(s=e[o]),i?tt(n,o,s):$e(n,o,s)}return n}function yt(e,t,n,r,i,a){var A=1&n,o=e.length,s=t.length;if(o!=s&&!(A&&s>o))return!1;var u=a.get(e);if(u&&a.get(t))return u==t;var c=-1,l=!0,h=2&n?new Je:void 0;for(a.set(e,t),a.set(t,e);++c<o;){var d=e[c],f=t[c];if(r)var p=A?r(f,d,c,t,e,a):r(d,f,c,e,t,a);if(void 0!==p){if(p)continue;l=!1;break}if(h){if(!te(t,(function(e,t){if(A=t,!h.has(A)&&(d===e||i(d,e,n,r,a)))return h.push(t);var A}))){l=!1;break}}else if(d!==f&&!i(d,f,n,r,a)){l=!1;break}}return a.delete(e),a.delete(t),l}function vt(e){return it(e,An,kt)}function mt(e){return it(e,on,Ct)}function Et(){var e=Ge.iteratee||un;return e=e===un?ct:e,arguments.length?e(arguments[0],arguments[1]):e}function Bt(e,t){var n,r,i=e.__data__;return("string"==(r=a(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function wt(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return ut(n)?n:void 0}Ye.prototype.clear=function(){this.__data__=Le?Le(null):{},this.size=0},Ye.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ye.prototype.get=function(e){var t=this.__data__;if(Le){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return he.call(t,e)?t[e]:void 0},Ye.prototype.has=function(e){var t=this.__data__;return Le?void 0!==t[e]:he.call(t,e)},Ye.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Le&&void 0===t?"__lodash_hash_undefined__":t,this},We.prototype.clear=function(){this.__data__=[],this.size=0},We.prototype.delete=function(e){var t=this.__data__,n=et(t,e);return!(n<0)&&(n==t.length-1?t.pop():ke.call(t,n,1),--this.size,!0)},We.prototype.get=function(e){var t=this.__data__,n=et(t,e);return n<0?void 0:t[n][1]},We.prototype.has=function(e){return et(this.__data__,e)>-1},We.prototype.set=function(e,t){var n=this.__data__,r=et(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Xe.prototype.clear=function(){this.size=0,this.__data__={hash:new Ye,map:new(Fe||We),string:new Ye}},Xe.prototype.delete=function(e){var t=Bt(this,e).delete(e);return this.size-=t?1:0,t},Xe.prototype.get=function(e){return Bt(this,e).get(e)},Xe.prototype.has=function(e){return Bt(this,e).has(e)},Xe.prototype.set=function(e,t){var n=Bt(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Je.prototype.add=Je.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Je.prototype.has=function(e){return this.__data__.has(e)},qe.prototype.clear=function(){this.__data__=new We,this.size=0},qe.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},qe.prototype.get=function(e){return this.__data__.get(e)},qe.prototype.has=function(e){return this.__data__.has(e)},qe.prototype.set=function(e,t){var n=this.__data__;if(n instanceof We){var r=n.__data__;if(!Fe||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Xe(r)}return n.set(e,t),this.size=n.size,this};var kt=Se?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var A=e[n];t(A,n,e)&&(a[i++]=A)}return a}(Se(e),(function(t){return we.call(e,t)})))}:ln,Ct=Se?function(e){for(var t=[];e;)ee(t,kt(e)),e=Ee(e);return t}:ln,bt=at;function St(e,t){var n=a(e);return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&O.test(e))&&e>-1&&e%1==0&&e<t}function Tt(e,t){if(Kt(e))return!1;var n=a(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!qt(e))||(Q.test(e)||!U.test(e)||null!=t&&e in Object(t))}function Mt(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ue)}function Ut(e){return e==e&&!Yt(e)}function Qt(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}(xe&&bt(new xe(new ArrayBuffer(1)))!=E||Fe&&bt(new Fe)!=h||_e&&"[object Promise]"!=bt(_e.resolve())||He&&bt(new He)!=g||Re&&bt(new Re)!=m)&&(bt=function(e){var t=at(e),n=t==f?e.constructor:void 0,r=n?_t(n):"";if(r)switch(r){case De:return E;case Ie:return h;case Oe:return"[object Promise]";case Ne:return g;case Pe:return m}return t});var xt=function(e){var t=Ot(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(x,(function(e,n,r,i){t.push(r?i.replace(_,"$1"):n||e)})),t}));function Ft(e){if("string"==typeof e||qt(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function _t(e){if(null!=e){try{return le.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ht(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=en(n),i=n<0?Ue(r+i,0):Qe(i,r-1)),function(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}(e,Et(t,3),i,!0)}function Rt(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Lt,Dt=(Lt=Ht,function(e,t,n){var r=Object(e);if(!Vt(e)){var i=Et(t,3);e=An(e),t=function(e){return i(r[e],e,r)}}var a=Lt(e,t,n);return a>-1?r[i?e[a]:a]:void 0}),It=function(){return G.Date.now()};function Ot(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var A=e.apply(this,r);return n.cache=a.set(i,A)||a,A};return n.cache=new(Ot.Cache||Xe),n}function Nt(e,t){return e===t||e!=e&&t!=t}Ot.Cache=Xe;var Pt=ot(function(){return arguments}())?ot:function(e){return Wt(e)&&he.call(e,"callee")&&!we.call(e,"callee")},Kt=Array.isArray;function Vt(e){return null!=e&&zt(e.length)&&!Gt(e)}var jt=Te||hn;function Gt(e){if(!Yt(e))return!1;var t=at(e);return t==c||t==l||"[object AsyncFunction]"==t||"[object Proxy]"==t}function zt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Yt(e){var t=a(e);return null!=e&&("object"==t||"function"==t)}function Wt(e){return null!=e&&"object"==a(e)}var Xt=q?ne(q):function(e){return Wt(e)&&bt(e)==h},Jt=Z?ne(Z):function(e){return Wt(e)&&bt(e)==g};function qt(e){return"symbol"==a(e)||Wt(e)&&at(e)==v}var Zt=$?ne($):function(e){return Wt(e)&&zt(e.length)&&!!N[at(e)]};function $t(e){return e?(e=tn(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function en(e){var t=$t(e),n=t%1;return t==t?n?t-n:t:0}function tn(e){if("number"==typeof e)return e;if(qt(e))return NaN;if(Yt(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Yt(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(F,"");var n=L.test(e);return n||I.test(e)?K(e.slice(2),n?2:8):R.test(e)?NaN:+e}function nn(e){return null==e?"":ht(e)}function rn(e,t,n){var r=null==e?void 0:rt(e,t);return void 0===r?n:r}function an(e,t){return null!=e&&function(e,t,n){for(var r=-1,i=(t=ft(t,e)).length,a=!1;++r<i;){var A=Ft(t[r]);if(!(a=null!=e&&n(e,A)))break;e=e[A]}return a||++r!=i?a:!!(i=null==e?0:e.length)&&zt(i)&&St(A,i)&&(Kt(e)||Pt(e))}(e,t,At)}function An(e){return Vt(e)?Ze(e):function(e){if(!Mt(e))return Me(e);var t=[];for(var n in Object(e))he.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}function on(e){return Vt(e)?Ze(e,!0):lt(e)}function sn(e){return e}function un(e){return ct("function"==typeof e?e:nt(e,1))}function cn(e){return Tt(e)?(t=Ft(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return rt(t,e)}}(e);var t}function ln(){return[]}function hn(){return!1}Ge.debounce=function(e,t,n){var r,i,a,A,o,s,u=0,c=!1,l=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function d(t){var n=r,a=i;return r=i=void 0,u=t,A=e.apply(a,n)}function f(e){return u=e,o=setTimeout(g,t),c?d(e):A}function p(e){var n=e-s;return void 0===s||n>=t||n<0||l&&e-u>=a}function g(){var e=It();if(p(e))return y(e);o=setTimeout(g,function(e){var n=t-(e-s);return l?Qe(n,a-(e-u)):n}(e))}function y(e){return o=void 0,h&&r?d(e):(r=i=void 0,A)}function v(){var e=It(),n=p(e);if(r=arguments,i=this,s=e,n){if(void 0===o)return f(s);if(l)return o=setTimeout(g,t),d(s)}return void 0===o&&(o=setTimeout(g,t)),A}return t=tn(t)||0,Yt(n)&&(c=!!n.leading,a=(l="maxWait"in n)?Ue(tn(n.maxWait)||0,t):a,h="trailing"in n?!!n.trailing:h),v.cancel=function(){void 0!==o&&clearTimeout(o),u=0,r=s=i=o=void 0},v.flush=function(){return void 0===o?A:y(It())},v},Ge.iteratee=un,Ge.keys=An,Ge.keysIn=on,Ge.memoize=Ot,Ge.property=cn,Ge.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],a=e.length;for(t=Et(t,3);++r<a;){var A=e[r];t(A,r,e)&&(n.push(A),i.push(r))}return function(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==a){var a=i;St(i)?ke.call(e,i,1):dt(e,i)}}}(e,i),n},Ge.cloneDeep=function(e){return nt(e,5)},Ge.eq=Nt,Ge.findLast=Dt,Ge.findLastIndex=Ht,Ge.get=rn,Ge.hasIn=an,Ge.identity=sn,Ge.isArguments=Pt,Ge.isArray=Kt,Ge.isArrayLike=Vt,Ge.isBuffer=jt,Ge.isFunction=Gt,Ge.isLength=zt,Ge.isMap=Xt,Ge.isObject=Yt,Ge.isObjectLike=Wt,Ge.isSet=Jt,Ge.isSymbol=qt,Ge.isTypedArray=Zt,Ge.last=Rt,Ge.stubArray=ln,Ge.stubFalse=hn,Ge.now=It,Ge.toFinite=$t,Ge.toInteger=en,Ge.toNumber=tn,Ge.toString=nn,Ge.VERSION="4.17.5","object"==a(n(15))&&n(15)&&(void 0===(i=function(){return Ge}.call(t,n,t,r))||(r.exports=i))}).call(this)}).call(this,n(13),n(89)(e))},,,,,function(e,t,n){var r=n(2),i=n(31);e.exports=function(e){var t=r(e),n=t.getFullYear(),a=new Date(0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);var A=i(a),o=new Date(0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);var s=i(o);return t.getTime()>=A.getTime()?n+1:t.getTime()>=s.getTime()?n:n-1}},function(e,t,n){var r=n(53);e.exports=function(e){return r(e,{weekStartsOn:1})}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e);return t.setHours(0,0,0,0),t}},,,,,function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setDate(n.getDate()+i),n}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},function(e,t,n){var r=n(30),i=n(31);e.exports=function(e){var t=r(e),n=new Date(0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),i(n)}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e).getTime(),i=r(t).getTime();return n<i?-1:n>i?1:0}},function(e,t,n){var r,i,a=n(22),A=n(23),o=0,s=0;e.exports=function(e,t,n){var u=t&&n||0,c=t||[],l=(e=e||{}).node||r,h=void 0!==e.clockseq?e.clockseq:i;if(null==l||null==h){var d=a();null==l&&(l=r=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==h&&(h=i=16383&(d[6]<<8|d[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:s+1,g=f-o+(p-s)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||f>o)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=f,s=p,i=h;var y=(1e4*(268435455&(f+=122192928e5))+p)%4294967296;c[u++]=y>>>24&255,c[u++]=y>>>16&255,c[u++]=y>>>8&255,c[u++]=255&y;var v=f/4294967296*1e4&268435455;c[u++]=v>>>8&255,c[u++]=255&v,c[u++]=v>>>24&15|16,c[u++]=v>>>16&255,c[u++]=h>>>8|128,c[u++]=255&h;for(var m=0;m<6;++m)c[u+m]=l[m];return t||A(c)}},function(e,t,n){var r=n(22),i=n(23);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var A=(e=e||{}).random||(e.rng||r)();if(A[6]=15&A[6]|64,A[8]=63&A[8]|128,t)for(var o=0;o<16;++o)t[a+o]=A[o];return t||i(A)}},,,,,,,,,function(e,t,n){e.exports={addDays:n(37),addHours:n(90),addISOYears:n(91),addMilliseconds:n(38),addMinutes:n(93),addMonths:n(55),addQuarters:n(94),addSeconds:n(95),addWeeks:n(68),addYears:n(96),areRangesOverlapping:n(443),closestIndexTo:n(444),closestTo:n(445),compareAsc:n(40),compareDesc:n(69),differenceInCalendarDays:n(54),differenceInCalendarISOWeeks:n(446),differenceInCalendarISOYears:n(97),differenceInCalendarMonths:n(98),differenceInCalendarQuarters:n(447),differenceInCalendarWeeks:n(448),differenceInCalendarYears:n(100),differenceInDays:n(101),differenceInHours:n(449),differenceInISOYears:n(450),differenceInMilliseconds:n(56),differenceInMinutes:n(451),differenceInMonths:n(70),differenceInQuarters:n(452),differenceInSeconds:n(71),differenceInWeeks:n(453),differenceInYears:n(454),distanceInWords:n(103),distanceInWordsStrict:n(458),distanceInWordsToNow:n(459),eachDay:n(460),endOfDay:n(73),endOfHour:n(461),endOfISOWeek:n(462),endOfISOYear:n(463),endOfMinute:n(464),endOfMonth:n(105),endOfQuarter:n(465),endOfSecond:n(466),endOfToday:n(467),endOfTomorrow:n(468),endOfWeek:n(104),endOfYear:n(469),endOfYesterday:n(470),format:n(471),getDate:n(472),getDay:n(473),getDayOfYear:n(106),getDaysInMonth:n(67),getDaysInYear:n(474),getHours:n(475),getISODay:n(110),getISOWeek:n(74),getISOWeeksInYear:n(476),getISOYear:n(30),getMilliseconds:n(477),getMinutes:n(478),getMonth:n(479),getOverlappingDaysInRanges:n(480),getQuarter:n(99),getSeconds:n(481),getTime:n(482),getYear:n(483),isAfter:n(484),isBefore:n(485),isDate:n(66),isEqual:n(486),isFirstDayOfMonth:n(487),isFriday:n(488),isFuture:n(489),isLastDayOfMonth:n(490),isLeapYear:n(109),isMonday:n(491),isPast:n(492),isSameDay:n(493),isSameHour:n(111),isSameISOWeek:n(113),isSameISOYear:n(114),isSameMinute:n(115),isSameMonth:n(117),isSameQuarter:n(118),isSameSecond:n(120),isSameWeek:n(75),isSameYear:n(122),isSaturday:n(494),isSunday:n(495),isThisHour:n(496),isThisISOWeek:n(497),isThisISOYear:n(498),isThisMinute:n(499),isThisMonth:n(500),isThisQuarter:n(501),isThisSecond:n(502),isThisWeek:n(503),isThisYear:n(504),isThursday:n(505),isToday:n(506),isTomorrow:n(507),isTuesday:n(508),isValid:n(108),isWednesday:n(509),isWeekend:n(510),isWithinRange:n(511),isYesterday:n(512),lastDayOfISOWeek:n(513),lastDayOfISOYear:n(514),lastDayOfMonth:n(515),lastDayOfQuarter:n(516),lastDayOfWeek:n(123),lastDayOfYear:n(517),max:n(518),min:n(519),parse:n(2),setDate:n(520),setDay:n(521),setDayOfYear:n(522),setHours:n(523),setISODay:n(524),setISOWeek:n(525),setISOYear:n(92),setMilliseconds:n(526),setMinutes:n(527),setMonth:n(124),setQuarter:n(528),setSeconds:n(529),setYear:n(530),startOfDay:n(32),startOfHour:n(112),startOfISOWeek:n(31),startOfISOYear:n(39),startOfMinute:n(116),startOfMonth:n(531),startOfQuarter:n(119),startOfSecond:n(121),startOfToday:n(532),startOfTomorrow:n(533),startOfWeek:n(53),startOfYear:n(107),startOfYesterday:n(534),subDays:n(535),subHours:n(536),subISOYears:n(102),subMilliseconds:n(537),subMinutes:n(538),subMonths:n(539),subQuarters:n(540),subSeconds:n(541),subWeeks:n(542),subYears:n(543)}},,function(e,t,n){var r=n(2);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),a=i.getDay(),A=(a<n?7:0)+a-n;return i.setDate(i.getDate()-A),i.setHours(0,0,0,0),i}},function(e,t,n){var r=n(32);e.exports=function(e,t){var n=r(e),i=r(t),a=n.getTime()-6e4*n.getTimezoneOffset(),A=i.getTime()-6e4*i.getTimezoneOffset();return Math.round((a-A)/864e5)}},function(e,t,n){var r=n(2),i=n(67);e.exports=function(e,t){var n=r(e),a=Number(t),A=n.getMonth()+a,o=new Date(0);o.setFullYear(n.getFullYear(),A,1),o.setHours(0,0,0,0);var s=i(o);return n.setMonth(A,Math.min(s,n.getDate())),n}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()-i.getTime()}},,,,,,,,function(e,t){try{new window.MouseEvent("test")}catch(e){var n=function(e,t){t=t||{bubbles:!1,cancelable:!1};var n=document.createEvent("MouseEvent");return n.initMouseEvent(e,t.bubbles,t.cancelable,window,0,t.screenX||0,t.screenY||0,t.clientX||0,t.clientY||0,!1,!1,!1,!1,0,null),n};n.prototype=Event.prototype,window.MouseEvent=n}},,function(e,t){e.exports=function(e){return e instanceof Date}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e),n=t.getFullYear(),i=t.getMonth(),a=new Date(0);return a.setFullYear(n,i+1,0),a.setHours(0,0,0,0),a.getDate()}},function(e,t,n){var r=n(37);e.exports=function(e,t){var n=Number(t);return r(e,7*n)}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e).getTime(),i=r(t).getTime();return n>i?-1:n<i?1:0}},function(e,t,n){var r=n(2),i=n(98),a=n(40);e.exports=function(e,t){var n=r(e),A=r(t),o=a(n,A),s=Math.abs(i(n,A));return n.setMonth(n.getMonth()-o*s),o*(s-(a(n,A)===-o))}},function(e,t,n){var r=n(56);e.exports=function(e,t){var n=r(e,t)/1e3;return n>0?Math.floor(n):Math.ceil(n)}},function(e,t,n){var r=n(455),i=n(456);e.exports={distanceInWords:r(),format:i()}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e);return t.setHours(23,59,59,999),t}},function(e,t,n){var r=n(2),i=n(31),a=n(39);e.exports=function(e){var t=r(e),n=i(t).getTime()-a(t).getTime();return Math.round(n/6048e5)+1}},function(e,t,n){var r=n(53);e.exports=function(e,t,n){var i=r(e,n),a=r(t,n);return i.getTime()===a.getTime()}},,,,,,,,,,,,,,function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(38);e.exports=function(e,t){var n=Number(t);return r(e,36e5*n)}},function(e,t,n){var r=n(30),i=n(92);e.exports=function(e,t){var n=Number(t);return i(e,r(e)+n)}},function(e,t,n){var r=n(2),i=n(39),a=n(54);e.exports=function(e,t){var n=r(e),A=Number(t),o=a(n,i(n)),s=new Date(0);return s.setFullYear(A,0,4),s.setHours(0,0,0,0),(n=i(s)).setDate(n.getDate()+o),n}},function(e,t,n){var r=n(38);e.exports=function(e,t){var n=Number(t);return r(e,6e4*n)}},function(e,t,n){var r=n(55);e.exports=function(e,t){var n=Number(t);return r(e,3*n)}},function(e,t,n){var r=n(38);e.exports=function(e,t){var n=Number(t);return r(e,1e3*n)}},function(e,t,n){var r=n(55);e.exports=function(e,t){var n=Number(t);return r(e,12*n)}},function(e,t,n){var r=n(30);e.exports=function(e,t){return r(e)-r(t)}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=r(t);return 12*(n.getFullYear()-i.getFullYear())+(n.getMonth()-i.getMonth())}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e);return Math.floor(t.getMonth()/3)+1}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=r(t);return n.getFullYear()-i.getFullYear()}},function(e,t,n){var r=n(2),i=n(54),a=n(40);e.exports=function(e,t){var n=r(e),A=r(t),o=a(n,A),s=Math.abs(i(n,A));return n.setDate(n.getDate()-o*s),o*(s-(a(n,A)===-o))}},function(e,t,n){var r=n(91);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(69),i=n(2),a=n(71),A=n(70),o=n(72);e.exports=function(e,t,n){var s=n||{},u=r(e,t),c=s.locale,l=o.distanceInWords.localize;c&&c.distanceInWords&&c.distanceInWords.localize&&(l=c.distanceInWords.localize);var h,d,f={addSuffix:Boolean(s.addSuffix),comparison:u};u>0?(h=i(e),d=i(t)):(h=i(t),d=i(e));var p,g=a(d,h),y=d.getTimezoneOffset()-h.getTimezoneOffset(),v=Math.round(g/60)-y;if(v<2)return s.includeSeconds?g<5?l("lessThanXSeconds",5,f):g<10?l("lessThanXSeconds",10,f):g<20?l("lessThanXSeconds",20,f):g<40?l("halfAMinute",null,f):l(g<60?"lessThanXMinutes":"xMinutes",1,f):0===v?l("lessThanXMinutes",1,f):l("xMinutes",v,f);if(v<45)return l("xMinutes",v,f);if(v<90)return l("aboutXHours",1,f);if(v<1440)return l("aboutXHours",Math.round(v/60),f);if(v<2520)return l("xDays",1,f);if(v<43200)return l("xDays",Math.round(v/1440),f);if(v<86400)return l("aboutXMonths",p=Math.round(v/43200),f);if((p=A(d,h))<12)return l("xMonths",Math.round(v/43200),f);var m=p%12,E=Math.floor(p/12);return m<3?l("aboutXYears",E,f):m<9?l("overXYears",E,f):l("almostXYears",E+1,f)}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),a=i.getDay(),A=6+(a<n?-7:0)-(a-n);return i.setDate(i.getDate()+A),i.setHours(23,59,59,999),i}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}},function(e,t,n){var r=n(2),i=n(107),a=n(54);e.exports=function(e){var t=r(e);return a(t,i(t))+1}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}},function(e,t,n){var r=n(66);e.exports=function(e){if(r(e))return!isNaN(e);throw new TypeError(toString.call(e)+" is not an instance of Date")}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e).getFullYear();return t%400==0||t%4==0&&t%100!=0}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e).getDay();return 0===t&&(t=7),t}},function(e,t,n){var r=n(112);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e);return t.setMinutes(0,0,0),t}},function(e,t,n){var r=n(75);e.exports=function(e,t){return r(e,t,{weekStartsOn:1})}},function(e,t,n){var r=n(39);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(116);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e);return t.setSeconds(0,0),t}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=r(t);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}},function(e,t,n){var r=n(119);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e),n=t.getMonth(),i=n-n%3;return t.setMonth(i,1),t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(121);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e);return t.setMilliseconds(0),t}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=r(t);return n.getFullYear()===i.getFullYear()}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),a=i.getDay(),A=6+(a<n?-7:0)-(a-n);return i.setHours(0,0,0,0),i.setDate(i.getDate()+A),i}},function(e,t,n){var r=n(2),i=n(67);e.exports=function(e,t){var n=r(e),a=Number(t),A=n.getFullYear(),o=n.getDate(),s=new Date(0);s.setFullYear(A,a,15),s.setHours(0,0,0,0);var u=i(s);return n.setMonth(a,Math.min(o,u)),n}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){!function(){var t=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],n="undefined"!=typeof window,r=n&&null!=window.mozInnerScreenX;function i(e,i,a){var A=e.ownerDocument,o=A.defaultView||A.parentWindow;if(!n)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var s=a&&a.debug||!1;if(s){var u=A.querySelector("#input-textarea-caret-position-mirror-div");u&&u.parentNode.removeChild(u)}var c=A.createElement("div");c.id="input-textarea-caret-position-mirror-div",A.body.appendChild(c);var l=c.style,h=o.getComputedStyle?o.getComputedStyle(e):e.currentStyle,d="INPUT"===e.nodeName;l.whiteSpace="pre-wrap",d||(l.wordWrap="break-word"),l.position="absolute",s||(l.visibility="hidden"),t.forEach((function(e){d&&"lineHeight"===e?l.lineHeight=h.height:l[e]=h[e]})),r?e.scrollHeight>parseInt(h.height)&&(l.overflowY="scroll"):l.overflow="hidden",c.textContent=e.value.substring(0,i),d&&(c.textContent=c.textContent.replace(/\s/g," "));var f=A.createElement("span");f.textContent=e.value.substring(i)||".",c.appendChild(f);var p={top:f.offsetTop+parseInt(h.borderTopWidth),left:f.offsetLeft+parseInt(h.borderLeftWidth),height:parseInt(h.lineHeight)};return s?f.style.backgroundColor="#aaa":A.body.removeChild(c),p}void 0!==e.exports?e.exports=i:n&&(_window.getCaretCoordinates=i)}()},function(e,t){e.exports="\n#define MESHLINE_PATH_ROUND_CAP     2.\n#define MESHLINE_PATH_FLAT_CAP      3.\nattribute vec3 position;\nattribute vec2 previous;\nattribute vec2 next;\nattribute float side;\nattribute float width;\nattribute float counters;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform vec2 resolution;\nuniform float lineWidth;\nuniform float opacity;\nvarying float vCounters;\nvarying float vPointType;\nvarying float vDistance;\nvarying float aaRange;\nvarying float totalWidth;\nvarying vec2 center;\nvarying vec2 finalPos;\nfloat when_eq(float x, float y) {\n  return 1.0 - abs(sign(x - y));\n}\nfloat when_neq(float x, float y) {\n  return abs(sign(x - y));\n}\nvoid main() {\n    float pixelsPerUnit = 0.5 * resolution.x * projectionMatrix[0][0];\n    vCounters = counters;\n    vPointType = abs(side);\n    float sideSgn = sign(side);\n    vec4 curPosition = modelViewMatrix * vec4(position.xy, 0.0, 1.0);\n    vec2 prevPos = (modelViewMatrix * vec4(previous, 0.0, 1.0)).xy;\n    vec2 nextPos = (modelViewMatrix * vec4(next, 0.0, 1.0)).xy;\n#ifdef IS_IE_11\n    aaRange = when_neq(width, 0.0) * when_eq(opacity, 1.0) * 1.0 / pixelsPerUnit;\n#else\n    aaRange = when_neq(width, 0.0) * 1.0 / pixelsPerUnit;\n#endif\n    \n    float minSize = when_neq(width, 0.0) * 0.5 / pixelsPerUnit;    \n   \n    totalWidth = lineWidth * width;\n    \n    float w = max(.5 * totalWidth, minSize) + aaRange;\n    \n    vDistance = w * sideSgn;\n    vec2 dir;\n    if (nextPos == curPosition.xy) {\n        dir = normalize(curPosition.xy - prevPos);\n    } else if (prevPos == curPosition.xy) {\n        dir = normalize(nextPos - curPosition.xy);\n    } else {\n#ifdef MITER\n        vec2 dir1 = normalize(curPosition.xy - prevPos);\n        vec2 dir2 = normalize(nextPos - curPosition.xy);\n        dir = normalize(dir1 + dir2);\n        vec2 perp = vec2(-dir1.y, dir1.x);\n        vec2 miter = vec2(-dir.y, dir.x);\n        w = clamp(w / dot(miter, perp), minSize + aaRange, 20. * w);\n#else\n        dir = normalize(curPosition.xy - prevPos);\n#endif\n    }\n    vec2 normal = vec2(-dir.y, dir.x);\n    normal *= w * sideSgn;\n    \n    if (vPointType == MESHLINE_PATH_ROUND_CAP) {\n        center = curPosition.xy;\n        curPosition.xy += normal;\n    } else  {\n        curPosition.xy += normal;\n        center = curPosition.xy;\n    }\n    \n    if (vCounters < 0.0 || vCounters > 1.0) {\n        normal = vec2(dir.x, dir.y);\n        normal *= sign(vCounters) * w;\n        curPosition.xy += normal;\n    }\n  \n    finalPos = curPosition.xy;\n    gl_Position = projectionMatrix * curPosition;\n}\n"},function(e,t){e.exports="#define MESHLINE_PATH_FLAT_CAP      3.0\nuniform vec3 color;\nuniform float opacity;\nvarying float vCounters;\nvarying float vDistance;\nvarying float aaRange;\nvarying float totalWidth;\nvarying vec2 center;\nvarying vec2 finalPos;\nvarying float vPointType;\nfloat when_eq(float x, float y) {\n  return 1.0 - abs(sign(x - y));\n}\nfloat getSmoothStep(float t, float d) {\n    return smoothstep(t - aaRange, t + aaRange, abs(d));\n}\nvoid main() {\n    float t = totalWidth / 2.0;\n    float d = vDistance;\n    float aa = 1.0;\n    if (vCounters < 0.0 || vCounters > 1.0) {\n        d = length(finalPos - center);\n        if (vPointType == MESHLINE_PATH_FLAT_CAP) {\n            t = aaRange;\n        }\n        if (d > t + aaRange) {\n            discard;\n        }\n        aa = 1.0 - getSmoothStep(t, d);       \n    }\n        \n#ifdef IS_IE_11\n    aa = (1.0 - when_eq(opacity, 1.0) * getSmoothStep(totalWidth / 2.0, vDistance)) * aa;\n#else\n    aa = (1.0 - getSmoothStep(totalWidth / 2.0, vDistance)) * aa;\n#endif\n    gl_FragColor = vec4(color, opacity * aa);\n}\n"},function(e,t,n){(function(e){var n,r,i,a;function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*!
                                                                                                                                                                                                                                                                                                                                                                                * html2canvas 1.0.0-alpha.12 <https://html2canvas.hertzen.com>
                                                                                                                                                                                                                                                                                                                                                                                * Copyright (c) 2018 Niklas von Hertzen <https://hertzen.com>
                                                                                                                                                                                                                                                                                                                                                                                * Released under MIT License
                                                                                                                                                                                                                                                                                                                                                                                */a=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=27)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var A,o=e[Symbol.iterator]();!(r=(A=o.next()).done)&&(n.push(A.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=/^#([a-f0-9]{3})$/i,A=/^#([a-f0-9]{6})$/i,o=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/,s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/,u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n,i=Array.isArray(t)?(n=t,[Math.min(n[0],255),Math.min(n[1],255),Math.min(n[2],255),n.length>3?n[3]:null]):function(e){var t=e.match(a);return!!t&&[parseInt(t[1][0]+t[1][0],16),parseInt(t[1][1]+t[1][1],16),parseInt(t[1][2]+t[1][2],16),null]}(t)||function(e){var t=e.match(o);return!!t&&[Number(t[1]),Number(t[2]),Number(t[3]),null]}(t)||function(e){var t=e.match(s);return!!(t&&t.length>4)&&[Number(t[1]),Number(t[2]),Number(t[3]),Number(t[4])]}(t)||c[t.toLowerCase()]||!1||function(e){var t=e.match(A);return!!t&&[parseInt(t[1].substring(0,2),16),parseInt(t[1].substring(2,4),16),parseInt(t[1].substring(4,6),16),null]}(t)||[0,0,0,null],u=r(i,4),l=u[0],h=u[1],d=u[2],f=u[3];this.r=l,this.g=h,this.b=d,this.a=f}return i(e,[{key:"isTransparent",value:function(){return 0===this.a}},{key:"toString",value:function(){return null!==this.a&&1!==this.a?"rgba("+this.r+","+this.g+","+this.b+","+this.a+")":"rgb("+this.r+","+this.g+","+this.b+")"}}]),e}();t.default=u;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,null],antiquewhite:[250,235,215,null],aqua:[0,255,255,null],aquamarine:[127,255,212,null],azure:[240,255,255,null],beige:[245,245,220,null],bisque:[255,228,196,null],black:[0,0,0,null],blanchedalmond:[255,235,205,null],blue:[0,0,255,null],blueviolet:[138,43,226,null],brown:[165,42,42,null],burlywood:[222,184,135,null],cadetblue:[95,158,160,null],chartreuse:[127,255,0,null],chocolate:[210,105,30,null],coral:[255,127,80,null],cornflowerblue:[100,149,237,null],cornsilk:[255,248,220,null],crimson:[220,20,60,null],cyan:[0,255,255,null],darkblue:[0,0,139,null],darkcyan:[0,139,139,null],darkgoldenrod:[184,134,11,null],darkgray:[169,169,169,null],darkgreen:[0,100,0,null],darkgrey:[169,169,169,null],darkkhaki:[189,183,107,null],darkmagenta:[139,0,139,null],darkolivegreen:[85,107,47,null],darkorange:[255,140,0,null],darkorchid:[153,50,204,null],darkred:[139,0,0,null],darksalmon:[233,150,122,null],darkseagreen:[143,188,143,null],darkslateblue:[72,61,139,null],darkslategray:[47,79,79,null],darkslategrey:[47,79,79,null],darkturquoise:[0,206,209,null],darkviolet:[148,0,211,null],deeppink:[255,20,147,null],deepskyblue:[0,191,255,null],dimgray:[105,105,105,null],dimgrey:[105,105,105,null],dodgerblue:[30,144,255,null],firebrick:[178,34,34,null],floralwhite:[255,250,240,null],forestgreen:[34,139,34,null],fuchsia:[255,0,255,null],gainsboro:[220,220,220,null],ghostwhite:[248,248,255,null],gold:[255,215,0,null],goldenrod:[218,165,32,null],gray:[128,128,128,null],green:[0,128,0,null],greenyellow:[173,255,47,null],grey:[128,128,128,null],honeydew:[240,255,240,null],hotpink:[255,105,180,null],indianred:[205,92,92,null],indigo:[75,0,130,null],ivory:[255,255,240,null],khaki:[240,230,140,null],lavender:[230,230,250,null],lavenderblush:[255,240,245,null],lawngreen:[124,252,0,null],lemonchiffon:[255,250,205,null],lightblue:[173,216,230,null],lightcoral:[240,128,128,null],lightcyan:[224,255,255,null],lightgoldenrodyellow:[250,250,210,null],lightgray:[211,211,211,null],lightgreen:[144,238,144,null],lightgrey:[211,211,211,null],lightpink:[255,182,193,null],lightsalmon:[255,160,122,null],lightseagreen:[32,178,170,null],lightskyblue:[135,206,250,null],lightslategray:[119,136,153,null],lightslategrey:[119,136,153,null],lightsteelblue:[176,196,222,null],lightyellow:[255,255,224,null],lime:[0,255,0,null],limegreen:[50,205,50,null],linen:[250,240,230,null],magenta:[255,0,255,null],maroon:[128,0,0,null],mediumaquamarine:[102,205,170,null],mediumblue:[0,0,205,null],mediumorchid:[186,85,211,null],mediumpurple:[147,112,219,null],mediumseagreen:[60,179,113,null],mediumslateblue:[123,104,238,null],mediumspringgreen:[0,250,154,null],mediumturquoise:[72,209,204,null],mediumvioletred:[199,21,133,null],midnightblue:[25,25,112,null],mintcream:[245,255,250,null],mistyrose:[255,228,225,null],moccasin:[255,228,181,null],navajowhite:[255,222,173,null],navy:[0,0,128,null],oldlace:[253,245,230,null],olive:[128,128,0,null],olivedrab:[107,142,35,null],orange:[255,165,0,null],orangered:[255,69,0,null],orchid:[218,112,214,null],palegoldenrod:[238,232,170,null],palegreen:[152,251,152,null],paleturquoise:[175,238,238,null],palevioletred:[219,112,147,null],papayawhip:[255,239,213,null],peachpuff:[255,218,185,null],peru:[205,133,63,null],pink:[255,192,203,null],plum:[221,160,221,null],powderblue:[176,224,230,null],purple:[128,0,128,null],rebeccapurple:[102,51,153,null],red:[255,0,0,null],rosybrown:[188,143,143,null],royalblue:[65,105,225,null],saddlebrown:[139,69,19,null],salmon:[250,128,114,null],sandybrown:[244,164,96,null],seagreen:[46,139,87,null],seashell:[255,245,238,null],sienna:[160,82,45,null],silver:[192,192,192,null],skyblue:[135,206,235,null],slateblue:[106,90,205,null],slategray:[112,128,144,null],slategrey:[112,128,144,null],snow:[255,250,250,null],springgreen:[0,255,127,null],steelblue:[70,130,180,null],tan:[210,180,140,null],teal:[0,128,128,null],thistle:[216,191,216,null],tomato:[255,99,71,null],turquoise:[64,224,208,null],violet:[238,130,238,null],wheat:[245,222,179,null],white:[255,255,255,null],whitesmoke:[245,245,245,null],yellow:[255,255,0,null],yellowgreen:[154,205,50,null]};t.TRANSPARENT=new u([0,0,0,0])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateLengthFromValueWithUnit=t.LENGTH_TYPE=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(3);(r=a)&&r.__esModule;var A=t.LENGTH_TYPE={PX:0,PERCENTAGE:1},o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="%"===t.substr(t.length-1)?A.PERCENTAGE:A.PX;var n=parseFloat(t);isNaN(n)&&console.error('Invalid value given for Length: "'+t+'"'),this.value=isNaN(n)?0:n}return i(e,[{key:"isPercentage",value:function(){return this.type===A.PERCENTAGE}},{key:"getAbsoluteValue",value:function(e){return this.isPercentage()?e*(this.value/100):this.value}}],[{key:"create",value:function(t){return new e(t)}}]),e}();t.default=o,t.calculateLengthFromValueWithUnit=function(e,t,n){switch(n){case"px":case"%":return new o(t+n);case"em":case"rem":var r=new o(t);return r.value*="em"===n?parseFloat(e.style.font.fontSize):function e(t){var n=t.parent;return n?e(n):parseFloat(t.style.font.fontSize)}(e),r;default:return new o("0")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBoundCurves=t.calculatePaddingBoxPath=t.calculateBorderBoxPath=t.parsePathForBorder=t.parseDocumentSize=t.calculateContentBox=t.calculatePaddingBox=t.parseBounds=t.Bounds=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=A(n(7)),a=A(n(32));function A(e){return e&&e.__esModule?e:{default:e}}var o=t.Bounds=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.left=t,this.top=n,this.width=r,this.height=i}return r(e,null,[{key:"fromClientRect",value:function(t,n,r){return new e(t.left+n,t.top+r,t.width,t.height)}}]),e}(),s=(t.parseBounds=function(e,t,n){return o.fromClientRect(e.getBoundingClientRect(),t,n)},t.calculatePaddingBox=function(e,t){return new o(e.left+t[3].borderWidth,e.top+t[0].borderWidth,e.width-(t[1].borderWidth+t[3].borderWidth),e.height-(t[0].borderWidth+t[2].borderWidth))},t.calculateContentBox=function(e,t,n){var r=t[0].value,i=t[1].value,a=t[2].value,A=t[3].value;return new o(e.left+A+n[3].borderWidth,e.top+r+n[0].borderWidth,e.width-(n[1].borderWidth+n[3].borderWidth+A+i),e.height-(n[0].borderWidth+n[2].borderWidth+r+a))},t.parseDocumentSize=function(e){var t=e.body,n=e.documentElement;if(!t||!n)throw new Error("Unable to get document size");var r=Math.max(Math.max(t.scrollWidth,n.scrollWidth),Math.max(t.offsetWidth,n.offsetWidth),Math.max(t.clientWidth,n.clientWidth)),i=Math.max(Math.max(t.scrollHeight,n.scrollHeight),Math.max(t.offsetHeight,n.offsetHeight),Math.max(t.clientHeight,n.clientHeight));return new o(0,0,r,i)},t.parsePathForBorder=function(e,t){switch(t){case 0:return s(e.topLeftOuter,e.topLeftInner,e.topRightOuter,e.topRightInner);case 1:return s(e.topRightOuter,e.topRightInner,e.bottomRightOuter,e.bottomRightInner);case 2:return s(e.bottomRightOuter,e.bottomRightInner,e.bottomLeftOuter,e.bottomLeftInner);case 3:default:return s(e.bottomLeftOuter,e.bottomLeftInner,e.topLeftOuter,e.topLeftInner)}},function(e,t,n,r){var i=[];return e instanceof a.default?i.push(e.subdivide(.5,!1)):i.push(e),n instanceof a.default?i.push(n.subdivide(.5,!0)):i.push(n),r instanceof a.default?i.push(r.subdivide(.5,!0).reverse()):i.push(r),t instanceof a.default?i.push(t.subdivide(.5,!1).reverse()):i.push(t),i}),u=(t.calculateBorderBoxPath=function(e){return[e.topLeftOuter,e.topRightOuter,e.bottomRightOuter,e.bottomLeftOuter]},t.calculatePaddingBoxPath=function(e){return[e.topLeftInner,e.topRightInner,e.bottomRightInner,e.bottomLeftInner]},t.parseBoundCurves=function(e,t,n){var r=n[u.TOP_LEFT][0].getAbsoluteValue(e.width),a=n[u.TOP_LEFT][1].getAbsoluteValue(e.height),A=n[u.TOP_RIGHT][0].getAbsoluteValue(e.width),o=n[u.TOP_RIGHT][1].getAbsoluteValue(e.height),s=n[u.BOTTOM_RIGHT][0].getAbsoluteValue(e.width),l=n[u.BOTTOM_RIGHT][1].getAbsoluteValue(e.height),h=n[u.BOTTOM_LEFT][0].getAbsoluteValue(e.width),d=n[u.BOTTOM_LEFT][1].getAbsoluteValue(e.height),f=[];f.push((r+A)/e.width),f.push((h+s)/e.width),f.push((a+d)/e.height),f.push((o+l)/e.height);var p=Math.max.apply(Math,f);p>1&&(r/=p,a/=p,A/=p,o/=p,s/=p,l/=p,h/=p,d/=p);var g=e.width-A,y=e.height-l,v=e.width-s,m=e.height-d;return{topLeftOuter:r>0||a>0?c(e.left,e.top,r,a,u.TOP_LEFT):new i.default(e.left,e.top),topLeftInner:r>0||a>0?c(e.left+t[3].borderWidth,e.top+t[0].borderWidth,Math.max(0,r-t[3].borderWidth),Math.max(0,a-t[0].borderWidth),u.TOP_LEFT):new i.default(e.left+t[3].borderWidth,e.top+t[0].borderWidth),topRightOuter:A>0||o>0?c(e.left+g,e.top,A,o,u.TOP_RIGHT):new i.default(e.left+e.width,e.top),topRightInner:A>0||o>0?c(e.left+Math.min(g,e.width+t[3].borderWidth),e.top+t[0].borderWidth,g>e.width+t[3].borderWidth?0:A-t[3].borderWidth,o-t[0].borderWidth,u.TOP_RIGHT):new i.default(e.left+e.width-t[1].borderWidth,e.top+t[0].borderWidth),bottomRightOuter:s>0||l>0?c(e.left+v,e.top+y,s,l,u.BOTTOM_RIGHT):new i.default(e.left+e.width,e.top+e.height),bottomRightInner:s>0||l>0?c(e.left+Math.min(v,e.width-t[3].borderWidth),e.top+Math.min(y,e.height+t[0].borderWidth),Math.max(0,s-t[1].borderWidth),l-t[2].borderWidth,u.BOTTOM_RIGHT):new i.default(e.left+e.width-t[1].borderWidth,e.top+e.height-t[2].borderWidth),bottomLeftOuter:h>0||d>0?c(e.left,e.top+m,h,d,u.BOTTOM_LEFT):new i.default(e.left,e.top+e.height),bottomLeftInner:h>0||d>0?c(e.left+t[3].borderWidth,e.top+m,Math.max(0,h-t[3].borderWidth),d-t[2].borderWidth,u.BOTTOM_LEFT):new i.default(e.left+t[3].borderWidth,e.top+e.height-t[2].borderWidth)}},{TOP_LEFT:0,TOP_RIGHT:1,BOTTOM_RIGHT:2,BOTTOM_LEFT:3}),c=function(e,t,n,r,A){var o=(Math.sqrt(2)-1)/3*4,s=n*o,c=r*o,l=e+n,h=t+r;switch(A){case u.TOP_LEFT:return new a.default(new i.default(e,h),new i.default(e,h-c),new i.default(l-s,t),new i.default(l,t));case u.TOP_RIGHT:return new a.default(new i.default(e,t),new i.default(e+s,t),new i.default(l,h-c),new i.default(l,h));case u.BOTTOM_RIGHT:return new a.default(new i.default(l,t),new i.default(l,t+c),new i.default(e+s,h),new i.default(e,h));case u.BOTTOM_LEFT:default:return new a.default(new i.default(l,h),new i.default(l-s,h),new i.default(e,t+c),new i.default(e,t))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),A=(r=a)&&r.__esModule?r:{default:r},o=n(4),s=n(5),u=n(12),c=n(33),l=n(34),h=n(35),d=n(36),f=n(37),p=n(38),g=n(8),y=n(39),v=n(40),m=n(18),E=n(17),B=n(19),w=n(11),k=n(41),C=n(20),b=n(42),S=n(43),T=n(44),M=n(45),U=n(2),Q=n(21),x=n(14),F=["INPUT","TEXTAREA","SELECT"],_=function(){function e(t,n,r,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=n,this.tagName=t.tagName,this.index=i,this.childNodes=[],this.listItems=[],"number"==typeof t.start&&(this.listStart=t.start);var o=t.ownerDocument.defaultView,_=o.pageXOffset,R=o.pageYOffset,L=o.getComputedStyle(t,null),D=(0,l.parseDisplay)(L.display),I="radio"===t.type||"checkbox"===t.type,O=(0,B.parsePosition)(L.position);if(this.style={background:I?Q.INPUT_BACKGROUND:(0,s.parseBackground)(L,r),border:I?Q.INPUT_BORDERS:(0,u.parseBorder)(L),borderRadius:(t instanceof o.HTMLInputElement||t instanceof HTMLInputElement)&&I?(0,Q.getInputBorderRadius)(t):(0,c.parseBorderRadius)(L),color:I?Q.INPUT_COLOR:new A.default(L.color),display:D,float:(0,h.parseCSSFloat)(L.float),font:(0,d.parseFont)(L),letterSpacing:(0,f.parseLetterSpacing)(L.letterSpacing),listStyle:D===l.DISPLAY.LIST_ITEM?(0,g.parseListStyle)(L):null,lineBreak:(0,p.parseLineBreak)(L.lineBreak),margin:(0,y.parseMargin)(L),opacity:parseFloat(L.opacity),overflow:-1===F.indexOf(t.tagName)?(0,v.parseOverflow)(L.overflow):v.OVERFLOW.HIDDEN,overflowWrap:(0,m.parseOverflowWrap)(L.overflowWrap?L.overflowWrap:L.wordWrap),padding:(0,E.parsePadding)(L),position:O,textDecoration:(0,w.parseTextDecoration)(L),textShadow:(0,k.parseTextShadow)(L.textShadow),textTransform:(0,C.parseTextTransform)(L.textTransform),transform:(0,b.parseTransform)(L),visibility:(0,S.parseVisibility)(L.visibility),wordBreak:(0,T.parseWordBreak)(L.wordBreak),zIndex:(0,M.parseZIndex)(O!==B.POSITION.STATIC?L.zIndex:"auto")},this.isTransformed()&&(t.style.transform="matrix(1,0,0,1,0,0)"),D===l.DISPLAY.LIST_ITEM){var N=(0,x.getListOwner)(this);if(N){var P=N.listItems.length;N.listItems.push(this),this.listIndex=t.hasAttribute("value")&&"number"==typeof t.value?t.value:0===P?"number"==typeof N.listStart?N.listStart:1:N.listItems[P-1].listIndex+1}}"IMG"===t.tagName&&t.addEventListener("load",(function(){a.bounds=(0,U.parseBounds)(t,_,R),a.curvedBounds=(0,U.parseBoundCurves)(a.bounds,a.style.border,a.style.borderRadius)})),this.image=H(t,r),this.bounds=I?(0,Q.reformatInputBounds)((0,U.parseBounds)(t,_,R)):(0,U.parseBounds)(t,_,R),this.curvedBounds=(0,U.parseBoundCurves)(this.bounds,this.style.border,this.style.borderRadius),this.name=t.tagName.toLowerCase()+(t.id?"#"+t.id:"")+t.className.toString().split(" ").map((function(e){return e.length?"."+e:""})).join("")}return i(e,[{key:"getClipPaths",value:function(){var e=this.parent?this.parent.getClipPaths():[];return this.style.overflow!==v.OVERFLOW.VISIBLE?e.concat([(0,U.calculatePaddingBoxPath)(this.curvedBounds)]):e}},{key:"isInFlow",value:function(){return this.isRootElement()&&!this.isFloating()&&!this.isAbsolutelyPositioned()}},{key:"isVisible",value:function(){return!(0,o.contains)(this.style.display,l.DISPLAY.NONE)&&this.style.opacity>0&&this.style.visibility===S.VISIBILITY.VISIBLE}},{key:"isAbsolutelyPositioned",value:function(){return this.style.position!==B.POSITION.STATIC&&this.style.position!==B.POSITION.RELATIVE}},{key:"isPositioned",value:function(){return this.style.position!==B.POSITION.STATIC}},{key:"isFloating",value:function(){return this.style.float!==h.FLOAT.NONE}},{key:"isRootElement",value:function(){return null===this.parent}},{key:"isTransformed",value:function(){return null!==this.style.transform}},{key:"isPositionedWithZIndex",value:function(){return this.isPositioned()&&!this.style.zIndex.auto}},{key:"isInlineLevel",value:function(){return(0,o.contains)(this.style.display,l.DISPLAY.INLINE)||(0,o.contains)(this.style.display,l.DISPLAY.INLINE_BLOCK)||(0,o.contains)(this.style.display,l.DISPLAY.INLINE_FLEX)||(0,o.contains)(this.style.display,l.DISPLAY.INLINE_GRID)||(0,o.contains)(this.style.display,l.DISPLAY.INLINE_LIST_ITEM)||(0,o.contains)(this.style.display,l.DISPLAY.INLINE_TABLE)}},{key:"isInlineBlockOrInlineTable",value:function(){return(0,o.contains)(this.style.display,l.DISPLAY.INLINE_BLOCK)||(0,o.contains)(this.style.display,l.DISPLAY.INLINE_TABLE)}}]),e}();t.default=_;var H=function(e,t){if(e instanceof e.ownerDocument.defaultView.SVGSVGElement||e instanceof SVGSVGElement){var n=new XMLSerializer;return t.loadImage("data:image/svg+xml,"+encodeURIComponent(n.serializeToString(e)))}switch(e.tagName){case"IMG":var r=e;return t.loadImage(r.currentSrc||r.src);case"CANVAS":var i=e;return t.loadCanvas(i);case"IFRAME":var a=e.getAttribute("data-html2canvas-internal-iframe-key");if(a)return a}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contains=function(e,t){return 0!=(e&t)},t.distance=function(e,t){return Math.sqrt(e*e+t*t)},t.copyCSSStyles=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e.item(n);"content"!==r&&t.style.setProperty(r,e.getPropertyValue(r))}return t},t.SMALL_IMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBackgroundImage=t.parseBackground=t.calculateBackgroundRepeatPath=t.calculateBackgroundPosition=t.calculateBackgroungPositioningArea=t.calculateBackgroungPaintingArea=t.calculateGradientBackgroundSize=t.calculateBackgroundSize=t.BACKGROUND_ORIGIN=t.BACKGROUND_CLIP=t.BACKGROUND_SIZE=t.BACKGROUND_REPEAT=void 0;var r=u(n(0)),i=u(n(1)),a=u(n(31)),A=u(n(7)),o=n(2),s=n(17);function u(e){return e&&e.__esModule?e:{default:e}}var c=t.BACKGROUND_REPEAT={REPEAT:0,NO_REPEAT:1,REPEAT_X:2,REPEAT_Y:3},l=t.BACKGROUND_SIZE={AUTO:0,CONTAIN:1,COVER:2,LENGTH:3},h=t.BACKGROUND_CLIP={BORDER_BOX:0,PADDING_BOX:1,CONTENT_BOX:2},d=t.BACKGROUND_ORIGIN=h,f=function e(t){switch(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t){case"contain":this.size=l.CONTAIN;break;case"cover":this.size=l.COVER;break;case"auto":this.size=l.AUTO;break;default:this.value=new i.default(t)}},p=(t.calculateBackgroundSize=function(e,t,n){var r=0,i=0,A=e.size;if(A[0].size===l.CONTAIN||A[0].size===l.COVER){var o=n.width/n.height,s=t.width/t.height;return o<s!=(A[0].size===l.COVER)?new a.default(n.width,n.width/s):new a.default(n.height*s,n.height)}return A[0].value&&(r=A[0].value.getAbsoluteValue(n.width)),A[0].size===l.AUTO&&A[1].size===l.AUTO?i=t.height:A[1].size===l.AUTO?i=r/t.width*t.height:A[1].value&&(i=A[1].value.getAbsoluteValue(n.height)),A[0].size===l.AUTO&&(r=i/t.height*t.width),new a.default(r,i)},t.calculateGradientBackgroundSize=function(e,t){var n=e.size,r=n[0].value?n[0].value.getAbsoluteValue(t.width):t.width,i=n[1].value?n[1].value.getAbsoluteValue(t.height):n[0].value?r:t.height;return new a.default(r,i)},new f("auto")),g=(t.calculateBackgroungPaintingArea=function(e,t){switch(t){case h.BORDER_BOX:return(0,o.calculateBorderBoxPath)(e);case h.PADDING_BOX:default:return(0,o.calculatePaddingBoxPath)(e)}},t.calculateBackgroungPositioningArea=function(e,t,n,r){var i=(0,o.calculatePaddingBox)(t,r);switch(e){case d.BORDER_BOX:return t;case d.CONTENT_BOX:var a=n[s.PADDING_SIDES.LEFT].getAbsoluteValue(t.width),A=n[s.PADDING_SIDES.RIGHT].getAbsoluteValue(t.width),u=n[s.PADDING_SIDES.TOP].getAbsoluteValue(t.width),c=n[s.PADDING_SIDES.BOTTOM].getAbsoluteValue(t.width);return new o.Bounds(i.left+a,i.top+u,i.width-a-A,i.height-u-c);case d.PADDING_BOX:default:return i}},t.calculateBackgroundPosition=function(e,t,n){return new A.default(e[0].getAbsoluteValue(n.width-t.width),e[1].getAbsoluteValue(n.height-t.height))},t.calculateBackgroundRepeatPath=function(e,t,n,r,i){switch(e.repeat){case c.REPEAT_X:return[new A.default(Math.round(i.left),Math.round(r.top+t.y)),new A.default(Math.round(i.left+i.width),Math.round(r.top+t.y)),new A.default(Math.round(i.left+i.width),Math.round(n.height+r.top+t.y)),new A.default(Math.round(i.left),Math.round(n.height+r.top+t.y))];case c.REPEAT_Y:return[new A.default(Math.round(r.left+t.x),Math.round(i.top)),new A.default(Math.round(r.left+t.x+n.width),Math.round(i.top)),new A.default(Math.round(r.left+t.x+n.width),Math.round(i.height+i.top)),new A.default(Math.round(r.left+t.x),Math.round(i.height+i.top))];case c.NO_REPEAT:return[new A.default(Math.round(r.left+t.x),Math.round(r.top+t.y)),new A.default(Math.round(r.left+t.x+n.width),Math.round(r.top+t.y)),new A.default(Math.round(r.left+t.x+n.width),Math.round(r.top+t.y+n.height)),new A.default(Math.round(r.left+t.x),Math.round(r.top+t.y+n.height))];default:return[new A.default(Math.round(i.left),Math.round(i.top)),new A.default(Math.round(i.left+i.width),Math.round(i.top)),new A.default(Math.round(i.left+i.width),Math.round(i.height+i.top)),new A.default(Math.round(i.left),Math.round(i.height+i.top))]}},t.parseBackground=function(e,t){return{backgroundColor:new r.default(e.backgroundColor),backgroundImage:m(e,t),backgroundClip:g(e.backgroundClip),backgroundOrigin:y(e.backgroundOrigin)}},function(e){switch(e){case"padding-box":return h.PADDING_BOX;case"content-box":return h.CONTENT_BOX}return h.BORDER_BOX}),y=function(e){switch(e){case"padding-box":return d.PADDING_BOX;case"content-box":return d.CONTENT_BOX}return d.BORDER_BOX},v=function(e){switch(e.trim()){case"no-repeat":return c.NO_REPEAT;case"repeat-x":case"repeat no-repeat":return c.REPEAT_X;case"repeat-y":case"no-repeat repeat":return c.REPEAT_Y;case"repeat":return c.REPEAT}return console.error('Invalid background-repeat value "'+e+'"'),c.REPEAT},m=function(e,t){var n=w(e.backgroundImage).map((function(e){if("url"===e.method){var n=t.loadImage(e.args[0]);e.args=n?[n]:[]}return e})),r=e.backgroundPosition.split(","),i=e.backgroundRepeat.split(","),a=e.backgroundSize.split(",");return n.map((function(e,t){var n=(a[t]||"auto").trim().split(" ").map(E),A=(r[t]||"auto").trim().split(" ").map(B);return{source:e,repeat:v("string"==typeof i[t]?i[t]:i[0]),size:n.length<2?[n[0],p]:[n[0],n[1]],position:A.length<2?[A[0],A[0]]:[A[0],A[1]]}}))},E=function(e){return"auto"===e?p:new f(e)},B=function(e){switch(e){case"bottom":case"right":return new i.default("100%");case"left":case"top":return new i.default("0%");case"auto":return new i.default("0")}return new i.default(e)},w=t.parseBackgroundImage=function(e){var t=/^\s$/,n=[],r=[],i="",a=null,A="",o=0,s=0,u=function(){var e="";if(i){'"'===A.substr(0,1)&&(A=A.substr(1,A.length-2)),A&&r.push(A.trim());var t=i.indexOf("-",1)+1;"-"===i.substr(0,1)&&t>0&&(e=i.substr(0,t).toLowerCase(),i=i.substr(t)),"none"!==(i=i.toLowerCase())&&n.push({prefix:e,method:i,args:r})}r=[],i=A=""};return e.split("").forEach((function(e){if(0!==o||!t.test(e)){switch(e){case'"':a?a===e&&(a=null):a=e;break;case"(":if(a)break;if(0===o)return void(o=1);s++;break;case")":if(a)break;if(1===o){if(0===s)return o=0,void u();s--}break;case",":if(a)break;if(0===o)return void u();if(1===o&&0===s&&!i.match(/^url$/i))return r.push(A.trim()),void(A="")}0===o?i+=e:A+=e}})),u(),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PATH={VECTOR:0,BEZIER_CURVE:1,CIRCLE:2}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=r.PATH.VECTOR,this.x=t,this.y=n,isNaN(t)&&console.error("Invalid x value given for Vector"),isNaN(n)&&console.error("Invalid y value given for Vector")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseListStyle=t.parseListStyleType=t.LIST_STYLE_TYPE=t.LIST_STYLE_POSITION=void 0;var r=n(5),i=t.LIST_STYLE_POSITION={INSIDE:0,OUTSIDE:1},a=t.LIST_STYLE_TYPE={NONE:-1,DISC:0,CIRCLE:1,SQUARE:2,DECIMAL:3,CJK_DECIMAL:4,DECIMAL_LEADING_ZERO:5,LOWER_ROMAN:6,UPPER_ROMAN:7,LOWER_GREEK:8,LOWER_ALPHA:9,UPPER_ALPHA:10,ARABIC_INDIC:11,ARMENIAN:12,BENGALI:13,CAMBODIAN:14,CJK_EARTHLY_BRANCH:15,CJK_HEAVENLY_STEM:16,CJK_IDEOGRAPHIC:17,DEVANAGARI:18,ETHIOPIC_NUMERIC:19,GEORGIAN:20,GUJARATI:21,GURMUKHI:22,HEBREW:22,HIRAGANA:23,HIRAGANA_IROHA:24,JAPANESE_FORMAL:25,JAPANESE_INFORMAL:26,KANNADA:27,KATAKANA:28,KATAKANA_IROHA:29,KHMER:30,KOREAN_HANGUL_FORMAL:31,KOREAN_HANJA_FORMAL:32,KOREAN_HANJA_INFORMAL:33,LAO:34,LOWER_ARMENIAN:35,MALAYALAM:36,MONGOLIAN:37,MYANMAR:38,ORIYA:39,PERSIAN:40,SIMP_CHINESE_FORMAL:41,SIMP_CHINESE_INFORMAL:42,TAMIL:43,TELUGU:44,THAI:45,TIBETAN:46,TRAD_CHINESE_FORMAL:47,TRAD_CHINESE_INFORMAL:48,UPPER_ARMENIAN:49,DISCLOSURE_OPEN:50,DISCLOSURE_CLOSED:51},A=t.parseListStyleType=function(e){switch(e){case"disc":return a.DISC;case"circle":return a.CIRCLE;case"square":return a.SQUARE;case"decimal":return a.DECIMAL;case"cjk-decimal":return a.CJK_DECIMAL;case"decimal-leading-zero":return a.DECIMAL_LEADING_ZERO;case"lower-roman":return a.LOWER_ROMAN;case"upper-roman":return a.UPPER_ROMAN;case"lower-greek":return a.LOWER_GREEK;case"lower-alpha":return a.LOWER_ALPHA;case"upper-alpha":return a.UPPER_ALPHA;case"arabic-indic":return a.ARABIC_INDIC;case"armenian":return a.ARMENIAN;case"bengali":return a.BENGALI;case"cambodian":return a.CAMBODIAN;case"cjk-earthly-branch":return a.CJK_EARTHLY_BRANCH;case"cjk-heavenly-stem":return a.CJK_HEAVENLY_STEM;case"cjk-ideographic":return a.CJK_IDEOGRAPHIC;case"devanagari":return a.DEVANAGARI;case"ethiopic-numeric":return a.ETHIOPIC_NUMERIC;case"georgian":return a.GEORGIAN;case"gujarati":return a.GUJARATI;case"gurmukhi":return a.GURMUKHI;case"hebrew":return a.HEBREW;case"hiragana":return a.HIRAGANA;case"hiragana-iroha":return a.HIRAGANA_IROHA;case"japanese-formal":return a.JAPANESE_FORMAL;case"japanese-informal":return a.JAPANESE_INFORMAL;case"kannada":return a.KANNADA;case"katakana":return a.KATAKANA;case"katakana-iroha":return a.KATAKANA_IROHA;case"khmer":return a.KHMER;case"korean-hangul-formal":return a.KOREAN_HANGUL_FORMAL;case"korean-hanja-formal":return a.KOREAN_HANJA_FORMAL;case"korean-hanja-informal":return a.KOREAN_HANJA_INFORMAL;case"lao":return a.LAO;case"lower-armenian":return a.LOWER_ARMENIAN;case"malayalam":return a.MALAYALAM;case"mongolian":return a.MONGOLIAN;case"myanmar":return a.MYANMAR;case"oriya":return a.ORIYA;case"persian":return a.PERSIAN;case"simp-chinese-formal":return a.SIMP_CHINESE_FORMAL;case"simp-chinese-informal":return a.SIMP_CHINESE_INFORMAL;case"tamil":return a.TAMIL;case"telugu":return a.TELUGU;case"thai":return a.THAI;case"tibetan":return a.TIBETAN;case"trad-chinese-formal":return a.TRAD_CHINESE_FORMAL;case"trad-chinese-informal":return a.TRAD_CHINESE_INFORMAL;case"upper-armenian":return a.UPPER_ARMENIAN;case"disclosure-open":return a.DISCLOSURE_OPEN;case"disclosure-closed":return a.DISCLOSURE_CLOSED;case"none":default:return a.NONE}},o=(t.parseListStyle=function(e){var t=(0,r.parseBackgroundImage)(e.getPropertyValue("list-style-image"));return{listStyleType:A(e.getPropertyValue("list-style-type")),listStyleImage:t.length?t[0]:null,listStylePosition:o(e.getPropertyValue("list-style-position"))}},function(e){switch(e){case"inside":return i.INSIDE;case"outside":default:return i.OUTSIDE}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(20),a=n(22),A=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text=t,this.parent=n,this.bounds=r}return r(e,null,[{key:"fromTextNode",value:function(t,n){var r=s(t.data,n.style.textTransform);return new e(r,n,(0,a.parseTextBounds)(r,n,t))}}]),e}();t.default=A;var o=/(^|\s|:|-|\(|\))([a-z])/g,s=function(e,t){switch(t){case i.TEXT_TRANSFORM.LOWERCASE:return e.toLowerCase();case i.TEXT_TRANSFORM.CAPITALIZE:return e.replace(o,u);case i.TEXT_TRANSFORM.UPPERCASE:return e.toUpperCase();default:return e}};function u(e,t,n){return e.length>0?t+n.toUpperCase():e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),i=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},a={get SUPPORT_RANGE_BOUNDS(){var e=function(e){if(e.createRange){var t=e.createRange();if(t.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height="123px",n.style.display="block",e.body.appendChild(n),t.selectNode(n);var r=t.getBoundingClientRect(),i=Math.round(r.height);if(e.body.removeChild(n),123===i)return!0}}return!1}(document);return Object.defineProperty(a,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=function(e){var t=new Image,n=e.createElement("canvas"),r=n.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(t,0,0),n.toDataURL()}catch(e){return!1}return!0}(document);return Object.defineProperty(a,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_BASE64_DRAWING(){return function(e){var t=function(e,t){var n=new Image,r=e.createElement("canvas"),i=r.getContext("2d");return new Promise((function(e){n.src=t;var a=function(){try{i.drawImage(n,0,0),r.toDataURL()}catch(t){return e(!1)}return e(!0)};n.onload=a,n.onerror=function(){return e(!1)},!0===n.complete&&setTimeout((function(){a()}),500)}))}(document,e);return Object.defineProperty(a,"SUPPORT_BASE64_DRAWING",{value:function(){return t}}),t}},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?function(e){var t=e.createElement("canvas");t.width=100,t.height=100;var n=t.getContext("2d");n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,100,100);var a=new Image,A=t.toDataURL();a.src=A;var o=(0,r.createForeignObjectSVG)(100,100,0,0,a);return n.fillStyle="red",n.fillRect(0,0,100,100),(0,r.loadSerializedSVG)(o).then((function(t){n.drawImage(t,0,0);var a=n.getImageData(0,0,100,100).data;n.fillStyle="red",n.fillRect(0,0,100,100);var o=e.createElement("div");return o.style.backgroundImage="url("+A+")",o.style.height="100px",i(a)?(0,r.loadSerializedSVG)((0,r.createForeignObjectSVG)(100,100,0,0,o)):Promise.reject(!1)})).then((function(e){return n.drawImage(e,0,0),i(n.getImageData(0,0,100,100).data)})).catch((function(e){return!1}))}(document):Promise.resolve(!1);return Object.defineProperty(a,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=void 0!==(new Image).crossOrigin;return Object.defineProperty(a,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(a,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(a,"SUPPORT_CORS_XHR",{value:e}),e}};t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTextDecoration=t.TEXT_DECORATION_LINE=t.TEXT_DECORATION=t.TEXT_DECORATION_STYLE=void 0;var r,i=n(0),a=(r=i)&&r.__esModule?r:{default:r},A=t.TEXT_DECORATION_STYLE={SOLID:0,DOUBLE:1,DOTTED:2,DASHED:3,WAVY:4},o=t.TEXT_DECORATION={NONE:null},s=t.TEXT_DECORATION_LINE={UNDERLINE:1,OVERLINE:2,LINE_THROUGH:3,BLINK:4},u=function(e){switch(e){case"underline":return s.UNDERLINE;case"overline":return s.OVERLINE;case"line-through":return s.LINE_THROUGH}return s.BLINK};t.parseTextDecoration=function(e){var t,n="none"===(t=e.textDecorationLine?e.textDecorationLine:e.textDecoration)?null:t.split(" ").map(u);return null===n?o.NONE:{textDecorationLine:n,textDecorationColor:e.textDecorationColor?new a.default(e.textDecorationColor):null,textDecorationStyle:function(e){switch(e){case"double":return A.DOUBLE;case"dotted":return A.DOTTED;case"dashed":return A.DASHED;case"wavy":return A.WAVY}return A.SOLID}(e.textDecorationStyle)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBorder=t.BORDER_SIDES=t.BORDER_STYLE=void 0;var r,i=n(0),a=(r=i)&&r.__esModule?r:{default:r},A=t.BORDER_STYLE={NONE:0,SOLID:1},o=t.BORDER_SIDES={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3},s=Object.keys(o).map((function(e){return e.toLowerCase()}));t.parseBorder=function(e){return s.map((function(t){var n=new a.default(e.getPropertyValue("border-"+t+"-color")),r=function(e){switch(e){case"none":return A.NONE}return A.SOLID}(e.getPropertyValue("border-"+t+"-style")),i=parseFloat(e.getPropertyValue("border-"+t+"-width"));return{borderColor:n,borderStyle:r,borderWidth:isNaN(i)?0:i}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toCodePoints=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var a=e.charCodeAt(n++);56320==(64512&a)?t.push(((1023&i)<<10)+(1023&a)+65536):(t.push(i),n--)}else t.push(i)}return t},t.fromCodePoint=function(){if(String.fromCodePoint)return String.fromCodePoint.apply(String,arguments);var e=arguments.length;if(!e)return"";for(var t=[],n=-1,r="";++n<e;){var i=arguments.length<=n?void 0:arguments[n];i<=65535?t.push(i):(i-=65536,t.push(55296+(i>>10),i%1024+56320)),(n+1===e||t.length>16384)&&(r+=String.fromCharCode.apply(String,t),t.length=0)}return r};for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="undefined"==typeof Uint8Array?[]:new Uint8Array(256),a=0;a<r.length;a++)i[r.charCodeAt(a)]=a;t.decode=function(e){var t=.75*e.length,n=e.length,r=void 0,a=0,A=void 0,o=void 0,s=void 0,u=void 0;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);var c="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(t):new Array(t),l=Array.isArray(c)?c:new Uint8Array(c);for(r=0;r<n;r+=4)A=i[e.charCodeAt(r)],o=i[e.charCodeAt(r+1)],s=i[e.charCodeAt(r+2)],u=i[e.charCodeAt(r+3)],l[a++]=A<<2|o>>4,l[a++]=(15&o)<<4|s>>2,l[a++]=(3&s)<<6|63&u;return c},t.polyUint16Array=function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n.push(e[r+1]<<8|e[r]);return n},t.polyUint32Array=function(e){for(var t=e.length,n=[],r=0;r<t;r+=4)n.push(e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]);return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCounterText=t.inlineListItemElement=t.getListOwner=void 0;var r=n(4),i=s(n(3)),a=s(n(9)),A=n(8),o=n(24);function s(e){return e&&e.__esModule?e:{default:e}}var u=["OL","UL","MENU"],c=(t.getListOwner=function(e){var t=e.parent;if(!t)return null;do{if(-1!==u.indexOf(t.tagName))return t;t=t.parent}while(t);return e.parent},t.inlineListItemElement=function(e,t,n){var o=t.style.listStyle;if(o){var s=e.ownerDocument.defaultView.getComputedStyle(e,null),u=e.ownerDocument.createElement("html2canvaswrapper");switch((0,r.copyCSSStyles)(s,u),u.style.position="absolute",u.style.bottom="auto",u.style.display="block",u.style.letterSpacing="normal",o.listStylePosition){case A.LIST_STYLE_POSITION.OUTSIDE:u.style.left="auto",u.style.right=e.ownerDocument.defaultView.innerWidth-t.bounds.left-t.style.margin[1].getAbsoluteValue(t.bounds.width)+7+"px",u.style.textAlign="right";break;case A.LIST_STYLE_POSITION.INSIDE:u.style.left=t.bounds.left-t.style.margin[3].getAbsoluteValue(t.bounds.width)+"px",u.style.right="auto",u.style.textAlign="left"}var c=void 0,l=t.style.margin[0].getAbsoluteValue(t.bounds.width),h=o.listStyleImage;if(h)if("url"===h.method){var d=e.ownerDocument.createElement("img");d.src=h.args[0],u.style.top=t.bounds.top-l+"px",u.style.width="auto",u.style.height="auto",u.appendChild(d)}else{var f=.5*parseFloat(t.style.font.fontSize);u.style.top=t.bounds.top-l+t.bounds.height-1.5*f+"px",u.style.width=f+"px",u.style.height=f+"px",u.style.backgroundImage=s.listStyleImage}else"number"==typeof t.listIndex&&(c=e.ownerDocument.createTextNode(m(t.listIndex,o.listStyleType,!0)),u.appendChild(c),u.style.top=t.bounds.top-l+"px");var p=e.ownerDocument.body;p.appendChild(u),c?(t.childNodes.push(a.default.fromTextNode(c,t)),p.removeChild(u)):t.childNodes.push(new i.default(u,t,n,0))}},{integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]}),l={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},h={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},d={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},f=function(e,t,n,r,i,a){return e<t||e>n?m(e,i,a.length>0):r.integers.reduce((function(t,n,i){for(;e>=n;)e-=n,t+=r.values[i];return t}),"")+a},p=function(e,t,n,r){var i="";do{n||e--,i=r(e)+i,e/=t}while(e*t>=t);return i},g=function(e,t,n,r,i){var a=n-t+1;return(e<0?"-":"")+(p(Math.abs(e),a,r,(function(e){return(0,o.fromCodePoint)(Math.floor(e%a)+t)}))+i)},y=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:". ",r=t.length;return p(Math.abs(e),r,!1,(function(e){return t[Math.floor(e%r)]}))+n},v=function(e,t,n,i,a,o){if(e<-9999||e>9999)return m(e,A.LIST_STYLE_TYPE.CJK_DECIMAL,a.length>0);var s=Math.abs(e),u=a;if(0===s)return t[0]+u;for(var c=0;s>0&&c<=4;c++){var l=s%10;0===l&&(0,r.contains)(o,1)&&""!==u?u=t[l]+u:l>1||1===l&&0===c||1===l&&1===c&&(0,r.contains)(o,2)||1===l&&1===c&&(0,r.contains)(o,4)&&e>100||1===l&&c>1&&(0,r.contains)(o,8)?u=t[l]+(c>0?n[c-1]:"")+u:1===l&&c>0&&(u=n[c-1]+u),s=Math.floor(s/10)}return(e<0?i:"")+u},m=t.createCounterText=function(e,t,n){var r=n?". ":"",i=n?"、":"",a=n?", ":"";switch(t){case A.LIST_STYLE_TYPE.DISC:return"•";case A.LIST_STYLE_TYPE.CIRCLE:return"◦";case A.LIST_STYLE_TYPE.SQUARE:return"◾";case A.LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO:var o=g(e,48,57,!0,r);return o.length<4?"0"+o:o;case A.LIST_STYLE_TYPE.CJK_DECIMAL:return y(e,"〇一二三四五六七八九",i);case A.LIST_STYLE_TYPE.LOWER_ROMAN:return f(e,1,3999,c,A.LIST_STYLE_TYPE.DECIMAL,r).toLowerCase();case A.LIST_STYLE_TYPE.UPPER_ROMAN:return f(e,1,3999,c,A.LIST_STYLE_TYPE.DECIMAL,r);case A.LIST_STYLE_TYPE.LOWER_GREEK:return g(e,945,969,!1,r);case A.LIST_STYLE_TYPE.LOWER_ALPHA:return g(e,97,122,!1,r);case A.LIST_STYLE_TYPE.UPPER_ALPHA:return g(e,65,90,!1,r);case A.LIST_STYLE_TYPE.ARABIC_INDIC:return g(e,1632,1641,!0,r);case A.LIST_STYLE_TYPE.ARMENIAN:case A.LIST_STYLE_TYPE.UPPER_ARMENIAN:return f(e,1,9999,l,A.LIST_STYLE_TYPE.DECIMAL,r);case A.LIST_STYLE_TYPE.LOWER_ARMENIAN:return f(e,1,9999,l,A.LIST_STYLE_TYPE.DECIMAL,r).toLowerCase();case A.LIST_STYLE_TYPE.BENGALI:return g(e,2534,2543,!0,r);case A.LIST_STYLE_TYPE.CAMBODIAN:case A.LIST_STYLE_TYPE.KHMER:return g(e,6112,6121,!0,r);case A.LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH:return y(e,"子丑寅卯辰巳午未申酉戌亥",i);case A.LIST_STYLE_TYPE.CJK_HEAVENLY_STEM:return y(e,"甲乙丙丁戊己庚辛壬癸",i);case A.LIST_STYLE_TYPE.CJK_IDEOGRAPHIC:case A.LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL:return v(e,"零一二三四五六七八九","十百千萬","負",i,14);case A.LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL:return v(e,"零壹貳參肆伍陸柒捌玖","拾佰仟萬","負",i,15);case A.LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL:return v(e,"零一二三四五六七八九","十百千萬","负",i,14);case A.LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL:return v(e,"零壹贰叁肆伍陆柒捌玖","拾佰仟萬","负",i,15);case A.LIST_STYLE_TYPE.JAPANESE_INFORMAL:return v(e,"〇一二三四五六七八九","十百千万","マイナス",i,0);case A.LIST_STYLE_TYPE.JAPANESE_FORMAL:return v(e,"零壱弐参四伍六七八九","拾百千万","マイナス",i,7);case A.LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL:return v(e,"영일이삼사오육칠팔구","십백천만","마이너스 ",a,7);case A.LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL:return v(e,"零一二三四五六七八九","十百千萬","마이너스 ",a,0);case A.LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL:return v(e,"零壹貳參四五六七八九","拾百千","마이너스 ",a,7);case A.LIST_STYLE_TYPE.DEVANAGARI:return g(e,2406,2415,!0,r);case A.LIST_STYLE_TYPE.GEORGIAN:return f(e,1,19999,d,A.LIST_STYLE_TYPE.DECIMAL,r);case A.LIST_STYLE_TYPE.GUJARATI:return g(e,2790,2799,!0,r);case A.LIST_STYLE_TYPE.GURMUKHI:return g(e,2662,2671,!0,r);case A.LIST_STYLE_TYPE.HEBREW:return f(e,1,10999,h,A.LIST_STYLE_TYPE.DECIMAL,r);case A.LIST_STYLE_TYPE.HIRAGANA:return y(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case A.LIST_STYLE_TYPE.HIRAGANA_IROHA:return y(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case A.LIST_STYLE_TYPE.KANNADA:return g(e,3302,3311,!0,r);case A.LIST_STYLE_TYPE.KATAKANA:return y(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",i);case A.LIST_STYLE_TYPE.KATAKANA_IROHA:return y(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",i);case A.LIST_STYLE_TYPE.LAO:return g(e,3792,3801,!0,r);case A.LIST_STYLE_TYPE.MONGOLIAN:return g(e,6160,6169,!0,r);case A.LIST_STYLE_TYPE.MYANMAR:return g(e,4160,4169,!0,r);case A.LIST_STYLE_TYPE.ORIYA:return g(e,2918,2927,!0,r);case A.LIST_STYLE_TYPE.PERSIAN:return g(e,1776,1785,!0,r);case A.LIST_STYLE_TYPE.TAMIL:return g(e,3046,3055,!0,r);case A.LIST_STYLE_TYPE.TELUGU:return g(e,3174,3183,!0,r);case A.LIST_STYLE_TYPE.THAI:return g(e,3664,3673,!0,r);case A.LIST_STYLE_TYPE.TIBETAN:return g(e,3872,3881,!0,r);case A.LIST_STYLE_TYPE.DECIMAL:default:return g(e,48,57,!0,r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6),a=n(11),A=function(e,t){var n=Math.max.apply(null,e.colorStops.map((function(e){return e.stop}))),r=1/Math.max(1,n);e.colorStops.forEach((function(e){t.addColorStop(r*e.stop,e.color.toString())}))},o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t||document.createElement("canvas")}return r(e,[{key:"render",value:function(e){this.ctx=this.canvas.getContext("2d"),this.options=e,this.canvas.width=Math.floor(e.width*e.scale),this.canvas.height=Math.floor(e.height*e.scale),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-e.x,-e.y),this.ctx.textBaseline="bottom",e.logger.log("Canvas renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+this.options.scale)}},{key:"clip",value:function(e,t){var n=this;e.length&&(this.ctx.save(),e.forEach((function(e){n.path(e),n.ctx.clip()}))),t(),e.length&&this.ctx.restore()}},{key:"drawImage",value:function(e,t,n){this.ctx.drawImage(e,t.left,t.top,t.width,t.height,n.left,n.top,n.width,n.height)}},{key:"drawShape",value:function(e,t){this.path(e),this.ctx.fillStyle=t.toString(),this.ctx.fill()}},{key:"fill",value:function(e){this.ctx.fillStyle=e.toString(),this.ctx.fill()}},{key:"getTarget",value:function(){return this.canvas.getContext("2d").setTransform(1,0,0,1,0,0),Promise.resolve(this.canvas)}},{key:"path",value:function(e){var t=this;this.ctx.beginPath(),Array.isArray(e)?e.forEach((function(e,n){var r=e.type===i.PATH.VECTOR?e:e.start;0===n?t.ctx.moveTo(r.x,r.y):t.ctx.lineTo(r.x,r.y),e.type===i.PATH.BEZIER_CURVE&&t.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)})):this.ctx.arc(e.x+e.radius,e.y+e.radius,e.radius,0,2*Math.PI,!0),this.ctx.closePath()}},{key:"rectangle",value:function(e,t,n,r,i){this.ctx.fillStyle=i.toString(),this.ctx.fillRect(e,t,n,r)}},{key:"renderLinearGradient",value:function(e,t){var n=this.ctx.createLinearGradient(e.left+t.direction.x1,e.top+t.direction.y1,e.left+t.direction.x0,e.top+t.direction.y0);A(t,n),this.ctx.fillStyle=n,this.ctx.fillRect(e.left,e.top,e.width,e.height)}},{key:"renderRadialGradient",value:function(e,t){var n=this,r=e.left+t.center.x,i=e.top+t.center.y,a=this.ctx.createRadialGradient(r,i,0,r,i,t.radius.x);if(a)if(A(t,a),this.ctx.fillStyle=a,t.radius.x!==t.radius.y){var o=e.left+.5*e.width,s=e.top+.5*e.height,u=t.radius.y/t.radius.x,c=1/u;this.transform(o,s,[1,0,0,u,0,0],(function(){return n.ctx.fillRect(e.left,c*(e.top-s)+s,e.width,e.height*c)}))}else this.ctx.fillRect(e.left,e.top,e.width,e.height)}},{key:"renderRepeat",value:function(e,t,n,r,i){this.path(e),this.ctx.fillStyle=this.ctx.createPattern(this.resizeImage(t,n),"repeat"),this.ctx.translate(r,i),this.ctx.fill(),this.ctx.translate(-r,-i)}},{key:"renderTextNode",value:function(e,t,n,r,i){var A=this;this.ctx.font=[n.fontStyle,n.fontVariant,n.fontWeight,n.fontSize,n.fontFamily].join(" "),e.forEach((function(e){if(A.ctx.fillStyle=t.toString(),i&&e.text.trim().length?i.slice(0).reverse().forEach((function(t){A.ctx.shadowColor=t.color.toString(),A.ctx.shadowOffsetX=t.offsetX*A.options.scale,A.ctx.shadowOffsetY=t.offsetY*A.options.scale,A.ctx.shadowBlur=t.blur,A.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height)})):A.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height),null!==r){var o=r.textDecorationColor||t;r.textDecorationLine.forEach((function(t){switch(t){case a.TEXT_DECORATION_LINE.UNDERLINE:var r=A.options.fontMetrics.getMetrics(n).baseline;A.rectangle(e.bounds.left,Math.round(e.bounds.top+r),e.bounds.width,1,o);break;case a.TEXT_DECORATION_LINE.OVERLINE:A.rectangle(e.bounds.left,Math.round(e.bounds.top),e.bounds.width,1,o);break;case a.TEXT_DECORATION_LINE.LINE_THROUGH:var i=A.options.fontMetrics.getMetrics(n).middle;A.rectangle(e.bounds.left,Math.ceil(e.bounds.top+i),e.bounds.width,1,o)}}))}}))}},{key:"resizeImage",value:function(e,t){if(e.width===t.width&&e.height===t.height)return e;var n=this.canvas.ownerDocument.createElement("canvas");return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),n}},{key:"setOpacity",value:function(e){this.ctx.globalAlpha=e}},{key:"transform",value:function(e,t,n,r){this.ctx.save(),this.ctx.translate(e,t),this.ctx.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.ctx.translate(-e,-t),r(),this.ctx.restore()}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enabled="undefined"!=typeof window&&t,this.start=r||Date.now(),this.id=n}return r(e,[{key:"child",value:function(t){return new e(this.enabled,t,this.start)}},{key:"log",value:function(){if(this.enabled&&window.console&&window.console.log){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-this.start+"ms",this.id?"html2canvas ("+this.id+"):":"html2canvas:"].concat([].slice.call(t,0)))}}},{key:"error",value:function(){if(this.enabled&&window.console&&window.console.error){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];Function.prototype.bind.call(window.console.error,window.console).apply(window.console,[Date.now()-this.start+"ms",this.id?"html2canvas ("+this.id+"):":"html2canvas:"].concat([].slice.call(t,0)))}}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsePadding=t.PADDING_SIDES=void 0;var r,i=n(1),a=(r=i)&&r.__esModule?r:{default:r};t.PADDING_SIDES={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3};var A=["top","right","bottom","left"];t.parsePadding=function(e){return A.map((function(t){return new a.default(e.getPropertyValue("padding-"+t))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.OVERFLOW_WRAP={NORMAL:0,BREAK_WORD:1};t.parseOverflowWrap=function(e){switch(e){case"break-word":return r.BREAK_WORD;case"normal":default:return r.NORMAL}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.POSITION={STATIC:0,RELATIVE:1,ABSOLUTE:2,FIXED:3,STICKY:4};t.parsePosition=function(e){switch(e){case"relative":return r.RELATIVE;case"absolute":return r.ABSOLUTE;case"fixed":return r.FIXED;case"sticky":return r.STICKY}return r.STATIC}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.TEXT_TRANSFORM={NONE:0,LOWERCASE:1,UPPERCASE:2,CAPITALIZE:3};t.parseTextTransform=function(e){switch(e){case"uppercase":return r.UPPERCASE;case"lowercase":return r.LOWERCASE;case"capitalize":return r.CAPITALIZE}return r.NONE}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reformatInputBounds=t.inlineSelectElement=t.inlineTextAreaElement=t.inlineInputElement=t.getInputBorderRadius=t.INPUT_BACKGROUND=t.INPUT_BORDERS=t.INPUT_COLOR=void 0;var r=l(n(9)),i=n(5),a=n(12),A=l(n(50)),o=l(n(7)),s=l(n(0)),u=l(n(1)),c=(n(2),n(22),n(4));function l(e){return e&&e.__esModule?e:{default:e}}t.INPUT_COLOR=new s.default([42,42,42]);var h=new s.default([165,165,165]),d=new s.default([222,222,222]),f={borderWidth:1,borderColor:h,borderStyle:a.BORDER_STYLE.SOLID},p=(t.INPUT_BORDERS=[f,f,f,f],t.INPUT_BACKGROUND={backgroundColor:d,backgroundImage:[],backgroundClip:i.BACKGROUND_CLIP.PADDING_BOX,backgroundOrigin:i.BACKGROUND_ORIGIN.PADDING_BOX},new u.default("50%")),g=[p,p],y=[g,g,g,g],v=new u.default("3px"),m=[v,v],E=[m,m,m,m],B=(t.getInputBorderRadius=function(e){return"radio"===e.type?y:E},t.inlineInputElement=function(e,t){if("radio"===e.type||"checkbox"===e.type){if(e.checked){var n=Math.min(t.bounds.width,t.bounds.height);t.childNodes.push("checkbox"===e.type?[new o.default(t.bounds.left+.39363*n,t.bounds.top+.79*n),new o.default(t.bounds.left+.16*n,t.bounds.top+.5549*n),new o.default(t.bounds.left+.27347*n,t.bounds.top+.44071*n),new o.default(t.bounds.left+.39694*n,t.bounds.top+.5649*n),new o.default(t.bounds.left+.72983*n,t.bounds.top+.23*n),new o.default(t.bounds.left+.84*n,t.bounds.top+.34085*n),new o.default(t.bounds.left+.39363*n,t.bounds.top+.79*n)]:new A.default(t.bounds.left+n/4,t.bounds.top+n/4,n/4))}}else B(w(e),e,t,!1)},t.inlineTextAreaElement=function(e,t){B(e.value,e,t,!0)},t.inlineSelectElement=function(e,t){var n=e.options[e.selectedIndex||0];B(n&&n.text||"",e,t,!1)},t.reformatInputBounds=function(e){return e.width>e.height?(e.left+=(e.width-e.height)/2,e.width=e.height):e.width<e.height&&(e.top+=(e.height-e.width)/2,e.height=e.width),e},function(e,t,n,i){var a=t.ownerDocument.body;if(e.length>0&&a){var A=t.ownerDocument.createElement("html2canvaswrapper");(0,c.copyCSSStyles)(t.ownerDocument.defaultView.getComputedStyle(t,null),A),A.style.position="absolute",A.style.left=n.bounds.left+"px",A.style.top=n.bounds.top+"px",i||(A.style.whiteSpace="nowrap");var o=t.ownerDocument.createTextNode(e);A.appendChild(o),a.appendChild(A),n.childNodes.push(r.default.fromTextNode(o,n)),a.removeChild(A)}}),w=function(e){var t="password"===e.type?new Array(e.value.length+1).join("•"):e.value;return 0===t.length?e.placeholder||"":t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTextBounds=t.TextBounds=void 0;var r,i=n(2),a=n(11),A=n(10),o=(r=A)&&r.__esModule?r:{default:r},s=n(24),u=t.TextBounds=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text=t,this.bounds=n},c=(t.parseTextBounds=function(e,t,n){for(var r=0!==t.style.letterSpacing?(0,s.toCodePoints)(e).map((function(e){return(0,s.fromCodePoint)(e)})):(0,s.breakWords)(e,t),i=r.length,A=n.parentNode?n.parentNode.ownerDocument.defaultView:null,h=A?A.pageXOffset:0,d=A?A.pageYOffset:0,f=[],p=0,g=0;g<i;g++){var y=r[g];if(t.style.textDecoration!==a.TEXT_DECORATION.NONE||y.trim().length>0)if(o.default.SUPPORT_RANGE_BOUNDS)f.push(new u(y,l(n,p,y.length,h,d)));else{var v=n.splitText(y.length);f.push(new u(y,c(n,h,d))),n=v}else o.default.SUPPORT_RANGE_BOUNDS||(n=n.splitText(y.length));p+=y.length}return f},function(e,t,n){var r=e.ownerDocument.createElement("html2canvaswrapper");r.appendChild(e.cloneNode(!0));var a=e.parentNode;if(a){a.replaceChild(r,e);var A=(0,i.parseBounds)(r,t,n);return r.firstChild&&a.replaceChild(r.firstChild,r),A}return new i.Bounds(0,0,0,0)}),l=function(e,t,n,r,a){var A=e.ownerDocument.createRange();return A.setStart(e,t),A.setEnd(e,t+n),i.Bounds.fromClientRect(A.getBoundingClientRect(),r,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element=t}return r(e,[{key:"render",value:function(e){var t=this;this.options=e,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=Math.floor(e.width)*e.scale,this.canvas.height=Math.floor(e.height)*e.scale,this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",e.logger.log("ForeignObject renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+e.scale);var n=a(Math.max(e.windowWidth,e.width)*e.scale,Math.max(e.windowHeight,e.height)*e.scale,e.scrollX*e.scale,e.scrollY*e.scale,this.element);return A(n).then((function(n){return e.backgroundColor&&(t.ctx.fillStyle=e.backgroundColor.toString(),t.ctx.fillRect(0,0,e.width*e.scale,e.height*e.scale)),t.ctx.drawImage(n,-e.x*e.scale,-e.y*e.scale),t.canvas}))}}]),e}();t.default=i;var a=t.createForeignObjectSVG=function(e,t,n,r,i){var a="http://www.w3.org/2000/svg",A=document.createElementNS(a,"svg"),o=document.createElementNS(a,"foreignObject");return A.setAttributeNS(null,"width",e),A.setAttributeNS(null,"height",t),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",n),o.setAttributeNS(null,"y",r),o.setAttributeNS(null,"externalResourcesRequired","true"),A.appendChild(o),o.appendChild(i),A},A=t.loadSerializedSVG=function(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){return t(r)},r.onerror=n,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakWords=t.fromCodePoint=t.toCodePoints=void 0;var r=n(46);Object.defineProperty(t,"toCodePoints",{enumerable:!0,get:function(){return r.toCodePoints}}),Object.defineProperty(t,"fromCodePoint",{enumerable:!0,get:function(){return r.fromCodePoint}});var i,a=n(3),A=((i=a)&&i.__esModule,n(18));t.breakWords=function(e,t){for(var n=(0,r.LineBreaker)(e,{lineBreak:t.style.lineBreak,wordBreak:t.style.overflowWrap===A.OVERFLOW_WRAP.BREAK_WORD?"break-word":t.style.wordBreak}),i=[],a=void 0;!(a=n.next()).done;)i.push(a.value.slice());return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontMetrics=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4);t.FontMetrics=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={},this._document=t}return r(e,[{key:"_parseMetrics",value:function(e){var t=this._document.createElement("div"),n=this._document.createElement("img"),r=this._document.createElement("span"),a=this._document.body;if(!a)throw new Error("No document found for font metrics");t.style.visibility="hidden",t.style.fontFamily=e.fontFamily,t.style.fontSize=e.fontSize,t.style.margin="0",t.style.padding="0",a.appendChild(t),n.src=i.SMALL_IMAGE,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",r.style.fontFamily=e.fontFamily,r.style.fontSize=e.fontSize,r.style.margin="0",r.style.padding="0",r.appendChild(this._document.createTextNode("Hidden Text")),t.appendChild(r),t.appendChild(n);var A=n.offsetTop-r.offsetTop+2;t.removeChild(r),t.appendChild(this._document.createTextNode("Hidden Text")),t.style.lineHeight="normal",n.style.verticalAlign="super";var o=n.offsetTop-t.offsetTop+2;return a.removeChild(t),{baseline:A,middle:o}}},{key:"getMetrics",value:function(e){var t=e.fontFamily+" "+e.fontSize;return void 0===this._data[t]&&(this._data[t]=this._parseMetrics(e)),this._data[t]}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Proxy=void 0;var r,i=n(10),a=(r=i)&&r.__esModule?r:{default:r};t.Proxy=function(e,t){if(!t.proxy)return Promise.reject("No proxy defined");var n=t.proxy;return new Promise((function(r,i){var A=a.default.SUPPORT_CORS_XHR&&a.default.SUPPORT_RESPONSE_TYPE?"blob":"text",o=a.default.SUPPORT_CORS_XHR?new XMLHttpRequest:new XDomainRequest;if(o.onload=function(){if(o instanceof XMLHttpRequest)if(200===o.status)if("text"===A)r(o.response);else{var t=new FileReader;t.addEventListener("load",(function(){return r(t.result)}),!1),t.addEventListener("error",(function(e){return i(e)}),!1),t.readAsDataURL(o.response)}else i("Failed to proxy resource "+e.substring(0,256)+" with status code "+o.status);else r(o.responseText)},o.onerror=i,o.open("GET",n+"?url="+encodeURIComponent(e)+"&responseType="+A),"text"!==A&&o instanceof XMLHttpRequest&&(o.responseType=A),t.imageTimeout){var s=t.imageTimeout;o.timeout=s,o.ontimeout=function(){return i("Timed out ("+s+"ms) proxying "+e.substring(0,256))}}o.send()}))}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=o(n(15)),a=o(n(16)),A=n(28);function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e,t){var n=t||{},o=new a.default("boolean"!=typeof n.logging||n.logging);o.log("html2canvas 1.0.0-alpha.12"),"function"==typeof n.onrendered&&o.error("onrendered option is deprecated, html2canvas returns a Promise with the canvas as the value");var s=e.ownerDocument;if(!s)return Promise.reject("Provided element is not within a Document");var u=s.defaultView,c={async:!0,allowTaint:!1,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,scale:u.devicePixelRatio||1,target:new i.default(n.canvas),useCORS:!1,windowWidth:u.innerWidth,windowHeight:u.innerHeight,scrollX:u.pageXOffset,scrollY:u.pageYOffset},l=(0,A.renderElement)(e,r({},c,n),o);return l.catch((function(e){throw o.error(e),e}))};s.CanvasRenderer=i.default,e.exports=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderElement=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var A,o=e[Symbol.iterator]();!(r=(A=o.next()).done)&&(n.push(A.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=(d(n(16)),n(29)),a=d(n(51)),A=d(n(23)),o=d(n(10)),s=n(2),u=n(54),c=n(25),l=n(0),h=d(l);function d(e){return e&&e.__esModule?e:{default:e}}t.renderElement=function e(t,n,d){var f=t.ownerDocument,p=new s.Bounds(n.scrollX,n.scrollY,n.windowWidth,n.windowHeight),g=f.documentElement?new h.default(getComputedStyle(f.documentElement).backgroundColor):l.TRANSPARENT,y=f.body?new h.default(getComputedStyle(f.body).backgroundColor):l.TRANSPARENT,v=t===f.documentElement?g.isTransparent()?y.isTransparent()?n.backgroundColor?new h.default(n.backgroundColor):null:y:g:n.backgroundColor?new h.default(n.backgroundColor):null;return(n.foreignObjectRendering?o.default.SUPPORT_FOREIGNOBJECT_DRAWING:Promise.resolve(!1)).then((function(o){return o?(h=new u.DocumentCloner(t,n,d,!0,e),d.log("Document cloned, using foreignObject rendering"),h.inlineFonts(f).then((function(){return h.resourceLoader.ready()})).then((function(){var e=new A.default(h.documentElement),r=f.defaultView,i=r.pageXOffset,a=r.pageYOffset,o="HTML"===t.tagName||"BODY"===t.tagName?(0,s.parseDocumentSize)(f):(0,s.parseBounds)(t,i,a),u=o.width,c=o.height,l=o.left,p=o.top;return e.render({backgroundColor:v,logger:d,scale:n.scale,x:"number"==typeof n.x?n.x:l,y:"number"==typeof n.y?n.y:p,width:"number"==typeof n.width?n.width:Math.ceil(u),height:"number"==typeof n.height?n.height:Math.ceil(c),windowWidth:n.windowWidth,windowHeight:n.windowHeight,scrollX:n.scrollX,scrollY:n.scrollY})}))):(0,u.cloneWindow)(f,p,t,n,d,e).then((function(e){var t=r(e,3),A=t[0],o=t[1],u=t[2];d.log("Document cloned, using computed rendering");var h=(0,i.NodeParser)(o,u,d),p=o.ownerDocument;return v===h.container.style.background.backgroundColor&&(h.container.style.background.backgroundColor=l.TRANSPARENT),u.ready().then((function(e){var t=new c.FontMetrics(p);d.log("Starting renderer");var r=p.defaultView,i=r.pageXOffset,u=r.pageYOffset,l="HTML"===o.tagName||"BODY"===o.tagName?(0,s.parseDocumentSize)(f):(0,s.parseBounds)(o,i,u),g=l.width,y=l.height,m=l.left,E=l.top,B={backgroundColor:v,fontMetrics:t,imageStore:e,logger:d,scale:n.scale,x:"number"==typeof n.x?n.x:m,y:"number"==typeof n.y?n.y:E,width:"number"==typeof n.width?n.width:Math.ceil(g),height:"number"==typeof n.height?n.height:Math.ceil(y)};if(Array.isArray(n.target))return Promise.all(n.target.map((function(e){return new a.default(e,B).render(h)})));var w=new a.default(n.target,B).render(h);return!0===n.removeContainer&&(A.parentNode?A.parentNode.removeChild(A):d.log("Cannot detach cloned iframe as it is not in the DOM anymore")),w}))}));var h}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeParser=void 0;var r=u(n(30)),i=u(n(3)),a=u(n(9)),A=n(21),o=n(14),s=n(8);function u(e){return e&&e.__esModule?e:{default:e}}t.NodeParser=function(e,t,n){n.log("Starting node parsing");var a=0,A=new i.default(e,null,t,a++),o=new r.default(A,null,!0);return l(e,A,o,t,1),n.log("Finished parsing node tree"),o};var c=["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"],l=function e(t,n,u,l,f){if(f>5e4)throw new Error("Recursion error while parsing node tree");for(var p,g=t.firstChild;g;g=p){p=g.nextSibling;var y=g.ownerDocument.defaultView;if(g instanceof y.Text||g instanceof Text||y.parent&&g instanceof y.parent.Text)g.data.trim().length>0&&n.childNodes.push(a.default.fromTextNode(g,n));else if(g instanceof y.HTMLElement||g instanceof HTMLElement||y.parent&&g instanceof y.parent.HTMLElement){if(-1===c.indexOf(g.nodeName)){var v=new i.default(g,n,l,f++);if(v.isVisible()){"INPUT"===g.tagName?(0,A.inlineInputElement)(g,v):"TEXTAREA"===g.tagName?(0,A.inlineTextAreaElement)(g,v):"SELECT"===g.tagName?(0,A.inlineSelectElement)(g,v):v.style.listStyle&&v.style.listStyle.listStyleType!==s.LIST_STYLE_TYPE.NONE&&(0,o.inlineListItemElement)(g,v,l);var m="TEXTAREA"!==g.tagName,E=h(v,g);if(E||d(v)){var B=E||v.isPositioned()?u.getRealParentStackingContext():u,w=new r.default(v,B,E);B.contexts.push(w),m&&e(g,v,w,l,f)}else u.children.push(v),m&&e(g,v,u,l,f)}}}else if(g instanceof y.SVGSVGElement||g instanceof SVGSVGElement||y.parent&&g instanceof y.parent.SVGSVGElement){var k=new i.default(g,n,l,f++),C=h(k,g);if(C||d(k)){var b=C||k.isPositioned()?u.getRealParentStackingContext():u,S=new r.default(k,b,C);b.contexts.push(S)}else u.children.push(k)}}},h=function(e,t){return e.isRootElement()||e.isPositionedWithZIndex()||e.style.opacity<1||e.isTransformed()||f(e,t)},d=function(e){return e.isPositioned()||e.isFloating()},f=function(e,t){return"BODY"===t.nodeName&&e.parent instanceof i.default&&e.parent.style.background.backgroundColor.isTransparent()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(3);(r=a)&&r.__esModule,n(19);var A=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.parent=n,this.contexts=[],this.children=[],this.treatAsRealStackingContext=r}return i(e,[{key:"getOpacity",value:function(){return this.parent?this.container.style.opacity*this.parent.getOpacity():this.container.style.opacity}},{key:"getRealParentStackingContext",value:function(){return!this.parent||this.treatAsRealStackingContext?this:this.parent.getRealParentStackingContext()}}]),e}();t.default=A},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(6),A=n(7),o=(r=A)&&r.__esModule?r:{default:r},s=function(e,t,n){return new o.default(e.x+(t.x-e.x)*n,e.y+(t.y-e.y)*n)},u=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=a.PATH.BEZIER_CURVE,this.start=t,this.startControl=n,this.endControl=r,this.end=i}return i(e,[{key:"subdivide",value:function(t,n){var r=s(this.start,this.startControl,t),i=s(this.startControl,this.endControl,t),a=s(this.endControl,this.end,t),A=s(r,i,t),o=s(i,a,t),u=s(A,o,t);return n?new e(this.start,r,A,u):new e(u,o,a,this.end)}},{key:"reverse",value:function(){return new e(this.end,this.endControl,this.startControl,this.start)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBorderRadius=void 0;var r,i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var A,o=e[Symbol.iterator]();!(r=(A=o.next()).done)&&(n.push(A.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=n(1),A=(r=a)&&r.__esModule?r:{default:r},o=["top-left","top-right","bottom-right","bottom-left"];t.parseBorderRadius=function(e){return o.map((function(t){var n=e.getPropertyValue("border-"+t+"-radius").split(" ").map(A.default.create),r=i(n,2),a=r[0],o=r[1];return void 0===o?[a,a]:[a,o]}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.DISPLAY={NONE:1,BLOCK:2,INLINE:4,RUN_IN:8,FLOW:16,FLOW_ROOT:32,TABLE:64,FLEX:128,GRID:256,RUBY:512,SUBGRID:1024,LIST_ITEM:2048,TABLE_ROW_GROUP:4096,TABLE_HEADER_GROUP:8192,TABLE_FOOTER_GROUP:16384,TABLE_ROW:32768,TABLE_CELL:65536,TABLE_COLUMN_GROUP:1<<17,TABLE_COLUMN:1<<18,TABLE_CAPTION:1<<19,RUBY_BASE:1<<20,RUBY_TEXT:1<<21,RUBY_BASE_CONTAINER:1<<22,RUBY_TEXT_CONTAINER:1<<23,CONTENTS:1<<24,INLINE_BLOCK:1<<25,INLINE_LIST_ITEM:1<<26,INLINE_TABLE:1<<27,INLINE_FLEX:1<<28,INLINE_GRID:1<<29},i=function(e,t){return e|function(e){switch(e){case"block":return r.BLOCK;case"inline":return r.INLINE;case"run-in":return r.RUN_IN;case"flow":return r.FLOW;case"flow-root":return r.FLOW_ROOT;case"table":return r.TABLE;case"flex":return r.FLEX;case"grid":return r.GRID;case"ruby":return r.RUBY;case"subgrid":return r.SUBGRID;case"list-item":return r.LIST_ITEM;case"table-row-group":return r.TABLE_ROW_GROUP;case"table-header-group":return r.TABLE_HEADER_GROUP;case"table-footer-group":return r.TABLE_FOOTER_GROUP;case"table-row":return r.TABLE_ROW;case"table-cell":return r.TABLE_CELL;case"table-column-group":return r.TABLE_COLUMN_GROUP;case"table-column":return r.TABLE_COLUMN;case"table-caption":return r.TABLE_CAPTION;case"ruby-base":return r.RUBY_BASE;case"ruby-text":return r.RUBY_TEXT;case"ruby-base-container":return r.RUBY_BASE_CONTAINER;case"ruby-text-container":return r.RUBY_TEXT_CONTAINER;case"contents":return r.CONTENTS;case"inline-block":return r.INLINE_BLOCK;case"inline-list-item":return r.INLINE_LIST_ITEM;case"inline-table":return r.INLINE_TABLE;case"inline-flex":return r.INLINE_FLEX;case"inline-grid":return r.INLINE_GRID}return r.NONE}(t)};t.parseDisplay=function(e){return e.split(" ").reduce(i,0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.FLOAT={NONE:0,LEFT:1,RIGHT:2,INLINE_START:3,INLINE_END:4};t.parseCSSFloat=function(e){switch(e){case"left":return r.LEFT;case"right":return r.RIGHT;case"inline-start":return r.INLINE_START;case"inline-end":return r.INLINE_END}return r.NONE}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFont=function(e){return{fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontVariant:e.fontVariant,fontWeight:function(e){switch(e){case"normal":return 400;case"bold":return 700}var t=parseInt(e,10);return isNaN(t)?400:t}(e.fontWeight)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLetterSpacing=function(e){if("normal"===e)return 0;var t=parseFloat(e);return isNaN(t)?0:t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.LINE_BREAK={NORMAL:"normal",STRICT:"strict"};t.parseLineBreak=function(e){switch(e){case"strict":return r.STRICT;case"normal":default:return r.NORMAL}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseMargin=void 0;var r,i=n(1),a=(r=i)&&r.__esModule?r:{default:r},A=["top","right","bottom","left"];t.parseMargin=function(e){return A.map((function(t){return new a.default(e.getPropertyValue("margin-"+t))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.OVERFLOW={VISIBLE:0,HIDDEN:1,SCROLL:2,AUTO:3};t.parseOverflow=function(e){switch(e){case"hidden":return r.HIDDEN;case"scroll":return r.SCROLL;case"auto":return r.AUTO;case"visible":default:return r.VISIBLE}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTextShadow=void 0;var r,i=n(0),a=(r=i)&&r.__esModule?r:{default:r},A=/^([+-]|\d|\.)$/i;t.parseTextShadow=function(e){if("none"===e||"string"!=typeof e)return null;for(var t="",n=!1,r=[],i=[],o=0,s=null,u=function(){t.length&&(n?r.push(parseFloat(t)):s=new a.default(t)),n=!1,t=""},c=function(){r.length&&null!==s&&i.push({color:s,offsetX:r[0]||0,offsetY:r[1]||0,blur:r[2]||0}),r.splice(0,r.length),s=null},l=0;l<e.length;l++){var h=e[l];switch(h){case"(":t+=h,o++;break;case")":t+=h,o--;break;case",":0===o?(u(),c()):t+=h;break;case" ":0===o?u():t+=h;break;default:0===t.length&&A.test(h)&&(n=!0),t+=h}}return u(),c(),0===i.length?null:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTransform=void 0;var r,i=n(1),a=(r=i)&&r.__esModule?r:{default:r},A=function(e){return parseFloat(e.trim())},o=/(matrix|matrix3d)\((.+)\)/,s=(t.parseTransform=function(e){var t=u(e.transform||e.webkitTransform||e.mozTransform||e.msTransform||e.oTransform);return null===t?null:{transform:t,transformOrigin:s(e.transformOrigin||e.webkitTransformOrigin||e.mozTransformOrigin||e.msTransformOrigin||e.oTransformOrigin)}},function(e){if("string"!=typeof e){var t=new a.default("0");return[t,t]}var n=e.split(" ").map(a.default.create);return[n[0],n[1]]}),u=function(e){if("none"===e||"string"!=typeof e)return null;var t=e.match(o);if(t){if("matrix"===t[1]){var n=t[2].split(",").map(A);return[n[0],n[1],n[2],n[3],n[4],n[5]]}var r=t[2].split(",").map(A);return[r[0],r[1],r[4],r[5],r[12],r[13]]}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.VISIBILITY={VISIBLE:0,HIDDEN:1,COLLAPSE:2};t.parseVisibility=function(e){switch(e){case"hidden":return r.HIDDEN;case"collapse":return r.COLLAPSE;case"visible":default:return r.VISIBLE}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.WORD_BREAK={NORMAL:"normal",BREAK_ALL:"break-all",KEEP_ALL:"keep-all"};t.parseWordBreak=function(e){switch(e){case"break-all":return r.BREAK_ALL;case"keep-all":return r.KEEP_ALL;case"normal":default:return r.NORMAL}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseZIndex=function(e){var t="auto"===e;return{auto:t,order:t?0:parseInt(e,10)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13);Object.defineProperty(t,"toCodePoints",{enumerable:!0,get:function(){return r.toCodePoints}}),Object.defineProperty(t,"fromCodePoint",{enumerable:!0,get:function(){return r.fromCodePoint}});var i=n(47);Object.defineProperty(t,"LineBreaker",{enumerable:!0,get:function(){return i.LineBreaker}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineBreaker=t.inlineBreakOpportunities=t.lineBreakAtIndex=t.codePointsToCharacterClasses=t.UnicodeTrie=t.BREAK_ALLOWED=t.BREAK_NOT_ALLOWED=t.BREAK_MANDATORY=t.classes=t.LETTER_NUMBER_MODIFIER=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var A,o=e[Symbol.iterator]();!(r=(A=o.next()).done)&&(n.push(A.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},A=n(48),o=n(49),s=(r=o)&&r.__esModule?r:{default:r},u=n(13),c=t.LETTER_NUMBER_MODIFIER=50,l=10,h=13,d=15,f=17,p=18,g=19,y=20,v=21,m=22,E=24,B=25,w=26,k=27,C=28,b=30,S=32,T=33,M=34,U=35,Q=37,x=38,F=39,_=40,H=42,R=(t.classes={BK:1,CR:2,LF:3,CM:4,NL:5,SG:6,WJ:7,ZW:8,GL:9,SP:l,ZWJ:11,B2:12,BA:h,BB:14,HY:d,CB:16,CL:f,CP:p,EX:g,IN:y,NS:v,OP:m,QU:23,IS:E,NU:B,PO:w,PR:k,SY:C,AI:29,AL:b,CJ:31,EB:S,EM:T,H2:M,H3:U,HL:36,ID:Q,JL:x,JV:F,JT:_,RI:41,SA:H,XX:43},t.BREAK_MANDATORY="!"),L=t.BREAK_NOT_ALLOWED="×",D=t.BREAK_ALLOWED="÷",I=t.UnicodeTrie=(0,A.createTrieFromBase64)(s.default),O=[b,36],N=[1,2,3,5],P=[l,8],K=[k,w],V=N.concat(P),j=[x,F,_,M,U],G=[d,h],z=t.codePointsToCharacterClasses=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"strict",n=[],r=[],i=[];return e.forEach((function(e,a){var A=I.get(e);if(A>c?(i.push(!0),A-=c):i.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(e))return r.push(a),n.push(16);if(4===A||11===A){if(0===a)return r.push(a),n.push(b);var o=n[a-1];return-1===V.indexOf(o)?(r.push(r[a-1]),n.push(o)):(r.push(a),n.push(b))}return r.push(a),31===A?n.push("strict"===t?v:Q):A===H||29===A?n.push(b):43===A?e>=131072&&e<=196605||e>=196608&&e<=262141?n.push(Q):n.push(b):void n.push(A)})),[r,n,i]},Y=function(e,t,n,r){var i=r[n];if(Array.isArray(e)?-1!==e.indexOf(i):e===i)for(var a=n;a<=r.length;){var A=r[++a];if(A===t)return!0;if(A!==l)break}if(i===l)for(var o=n;o>0;){var s=r[--o];if(Array.isArray(e)?-1!==e.indexOf(s):e===s)for(var u=n;u<=r.length;){var c=r[++u];if(c===t)return!0;if(c!==l)break}if(s!==l)break}return!1},W=function(e,t){for(var n=e;n>=0;){var r=t[n];if(r!==l)return r;n--}return 0},X=function(e,t,n,r,i){if(0===n[r])return L;var a=r-1;if(Array.isArray(i)&&!0===i[a])return L;var A=a-1,o=a+1,s=t[a],u=A>=0?t[A]:0,c=t[o];if(2===s&&3===c)return L;if(-1!==N.indexOf(s))return R;if(-1!==N.indexOf(c))return L;if(-1!==P.indexOf(c))return L;if(8===W(a,t))return D;if(11===I.get(e[a])&&(c===Q||c===S||c===T))return L;if(7===s||7===c)return L;if(9===s)return L;if(-1===[l,h,d].indexOf(s)&&9===c)return L;if(-1!==[f,p,g,E,C].indexOf(c))return L;if(W(a,t)===m)return L;if(Y(23,m,a,t))return L;if(Y([f,p],v,a,t))return L;if(Y(12,12,a,t))return L;if(s===l)return D;if(23===s||23===c)return L;if(16===c||16===s)return D;if(-1!==[h,d,v].indexOf(c)||14===s)return L;if(36===u&&-1!==G.indexOf(s))return L;if(s===C&&36===c)return L;if(c===y&&-1!==O.concat(y,g,B,Q,S,T).indexOf(s))return L;if(-1!==O.indexOf(c)&&s===B||-1!==O.indexOf(s)&&c===B)return L;if(s===k&&-1!==[Q,S,T].indexOf(c)||-1!==[Q,S,T].indexOf(s)&&c===w)return L;if(-1!==O.indexOf(s)&&-1!==K.indexOf(c)||-1!==K.indexOf(s)&&-1!==O.indexOf(c))return L;if(-1!==[k,w].indexOf(s)&&(c===B||-1!==[m,d].indexOf(c)&&t[o+1]===B)||-1!==[m,d].indexOf(s)&&c===B||s===B&&-1!==[B,C,E].indexOf(c))return L;if(-1!==[B,C,E,f,p].indexOf(c))for(var b=a;b>=0;){var H=t[b];if(H===B)return L;if(-1===[C,E].indexOf(H))break;b--}if(-1!==[k,w].indexOf(c))for(var V=-1!==[f,p].indexOf(s)?A:a;V>=0;){var z=t[V];if(z===B)return L;if(-1===[C,E].indexOf(z))break;V--}if(x===s&&-1!==[x,F,M,U].indexOf(c)||-1!==[F,M].indexOf(s)&&-1!==[F,_].indexOf(c)||-1!==[_,U].indexOf(s)&&c===_)return L;if(-1!==j.indexOf(s)&&-1!==[y,w].indexOf(c)||-1!==j.indexOf(c)&&s===k)return L;if(-1!==O.indexOf(s)&&-1!==O.indexOf(c))return L;if(s===E&&-1!==O.indexOf(c))return L;if(-1!==O.concat(B).indexOf(s)&&c===m||-1!==O.concat(B).indexOf(c)&&s===p)return L;if(41===s&&41===c){for(var X=n[a],J=1;X>0&&41===t[--X];)J++;if(J%2!=0)return L}return s===S&&c===T?L:D},J=(t.lineBreakAtIndex=function(e,t){if(0===t)return L;if(t>=e.length)return R;var n=z(e),r=a(n,2),i=r[0],A=r[1];return X(e,A,i,t)},function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var n=z(e,t.lineBreak),r=a(n,3),i=r[0],A=r[1],o=r[2];return"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(A=A.map((function(e){return-1!==[B,b,H].indexOf(e)?Q:e}))),[i,A,"keep-all"===t.wordBreak?o.map((function(t,n){return t&&e[n]>=19968&&e[n]<=40959})):null]}),q=(t.inlineBreakOpportunities=function(e,t){var n=(0,u.toCodePoints)(e),r=L,i=J(n,t),A=a(i,3),o=A[0],s=A[1],c=A[2];return n.forEach((function(e,t){r+=(0,u.fromCodePoint)(e)+(t>=n.length-1?R:X(n,s,o,t+1,c))})),r},function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._codePoints=t,this.required=n===R,this.start=r,this.end=i}return i(e,[{key:"slice",value:function(){return u.fromCodePoint.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this._codePoints.slice(this.start,this.end)))}}]),e}());t.LineBreaker=function(e,t){var n=(0,u.toCodePoints)(e),r=J(n,t),i=a(r,3),A=i[0],o=i[1],s=i[2],c=n.length,l=0,h=0;return{next:function(){if(h>=c)return{done:!0};for(var e=L;h<c&&(e=X(n,o,A,++h,s))===L;);if(e!==L||h===c){var t=new q(n,e,l,h);return l=h,{value:t,done:!1}}return{done:!0}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Trie=t.createTrieFromBase64=t.UTRIE2_INDEX_2_MASK=t.UTRIE2_INDEX_2_BLOCK_LENGTH=t.UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=t.UTRIE2_INDEX_1_OFFSET=t.UTRIE2_UTF8_2B_INDEX_2_LENGTH=t.UTRIE2_UTF8_2B_INDEX_2_OFFSET=t.UTRIE2_INDEX_2_BMP_LENGTH=t.UTRIE2_LSCP_INDEX_2_LENGTH=t.UTRIE2_DATA_MASK=t.UTRIE2_DATA_BLOCK_LENGTH=t.UTRIE2_LSCP_INDEX_2_OFFSET=t.UTRIE2_SHIFT_1_2=t.UTRIE2_INDEX_SHIFT=t.UTRIE2_SHIFT_1=t.UTRIE2_SHIFT_2=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(13),a=t.UTRIE2_SHIFT_2=5,A=t.UTRIE2_SHIFT_1=11,o=t.UTRIE2_INDEX_SHIFT=2,s=t.UTRIE2_SHIFT_1_2=A-a,u=t.UTRIE2_LSCP_INDEX_2_OFFSET=65536>>a,c=t.UTRIE2_DATA_BLOCK_LENGTH=1<<a,l=t.UTRIE2_DATA_MASK=c-1,h=t.UTRIE2_LSCP_INDEX_2_LENGTH=1024>>a,d=t.UTRIE2_INDEX_2_BMP_LENGTH=u+h,f=t.UTRIE2_UTF8_2B_INDEX_2_OFFSET=d,p=t.UTRIE2_UTF8_2B_INDEX_2_LENGTH=32,g=t.UTRIE2_INDEX_1_OFFSET=f+p,y=t.UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=65536>>A,v=t.UTRIE2_INDEX_2_BLOCK_LENGTH=1<<s,m=t.UTRIE2_INDEX_2_MASK=v-1,E=(t.createTrieFromBase64=function(e){var t=(0,i.decode)(e),n=Array.isArray(t)?(0,i.polyUint32Array)(t):new Uint32Array(t),r=Array.isArray(t)?(0,i.polyUint16Array)(t):new Uint16Array(t),a=r.slice(12,n[4]/2),A=2===n[5]?r.slice((24+n[4])/2):n.slice(Math.ceil((24+n[4])/4));return new E(n[0],n[1],n[2],n[3],a,A)},t.Trie=function(){function e(t,n,r,i,a,A){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initialValue=t,this.errorValue=n,this.highStart=r,this.highValueIndex=i,this.index=a,this.data=A}return r(e,[{key:"get",value:function(e){var t=void 0;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>a])<<o)+(e&l),this.data[t];if(e<=65535)return t=((t=this.index[u+(e-55296>>a)])<<o)+(e&l),this.data[t];if(e<this.highStart)return t=g-y+(e>>A),t=this.index[t],t+=e>>a&m,t=((t=this.index[t])<<o)+(e&l),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue}}]),e}())},function(e,t,n){"use strict";e.exports="KwAAAAAAAAAACA4AIDoAAPAfAAACAAAAAAAIABAAGABAAEgAUABYAF4AZgBeAGYAYABoAHAAeABeAGYAfACEAIAAiACQAJgAoACoAK0AtQC9AMUAXgBmAF4AZgBeAGYAzQDVAF4AZgDRANkA3gDmAOwA9AD8AAQBDAEUARoBIgGAAIgAJwEvATcBPwFFAU0BTAFUAVwBZAFsAXMBewGDATAAiwGTAZsBogGkAawBtAG8AcIBygHSAdoB4AHoAfAB+AH+AQYCDgIWAv4BHgImAi4CNgI+AkUCTQJTAlsCYwJrAnECeQKBAk0CiQKRApkCoQKoArACuALAAsQCzAIwANQC3ALkAjAA7AL0AvwCAQMJAxADGAMwACADJgMuAzYDPgOAAEYDSgNSA1IDUgNaA1oDYANiA2IDgACAAGoDgAByA3YDfgOAAIQDgACKA5IDmgOAAIAAogOqA4AAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAK8DtwOAAIAAvwPHA88D1wPfAyAD5wPsA/QD/AOAAIAABAQMBBIEgAAWBB4EJgQuBDMEIAM7BEEEXgBJBCADUQRZBGEEaQQwADAAcQQ+AXkEgQSJBJEEgACYBIAAoASoBK8EtwQwAL8ExQSAAIAAgACAAIAAgACgAM0EXgBeAF4AXgBeAF4AXgBeANUEXgDZBOEEXgDpBPEE+QQBBQkFEQUZBSEFKQUxBTUFPQVFBUwFVAVcBV4AYwVeAGsFcwV7BYMFiwWSBV4AmgWgBacFXgBeAF4AXgBeAKsFXgCyBbEFugW7BcIFwgXIBcIFwgXQBdQF3AXkBesF8wX7BQMGCwYTBhsGIwYrBjMGOwZeAD8GRwZNBl4AVAZbBl4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAGMGXgBqBnEGXgBeAF4AXgBeAF4AXgBeAF4AXgB5BoAG4wSGBo4GkwaAAIADHgR5AF4AXgBeAJsGgABGA4AAowarBrMGswagALsGwwbLBjAA0wbaBtoG3QbaBtoG2gbaBtoG2gblBusG8wb7BgMHCwcTBxsHCwcjBysHMAc1BzUHOgdCB9oGSgdSB1oHYAfaBloHaAfaBlIH2gbaBtoG2gbaBtoG2gbaBjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHbQdeAF4ANQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQd1B30HNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B4MH2gaKB68EgACAAIAAgACAAIAAgACAAI8HlwdeAJ8HpweAAIAArwe3B14AXgC/B8UHygcwANAH2AfgB4AA6AfwBz4B+AcACFwBCAgPCBcIogEYAR8IJwiAAC8INwg/CCADRwhPCFcIXwhnCEoDGgSAAIAAgABvCHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIhAiLCI4IMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAANQc1BzUHNQc1BzUHNQc1BzUHNQc1B54INQc1B6II2gaqCLIIugiAAIAAvgjGCIAAgACAAIAAgACAAIAAgACAAIAAywiHAYAA0wiAANkI3QjlCO0I9Aj8CIAAgACAAAIJCgkSCRoJIgknCTYHLwk3CZYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiAAIAAAAFAAXgBeAGAAcABeAHwAQACQAKAArQC9AJ4AXgBeAE0A3gBRAN4A7AD8AMwBGgEAAKcBNwEFAUwBXAF4QkhCmEKnArcCgAHHAsABz4LAAcABwAHAAd+C6ABoAG+C/4LAAcABwAHAAc+DF4MAAcAB54M3gweDV4Nng3eDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEeDqABVg6WDqABoQ6gAaABoAHXDvcONw/3DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DncPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB7cPPwlGCU4JMACAAIAAgABWCV4JYQmAAGkJcAl4CXwJgAkwADAAMAAwAIgJgACLCZMJgACZCZ8JowmrCYAAswkwAF4AXgB8AIAAuwkABMMJyQmAAM4JgADVCTAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAqwYWBNkIMAAwADAAMADdCeAJ6AnuCR4E9gkwAP4JBQoNCjAAMACAABUK0wiAAB0KJAosCjQKgAAwADwKQwqAAEsKvQmdCVMKWwowADAAgACAALcEMACAAGMKgABrCjAAMAAwADAAMAAwADAAMAAwADAAMAAeBDAAMAAwADAAMAAwADAAMAAwADAAMAAwAIkEPQFzCnoKiQSCCooKkAqJBJgKoAqkCokEGAGsCrQKvArBCjAAMADJCtEKFQHZCuEK/gHpCvEKMAAwADAAMACAAIwE+QowAIAAPwEBCzAAMAAwADAAMACAAAkLEQswAIAAPwEZCyELgAAOCCkLMAAxCzkLMAAwADAAMAAwADAAXgBeAEELMAAwADAAMAAwADAAMAAwAEkLTQtVC4AAXAtkC4AAiQkwADAAMAAwADAAMAAwADAAbAtxC3kLgAuFC4sLMAAwAJMLlwufCzAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAApwswADAAMACAAIAAgACvC4AAgACAAIAAgACAALcLMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAvwuAAMcLgACAAIAAgACAAIAAyguAAIAAgACAAIAA0QswADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAANkLgACAAIAA4AswADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACJCR4E6AswADAAhwHwC4AA+AsADAgMEAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMACAAIAAGAwdDCUMMAAwAC0MNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQw1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHPQwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADUHNQc1BzUHNQc1BzUHNQc2BzAAMAA5DDUHNQc1BzUHNQc1BzUHNQc1BzUHNQdFDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAATQxSDFoMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAF4AXgBeAF4AXgBeAF4AYgxeAGoMXgBxDHkMfwxeAIUMXgBeAI0MMAAwADAAMAAwAF4AXgCVDJ0MMAAwADAAMABeAF4ApQxeAKsMswy7DF4Awgy9DMoMXgBeAF4AXgBeAF4AXgBeAF4AXgDRDNkMeQBqCeAM3Ax8AOYM7Az0DPgMXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgCgAAANoAAHDQ4NFg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAeDSYNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAC4NMABeAF4ANg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAD4NRg1ODVYNXg1mDTAAbQ0wADAAMAAwADAAMAAwADAA2gbaBtoG2gbaBtoG2gbaBnUNeg3CBYANwgWFDdoGjA3aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gaUDZwNpA2oDdoG2gawDbcNvw3HDdoG2gbPDdYN3A3fDeYN2gbsDfMN2gbaBvoN/g3aBgYODg7aBl4AXgBeABYOXgBeACUG2gYeDl4AJA5eACwO2w3aBtoGMQ45DtoG2gbaBtoGQQ7aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B1EO2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQdZDjUHNQc1BzUHNQc1B2EONQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHaA41BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B3AO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B2EO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBkkOeA6gAKAAoAAwADAAMAAwAKAAoACgAKAAoACgAKAAgA4wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAD//wQABAAEAAQABAAEAAQABAAEAA0AAwABAAEAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAKABMAFwAeABsAGgAeABcAFgASAB4AGwAYAA8AGAAcAEsASwBLAEsASwBLAEsASwBLAEsAGAAYAB4AHgAeABMAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAFgAbABIAHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYADQARAB4ABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkAFgAaABsAGwAbAB4AHQAdAB4ATwAXAB4ADQAeAB4AGgAbAE8ATwAOAFAAHQAdAB0ATwBPABcATwBPAE8AFgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwArAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAAQABAANAA0ASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAUAArACsAKwArACsAKwArACsABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAGgAaAFAAUABQAFAAUABMAB4AGwBQAB4AKwArACsABAAEAAQAKwBQAFAAUABQAFAAUAArACsAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUAArAFAAUAArACsABAArAAQABAAEAAQABAArACsAKwArAAQABAArACsABAAEAAQAKwArACsABAArACsAKwArACsAKwArAFAAUABQAFAAKwBQACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwAEAAQAUABQAFAABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQAKwArAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeABsAKwArACsAKwArACsAKwBQAAQABAAEAAQABAAEACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAKwArACsAKwArACsAKwArAAQABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwAEAFAAKwBQAFAAUABQAFAAUAArACsAKwBQAFAAUAArAFAAUABQAFAAKwArACsAUABQACsAUAArAFAAUAArACsAKwBQAFAAKwArACsAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQAKwArACsABAAEAAQAKwAEAAQABAAEACsAKwBQACsAKwArACsAKwArAAQAKwArACsAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAB4AHgAeAB4AHgAeABsAHgArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArAFAAUABQACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAB4AUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArACsAKwArACsAKwArAFAAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwArAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAKwBcAFwAKwBcACsAKwBcACsAKwArACsAKwArAFwAXABcAFwAKwBcAFwAXABcAFwAXABcACsAXABcAFwAKwBcACsAXAArACsAXABcACsAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgArACoAKgBcACsAKwBcAFwAXABcAFwAKwBcACsAKgAqACoAKgAqACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAFwAXABcAFwAUAAOAA4ADgAOAB4ADgAOAAkADgAOAA0ACQATABMAEwATABMACQAeABMAHgAeAB4ABAAEAB4AHgAeAB4AHgAeAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUAANAAQAHgAEAB4ABAAWABEAFgARAAQABABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAAQABAAEAAQABAANAAQABABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsADQANAB4AHgAeAB4AHgAeAAQAHgAeAB4AHgAeAB4AKwAeAB4ADgAOAA0ADgAeAB4AHgAeAB4ACQAJACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgAeAB4AHgBcAFwAXABcAFwAXAAqACoAKgAqAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAKgAqACoAKgAqACoAKgBcAFwAXAAqACoAKgAqAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAXAAqAEsASwBLAEsASwBLAEsASwBLAEsAKgAqACoAKgAqACoAUABQAFAAUABQAFAAKwBQACsAKwArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQACsAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwAEAAQABAAeAA0AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAEQArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAADQANAA0AUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAA0ADQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoADQANABUAXAANAB4ADQAbAFwAKgArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAB4AHgATABMADQANAA4AHgATABMAHgAEAAQABAAJACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAUABQAFAAUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwAeACsAKwArABMAEwBLAEsASwBLAEsASwBLAEsASwBLAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwBcAFwAXABcAFwAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcACsAKwArACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwAeAB4AXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsABABLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKgAqACoAKgAqACoAKgBcACoAKgAqACoAKgAqACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAUABQAFAAUABQAFAAUAArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4ADQANAA0ADQAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAHgAeAB4AHgBQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwANAA0ADQANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwBQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsABAAEAAQAHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAABABQAFAAUABQAAQABAAEAFAAUAAEAAQABAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAKwBQACsAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAKwArAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAKwAeAB4AHgAeAB4AHgAeAA4AHgArAA0ADQANAA0ADQANAA0ACQANAA0ADQAIAAQACwAEAAQADQAJAA0ADQAMAB0AHQAeABcAFwAWABcAFwAXABYAFwAdAB0AHgAeABQAFAAUAA0AAQABAAQABAAEAAQABAAJABoAGgAaABoAGgAaABoAGgAeABcAFwAdABUAFQAeAB4AHgAeAB4AHgAYABYAEQAVABUAFQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgANAB4ADQANAA0ADQAeAA0ADQANAAcAHgAeAB4AHgArAAQABAAEAAQABAAEAAQABAAEAAQAUABQACsAKwBPAFAAUABQAFAAUAAeAB4AHgAWABEATwBQAE8ATwBPAE8AUABQAFAAUABQAB4AHgAeABYAEQArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGgAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgBQABoAHgAdAB4AUAAeABoAHgAeAB4AHgAeAB4AHgAeAB4ATwAeAFAAGwAeAB4AUABQAFAAUABQAB4AHgAeAB0AHQAeAFAAHgBQAB4AUAAeAFAATwBQAFAAHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AUABQAFAAUABPAE8AUABQAFAAUABQAE8AUABQAE8AUABPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAE8ATwBPAE8ATwBPAE8ATwBPAE8AUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAATwAeAB4AKwArACsAKwAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB0AHQAeAB4AHgAdAB0AHgAeAB0AHgAeAB4AHQAeAB0AGwAbAB4AHQAeAB4AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB0AHgAdAB4AHQAdAB0AHQAdAB0AHgAdAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAdAB0AHQAdAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAlACUAHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB0AHQAeAB4AHgAeAB0AHQAdAB4AHgAdAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB0AHQAeAB4AHQAeAB4AHgAeAB0AHQAeAB4AHgAeACUAJQAdAB0AJQAeACUAJQAlACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHQAdAB0AHgAdACUAHQAdAB4AHQAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHQAdAB0AHQAlAB4AJQAlACUAHQAlACUAHQAdAB0AJQAlAB0AHQAlAB0AHQAlACUAJQAeAB0AHgAeAB4AHgAdAB0AJQAdAB0AHQAdAB0AHQAlACUAJQAlACUAHQAlACUAIAAlAB0AHQAlACUAJQAlACUAJQAlACUAHgAeAB4AJQAlACAAIAAgACAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeABcAFwAXABcAFwAXAB4AEwATACUAHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACUAJQBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwArACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAE8ATwBPAE8ATwBPAE8ATwAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeACsAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUAArACsAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQBQAFAAUABQACsAKwArACsAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAABAAEAAQAKwAEAAQAKwArACsAKwArAAQABAAEAAQAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsABAAEAAQAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsADQANAA0ADQANAA0ADQANAB4AKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAUABQAFAAUABQAA0ADQANAA0ADQANABQAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwANAA0ADQANAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAeAAQABAAEAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLACsADQArAB4AKwArAAQABAAEAAQAUABQAB4AUAArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwAEAAQABAAEAAQABAAEAAQABAAOAA0ADQATABMAHgAeAB4ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0AUABQAFAAUAAEAAQAKwArAAQADQANAB4AUAArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXABcAA0ADQANACoASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUAArACsAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANACsADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEcARwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwAeAAQABAANAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAEAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUAArACsAUAArACsAUABQACsAKwBQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAeAB4ADQANAA0ADQAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAArAAQABAArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAEAAQABAAEAAQABAAEACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAFgAWAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAKwBQACsAKwArACsAKwArAFAAKwArACsAKwBQACsAUAArAFAAKwBQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQACsAUAArAFAAKwBQACsAUABQACsAUAArACsAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAUABQAFAAUAArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUAArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAlACUAJQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeACUAJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeACUAJQAlACUAJQAeACUAJQAlACUAJQAgACAAIAAlACUAIAAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIQAhACEAIQAhACUAJQAgACAAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAIAAlACUAJQAlACAAJQAgACAAIAAgACAAIAAgACAAIAAlACUAJQAgACUAJQAlACUAIAAgACAAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeACUAHgAlAB4AJQAlACUAJQAlACAAJQAlACUAJQAeACUAHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAIAAgACAAIAAgAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFwAXABcAFQAVABUAHgAeAB4AHgAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAlACAAIAAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsA"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=r.PATH.CIRCLE,this.x=t,this.y=n,this.radius=i,isNaN(t)&&console.error("Invalid x value given for Circle"),isNaN(n)&&console.error("Invalid y value given for Circle"),isNaN(i)&&console.error("Invalid radius value given for Circle")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var A,o=e[Symbol.iterator]();!(r=(A=o.next()).done)&&(n.push(A.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A=n(2),o=(n(25),n(52)),s=n(9),u=(r=s)&&r.__esModule?r:{default:r},c=n(5),l=n(12),h=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=t,this.options=n,t.render(n)}return a(e,[{key:"renderNode",value:function(e){e.isVisible()&&(this.renderNodeBackgroundAndBorders(e),this.renderNodeContent(e))}},{key:"renderNodeContent",value:function(e){var t=this,n=function(){if(e.childNodes.length&&e.childNodes.forEach((function(n){if(n instanceof u.default){var r=n.parent.style;t.target.renderTextNode(n.bounds,r.color,r.font,r.textDecoration,r.textShadow)}else t.target.drawShape(n,e.style.color)})),e.image){var n=t.options.imageStore.get(e.image);if(n){var r=(0,A.calculateContentBox)(e.bounds,e.style.padding,e.style.border),i="number"==typeof n.width&&n.width>0?n.width:r.width,a="number"==typeof n.height&&n.height>0?n.height:r.height;i>0&&a>0&&t.target.clip([(0,A.calculatePaddingBoxPath)(e.curvedBounds)],(function(){t.target.drawImage(n,new A.Bounds(0,0,i,a),r)}))}}},r=e.getClipPaths();r.length?this.target.clip(r,n):n()}},{key:"renderNodeBackgroundAndBorders",value:function(e){var t=this,n=!e.style.background.backgroundColor.isTransparent()||e.style.background.backgroundImage.length,r=e.style.border.some((function(e){return e.borderStyle!==l.BORDER_STYLE.NONE&&!e.borderColor.isTransparent()})),i=function(){var r=(0,c.calculateBackgroungPaintingArea)(e.curvedBounds,e.style.background.backgroundClip);n&&t.target.clip([r],(function(){e.style.background.backgroundColor.isTransparent()||t.target.fill(e.style.background.backgroundColor),t.renderBackgroundImage(e)})),e.style.border.forEach((function(n,r){n.borderStyle===l.BORDER_STYLE.NONE||n.borderColor.isTransparent()||t.renderBorder(n,r,e.curvedBounds)}))};if(n||r){var a=e.parent?e.parent.getClipPaths():[];a.length?this.target.clip(a,i):i()}}},{key:"renderBackgroundImage",value:function(e){var t=this;e.style.background.backgroundImage.slice(0).reverse().forEach((function(n){"url"===n.source.method&&n.source.args.length?t.renderBackgroundRepeat(e,n):/gradient/i.test(n.source.method)&&t.renderBackgroundGradient(e,n)}))}},{key:"renderBackgroundRepeat",value:function(e,t){var n=this.options.imageStore.get(t.source.args[0]);if(n){var r=(0,c.calculateBackgroungPositioningArea)(e.style.background.backgroundOrigin,e.bounds,e.style.padding,e.style.border),i=(0,c.calculateBackgroundSize)(t,n,r),a=(0,c.calculateBackgroundPosition)(t.position,i,r),A=(0,c.calculateBackgroundRepeatPath)(t,a,i,r,e.bounds),o=Math.round(r.left+a.x),s=Math.round(r.top+a.y);this.target.renderRepeat(A,n,i,o,s)}}},{key:"renderBackgroundGradient",value:function(e,t){var n=(0,c.calculateBackgroungPositioningArea)(e.style.background.backgroundOrigin,e.bounds,e.style.padding,e.style.border),r=(0,c.calculateGradientBackgroundSize)(t,n),i=(0,c.calculateBackgroundPosition)(t.position,r,n),a=new A.Bounds(Math.round(n.left+i.x),Math.round(n.top+i.y),r.width,r.height),s=(0,o.parseGradient)(e,t.source,a);if(s)switch(s.type){case o.GRADIENT_TYPE.LINEAR_GRADIENT:this.target.renderLinearGradient(a,s);break;case o.GRADIENT_TYPE.RADIAL_GRADIENT:this.target.renderRadialGradient(a,s)}}},{key:"renderBorder",value:function(e,t,n){this.target.drawShape((0,A.parsePathForBorder)(n,t),e.borderColor)}},{key:"renderStack",value:function(e){var t=this;if(e.container.isVisible()){var n=e.getOpacity();n!==this._opacity&&(this.target.setOpacity(e.getOpacity()),this._opacity=n);var r=e.container.style.transform;null!==r?this.target.transform(e.container.bounds.left+r.transformOrigin[0].value,e.container.bounds.top+r.transformOrigin[1].value,r.transform,(function(){return t.renderStackContent(e)})):this.renderStackContent(e)}}},{key:"renderStackContent",value:function(e){var t=f(e),n=i(t,5),r=n[0],a=n[1],A=n[2],o=n[3],s=n[4],u=d(e),c=i(u,2),l=c[0],h=c[1];this.renderNodeBackgroundAndBorders(e.container),r.sort(p).forEach(this.renderStack,this),this.renderNodeContent(e.container),h.forEach(this.renderNode,this),o.forEach(this.renderStack,this),s.forEach(this.renderStack,this),l.forEach(this.renderNode,this),a.forEach(this.renderStack,this),A.sort(p).forEach(this.renderStack,this)}},{key:"render",value:function(e){var t=this;this.options.backgroundColor&&this.target.rectangle(this.options.x,this.options.y,this.options.width,this.options.height,this.options.backgroundColor),this.renderStack(e);var n=this.target.getTarget();return n.then((function(e){return t.options.logger.log("Render completed"),e}))}}]),e}();t.default=h;var d=function(e){for(var t=[],n=[],r=e.children.length,i=0;i<r;i++){var a=e.children[i];a.isInlineLevel()?t.push(a):n.push(a)}return[t,n]},f=function(e){for(var t=[],n=[],r=[],i=[],a=[],A=e.contexts.length,o=0;o<A;o++){var s=e.contexts[o];s.container.isPositioned()||s.container.style.opacity<1||s.container.isTransformed()?s.container.style.zIndex.order<0?t.push(s):s.container.style.zIndex.order>0?r.push(s):n.push(s):s.container.isFloating()?i.push(s):a.push(s)}return[t,n,r,i,a]},p=function(e,t){return e.container.style.zIndex.order>t.container.style.zIndex.order?1:e.container.style.zIndex.order<t.container.style.zIndex.order?-1:e.container.index>t.container.index?1:-1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformWebkitRadialGradientArgs=t.parseGradient=t.RadialGradient=t.LinearGradient=t.RADIAL_GRADIENT_SHAPE=t.GRADIENT_TYPE=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var A,o=e[Symbol.iterator]();!(r=(A=o.next()).done)&&(n.push(A.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=(u(n(3)),n(53)),a=u(n(0)),A=n(1),o=u(A),s=n(4);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=/^(to )?(left|top|right|bottom)( (left|top|right|bottom))?$/i,h=/^([+-]?\d*\.?\d+)% ([+-]?\d*\.?\d+)%$/i,d=/(px)|%|( 0)$/i,f=/^(from|to|color-stop)\((?:([\d.]+)(%)?,\s*)?(.+?)\)$/i,p=/^\s*(circle|ellipse)?\s*((?:([\d.]+)(px|r?em|%)\s*(?:([\d.]+)(px|r?em|%))?)|closest-side|closest-corner|farthest-side|farthest-corner)?\s*(?:at\s*(?:(left|center|right)|([\d.]+)(px|r?em|%))\s+(?:(top|center|bottom)|([\d.]+)(px|r?em|%)))?(?:\s|$)/i,g=t.GRADIENT_TYPE={LINEAR_GRADIENT:0,RADIAL_GRADIENT:1},y=t.RADIAL_GRADIENT_SHAPE={CIRCLE:0,ELLIPSE:1},v={left:new o.default("0%"),top:new o.default("0%"),center:new o.default("50%"),right:new o.default("100%"),bottom:new o.default("100%")},m=t.LinearGradient=function e(t,n){c(this,e),this.type=g.LINEAR_GRADIENT,this.colorStops=t,this.direction=n},E=t.RadialGradient=function e(t,n,r,i){c(this,e),this.type=g.RADIAL_GRADIENT,this.colorStops=t,this.shape=n,this.center=r,this.radius=i},B=(t.parseGradient=function(e,t,n){var r=t.args,i=t.method,a=t.prefix;return"linear-gradient"===i?w(r,n,!!a):"gradient"===i&&"linear"===r[0]?w(["to bottom"].concat(x(r.slice(3))),n,!!a):"radial-gradient"===i?k(e,"-webkit-"===a?Q(r):r,n):"gradient"===i&&"radial"===r[0]?k(e,x(Q(r.slice(1))),n):void 0},function(e,t,n){for(var r=[],i=t;i<e.length;i++){var A=e[i],s=d.test(A),u=A.lastIndexOf(" "),c=new a.default(s?A.substring(0,u):A),l=s?new o.default(A.substring(u+1)):i===t?new o.default("0%"):i===e.length-1?new o.default("100%"):null;r.push({color:c,stop:l})}for(var h=r.map((function(e){var t=e.color,r=e.stop;return{color:t,stop:0===n?0:r?r.getAbsoluteValue(n)/n:null}})),f=h[0].stop,p=0;p<h.length;p++)if(null!==f){var g=h[p].stop;if(null===g){for(var y=p;null===h[y].stop;)y++;for(var v=y-p+1,m=(h[y].stop-f)/v;p<y;p++)f=h[p].stop=f+m}else f=g}return h}),w=function(e,t,n){var r=(0,i.parseAngle)(e[0]),a=l.test(e[0]),A=a||null!==r||h.test(e[0]),o=A?null!==r?C(n?r-.5*Math.PI:r,t):a?S(e[0],t):T(e[0],t):C(Math.PI,t),u=A?1:0,c=Math.min((0,s.distance)(Math.abs(o.x0)+Math.abs(o.x1),Math.abs(o.y0)+Math.abs(o.y1)),2*t.width,2*t.height);return new m(B(e,u,c),o)},k=function(e,t,n){var r=t[0].match(p),i=r&&("circle"===r[1]||void 0!==r[3]&&void 0===r[5])?y.CIRCLE:y.ELLIPSE,a={},o={};r&&(void 0!==r[3]&&(a.x=(0,A.calculateLengthFromValueWithUnit)(e,r[3],r[4]).getAbsoluteValue(n.width)),void 0!==r[5]&&(a.y=(0,A.calculateLengthFromValueWithUnit)(e,r[5],r[6]).getAbsoluteValue(n.height)),r[7]?o.x=v[r[7].toLowerCase()]:void 0!==r[8]&&(o.x=(0,A.calculateLengthFromValueWithUnit)(e,r[8],r[9])),r[10]?o.y=v[r[10].toLowerCase()]:void 0!==r[11]&&(o.y=(0,A.calculateLengthFromValueWithUnit)(e,r[11],r[12])));var s={x:void 0===o.x?n.width/2:o.x.getAbsoluteValue(n.width),y:void 0===o.y?n.height/2:o.y.getAbsoluteValue(n.height)},u=U(r&&r[2]||"farthest-corner",i,s,a,n);return new E(B(t,r?1:0,Math.min(u.x,u.y)),i,s,u)},C=function(e,t){var n=t.width,r=t.height,i=.5*n,a=.5*r,A=(Math.abs(n*Math.sin(e))+Math.abs(r*Math.cos(e)))/2,o=i+Math.sin(e)*A,s=a-Math.cos(e)*A;return{x0:o,x1:n-o,y0:s,y1:r-s}},b=function(e){return Math.acos(e.width/2/((0,s.distance)(e.width,e.height)/2))},S=function(e,t){switch(e){case"bottom":case"to top":return C(0,t);case"left":case"to right":return C(Math.PI/2,t);case"right":case"to left":return C(3*Math.PI/2,t);case"top right":case"right top":case"to bottom left":case"to left bottom":return C(Math.PI+b(t),t);case"top left":case"left top":case"to bottom right":case"to right bottom":return C(Math.PI-b(t),t);case"bottom left":case"left bottom":case"to top right":case"to right top":return C(b(t),t);case"bottom right":case"right bottom":case"to top left":case"to left top":return C(2*Math.PI-b(t),t);case"top":case"to bottom":default:return C(Math.PI,t)}},T=function(e,t){var n=e.split(" ").map(parseFloat),i=r(n,2),a=i[0],A=i[1],o=a/100*t.width/(A/100*t.height);return C(Math.atan(isNaN(o)?1:o)+Math.PI/2,t)},M=function(e,t,n,r){return[{x:0,y:0},{x:0,y:e.height},{x:e.width,y:0},{x:e.width,y:e.height}].reduce((function(e,i){var a=(0,s.distance)(t-i.x,n-i.y);return(r?a<e.optimumDistance:a>e.optimumDistance)?{optimumCorner:i,optimumDistance:a}:e}),{optimumDistance:r?1/0:-1/0,optimumCorner:null}).optimumCorner},U=function(e,t,n,r,i){var a=n.x,A=n.y,o=0,u=0;switch(e){case"closest-side":t===y.CIRCLE?o=u=Math.min(Math.abs(a),Math.abs(a-i.width),Math.abs(A),Math.abs(A-i.height)):t===y.ELLIPSE&&(o=Math.min(Math.abs(a),Math.abs(a-i.width)),u=Math.min(Math.abs(A),Math.abs(A-i.height)));break;case"closest-corner":if(t===y.CIRCLE)o=u=Math.min((0,s.distance)(a,A),(0,s.distance)(a,A-i.height),(0,s.distance)(a-i.width,A),(0,s.distance)(a-i.width,A-i.height));else if(t===y.ELLIPSE){var c=Math.min(Math.abs(A),Math.abs(A-i.height))/Math.min(Math.abs(a),Math.abs(a-i.width)),l=M(i,a,A,!0);u=c*(o=(0,s.distance)(l.x-a,(l.y-A)/c))}break;case"farthest-side":t===y.CIRCLE?o=u=Math.max(Math.abs(a),Math.abs(a-i.width),Math.abs(A),Math.abs(A-i.height)):t===y.ELLIPSE&&(o=Math.max(Math.abs(a),Math.abs(a-i.width)),u=Math.max(Math.abs(A),Math.abs(A-i.height)));break;case"farthest-corner":if(t===y.CIRCLE)o=u=Math.max((0,s.distance)(a,A),(0,s.distance)(a,A-i.height),(0,s.distance)(a-i.width,A),(0,s.distance)(a-i.width,A-i.height));else if(t===y.ELLIPSE){var h=Math.max(Math.abs(A),Math.abs(A-i.height))/Math.max(Math.abs(a),Math.abs(a-i.width)),d=M(i,a,A,!1);u=h*(o=(0,s.distance)(d.x-a,(d.y-A)/h))}break;default:o=r.x||0,u=void 0!==r.y?r.y:o}return{x:o,y:u}},Q=t.transformWebkitRadialGradientArgs=function(e){var t="",n="",r="",i="",a=0,A=/^(left|center|right|\d+(?:px|r?em|%)?)(?:\s+(top|center|bottom|\d+(?:px|r?em|%)?))?$/i,o=/^\d+(px|r?em|%)?(?:\s+\d+(px|r?em|%)?)?$/i,s=e[a].match(A);s&&a++;var u=e[a].match(/^(circle|ellipse)?\s*(closest-side|closest-corner|farthest-side|farthest-corner|contain|cover)?$/i);u&&(t=u[1]||"","contain"===(r=u[2]||"")?r="closest-side":"cover"===r&&(r="farthest-corner"),a++);var c=e[a].match(o);c&&a++;var l=e[a].match(A);l&&a++;var h=e[a].match(o);h&&a++;var d=l||s;d&&d[1]&&(i=d[1]+(/^\d+$/.test(d[1])?"px":""),d[2]&&(i+=" "+d[2]+(/^\d+$/.test(d[2])?"px":"")));var f=h||c;return f&&(n=f[0],f[1]||(n+="px")),!i||t||n||r||(n=i,i=""),i&&(i="at "+i),[[t,r,n,i].filter((function(e){return!!e})).join(" ")].concat(e.slice(a))},x=function(e){return e.map((function(e){return e.match(f)})).map((function(t,n){if(!t)return e[n];switch(t[1]){case"from":return t[4]+" 0%";case"to":return t[4]+" 100%";case"color-stop":return"%"===t[3]?t[4]+" "+t[2]:t[4]+" "+100*parseFloat(t[2])+"%"}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/([+-]?\d*\.?\d+)(deg|grad|rad|turn)/i;t.parseAngle=function(e){var t=e.match(r);if(t){var n=parseFloat(t[1]);switch(t[2].toLowerCase()){case"deg":return Math.PI*n/180;case"grad":return Math.PI/200*n;case"rad":return n;case"turn":return 2*Math.PI*n}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneWindow=t.DocumentCloner=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var A,o=e[Symbol.iterator]();!(r=(A=o.next()).done)&&(n.push(A.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),A=n(26),o=h(n(55)),s=n(4),u=n(5),c=h(n(15)),l=n(56);function h(e){return e&&e.__esModule?e:{default:e}}var d=t.DocumentCloner=function(){function e(t,n,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.referenceElement=t,this.scrolledElements=[],this.copyStyles=i,this.inlineImages=i,this.logger=r,this.options=n,this.renderer=a,this.resourceLoader=new o.default(n,r,window),this.pseudoContentData={counters:{},quoteDepth:0},this.documentElement=this.cloneNode(t.ownerDocument.documentElement)}return i(e,[{key:"inlineAllImages",value:function(e){var t=this;if(this.inlineImages&&e){var n=e.style;Promise.all((0,u.parseBackgroundImage)(n.backgroundImage).map((function(e){return"url"===e.method?t.resourceLoader.inlineImage(e.args[0]).then((function(e){return e&&"string"==typeof e.src?'url("'+e.src+'")':"none"})).catch((function(e){t.logger.log("Unable to load image",e)})):Promise.resolve(""+e.prefix+e.method+"("+e.args.join(",")+")")}))).then((function(e){e.length>1&&(n.backgroundColor=""),n.backgroundImage=e.join(",")})),e instanceof HTMLImageElement&&this.resourceLoader.inlineImage(e.src).then((function(t){if(t&&e instanceof HTMLImageElement&&e.parentNode){var n=e.parentNode,r=(0,s.copyCSSStyles)(e.style,t.cloneNode(!1));n.replaceChild(r,e)}})).catch((function(e){t.logger.log("Unable to load image",e)}))}}},{key:"inlineFonts",value:function(e){var t=this;return Promise.all(Array.from(e.styleSheets).map((function(n){return n.href?fetch(n.href).then((function(e){return e.text()})).then((function(e){return p(e,n.href)})).catch((function(e){return t.logger.log("Unable to load stylesheet",e),[]})):f(n,e)}))).then((function(e){return e.reduce((function(e,t){return e.concat(t)}),[])})).then((function(e){return Promise.all(e.map((function(e){return fetch(e.formats[0].src).then((function(e){return e.blob()})).then((function(e){return new Promise((function(t,n){var r=new FileReader;r.onerror=n,r.onload=function(){var e=r.result;t(e)},r.readAsDataURL(e)}))})).then((function(t){return e.fontFace.setProperty("src",'url("'+t+'")'),"@font-face {"+e.fontFace.cssText+" "}))})))})).then((function(n){var r=e.createElement("style");r.textContent=n.join("\n"),t.documentElement.appendChild(r)}))}},{key:"createElementClone",value:function(e){var t=this;if(this.copyStyles&&e instanceof HTMLCanvasElement){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch(e){this.logger.log("Unable to clone canvas contents, canvas is tainted")}}if(e instanceof HTMLIFrameElement){var r=e.cloneNode(!1),i=b();r.setAttribute("data-html2canvas-internal-iframe-key",i);var A=(0,a.parseBounds)(e,0,0),o=A.width,u=A.height;return this.resourceLoader.cache[i]=T(e,this.options).then((function(e){return t.renderer(e,{async:t.options.async,allowTaint:t.options.allowTaint,backgroundColor:"#ffffff",canvas:null,imageTimeout:t.options.imageTimeout,logging:t.options.logging,proxy:t.options.proxy,removeContainer:t.options.removeContainer,scale:t.options.scale,foreignObjectRendering:t.options.foreignObjectRendering,useCORS:t.options.useCORS,target:new c.default,width:o,height:u,x:0,y:0,windowWidth:e.ownerDocument.defaultView.innerWidth,windowHeight:e.ownerDocument.defaultView.innerHeight,scrollX:e.ownerDocument.defaultView.pageXOffset,scrollY:e.ownerDocument.defaultView.pageYOffset},t.logger.child(i))})).then((function(t){return new Promise((function(n,i){var a=document.createElement("img");a.onload=function(){return n(t)},a.onerror=i,a.src=t.toDataURL(),r.parentNode&&r.parentNode.replaceChild((0,s.copyCSSStyles)(e.ownerDocument.defaultView.getComputedStyle(e),a),r)}))})),r}if(e instanceof HTMLStyleElement&&e.sheet&&e.sheet.cssRules){var l=[].slice.call(e.sheet.cssRules,0).reduce((function(e,n){try{return n&&n.cssText?e+n.cssText:e}catch(r){return t.logger.log("Unable to access cssText property",n.name),e}}),""),h=e.cloneNode(!1);return h.textContent=l,h}return e.cloneNode(!1)}},{key:"cloneNode",value:function(e){var t=e.nodeType===Node.TEXT_NODE?document.createTextNode(e.nodeValue):this.createElementClone(e),n=e.ownerDocument.defaultView,r=e instanceof n.HTMLElement?n.getComputedStyle(e):null,i=e instanceof n.HTMLElement?n.getComputedStyle(e,":before"):null,a=e instanceof n.HTMLElement?n.getComputedStyle(e,":after"):null;this.referenceElement===e&&t instanceof n.HTMLElement&&(this.clonedReferenceElement=t),t instanceof n.HTMLBodyElement&&w(t);for(var A=(0,l.parseCounterReset)(r,this.pseudoContentData),o=(0,l.resolvePseudoContent)(e,i,this.pseudoContentData),u=e.firstChild;u;u=u.nextSibling)u.nodeType===Node.ELEMENT_NODE&&("SCRIPT"===u.nodeName||u.hasAttribute("data-html2canvas-ignore")||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(u))||this.copyStyles&&"STYLE"===u.nodeName||t.appendChild(this.cloneNode(u));var c=(0,l.resolvePseudoContent)(e,a,this.pseudoContentData);if((0,l.popCounters)(A,this.pseudoContentData),e instanceof n.HTMLElement&&t instanceof n.HTMLElement)switch(i&&this.inlineAllImages(y(e,t,i,o,v)),a&&this.inlineAllImages(y(e,t,a,c,m)),!r||!this.copyStyles||e instanceof HTMLIFrameElement||(0,s.copyCSSStyles)(r,t),this.inlineAllImages(t),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([t,e.scrollLeft,e.scrollTop]),e.nodeName){case"CANVAS":this.copyStyles||g(e,t);break;case"TEXTAREA":case"SELECT":t.value=e.value}return t}}]),e}(),f=function(e,t){return(e.cssRules?Array.from(e.cssRules):[]).filter((function(e){return e.type===CSSRule.FONT_FACE_RULE})).map((function(e){for(var n=(0,u.parseBackgroundImage)(e.style.getPropertyValue("src")),r=[],i=0;i<n.length;i++)if("url"===n[i].method&&n[i+1]&&"format"===n[i+1].method){var a=t.createElement("a");a.href=n[i].args[0],t.body&&t.body.appendChild(a);var A={src:a.href,format:n[i+1].args[0]};r.push(A)}return{formats:r.filter((function(e){return/^woff/i.test(e.format)})),fontFace:e.style}})).filter((function(e){return e.formats.length}))},p=function(e,t){var n=document.implementation.createHTMLDocument(""),r=document.createElement("base");r.href=t;var i=document.createElement("style");return i.textContent=e,n.head&&n.head.appendChild(r),n.body&&n.body.appendChild(i),i.sheet?f(i.sheet,n):[]},g=function(e,t){try{if(t){t.width=e.width,t.height=e.height;var n=e.getContext("2d"),r=t.getContext("2d");n?r.putImageData(n.getImageData(0,0,e.width,e.height),0,0):r.drawImage(e,0,0)}}catch(e){}},y=function(e,t,n,r,i){if(n&&n.content&&"none"!==n.content&&"-moz-alt-content"!==n.content&&"none"!==n.display){var a=t.ownerDocument.createElement("html2canvaspseudoelement");if((0,s.copyCSSStyles)(n,a),r)for(var A=r.length,o=0;o<A;o++){var c=r[o];switch(c.type){case l.PSEUDO_CONTENT_ITEM_TYPE.IMAGE:var h=t.ownerDocument.createElement("img");h.src=(0,u.parseBackgroundImage)("url("+c.value+")")[0].args[0],h.style.opacity="1",a.appendChild(h);break;case l.PSEUDO_CONTENT_ITEM_TYPE.TEXT:a.appendChild(t.ownerDocument.createTextNode(c.value))}}return a.className=E+" "+B,t.className+=i===v?" "+E:" "+B,i===v?t.insertBefore(a,t.firstChild):t.appendChild(a),a}},v=":before",m=":after",E="___html2canvas___pseudoelement_before",B="___html2canvas___pseudoelement_after",w=function(e){k(e,"."+E+v+'{\n    content: "" !important;\n    display: none !important;\n}\n         .'+B+m+'{\n    content: "" !important;\n    display: none !important;\n}')},k=function(e,t){var n=e.ownerDocument.createElement("style");n.innerHTML=t,e.appendChild(n)},C=function(e){var t=r(e,3),n=t[0],i=t[1],a=t[2];n.scrollLeft=i,n.scrollTop=a},b=function(){return Math.ceil(Date.now()+1e7*Math.random()).toString(16)},S=/^data:text\/(.+);(base64)?,(.*)$/i,T=function(e,t){try{return Promise.resolve(e.contentWindow.document.documentElement)}catch(n){return t.proxy?(0,A.Proxy)(e.src,t).then((function(e){var t=e.match(S);return t?"base64"===t[2]?window.atob(decodeURIComponent(t[3])):decodeURIComponent(t[3]):Promise.reject()})).then((function(t){return M(e.ownerDocument,(0,a.parseBounds)(e,0,0)).then((function(e){var n=e.contentWindow.document;n.open(),n.write(t);var r=U(e).then((function(){return n.documentElement}));return n.close(),r}))})):Promise.reject()}},M=function(e,t){var n=e.createElement("iframe");return n.className="html2canvas-container",n.style.visibility="hidden",n.style.position="fixed",n.style.left="-10000px",n.style.top="0px",n.style.border="0",n.width=t.width.toString(),n.height=t.height.toString(),n.scrolling="no",n.setAttribute("data-html2canvas-ignore","true"),e.body?(e.body.appendChild(n),Promise.resolve(n)):Promise.reject("Body element not found in Document that is getting rendered")},U=function(e){var t=e.contentWindow,n=t.document;return new Promise((function(r,i){t.onload=e.onload=n.onreadystatechange=function(){var t=setInterval((function(){n.body.childNodes.length>0&&"complete"===n.readyState&&(clearInterval(t),r(e))}),50)}}))},Q=(t.cloneWindow=function(e,t,n,r,i,a){var A=new d(n,r,i,!1,a),o=e.defaultView.pageXOffset,s=e.defaultView.pageYOffset;return M(e,t).then((function(i){var a=i.contentWindow,u=a.document,c=U(i).then((function(){A.scrolledElements.forEach(C),a.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||a.scrollY===t.top&&a.scrollX===t.left||(u.documentElement.style.top=-t.top+"px",u.documentElement.style.left=-t.left+"px",u.documentElement.style.position="absolute");var o=Promise.resolve([i,A.clonedReferenceElement,A.resourceLoader]),s=r.onclone;return A.clonedReferenceElement instanceof a.HTMLElement||A.clonedReferenceElement instanceof e.defaultView.HTMLElement||A.clonedReferenceElement instanceof HTMLElement?"function"==typeof s?Promise.resolve().then((function(){return s(u)})).then((function(){return o})):o:Promise.reject("Error finding the "+n.nodeName+" in the cloned document")}));return u.open(),u.write(Q(document.doctype)+"<html></html>"),function(e,t,n){!e.defaultView||t===e.defaultView.pageXOffset&&n===e.defaultView.pageYOffset||e.defaultView.scrollTo(t,n)}(n.ownerDocument,o,s),u.replaceChild(u.adoptNode(A.documentElement),u.documentElement),u.close(),c}))},function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceStore=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(10),A=(r=a)&&r.__esModule?r:{default:r},o=n(26);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(t,n,r){s(this,e),this.options=t,this._window=r,this.origin=this.getOrigin(r.location.href),this.cache={},this.logger=n,this._index=0}return i(e,[{key:"loadImage",value:function(e){var t=this;if(this.hasResourceInCache(e))return e;if(g(e))return this.cache[e]=v(e,this.options.imageTimeout||0),e;if(!y(e)||A.default.SUPPORT_SVG_DRAWING){if(!0===this.options.allowTaint||f(e)||this.isSameOrigin(e))return this.addImage(e,e,!1);if(!this.isSameOrigin(e)){if("string"==typeof this.options.proxy)return this.cache[e]=(0,o.Proxy)(e,this.options).then((function(e){return v(e,t.options.imageTimeout||0)})),e;if(!0===this.options.useCORS&&A.default.SUPPORT_CORS_IMAGES)return this.addImage(e,e,!0)}}}},{key:"inlineImage",value:function(e){var t=this;return f(e)?v(e,this.options.imageTimeout||0):this.hasResourceInCache(e)?this.cache[e]:this.isSameOrigin(e)||"string"!=typeof this.options.proxy?this.xhrImage(e):this.cache[e]=(0,o.Proxy)(e,this.options).then((function(e){return v(e,t.options.imageTimeout||0)}))}},{key:"xhrImage",value:function(e){var t=this;return this.cache[e]=new Promise((function(n,r){var i=new XMLHttpRequest;if(i.onreadystatechange=function(){if(4===i.readyState)if(200!==i.status)r("Failed to fetch image "+e.substring(0,256)+" with status code "+i.status);else{var t=new FileReader;t.addEventListener("load",(function(){var e=t.result;n(e)}),!1),t.addEventListener("error",(function(e){return r(e)}),!1),t.readAsDataURL(i.response)}},i.responseType="blob",t.options.imageTimeout){var a=t.options.imageTimeout;i.timeout=a,i.ontimeout=function(){return r("Timed out ("+a+"ms) fetching "+e.substring(0,256))}}i.open("GET",e,!0),i.send()})).then((function(e){return v(e,t.options.imageTimeout||0)})),this.cache[e]}},{key:"loadCanvas",value:function(e){var t=String(this._index++);return this.cache[t]=Promise.resolve(e),t}},{key:"hasResourceInCache",value:function(e){return void 0!==this.cache[e]}},{key:"addImage",value:function(e,t,n){var r=this;this.logger.log("Added image "+e.substring(0,256));var i=function(e){return new Promise((function(i,a){var A=new Image;if(A.onload=function(){return i(A)},e&&!n||(A.crossOrigin="anonymous"),A.onerror=a,A.src=t,!0===A.complete&&setTimeout((function(){i(A)}),500),r.options.imageTimeout){var o=r.options.imageTimeout;setTimeout((function(){return a("Timed out ("+o+"ms) fetching "+t.substring(0,256))}),o)}}))};return this.cache[e]=p(t)&&!y(t)?A.default.SUPPORT_BASE64_DRAWING(t).then(i):i(!0),e}},{key:"isSameOrigin",value:function(e){return this.getOrigin(e)===this.origin}},{key:"getOrigin",value:function(e){var t=this._link||(this._link=this._window.document.createElement("a"));return t.href=e,t.href=t.href,t.protocol+t.hostname+t.port}},{key:"ready",value:function(){var e=this,t=Object.keys(this.cache),n=t.map((function(t){return e.cache[t].catch((function(t){return e.logger.log("Unable to load image",t),null}))}));return Promise.all(n).then((function(n){return e.logger.log("Finished loading "+n.length+" images",n),new c(t,n)}))}}]),e}();t.default=u;var c=t.ResourceStore=function(){function e(t,n){s(this,e),this._keys=t,this._resources=n}return i(e,[{key:"get",value:function(e){var t=this._keys.indexOf(e);return-1===t?null:this._resources[t]}}]),e}(),l=/^data:image\/svg\+xml/i,h=/^data:image\/.*;base64,/i,d=/^data:image\/.*/i,f=function(e){return d.test(e)},p=function(e){return h.test(e)},g=function(e){return"blob"===e.substr(0,4)},y=function(e){return"svg"===e.substr(-3).toLowerCase()||l.test(e)},v=function(e,t){return new Promise((function(n,r){var i=new Image;i.onload=function(){return n(i)},i.onerror=r,i.src=e,!0===i.complete&&setTimeout((function(){n(i)}),500),t&&setTimeout((function(){return r("Timed out ("+t+"ms) loading image")}),t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseContent=t.resolvePseudoContent=t.popCounters=t.parseCounterReset=t.TOKEN_TYPE=t.PSEUDO_CONTENT_ITEM_TYPE=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var A,o=e[Symbol.iterator]();!(r=(A=o.next()).done)&&(n.push(A.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=n(14),a=n(8),A=t.PSEUDO_CONTENT_ITEM_TYPE={TEXT:0,IMAGE:1},o=t.TOKEN_TYPE={STRING:0,ATTRIBUTE:1,URL:2,COUNTER:3,COUNTERS:4,OPENQUOTE:5,CLOSEQUOTE:6},s=(t.parseCounterReset=function(e,t){if(!e||!e.counterReset||"none"===e.counterReset)return[];for(var n=[],i=e.counterReset.split(/\s*,\s*/),a=i.length,A=0;A<a;A++){var o=i[A].split(/\s+/),s=r(o,2),u=s[0],c=s[1];n.push(u);var l=t.counters[u];l||(l=t.counters[u]=[]),l.push(parseInt(c||0,10))}return n},t.popCounters=function(e,t){for(var n=e.length,r=0;r<n;r++)t.counters[e[r]].pop()},t.resolvePseudoContent=function(e,t,n){if(!t||!t.content||"none"===t.content||"-moz-alt-content"===t.content||"none"===t.display)return null;var i=s(t.content),a=i.length,u=[],h="",d=t.counterIncrement;if(d&&"none"!==d){var f=d.split(/\s+/),p=r(f,2),g=p[0],y=p[1],v=n.counters[g];v&&(v[v.length-1]+=void 0===y?1:parseInt(y,10))}for(var m=0;m<a;m++){var E=i[m];switch(E.type){case o.STRING:h+=E.value||"";break;case o.ATTRIBUTE:e instanceof HTMLElement&&E.value&&(h+=e.getAttribute(E.value)||"");break;case o.COUNTER:var B=n.counters[E.name||""];B&&(h+=l([B[B.length-1]],"",E.format));break;case o.COUNTERS:var w=n.counters[E.name||""];w&&(h+=l(w,E.glue,E.format));break;case o.OPENQUOTE:h+=c(t,!0,n.quoteDepth),n.quoteDepth++;break;case o.CLOSEQUOTE:n.quoteDepth--,h+=c(t,!1,n.quoteDepth);break;case o.URL:h&&(u.push({type:A.TEXT,value:h}),h=""),u.push({type:A.IMAGE,value:E.value||""})}}return h&&u.push({type:A.TEXT,value:h}),u},t.parseContent=function(e,t){if(t&&t[e])return t[e];for(var n=[],r=e.length,i=!1,a=!1,A=!1,s="",c="",l=[],h=0;h<r;h++){var d=e.charAt(h);switch(d){case"'":case'"':a?s+=d:(i=!i,A||i||(n.push({type:o.STRING,value:s}),s=""));break;case"\\":a?(s+=d,a=!1):a=!0;break;case"(":i?s+=d:(A=!0,c=s,s="",l=[]);break;case")":if(i)s+=d;else if(A){switch(s&&l.push(s),c){case"attr":l.length>0&&n.push({type:o.ATTRIBUTE,value:l[0]});break;case"counter":if(l.length>0){var f={type:o.COUNTER,name:l[0]};l.length>1&&(f.format=l[1]),n.push(f)}break;case"counters":if(l.length>0){var p={type:o.COUNTERS,name:l[0]};l.length>1&&(p.glue=l[1]),l.length>2&&(p.format=l[2]),n.push(p)}break;case"url":l.length>0&&n.push({type:o.URL,value:l[0]})}A=!1,s=""}break;case",":i?s+=d:A&&(l.push(s),s="");break;case" ":case"\t":i?s+=d:s&&(u(n,s),s="");break;default:s+=d}"\\"!==d&&(a=!1)}return s&&u(n,s),t&&(t[e]=n),n}),u=function(e,t){switch(t){case"open-quote":e.push({type:o.OPENQUOTE});break;case"close-quote":e.push({type:o.CLOSEQUOTE})}},c=function(e,t,n){var r=e.quotes?e.quotes.split(/\s+/):["'\"'","'\"'"],i=2*n;return i>=r.length&&(i=r.length-2),t||++i,r[i].replace(/^["']|["']$/g,"")},l=function(e,t,n){for(var r=e.length,A="",o=0;o<r;o++)o>0&&(A+=t||""),A+=(0,i.createCounterText)(e[o],(0,a.parseListStyleType)(n||"decimal"),!1);return A}}])},"object"===A(t)&&"object"===A(e)?e.exports=a():(r=[],void 0===(i="function"==typeof(n=a)?n.apply(t,r):n)||(e.exports=i))}).call(this,n(89)(e))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(437);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(4)(!1)).push([e.i,".markup-frames-container{transform:translateZ(0);left:0;top:0;position:absolute}.markup-selection-frame-container{display:none}.markup-selection-frame-container.visible{display:block}.markup-selection-frame{transform:translateZ(0);position:absolute;pointer-events:none}.markup-selection-frame.fill{display:none;background-color:rgba(6,150,215,0.05)}.markup-selection-frame.fill.ios,.markup-selection-frame.border.ios{transform:translateZ(0);-webkit-transform:rotateZ(0deg)}.markup-selection-frame.fill.visible{display:block}.markup-selection-frame.border{background-color:rgba(6,150,215,0.6)}.markup-selection-frame.segment{display:none}.markup-selection-frame.segment.visible{display:block}.markup-anchor{transform:translateZ(0);display:none;position:absolute;background:#FFFFFF;box-shadow:0 0 0 1px rgba(107,120,127,0.7);pointer-events:none;border-radius:20px;z-index:1}.markup-anchor-fill.rectangle,.markup-anchor.rectangle{border-radius:0px}.markup-anchor-fill{display:none;width:100%;margin:1px;border-radius:20px;background:#0696D7}.markup-anchor-fill.visible{display:block}.markup-anchor.visible{display:flex}.rect-selector-frame{transform:translateZ(0);position:absolute;pointer-events:none;border:#222222 dashed 1px;border-radius:5px}.rect-selector-frame.visible{display:block}\n",""])},function(e,t,n){var r=n(439);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(4)(!1)).push([e.i,'.markup-links-container{transform:translateZ(0);left:0;top:0;position:absolute}.link{display:none;position:absolute;pointer-events:none;z-index:1}.link.visible{display:block}.link.transparent{opacity:0.3}.link-document-attachment{transform:translateZ(0);display:block;position:absolute;text-align:center;font-family:"Artifakt Element";background-color:#0696D7;border-radius:10.5px;color:white;cursor:pointer;font-size:13px;font-weight:500;line-height:19px;height:20px;width:40px}.link-document-attachment:before{font-family:"bimviewericon", sans-serif;content:"\\E911";font-size:11px;padding-right:4px}.link.selected .link-document-attachment{background-color:#0584BD}.link.hover .link-document-attachment{background-color:#38ABDF}.link.editable .link-document-attachment{outline:1px solid rgba(6,150,215,0.6)}\n',""])},function(e,t,n){var r=n(441);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(4)(!1)).push([e.i,".markup-text-container{left:0;top:0;width:100%;height:100%;position:absolute;pointer-events:none}.markup-text{will-change:contents;transform:translateZ(0);text-rendering:geometricPrecision;display:none;position:absolute;pointer-events:none;text-align:left;white-space:pre-wrap;overflow-wrap:break-word;word-wrap:break-word;outline:none;-webkit-user-select:none;user-select:none}.markup-text p{display:block;box-sizing:content-box;font-weight:inherit;font-size:inherit;font-family:inherit;font-style:inherit;word-wrap:inherit;white-space:inherit;line-height:inherit;text-rendering:geometricPrecision;-ms-text-size-adjust:100%;text-align:left;margin:0 0 0 0;padding:0 0 0 0;user-select:text}.markup-text.single-line br{display:none}.markup-text.visible{display:block}.markup-text-area{pointer-events:all;position:absolute;z-index:100}\n",""])},function(e,t){e.exports=function(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();return t.setSeconds(0,0),6e4*n+t.getTime()%6e4}},function(e,t,n){var r=n(2);e.exports=function(e,t,n,i){var a=r(e).getTime(),A=r(t).getTime(),o=r(n).getTime(),s=r(i).getTime();if(a>A||o>s)throw new Error("The start of the range cannot be after the end of the range");return a<s&&o<A}},function(e,t,n){var r=n(2);e.exports=function(e,t){if(!(t instanceof Array))throw new TypeError(toString.call(t)+" is not an instance of Array");var n,i,a=r(e).getTime();return t.forEach((function(e,t){var A=r(e),o=Math.abs(a-A.getTime());(void 0===n||o<i)&&(n=t,i=o)})),n}},function(e,t,n){var r=n(2);e.exports=function(e,t){if(!(t instanceof Array))throw new TypeError(toString.call(t)+" is not an instance of Array");var n,i,a=r(e).getTime();return t.forEach((function(e){var t=r(e),A=Math.abs(a-t.getTime());(void 0===n||A<i)&&(n=t,i=A)})),n}},function(e,t,n){var r=n(31);e.exports=function(e,t){var n=r(e),i=r(t),a=n.getTime()-6e4*n.getTimezoneOffset(),A=i.getTime()-6e4*i.getTimezoneOffset();return Math.round((a-A)/6048e5)}},function(e,t,n){var r=n(99),i=n(2);e.exports=function(e,t){var n=i(e),a=i(t);return 4*(n.getFullYear()-a.getFullYear())+(r(n)-r(a))}},function(e,t,n){var r=n(53);e.exports=function(e,t,n){var i=r(e,n),a=r(t,n),A=i.getTime()-6e4*i.getTimezoneOffset(),o=a.getTime()-6e4*a.getTimezoneOffset();return Math.round((A-o)/6048e5)}},function(e,t,n){var r=n(56);e.exports=function(e,t){var n=r(e,t)/36e5;return n>0?Math.floor(n):Math.ceil(n)}},function(e,t,n){var r=n(2),i=n(97),a=n(40),A=n(102);e.exports=function(e,t){var n=r(e),o=r(t),s=a(n,o),u=Math.abs(i(n,o));return n=A(n,s*u),s*(u-(a(n,o)===-s))}},function(e,t,n){var r=n(56);e.exports=function(e,t){var n=r(e,t)/6e4;return n>0?Math.floor(n):Math.ceil(n)}},function(e,t,n){var r=n(70);e.exports=function(e,t){var n=r(e,t)/3;return n>0?Math.floor(n):Math.ceil(n)}},function(e,t,n){var r=n(101);e.exports=function(e,t){var n=r(e,t)/7;return n>0?Math.floor(n):Math.ceil(n)}},function(e,t,n){var r=n(2),i=n(100),a=n(40);e.exports=function(e,t){var n=r(e),A=r(t),o=a(n,A),s=Math.abs(i(n,A));return n.setFullYear(n.getFullYear()-o*s),o*(s-(a(n,A)===-o))}},function(e,t){e.exports=function(){var e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};return{localize:function(t,n,r){var i;return r=r||{},i="string"==typeof e[t]?e[t]:1===n?e[t].one:e[t].other.replace("{{count}}",n),r.addSuffix?r.comparison>0?"in "+i:i+" ago":i}}}},function(e,t,n){var r=n(457);e.exports=function(){var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=["January","February","March","April","May","June","July","August","September","October","November","December"],n=["Su","Mo","Tu","We","Th","Fr","Sa"],i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],A=["AM","PM"],o=["am","pm"],s=["a.m.","p.m."],u={MMM:function(t){return e[t.getMonth()]},MMMM:function(e){return t[e.getMonth()]},dd:function(e){return n[e.getDay()]},ddd:function(e){return i[e.getDay()]},dddd:function(e){return a[e.getDay()]},A:function(e){return e.getHours()/12>=1?A[1]:A[0]},a:function(e){return e.getHours()/12>=1?o[1]:o[0]},aa:function(e){return e.getHours()/12>=1?s[1]:s[0]}};return["M","D","DDD","d","Q","W"].forEach((function(e){u[e+"o"]=function(t,n){return function(e){var t=e%100;if(t>20||t<10)switch(t%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"}(n[e](t))}})),{formatters:u,formattingTokensRegExp:r(u)}}},function(e,t){var n=["M","MM","Q","D","DD","DDD","DDDD","d","E","W","WW","YY","YYYY","GG","GGGG","H","HH","h","hh","m","mm","s","ss","S","SS","SSS","Z","ZZ","X","x"];e.exports=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);var i=n.concat(t).sort().reverse();return new RegExp("(\\[[^\\[]*\\])|(\\\\)?("+i.join("|")+"|.)","g")}},function(e,t,n){var r=n(69),i=n(2),a=n(71),A=n(72);e.exports=function(e,t,n){var o=n||{},s=r(e,t),u=o.locale,c=A.distanceInWords.localize;u&&u.distanceInWords&&u.distanceInWords.localize&&(c=u.distanceInWords.localize);var l,h,d,f={addSuffix:Boolean(o.addSuffix),comparison:s};s>0?(l=i(e),h=i(t)):(l=i(t),h=i(e));var p=Math[o.partialMethod?String(o.partialMethod):"floor"],g=a(h,l),y=h.getTimezoneOffset()-l.getTimezoneOffset(),v=p(g/60)-y;if("s"===(d=o.unit?String(o.unit):v<1?"s":v<60?"m":v<1440?"h":v<43200?"d":v<525600?"M":"Y"))return c("xSeconds",g,f);if("m"===d)return c("xMinutes",v,f);if("h"===d)return c("xHours",p(v/60),f);if("d"===d)return c("xDays",p(v/1440),f);if("M"===d)return c("xMonths",p(v/43200),f);if("Y"===d)return c("xYears",p(v/525600),f);throw new Error("Unknown unit: "+d)}},function(e,t,n){var r=n(103);e.exports=function(e,t){return r(Date.now(),e,t)}},function(e,t,n){var r=n(2);e.exports=function(e,t,n){var i=r(e),a=void 0!==n?n:1,A=r(t).getTime();if(i.getTime()>A)throw new Error("The first date cannot be after the second date");var o=[],s=i;for(s.setHours(0,0,0,0);s.getTime()<=A;)o.push(r(s)),s.setDate(s.getDate()+a);return o}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e);return t.setMinutes(59,59,999),t}},function(e,t,n){var r=n(104);e.exports=function(e){return r(e,{weekStartsOn:1})}},function(e,t,n){var r=n(30),i=n(31);e.exports=function(e){var t=r(e),n=new Date(0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);var a=i(n);return a.setMilliseconds(a.getMilliseconds()-1),a}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e);return t.setSeconds(59,999),t}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e),n=t.getMonth(),i=n-n%3+3;return t.setMonth(i,0),t.setHours(23,59,59,999),t}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e);return t.setMilliseconds(999),t}},function(e,t,n){var r=n(73);e.exports=function(){return r(new Date)}},function(e,t){e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r+1),i.setHours(23,59,59,999),i}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}},function(e,t){e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r-1),i.setHours(23,59,59,999),i}},function(e,t,n){var r=n(106),i=n(74),a=n(30),A=n(2),o=n(108),s=n(72);var u={M:function(e){return e.getMonth()+1},MM:function(e){return h(e.getMonth()+1,2)},Q:function(e){return Math.ceil((e.getMonth()+1)/3)},D:function(e){return e.getDate()},DD:function(e){return h(e.getDate(),2)},DDD:function(e){return r(e)},DDDD:function(e){return h(r(e),3)},d:function(e){return e.getDay()},E:function(e){return e.getDay()||7},W:function(e){return i(e)},WW:function(e){return h(i(e),2)},YY:function(e){return h(e.getFullYear(),4).substr(2)},YYYY:function(e){return h(e.getFullYear(),4)},GG:function(e){return String(a(e)).substr(2)},GGGG:function(e){return a(e)},H:function(e){return e.getHours()},HH:function(e){return h(e.getHours(),2)},h:function(e){var t=e.getHours();return 0===t?12:t>12?t%12:t},hh:function(e){return h(u.h(e),2)},m:function(e){return e.getMinutes()},mm:function(e){return h(e.getMinutes(),2)},s:function(e){return e.getSeconds()},ss:function(e){return h(e.getSeconds(),2)},S:function(e){return Math.floor(e.getMilliseconds()/100)},SS:function(e){return h(Math.floor(e.getMilliseconds()/10),2)},SSS:function(e){return h(e.getMilliseconds(),3)},Z:function(e){return l(e.getTimezoneOffset(),":")},ZZ:function(e){return l(e.getTimezoneOffset())},X:function(e){return Math.floor(e.getTime()/1e3)},x:function(e){return e.getTime()}};function c(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|]$/g,""):e.replace(/\\/g,"")}function l(e,t){t=t||"";var n=e>0?"-":"+",r=Math.abs(e),i=r%60;return n+h(Math.floor(r/60),2)+t+h(i,2)}function h(e,t){for(var n=Math.abs(e).toString();n.length<t;)n="0"+n;return n}e.exports=function(e,t,n){var r=t?String(t):"YYYY-MM-DDTHH:mm:ss.SSSZ",i=(n||{}).locale,a=s.format.formatters,l=s.format.formattingTokensRegExp;i&&i.format&&i.format.formatters&&(a=i.format.formatters,i.format.formattingTokensRegExp&&(l=i.format.formattingTokensRegExp));var h=A(e);return o(h)?function(e,t,n){var r,i,a=e.match(n),A=a.length;for(r=0;r<A;r++)i=t[a[r]]||u[a[r]],a[r]=i||c(a[r]);return function(e){for(var t="",n=0;n<A;n++)a[n]instanceof Function?t+=a[n](e,u):t+=a[n];return t}}(r,a,l)(h):"Invalid Date"}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getDate()}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getDay()}},function(e,t,n){var r=n(109);e.exports=function(e){return r(e)?366:365}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getHours()}},function(e,t,n){var r=n(39),i=n(68);e.exports=function(e){var t=r(e),n=r(i(t,60)).valueOf()-t.valueOf();return Math.round(n/6048e5)}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getMilliseconds()}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getMinutes()}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getMonth()}},function(e,t,n){var r=n(2);e.exports=function(e,t,n,i){var a=r(e).getTime(),A=r(t).getTime(),o=r(n).getTime(),s=r(i).getTime();if(a>A||o>s)throw new Error("The start of the range cannot be after the end of the range");if(!(a<s&&o<A))return 0;var u=(s>A?A:s)-(o<a?a:o);return Math.ceil(u/864e5)}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getSeconds()}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getTime()}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getFullYear()}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()>i.getTime()}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()<i.getTime()}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(2);e.exports=function(e){return 1===r(e).getDate()}},function(e,t,n){var r=n(2);e.exports=function(e){return 5===r(e).getDay()}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getTime()>(new Date).getTime()}},function(e,t,n){var r=n(2),i=n(73),a=n(105);e.exports=function(e){var t=r(e);return i(t).getTime()===a(t).getTime()}},function(e,t,n){var r=n(2);e.exports=function(e){return 1===r(e).getDay()}},function(e,t,n){var r=n(2);e.exports=function(e){return r(e).getTime()<(new Date).getTime()}},function(e,t,n){var r=n(32);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()===i.getTime()}},function(e,t,n){var r=n(2);e.exports=function(e){return 6===r(e).getDay()}},function(e,t,n){var r=n(2);e.exports=function(e){return 0===r(e).getDay()}},function(e,t,n){var r=n(111);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(113);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(114);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(115);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(117);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(118);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(120);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(75);e.exports=function(e,t){return r(new Date,e,t)}},function(e,t,n){var r=n(122);e.exports=function(e){return r(new Date,e)}},function(e,t,n){var r=n(2);e.exports=function(e){return 4===r(e).getDay()}},function(e,t,n){var r=n(32);e.exports=function(e){return r(e).getTime()===r(new Date).getTime()}},function(e,t,n){var r=n(32);e.exports=function(e){var t=new Date;return t.setDate(t.getDate()+1),r(e).getTime()===r(t).getTime()}},function(e,t,n){var r=n(2);e.exports=function(e){return 2===r(e).getDay()}},function(e,t,n){var r=n(2);e.exports=function(e){return 3===r(e).getDay()}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e).getDay();return 0===t||6===t}},function(e,t,n){var r=n(2);e.exports=function(e,t,n){var i=r(e).getTime(),a=r(t).getTime(),A=r(n).getTime();if(a>A)throw new Error("The start of the range cannot be after the end of the range");return i>=a&&i<=A}},function(e,t,n){var r=n(32);e.exports=function(e){var t=new Date;return t.setDate(t.getDate()-1),r(e).getTime()===r(t).getTime()}},function(e,t,n){var r=n(123);e.exports=function(e){return r(e,{weekStartsOn:1})}},function(e,t,n){var r=n(30),i=n(31);e.exports=function(e){var t=r(e),n=new Date(0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);var a=i(n);return a.setDate(a.getDate()-1),a}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e),n=t.getMonth(),i=n-n%3+3;return t.setMonth(i,0),t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(2);e.exports=function(){var e=Array.prototype.slice.call(arguments),t=e.map((function(e){return r(e)})),n=Math.max.apply(null,t);return new Date(n)}},function(e,t,n){var r=n(2);e.exports=function(){var e=Array.prototype.slice.call(arguments),t=e.map((function(e){return r(e)})),n=Math.min.apply(null,t);return new Date(n)}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setDate(i),n}},function(e,t,n){var r=n(2),i=n(37);e.exports=function(e,t,n){var a=n&&Number(n.weekStartsOn)||0,A=r(e),o=Number(t),s=A.getDay();return i(A,((o%7+7)%7<a?7:0)+o-s)}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setMonth(0),n.setDate(i),n}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setHours(i),n}},function(e,t,n){var r=n(2),i=n(37),a=n(110);e.exports=function(e,t){var n=r(e),A=Number(t),o=a(n);return i(n,A-o)}},function(e,t,n){var r=n(2),i=n(74);e.exports=function(e,t){var n=r(e),a=Number(t),A=i(n)-a;return n.setDate(n.getDate()-7*A),n}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setMilliseconds(i),n}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setMinutes(i),n}},function(e,t,n){var r=n(2),i=n(124);e.exports=function(e,t){var n=r(e),a=Number(t)-(Math.floor(n.getMonth()/3)+1);return i(n,n.getMonth()+3*a)}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setSeconds(i),n}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setFullYear(i),n}},function(e,t,n){var r=n(2);e.exports=function(e){var t=r(e);return t.setDate(1),t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(32);e.exports=function(){return r(new Date)}},function(e,t){e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r+1),i.setHours(0,0,0,0),i}},function(e,t){e.exports=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=new Date(0);return i.setFullYear(t,n,r-1),i.setHours(0,0,0,0),i}},function(e,t,n){var r=n(37);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(90);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(38);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(93);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(55);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(94);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(95);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(68);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(96);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Xc}));var r={};n.r(r),n.d(r,"COLORS",(function(){return o})),n.d(r,"DEFAULT_COLORS",(function(){return s})),n.d(r,"DEFAULT_FILL_COLORS",(function(){return u})),n.d(r,"STYLE_PROPERTIES",(function(){return c})),n.d(r,"FONT_SIZES",(function(){return l})),n.d(r,"MESHLINE_PATH_START",(function(){return h})),n.d(r,"MESHLINE_PATH_END",(function(){return d})),n.d(r,"MESHLINE_PATH_DEFAULT",(function(){return f})),n.d(r,"MESHLINE_PATH_ROUND_CAP",(function(){return p})),n.d(r,"MESHLINE_PATH_FLAT_CAP",(function(){return g})),n.d(r,"MARKUP_TYPE_ARROW",(function(){return y})),n.d(r,"MARKUP_TYPE_RECTANGLE",(function(){return v})),n.d(r,"MARKUP_TYPE_CIRCLE",(function(){return m})),n.d(r,"MARKUP_TYPE_CLOUD",(function(){return E})),n.d(r,"MARKUP_TYPE_FREEHAND",(function(){return B})),n.d(r,"MARKUP_TYPE_HIGHLIGHT",(function(){return w})),n.d(r,"MARKUP_TYPE_POLYLINE",(function(){return k})),n.d(r,"MARKUP_TYPE_POLYCLOUD",(function(){return C})),n.d(r,"MARKUP_TYPE_TEXT",(function(){return b})),n.d(r,"MARKUP_TYPE_CALLOUT",(function(){return S})),n.d(r,"MARKUP_TYPE_ARROW_CALLOUT",(function(){return T})),n.d(r,"MARKUP_TYPE_ARROW_CLOUD_CALLOUT",(function(){return M})),n.d(r,"MARKUP_TYPE_DIMENSION",(function(){return U})),n.d(r,"MARKUP_TYPE_LINE",(function(){return Q})),n.d(r,"RECT_SELECTOR",(function(){return x})),n.d(r,"MARKUP_STATUS_SAVE_FAILED",(function(){return F})),n.d(r,"MARKUP_STATUS_SAVE_SUCCEED",(function(){return _})),n.d(r,"MARKUP_STATUS_SAVING",(function(){return H})),n.d(r,"MARKUP_STATUS_DELETING",(function(){return R})),n.d(r,"MARKUP_STATUS_DELETE_SUCCEED",(function(){return L})),n.d(r,"MARKUP_STATUS_DELETE_FAILED",(function(){return D})),n.d(r,"MARKUP_STATUS_CREATED",(function(){return I})),n.d(r,"MARKUP_STATUS_OPEN",(function(){return O})),n.d(r,"MARKUP_STATUS_PRIVATE",(function(){return N})),n.d(r,"MARKUP_STATUS_PUBLISHED",(function(){return P})),n.d(r,"MARKUP_STATUS_PUBLISHING",(function(){return K})),n.d(r,"MARKUP_STATUS_CLOSED",(function(){return V})),n.d(r,"MARKUP_STATUS_ARCHIVED",(function(){return j})),n.d(r,"MARKUP_STATUS_ARCHIVING",(function(){return G})),n.d(r,"MARKUP_ATTACHMENT_LOADING",(function(){return z})),n.d(r,"MARKUP_ATTACHMENT_SAVING",(function(){return Y})),n.d(r,"MARKUP_ATTACHMENT_SAVE_SUCCEED",(function(){return W})),n.d(r,"MARKUP_ATTACHMENT_SAVE_FAILED",(function(){return X})),n.d(r,"MARKUP_ATTACHMENT_RENAMING",(function(){return J})),n.d(r,"MARKUP_ATTACHMENT_DELETEING",(function(){return q})),n.d(r,"ATTACHMENT_DATA_TYPE_BINARY",(function(){return Z})),n.d(r,"ATTACHMENT_DATA_TYPE_TEXT",(function(){return $})),n.d(r,"MARKUP_RESOURCE_TYPE_SVG",(function(){return ee})),n.d(r,"MARKUP_RESOURCE_TYPE_SCREEN_CAPTURE",(function(){return te})),n.d(r,"DEFAULT_STATUSES_TO_LOAD",(function(){return ne})),n.d(r,"MARKUP_SUPPORT_GUID_EXT",(function(){return re})),n.d(r,"LINK_TYPE_ATTACHMENTS",(function(){return ie})),n.d(r,"LINK_TYPE_DOCUMENT_ATTACHMENT",(function(){return ae})),n.d(r,"DEFAULT_MARKUP",(function(){return Ae})),n.d(r,"DEFAULT_COLOR",(function(){return oe})),n.d(r,"DEFAULT_FONT_COLOR",(function(){return se})),n.d(r,"DEFAULT_FILL_COLOR",(function(){return ue})),n.d(r,"DEFAULT_THICKNESS",(function(){return ce})),n.d(r,"DEFAULT_OPACITY",(function(){return le})),n.d(r,"DEFAULT_HIGHLIGHT_OPACITY",(function(){return he})),n.d(r,"DEFAULT_FILL_OPACITY",(function(){return de})),n.d(r,"DEFAULT_STROKE_IN_MM",(function(){return fe})),n.d(r,"DEFAULT_FONT_SIZE_IN_PIXELS",(function(){return pe})),n.d(r,"DEFAULT_FONT_SIZE_IN_MM",(function(){return ge})),n.d(r,"DEFAULT_FONT_WEIGHT",(function(){return ye})),n.d(r,"DEFAULT_FONT_FAMILY",(function(){return ve})),n.d(r,"DEFAULT_FONT_STYLE",(function(){return me})),n.d(r,"SUB_MENU_VISIBLE_CLASS",(function(){return Ee})),n.d(r,"ARROW_TIP_LENGTH",(function(){return we})),n.d(r,"EPSILON",(function(){return ke})),n.d(r,"TOUCH_RADIUS",(function(){return Ce})),n.d(r,"ANCHOR_RADIUS",(function(){return be})),n.d(r,"MIN_CHANGE_DISTANCE",(function(){return Se})),n.d(r,"SNAP_DISTANCE",(function(){return Te})),n.d(r,"MIN_FREEHAND_POINT_DISTANCE",(function(){return Me})),n.d(r,"MIN_ANGLE_CHANGE",(function(){return Ue})),n.d(r,"ROTATION_ANCHOR_DISTANCE",(function(){return Qe})),n.d(r,"ROTATION_SNAP_DEGREES",(function(){return xe})),n.d(r,"PASTE_OFFSET",(function(){return Fe})),n.d(r,"ARROW_MOVE_OFFSET",(function(){return _e})),n.d(r,"CONTEXTUAL_MENU_OFFSET",(function(){return He})),n.d(r,"LINK_POSITION_OFFSET",(function(){return Re})),n.d(r,"LINK_ICON_SIZE",(function(){return Le})),n.d(r,"SELECTION_ZOOM_MARGIN",(function(){return De})),n.d(r,"MAX_THICKNESS",(function(){return Ie})),n.d(r,"PERSPECTIVE_MODE_SCALE",(function(){return Oe})),n.d(r,"FRAME_SIZE_SCALE",(function(){return Ne})),n.d(r,"BOUNDING_BOX_MARGIN",(function(){return Pe})),n.d(r,"HIT_AREA_MARGIN",(function(){return Ke})),n.d(r,"TEXT_DEBOUNCE",(function(){return Ve})),n.d(r,"DIMENSION_TIP_LENGTH",(function(){return je})),n.d(r,"DIMENSION_THICKNESS_FACTOR",(function(){return Ge})),n.d(r,"DIMENSION_FONT_SIZE_FACTOR",(function(){return ze})),n.d(r,"DISABLED_OPACITY",(function(){return Ye})),n.d(r,"MOBILE_GESTURES_MIN_THRESHOLD_TIME",(function(){return We})),n.d(r,"SCREEN_MARGIN",(function(){return Xe})),n.d(r,"TEXT_LENGTH_LIMIT",(function(){return Je})),n.d(r,"MINIMUM_THUMBNAIL_SIZE",(function(){return qe})),n.d(r,"WORLD_3D_SIZE",(function(){return Ze})),n.d(r,"MAX_NORMA_PERCENTAGE",(function(){return $e})),n.d(r,"MAX_NORMA_TEXT_PERCENTAGE",(function(){return et})),n.d(r,"NORMA_3D",(function(){return tt})),n.d(r,"NORMA_TEXT_3D",(function(){return nt})),n.d(r,"POINT_SIZE_IN_MM",(function(){return rt})),n.d(r,"TIMEOUT_TO_SELECT_AFTER_DRAWEND",(function(){return it})),n.d(r,"MARKUP_CREATION_CURSORS",(function(){return at})),n.d(r,"MARKUP_ERRORS",(function(){return At}));var i,a={MARKUP_SESSION_START:"markup.session.start",MARKUP_SESSION_END:"markup.session.end",MARKUP_TOOL_ENABLED_CHANGED:"markup.tool.enabled.changed",MARKUP_REMOVED:"markup.removed",MARKUP_DRAWING_START:"markup.drawing.start",MARKUP_DRAWING_END:"markup.drawing.end",MARKUP_DRAWING_CANCEL:"markup.drawing.cancel",MARKUP_EDIT_START:"markup.edit.start",MARKUP_EDIT_END:"markup.edit.end",MARKUP_SELECTED:"markup.selected",MARKUP_DESELECTED:"markup.deselected",MARKUP_ENABLE_EDIT:"markup.enable.edit",MARKUP_DISABLE_EDIT:"markup.disable.edit",MARKUP_DIRTY:"markup.dirty",MARKUP_VISIBILITY_CHANGED:"markup.visibility.changed",MARKUP_VIEW_ENTERED:"markup.view.entered",MARKUP_VIEW_EXITED:"markup.view.exited",TEXT_EDITING_STARTED:"text.editing.started",TEXT_EDITING_ENDED:"text.editing.ended",LAYER_DIRTY:"layer.dirty",LAYER_SELECTED:"layer.selected",LAYER_DESELECTED:"layer.deselected",LAYER_SELECTED_FROM_DIFFERENT_SHEET:"layer.selected.from.different.sheet",LAYER_EDITED_FROM_DIFFERENT_SHEET:"layer.edited.from.different.sheet",LAYER_DELETE:"layer.delete",LAYER_DELETED:"layer.deleted",LAYER_PUBLISH:"layer.publish",LAYER_ARCHIVE:"layer.archive",LAYER_SYNCING:"layer.syncing",LAYER_SYNCED:"layer.synced",LAYER_READY_TO_SAVE:"layer.ready.to.save",LAYER_CREATED:"layer.created",DOCUMENT_ATTACHMENT_CREATION_START:"document.attachment.creation.start",DOCUMENT_ATTACHMENT_RENAME:"document.attachment.rename",DOCUMENT_ATTACHMENT_DELETE:"document.attachment.delete",LAYER_FETCHED:"layer.fetched",LAYER_RESOURCE_FETCHED:"layer.resource.fetched",LAYER_THUMBNAIL_FETCHED:"layer.thumbnail.fetched",LAYER_METADATA_FETCHED:"layer.metadata.fetched",ATTACHMENT_THUMBNAIL_LOADED:"attachment.thumbnail.loaded",ALL_MARKUPS_LOADED:"all.markups.loaded",PROJECT_USERS_FETCHED:"project.users.fetched",LINK_DIRTY:"link.dirty",LINK_SELECTED:"link.selected",LINK_DESELECTED:"link.deselected",LINK_SYNCED:"link.synced",LINK_SYNCING:"link.syncing",LINK_REMOVED:"link.removed",LINK_RENDERED:"link.rendered",FILTER_CHANGED:"filter.changed",BUTTON_DOWN:"button.down",MARKUP_CREATION_TYPE_CHANGED:"markup.creation.type.changed",MARKUP_STYLE_PROPERTY_CHANGED:"markup.style.property.changed",LAYER_DISCARD_PRESSED:"layer.discard.pressed",LAYER_PUBLISH_PRESSED:"layer.publish.pressed",LAYER_ARCHIVE_PRESSED:"layer.archive.pressed",LAYER_DELETE_PRESSED:"layer.delete.pressed",LAYER_DELETE_EMPTY_PRESSED:"layer.delete.empty.pressed",EXIT_VIEWER_PRESSED:"exit.viewer.pressed",RECT_SELECTOR_UPDATED:"rect.selector.updated",CALIBRATION_REQUIRED:"calibration.required"};function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o={RED:"#FF0000",GREEN:"#00F72C",BLUE:"#103FFB",ORANGE:"#FF9224",YELLOW:"#FEF935",CYAN:"#03FCFE",WHITE:"#FFFFFF",BLACK:"#000000",PINK:"#FF4CFC",PURPLE:"#922890",NO_COLOR:"-1"},s=[{color:o.RED,label:"Red"},{color:o.BLUE,label:"Blue"},{color:o.PURPLE,label:"Purple"},{color:o.YELLOW,label:"Yellow"},{color:o.ORANGE,label:"Orange"},{color:o.CYAN,label:"Cyan"},{color:o.PINK,label:"Pink"},{color:o.GREEN,label:"Green"},{color:o.BLACK,label:"Black"},{color:o.WHITE,label:"White"}],u=[{color:o.RED,label:"Red"},{color:o.BLUE,label:"Blue"},{color:o.PURPLE,label:"Purple"},{color:o.YELLOW,label:"Yellow"},{color:o.ORANGE,label:"Orange"},{color:o.CYAN,label:"Cyan"},{color:o.PINK,label:"Pink"},{color:o.GREEN,label:"Green"},{color:o.NO_COLOR,label:"No Fill"},{color:o.BLACK,label:"Black"},{color:o.WHITE,label:"White"}],c={COLOR:"stroke-color",FILL_COLOR:"fill-color",THICKNESS:"stroke-width",OPACITY:"stroke-opacity",FILL_OPACITY:"fill-opacity",FONT_SIZE:"font-size",FONT_WEIGHT:"font-weight",FONT_FAMILY:"font-family",FONT_STYLE:"font-style",FONT_COLOR:"font-color",STROKE_LINEJOIN:"stroke-linejoin"},l=[10,12,14,16,18,20,24,28,32,36,40,44,48,52,58,64,70,76,82,88,94,100],h=1,d=2,f=1,p=2,g=3,y="arrow",v="rectangle",m="ellipse",E="cloud",B="freehand",w="highlight",k="polyline",C="polycloud",b="label",S="callout",T="simple-arrow-callout",M="arrow-cloud-callout",U="dimension",Q="line",x="selector",F="save_failed",_="save_success",H="markup_saving",R="deleting",L="delete_success",D="delete_failed",I="created",O="open",N="private",P="published",K="publishing",V="closed",j="archived",G="archiving",z="attachment_loading",Y="attachment_saving",W="attachment_save_success",X="attachment_save_failed",J="attachment_renaming",q="attachment_deleting",Z="binary",$="text",ee="svg",te="screencapture",ne=[N,P,j].join(","),re=["dwfx","rvt","dwf"],ie="attachments",ae="document",Ae=B,oe=o.RED,se=o.RED,ue=o.NO_COLOR,ce=10,le=1,he=.5,de=.5,fe=.1,pe=36,ge=10,ye="normal",ve="Artifakt Element, Arial",me="normal",Ee="subMenuVisible",Be="undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0),we=5,ke=1e-4,Ce=Be?34:4,be=4,Se=5,Te=20,Me=1,Ue=.05,Qe=Be?30:20,xe=45,Fe=20,_e=20,He=60,Re=10,Le=20,De=.05,Ie=100,Oe=1e3,Ne=20,Pe=4*window.devicePixelRatio+10,Ke=Ce+10,Ve=200,je=8,Ge=.4,ze=.6,Ye=.3,We=100,Xe=10,Je=3e3,qe=92,Ze=1e3,$e=5e-4,et=20*$e,tt=1,nt=20*tt,rt=.005,it=700,at=(A(i={},x,"cell"),A(i,b,"text"),A(i,S,"text"),i),At={MARKUP_SAVE_FAILED:"MARKUP_SAVE_FAILED",MARKUP_DELETE_FAILED:"MARKUP_DELETE_FAILED",MARKUP_PUBLISH_FAILED:"MARKUP_PUBLISH_FAILED",MARKUP_ARCHIVE_FAILED:"MARKUP_ARCHIVE_FAILED",MARKUP_ATTACHMENT_CREATE_FAILED:"MARKUP_ATTACHMENT_CREATE_FAILED",MARKUP_ATTACHMENT_DELETE_FAILED:"MARKUP_ATTACHMENT_DELETE_FAILED",MARKUP_ATTACHMENT_RENAME_FAILED:"MARKUP_ATTACHMENT_RENAME_FAILED",MARKUP_ATTACHMENT_UPDATE_FAILED:"MARKUP_ATTACHMENT_UPDATE_FAILED"},ot={radiansToDegrees:function(e){return e*(180/Math.PI)},degreesToRadians:function(e){return e*(Math.PI/180)},applyRotation:function(e,t,n,r){e instanceof Array||(e=[e]),e.forEach((function(e){e.sub(n),e.applyAxisAngle(r,t),e.add(n)}))},getSignedAngle:function(e,t,n){var r=e.angleTo(t),i=e.clone().cross(t).normalize();return r*(n.dot(i)>0?1:-1)},swapBoundingBoxY:function(e){var t=[e.min.y,e.max.y];return e.max.y=t[0],e.min.y=t[1],e}},st=ot,ut=n(25),ct={cloneDeep:function(e){return Object(ut.cloneDeep)(e)},findLast:function(e,t){return Object(ut.findLast)(e,t)},debounce:function(e,t,n){return Object(ut.debounce)(e,t,n)},remove:function(e,t){return Object(ut.remove)(e,t)}},lt=ct;function ht(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var dt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.actionManager=t}var t,n,r;return t=e,(n=[{key:"execute",value:function(){this.actionManager.execute(this)}},{key:"undo",value:function(){}},{key:"redo",value:function(){}}])&&ht(t.prototype,n),r&&ht(t,r),e}();function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gt(e,t){return(gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mt(e);if(t){var i=mt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return vt(this,n)}}function vt(e,t){return!t||"object"!==ft(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mt(e){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Et=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gt(e,t)}(a,e);var t,n,r,i=yt(a);function a(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this,e.actionManager)).markupsManager=e,r.markup=t,r.layer=n,r}return t=a,(n=[{key:"undo",value:function(){this.markupsManager.removeMarkupFromLayer(this.markup)}},{key:"redo",value:function(){this.markupsManager.addMarkupToLayer(this.markup,this.layer)}}])&&pt(t.prototype,n),r&&pt(t,r),a}(dt);function Bt(e){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kt(e,t){return(kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=St(e);if(t){var i=St(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return bt(this,n)}}function bt(e,t){return!t||"object"!==Bt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kt(e,t)}(a,e);var t,n,r,i=Ct(a);function a(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this,e.actionManager)).markupsManager=e,r.markup=t,r.layer=r.markup.layer,r.oldState=lt.cloneDeep(r.markup.getState()),r.newState=lt.cloneDeep(n),r}return t=a,(n=[{key:"undo",value:function(){this.markup.setState(this.oldState),this.markup.syncEditState()}},{key:"redo",value:function(){this.markup.setState(this.newState),this.markup.syncEditState()}}])&&wt(t.prototype,n),r&&wt(t,r),a}(dt);function Mt(e){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qt(e,t){return(Qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_t(e);if(t){var i=_t(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ft(this,n)}}function Ft(e,t){return!t||"object"!==Mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _t(e){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ht=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qt(e,t)}(a,e);var t,n,r,i=xt(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e.actionManager)).markupsManager=e,n.markup=t,n.layer=n.markup.layer,n}return t=a,(n=[{key:"undo",value:function(){this.markupsManager.addMarkupToLayer(this.markup,this.layer)}},{key:"redo",value:function(){this.markupsManager.removeMarkupFromLayer(this.markup)}}])&&Ut(t.prototype,n),r&&Ut(t,r),a}(dt),Rt=Autodesk.Viewing,Lt=function(e,t){e&&Object.keys(e).forEach((function(n){var r=e[n];r&&t(r)}))},Dt=function(e,t,n){return!(!e||!t)&&(n=n||ke,e.distanceTo(t)<=n)},It=function(e){var t=[];return Lt(e,(function(e){Array.isArray(e)?e.forEach((function(e){t.push(e)})):t.push(e)})),t},Ot=function(e,t,n){var r,i=new THREE.Vector3,a=new THREE.Vector3;return i.subVectors(t,e),a.subVectors(n,t),r=i.dot(a),i.subVectors(n,t),r=-r/i.dot(i),i.subVectors(n,t),i.multiplyScalar(r),i.add(t)},Nt=function(e,t){e instanceof Array||(e=[e]),e.forEach((function(e){e.x+=t.x,e.y+=t.y,e.z+=t.z}))},Pt=function(){var e=Rt.getGlobal().document,t=e.createElement("div");t.id="text-markup-measure-div",t.style.position="absolute",t.style.visibility="hidden",t.style.pointerEvents="none",t.style.textRendering="geometricPrecision",e.body.appendChild(t);var n={};return function(e,r){var i="".concat(e,"_").concat(r.fontWeight,"_").concat(r.fontSize,"_").concat(r.fontFamily,"_").concat(r.fontStyle,"_").concat(r.width);if(n[i])return n[i];t.innerText=e,t.style.fontWeight=r.fontWeight,t.style.fontSize=r.fontSize,t.style.fontFamily=r.fontFamily,t.style.fontStyle=r.fontStyle,t.style.overflowWrap=r.overflowWrap||"break-word",t.style.wordWrap=r.wordWrap||"break-word",t.style.whiteSpace=r.whiteSpace||"pre-wrap",t.style.width=r.width||(Autodesk.Viewing.isIE11?"auto":"unset"),t.style.lineHeight=r.lineHeight||1;var a=t.getBoundingClientRect(),A=a.width,o=a.height;return n[i]={width:A,height:o},n[i]}}(),Kt=function(e,t,n,r,i,a,A,o){var s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;o||(o=[]),e=e||0,t=t||0,n=n||0,r=r||0,i=i||0;var c=Math.abs(r-i);c>2*Math.PI&&(c-=2*Math.PI),(!a&&r>i||a&&i>r)&&(c=2*Math.PI-c),"number"!=typeof A&&(s=s||n,A=Math.max(6,2*Math.floor(6*Math.pow(s,1/3)*(c/Math.PI))));var l=c/(A=Math.max(A,3)),h=r;l*=a?-1:1;for(var d=0;d<A+1;d++){var f=e+Math.cos(h)*n,p=t+Math.sin(h)*n;o.push({x:f,y:p,z:0}),u&&(u.min.x=Math.min(u.min.x,f),u.min.y=Math.min(u.min.y,p),u.max.x=Math.max(u.max.x,f),u.max.y=Math.max(u.max.y,p)),h+=l}return o},Vt=function(e,t,n,r){var i=new THREE.Vector2(e[n].x+Math.cos(e[n].end)*t,e[n].y+Math.sin(e[n].end)*t),a=new THREE.Vector2(e[r].x+Math.cos(e[r].begin)*t,e[r].y+Math.sin(e[r].begin)*t),A=i.clone().sub(a),o=A.length(),s=i.clone().add(a).divideScalar(2);A.normalize();var u=Math.sqrt(Math.max(0,t*t-o/2*(o/2))),c=new THREE.Vector2(A.y,-A.x);c.multiplyScalar(u);var l=s.clone().add(c),h=Math.atan2(i.y-l.y,i.x-l.x),d=Math.atan2(a.y-l.y,a.x-l.x),f={x:l.x,y:l.y,begin:h,end:d};return e.splice(n+1,0,f),{newCircle:f,beginPoint:i,endPoint:a}},jt=function(e,t,n){for(var r=0;r<n.length;r++){for(var i=null,a=0,A=0;A<e.length;A++)if(e[A]["isCurrentIntersection"+r])for(var o=0;o<e.length;o++){if(e[o]["isNextIntersection"+r])Math.sqrt((e[A].x-e[o].x)*(e[A].x-e[o].x)+(e[A].y-e[o].y)*(e[A].y-e[o].y))<2*t&&(e[A].hide=!0,null===i&&(i=A-1),e[o].hide=!0,a<o+1&&(a=o+1))}n[r].begin=i,n[r].end=a}},Gt=function(e,t,n){return t.splice(function(e,t,n){if(0===t.length)return-1;for(var r=0,i=t.length,a=Math.floor(i/2);i-r>1;){var A=n(t[a],e);if(0===A)return a;A>0?i=a:r=a,a=Math.floor(r+(i-r)/2)}return n(t[a],e)>0?a-1:a}(e,t,n)+1,0,e),t},zt=function(e,t,n,r){var i={x:null,y:null,onLine1:!1,onLine2:!1,onBothLines:!1},a=(r.y-n.y)*(t.x-e.x)-(r.x-n.x)*(t.y-e.y);if(0===a)return i;var A=e.y-n.y,o=e.x-n.x,s=(r.x-n.x)*A-(r.y-n.y)*o,u=(t.x-e.x)*A-(t.y-e.y)*o;return A=s/a,o=u/a,i.x=e.x+A*(t.x-e.x),i.y=e.y+A*(t.y-e.y),A>0&&A<1&&(i.onLine1=!0),o>0&&o<1&&(i.onLine2=!0),i.onBothLines=i.onLine1&&i.onLine2,i},Yt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.width,i=t.height,a=t.ctx,A=t.target,o=t.screenshotCamera,s=t.onRenderDone,u=n.markupLayer,c=e.getExtension("Autodesk.BIM360.Markups");if(c){var l=e.impl.getCanvasBoundingClientRect(),h=l.width,d=l.height,f=e.impl.glrenderer();f.pushViewport(),f.setPixelRatio(1),f.setViewport(0,0,r,i),c.renderer.onResize({width:r,height:i});var p,g,y=e.impl.is2d?o:c.renderer.markupsCamera,v=c.markupsManager.getVisibleLayers();u&&v.forEach((function(e){return e!==u&&e.setVisible(!1)}));var m=function(){u&&(p=u.isVisible(),g=u.isTransparent(),u.setVisible(!0),u.changeTransparency(!1))},E=function(){u&&(u.setVisible(p),u.changeTransparency(!g))};m(),c.renderer.render(A,y),E(),f.popViewport(),f.setPixelRatio(),c.renderer.onResize({width:h,height:d});var B=a.targetToCanvas(A),w=B.canvas,k=r/h;c.renderer.textRenderer.renderTextToCanvas(w,y,k,m,E,s),u&&v.forEach((function(e){return e!==u&&e.setVisible(!0)}))}else s(a.targetToCanvas(A).canvas)},Wt=function(e,t,n){if(e.length<=2)return e;function r(e,t,n){var r=t.x,i=t.y,a=n.x-r,A=n.y-i;if(0!==a||0!==A){var o=((e.x-r)*a+(e.y-i)*A)/(a*a+A*A);o>1?(r=n.x,i=n.y):o>0&&(r+=a*o,i+=A*o)}return(a=e.x-r)*a+(A=e.y-i)*A}var i=void 0!==t?t*t:1;return e=function(e,t){var n=e.length-1,i=[e[0]];return function e(t,n,i,a,A){for(var o,s=a,u=n+1;u<i;u++){var c=r(t[u],t[n],t[i]);c>s&&(o=u,s=c)}s>a&&(o-n>1&&e(t,n,o,a,A),A.push(t[o]),i-o>1&&e(t,o,i,a,A))}(e,0,n,t,i),i.push(e[n]),i}(e=n?e:function(e,t){for(var n,r,i,a,A,o=e[0],s=[o],u=1,c=e.length;u<c;u++)n=e[u],i=o,a=void 0,A=void 0,a=(r=n).x-i.x,A=r.y-i.y,a*a+A*A>t&&(s.push(n),o=n);return o!==n&&s.push(n),s}(e,i),i)};function Xt(e){var t=e.length;if(3===t)return!0;for(var n=0;n<t;n++)for(var r=e[n],i=e[(n+1)%t],a=n+2;a<t;a++){var A=e[a%t],o=e[(a+1)%t];if(o===r)break;if(zt(r,i,A,o).onBothLines)return!1}return!0}var Jt=function(e,t){e.navigation.getRequestTransition()||e.navigation.getTransitionActive()?setTimeout((function(){e.navigation.getRequestTransition()||e.navigation.getTransitionActive()?e.addEventListener(Autodesk.Viewing.CAMERA_TRANSITION_COMPLETED,(function(){t()}),{once:!0}):t()}),1):t()};function qt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $t=Autodesk.Viewing,en=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};qt(this,e),this.setGlobalManager(t.globalManager),this.markupsExtension=t,this.viewer=t.viewer,this.markup=n,this.options=r}var t,n,r;return t=e,(n=[{key:"getEditState",value:function(){return this.markup.getEditState()}},{key:"setEditState",value:function(e,t){this.markup.setEditState(e,t,this)}},{key:"getAnchors",value:function(){return this.getEditState().anchors}},{key:"updateEditState",value:function(e){this.setEditState(this.getEditState(),e)}},{key:"updateEditStateAnchors",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getEditState().anchors;this.updateEditState({anchors:e})}},{key:"handleCompensation",value:function(){if(this.markup.layer){var e=this.markup.getAnchors();this.prevCenter||(this.prevCenter=this.markup.center.clone());var t=this.markup.center.clone().sub(this.prevCenter);e.forEach((function(e){e.sub(t)})),t.applyMatrix4(this.markup.scaleMatrix);var n=this.markup.getRotation();if(0!==n){var r=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(t,n,new THREE.Vector3,r)}t.add(this.markup.editState.translation),this.updateEditState({anchors:e,translation:t}),this.prevCenter.copy(this.markup.center)}}},{key:"submitChanges",value:function(e){var t;if(this.markup.layer){if(this.markup.belongsToGroup())return void this.submitGroupUpdate(e);t=new Tt(this.markupsExtension.markupsManager,this.markup,this.getEditState())}else{var n=this.markupsExtension.markupsManager.getActiveLayer();this.markup.syncState(),t=new Et(this.markupsExtension.markupsManager,this.markup,n)}t.isDuringEdit=e,t.execute()}},{key:"submitGroupUpdate",value:function(e){var t=this,n=this.markup.markupGroup.markups,r=this.markupsExtension.markupsManager.isActionGroupOpen();r||this.markupsExtension.markupsManager.openActionGroup(),n.forEach((function(r,i){var a=new Tt(t.markupsExtension.markupsManager,r,r.getEditState());a.isDuringEdit=i<n.length-1||e,a.execute()})),r||this.markupsExtension.markupsManager.closeActionGroup()}},{key:"deleteMarkup",value:function(){new Ht(this.markupsExtension.markupsManager,this.markup).execute()}},{key:"changeStyleProperty",value:function(e,t,n){var r=lt.cloneDeep(this.getEditState());r.style[e]=t,this.updateEditState({style:Object.assign({},r.style)}),n||(this.submitChanges(!0),this.editEnd(!0))}},{key:"snapPointToAxis",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!Dt(e,t)){var i=this.markupsExtension.renderer.worldToClient(e),a=this.markupsExtension.renderer.worldToClient(t),A=i.clone().sub(a).normalize(),o=st.getSignedAngle(this.markupsExtension.renderer.absoluteUpVec,A,this.markupsExtension.renderer.getCameraEyeVector()),s=o+st.degreesToRadians(r),u=st.degreesToRadians(n),c=Math.ceil((s-st.degreesToRadians(n/2))/u)*u,l=new THREE.Vector3(0,0,-1),h=i.clone();st.applyRotation(h,c-s,a,l);var d=h.clone().sub(a).normalize(),f=i.clone().sub(a).dot(d),p=a.add(d.multiplyScalar(f));e.copy(this.markupsExtension.renderer.clientToWorld(p))}}},{key:"getSnappedPosition",value:function(){return this.markupsExtension.markupsTool.isSnappingAllowed()?this.markupsExtension.markupsTool.getSnappedPosition():this.markupsExtension.markupsTool.lastMousePos}},{key:"didMouseMove",value:function(){return this.markupsExtension.markupsTool.mouseMoved}},{key:"getTouchRadiusWorld",value:function(){return this.markupsExtension.renderer.sizeFromClientToWorld(Ce)}},{key:"getMinChangeDistanceWorld",value:function(){return this.markupsExtension.renderer.sizeFromClientToWorld(Se)}},{key:"snapDistance",value:function(){return this.markupsExtension.renderer.sizeFromClientToWorld(Te)}},{key:"intersect",value:function(e){return null}},{key:"getCursor",value:function(){return"crosshair"}},{key:"isDragging",value:function(){return!1}},{key:"editStart",value:function(){this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_EDIT_START,markup:this.markup,handler:this})}},{key:"editEnd",value:function(e){this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_EDIT_END,markup:this.markup,isDuringEdit:e,handler:this})}},{key:"isSamePoint",value:function(e,t){return Dt(e,t,this.getMinChangeDistanceWorld())}},{key:"isSamePointClient",value:function(e,t){return Dt(e,t,Se)}},{key:"handleDoubleClick",value:function(e,t){}},{key:"handleButtonDown",value:function(e,t){}},{key:"handleButtonUp",value:function(e,t){}},{key:"handleKeyDown",value:function(e,t){}},{key:"handleKeyUp",value:function(e,t){}},{key:"handleMouseMove",value:function(e){}},{key:"handleGesture",value:function(e){}},{key:"handleResize",value:function(){}},{key:"destroy",value:function(){this.markupsExtension=null,this.viewer=null,this.markup=null}}])&&Zt(t.prototype,n),r&&Zt(t,r),e}();function tn(e){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function an(e,t){return(an=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function An(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=un(e);if(t){var i=un(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return on(this,n)}}function on(e,t){return!t||"object"!==tn(t)&&"function"!=typeof t?sn(e):t}function sn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function un(e){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}$t.GlobalManagerMixin.call(en.prototype);var cn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&an(e,t)}(A,e);var t,n,r,i=An(A);function A(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return nn(this,A),(t=i.call(this,e,null,n)).bounds=new THREE.Box3,t.markupsExtension.markupsManager.addEventListener(a.MARKUP_SESSION_END,t.clean.bind(sn(t))),t}return t=A,(n=[{key:"handleMouseMove",value:function(e){var t=this;return!!(this.buttonDownPoint&&this.markupsExtension.markupsTool.dragging&&this.didMouseMove())&&(this.bounds.makeEmpty(),this.bounds.expandByVector(new THREE.Vector3(0,0,1/0)),this.bounds.expandByPoint(e),this.bounds.expandByPoint(this.buttonDownPoint),this.markupsExtension.markupsManager.getEnabledMarkups().filter((function(e){return!e.isSelected()})).forEach((function(e){var n=e.getWorldBoundingBox(!0);t.bounds.isIntersectionBox(n)&&e.setHover(!0)})),this.markupsExtension.markupsManager.dispatchEvent({type:a.RECT_SELECTOR_UPDATED,bounds:this.bounds}),!0)}},{key:"clean",value:function(){this.buttonDownPoint=null,this.bounds.makeEmpty(),this.markupsExtension.markupsManager.dispatchEvent({type:a.RECT_SELECTOR_UPDATED,bounds:this.bounds})}},{key:"handleButtonDown",value:function(e,t){return this.clean(),this.buttonDownPoint=e,!0}},{key:"handleButtonUp",value:function(e,t){return this.selectMarkups(),this.clean(),!1}},{key:"selectMarkups",value:function(){var e=this;this.markupsExtension.markupsTool.shiftDown||this.markupsExtension.markupsManager.deselectAllMarkups(),this.markupsExtension.markupsManager.getEnabledMarkups().filter((function(e){return!e.isSelected()})).forEach((function(t){var n=t.getWorldBoundingBox(!0);e.bounds.isIntersectionBox(n)&&t.select()}))}}])&&rn(t.prototype,n),r&&rn(t,r),A}(en);function ln(e){return(ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yn(e);if(t){var i=yn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gn(this,n)}}function gn(e,t){return!t||"object"!==ln(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yn(e){return(yn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(a,e);var t,n,r,i=pn(a);function a(){return hn(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"getCursor",value:function(){return"pointer"}},{key:"intersect",value:function(e){return this.markup.intersect(e)}},{key:"handleMouseMove",value:function(e){if(this.markupsExtension.markupsTool.dragging||Autodesk.Viewing.isMobileDevice())return!1;var t=this.markup.intersect(e);return t&&(this.markup.layer===this.markupsExtension.markupsManager.getActiveLayer()?this.markup.setHover(!0):this.markup.layer.setHover(!0)),t}},{key:"handleDoubleClick",value:function(e,t){return!this.didMouseMove()&&!!this.markup.intersect(e)&&(this.markupsExtension.markupsManager.isMarkupSessionOpen()||this.markup.layer===this.markupsExtension.markupsManager.getActiveLayer()||this.markupsExtension.markupsManager.editLayer(this.markup.layer,!1,!1,!1),this.markupsExtension.markupsTool.shiftDown||this.markupsExtension.markupsTool.ctrlDown||this.markupsExtension.markupsManager.deselectAllMarkups([this.markup]),this.markup.select(),!0)}},{key:"handleButtonDown",value:function(e,t){return!1}},{key:"handleButtonUp",value:function(e,t){return!this.didMouseMove()&&!!this.markup.intersect(e)&&(this.markupsExtension.markupsManager.deselectAllLayers([this.markup.layer]),this.markupsExtension.markupsManager.selectLayer(this.markup.layer,!1,!1),this.markupsExtension.markupsManager.isMarkupSessionOpen()&&(this.markupsExtension.markupsTool.shiftDown||this.markupsExtension.markupsTool.ctrlDown||this.markupsExtension.markupsManager.deselectAllMarkups([this.markup]),this.markup.select()),!0)}}])&&dn(t.prototype,n),r&&dn(t,r),a}(en);function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function En(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wn(e,t){return(wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bn(e);if(t){var i=bn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Cn(this,n)}}function Cn(e,t){return!t||"object"!==mn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bn(e){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wn(e,t)}(a,e);var t,n,r,i=kn(a);function a(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return En(this,a),(n=i.call(this,e,t,r)).keyTranslation=new THREE.Vector3,n}return t=a,r=[{key:"hasOneGroupInEdit",value:function(e){var t=0,n=0;return e.forEach((function(e){e.isGroupMarkup()?t++:e.belongsToGroup()||n++})),1===t&&0===n}}],(n=[{key:"handleMouseMove",value:function(e){return this.translating&&this.handleMouseTranslation(e),this.translating}},{key:"handleButtonDown",value:function(e,t){return!!this.translating||(this.translating=this.intersect(e),this.translating&&(this.lastTranslationPoint=e,this.buttonDownPos=e,this.editStart()),this.translating)}},{key:"handleButtonUp",value:function(e,t){if(this.translating){var n,r=this.markupsExtension.markupsManager.getInEditMarkups();return this.markupsExtension.markupsManager.openActionGroup(),Dt(e,this.lastTranslationPoint,this.getMinChangeDistanceWorld())?(this.cancelTransformEditing(),n=!1):(r.forEach((function(e,t){e.translationHandler&&e.translationHandler.submitChanges(t<r.length-1)})),this.editEnd(),n=!0),this.markupsExtension.markupsManager.closeActionGroup(),this.translating=!1,this.lastTranslationPoint=null,n}return!1}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:if(this.translating)return this.cancelTransformEditing(),!0;break;case Autodesk.Viewing.KeyCode.UP:return this.handleKeyTranslation(this.markupsExtension.renderer.getCameraUpVector()),!0;case Autodesk.Viewing.KeyCode.DOWN:return this.handleKeyTranslation(this.markupsExtension.renderer.getCameraUpVector().negate()),!0;case Autodesk.Viewing.KeyCode.RIGHT:return this.handleKeyTranslation(this.markupsExtension.renderer.getCameraRightVector()),!0;case Autodesk.Viewing.KeyCode.LEFT:return this.handleKeyTranslation(this.markupsExtension.renderer.getCameraRightVector().negate()),!0}return!1}},{key:"handleKeyUp",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.UP:case Autodesk.Viewing.KeyCode.DOWN:case Autodesk.Viewing.KeyCode.RIGHT:case Autodesk.Viewing.KeyCode.LEFT:return this.keyTranslation.set(0,0,0),this.submitChanges(e.isDuringEdit),!0}return!1}},{key:"handleDoubleClick",value:function(e,t){return this.translating}},{key:"getCursor",value:function(){return"move"}},{key:"cancelTransformEditing",value:function(){this.markupsExtension.markupsManager.getInEditMarkups().forEach((function(e){e.syncEditState()})),this.translating=!1,this.lastTranslationPoint=null,this.editEnd()}},{key:"handleMouseTranslation",value:function(e){var t=this;this.markupsExtension.markupsTool.shiftDown&&(e=e.clone(),this.snapPointToAxis(e,this.buttonDownPos,90));var n=e.clone().sub(this.lastTranslationPoint),r=this.markupsExtension.markupsManager.getInEditMarkups();a.hasOneGroupInEdit(r)?this.handleTranslation(this.markup,n):r.forEach((function(e){t.handleTranslation(e,n)}))}},{key:"handleKeyTranslation",value:function(e){var t=e.multiplyScalar(this.markupsExtension.renderer.multiplyByNormaStrokeWidth(_e));this.keyTranslation.add(t),this.handleTranslation(this.markup,this.keyTranslation)}},{key:"handleTranslation",value:function(e,t){if(e.translationHandler){var n=t.clone().add(e.state.translation);e.translationHandler.updateEditState({translation:n})}}},{key:"intersect",value:function(e){return this.markup.intersect(e)}},{key:"isDragging",value:function(){return this.translating}}])&&Bn(t.prototype,n),r&&Bn(t,r),a}(en);function Tn(e){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qn(e,t){return(Qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_n(e);if(t){var i=_n(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fn(this,n)}}function Fn(e,t){return!t||"object"!==Tn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _n(e){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qn(e,t)}(a,e);var t,n,r,i=xn(a);function a(){return Mn(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"handleMouseMove",value:function(e){return!!this.activeAnchor&&(e=this.getSnappedPosition(),this.markup.applyInverseRotation(e),this.markup.applyInverseScaleAndTranslation(e),this.markupsExtension.markupsTool.shiftDown&&this.snapAxis(e),this.updateActiveAnchor(e),!0)}},{key:"handleButtonDown",value:function(e,t){return!!this.activeAnchor||(this.activeAnchor=this.intersect(e),this.activeAnchor&&(this.originalAnchor=this.activeAnchor.clone(),this.editStart()),!!this.activeAnchor)}},{key:"handleButtonUp",value:function(e,t){return!!this.activeAnchor&&(e=this.getSnappedPosition(),this.markup.applyInverseRotation(e),this.markup.applyInverseScaleAndTranslation(e),this.markupsExtension.markupsTool.shiftDown&&this.snapAxis(e),this.updateActiveAnchor(e),Dt(this.activeAnchor,this.originalAnchor,this.getMinChangeDistanceWorld())?this.cancelAnchorEditing():(this.submitChanges(),this.editEnd()),this.activeAnchor=null,!0)}},{key:"handleKeyDown",value:function(e,t){if(this.activeAnchor)switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:return this.cancelAnchorEditing(),!0}return!1}},{key:"handleKeyUp",value:function(e,t){}},{key:"handleDoubleClick",value:function(e,t){}},{key:"updateActiveAnchor",value:function(e){this.markup.getAnchors(),this.activeAnchor.copy(e),this.updateEditStateAnchors(),this.handleCompensation()}},{key:"cancelAnchorEditing",value:function(){this.activeAnchor=null,this.markup.syncEditState(),this.updateEditStateAnchors(),this.editEnd()}},{key:"isDragging",value:function(){return!!this.activeAnchor}},{key:"snapAxis",value:function(e){var t=this,n=this.markup.getAnchors(),r=n.findIndex((function(e){return e===t.activeAnchor}));n[r-1]?this.snapPointToAxis(e,n[r-1],xe):n[r+1]&&this.snapPointToAxis(e,n[r+1],xe)}},{key:"intersect",value:function(e){var t=this;e=e.clone(),this.markup.applyInverseRotation(e),this.markup.applyInverseScaleAndTranslation(e);var n=this.markupsExtension.renderer.worldToClient(e);return this.markup.getAnchors().find((function(e){if(t.markup.isAnchorHandlingAllowed(e))return t.markupsExtension.renderer.worldToClient(e).distanceTo(n)<=Ce}))}},{key:"getCursor",value:function(){return this.activeAnchor?"grabbing":"grab"}}])&&Un(t.prototype,n),r&&Un(t,r),a}(en);function Rn(e){return(Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ln(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function In(e,t){return(In=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function On(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pn(e);if(t){var i=Pn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Nn(this,n)}}function Nn(e,t){return!t||"object"!==Rn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pn(e){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&In(e,t)}(a,e);var t,n,r,i=On(a);function a(){return Ln(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"handleMouseMove",value:function(e){return this.rotating&&this.handleRotation(e),this.rotating}},{key:"handleButtonDown",value:function(e,t){return this.rotating||(this.rotating=this.intersect(e),this.rotating&&(this.originalRotation=this.markup.getRotation(),this.handleRotation(e),this.editStart())),this.rotating}},{key:"handleButtonUp",value:function(e,t){return!!this.rotating&&(this.rotating=!1,Math.abs(this.originalRotation-this.markup.getRotation())<Ue?this.cancelTransformEditing():(this.submitChanges(),this.editEnd()),this.originalRotation=null,!0)}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:if(this.rotating)return this.cancelTransformEditing(),!0}return!1}},{key:"handleKeyUp",value:function(e,t){return!1}},{key:"handleDoubleClick",value:function(e,t){return this.rotating}},{key:"getCursor",value:function(){return"url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjAgMCAyMCAyMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT5tb3VzZSBjdXJzb3Ivcm90YXRlPC90aXRsZT4gICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+ICAgIDxkZWZzPiAgICAgICAgPHBhdGggZD0iTTMsOCBMMSw4IEw0LDQgTDcsOCBMNSw4IEM1LDEwLjQ4NTI4MTQgNy41MTQ3MTg2MywxMyAxMCwxMyBDMTIuNDg1MjgxNCwxMyAxNSwxMC40ODUyODE0IDE1LDggTDEzLDggTDE2LDQgTDE5LDggTDE3LDggQzE3LDExLjU4OTg1MDkgMTMuNTg5ODUwOSwxNSAxMCwxNSBDNi40MTAxNDkxMywxNSAzLDExLjU4OTg1MDkgMyw4IFoiIGlkPSJwYXRoLTEiPjwvcGF0aD4gICAgICAgIDxmaWx0ZXIgeD0iLTMzLjMlIiB5PSItNjkuNyUiIHdpZHRoPSIxNjYuNyUiIGhlaWdodD0iMTk3LjAlIiBmaWx0ZXJVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIGlkPSJmaWx0ZXItMiI+ICAgICAgICAgICAgPGZlTW9ycGhvbG9neSByYWRpdXM9IjEiIG9wZXJhdG9yPSJkaWxhdGUiIGluPSJTb3VyY2VBbHBoYSIgcmVzdWx0PSJzaGFkb3dTcHJlYWRPdXRlcjEiPjwvZmVNb3JwaG9sb2d5PiAgICAgICAgICAgIDxmZU9mZnNldCBkeD0iMCIgZHk9Ii0yIiBpbj0ic2hhZG93U3ByZWFkT3V0ZXIxIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMSI+PC9mZU9mZnNldD4gICAgICAgICAgICA8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIxIiBpbj0ic2hhZG93T2Zmc2V0T3V0ZXIxIiByZXN1bHQ9InNoYWRvd0JsdXJPdXRlcjEiPjwvZmVHYXVzc2lhbkJsdXI+ICAgICAgICAgICAgPGZlQ29tcG9zaXRlIGluPSJzaGFkb3dCbHVyT3V0ZXIxIiBpbjI9IlNvdXJjZUFscGhhIiBvcGVyYXRvcj0ib3V0IiByZXN1bHQ9InNoYWRvd0JsdXJPdXRlcjEiPjwvZmVDb21wb3NpdGU+ICAgICAgICAgICAgPGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAgICAwIDAgMCAwIDAgICAwIDAgMCAwIDAgIDAgMCAwIDAuNSAwIiB0eXBlPSJtYXRyaXgiIGluPSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlQ29sb3JNYXRyaXg+ICAgICAgICA8L2ZpbHRlcj4gICAgPC9kZWZzPiAgICA8ZyBpZD0ibW91c2UtY3Vyc29yL3JvdGF0ZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+ICAgICAgICA8ZyBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuMDAwMDAwLCA5LjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTEwLjAwMDAwMCwgLTkuNTAwMDAwKSAiPiAgICAgICAgICAgIDx1c2UgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMSIgZmlsdGVyPSJ1cmwoI2ZpbHRlci0yKSIgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+ICAgICAgICAgICAgPHBhdGggc3Ryb2tlPSIjRkZGRkZGIiBzdHJva2Utd2lkdGg9IjEiIGQ9Ik0yLjUyMDExNDgzLDguNSBMMy40MjUyNjAwOGUtMTIsOC41IEw0LDMuMTY2NjY2NjcgTDgsOC41IEw1LjUzODA0MjA3LDguNSBDNS44NDQ5MzkyOCwxMC41NDE1MjMyIDcuOTU3NDAyMDYsMTIuNSAxMCwxMi41IEMxMi4wNDI1OTc5LDEyLjUgMTQuMTU1MDYwNywxMC41NDE1MjMyIDE0LjQ2MTk1NzksOC41IEwxMiw4LjUgTDE2LDMuMTY2NjY2NjcgTDIwLDguNSBMMTcuNDc5ODg1Miw4LjUgQzE3LjE4NTI0NywxMi4xNzM1MTU3IDEzLjY5ODgwMSwxNS41IDEwLDE1LjUgQzYuMzAxMTk5MDIsMTUuNSAyLjgxNDc1MzAzLDEyLjE3MzUxNTcgMi41MjAxMTQ4Myw4LjUgWiIgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJldmVub2RkIj48L3BhdGg+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=) 10 10, auto"}},{key:"cancelTransformEditing",value:function(){this.markup.syncEditState(),this.rotating=!1,this.editEnd()}},{key:"handleRotation",value:function(e){var t=this.markupsExtension.renderer.worldToClient(e),n=this.markup.getClientCenter(),r=t.clone().sub(n).normalize(),i=st.getSignedAngle(r,this.markupsExtension.renderer.getCameraUpVector(),this.markupsExtension.renderer.getCameraEyeVector());if(this.markupsExtension.markupsTool.shiftDown){var a=st.degreesToRadians(xe);i=Math.ceil((i-st.degreesToRadians(xe/2))/a)*a}this.updateEditState({rotation:i})}},{key:"getRotationAnchor",value:function(){var e=this.markup.getClientBoundingBox(!0),t=e.center().add(new THREE.Vector3(0,Qe+e.size().y/2,0)),n=e.center(),r=this.markup.getRotation()+this.markupsExtension.renderer.getCameraRotation();return st.applyRotation(t,r,n,this.markupsExtension.renderer.absoluteEyeVec),t}},{key:"intersect",value:function(e){e=e.clone();var t=this.markupsExtension.renderer.worldToClient(e);return this.getRotationAnchor().distanceTo(t)<=Ce}},{key:"isDragging",value:function(){return this.rotating}}])&&Dn(t.prototype,n),r&&Dn(t,r),a}(en);function Vn(e){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zn(e,t){return(zn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xn(e);if(t){var i=Xn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Wn(this,n)}}function Wn(e,t){return!t||"object"!==Vn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xn(e){return(Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zn(e,t)}(a,e);var t,n,r,i=Yn(a);function a(){return jn(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"handleMouseMove",value:function(e){if(this.scaling){var t=e.clone();this.markup.applyInverseRotation(t),this.markup.applyInverseCameraRotation(t),this.handleScaling(t)}return this.scaling}},{key:"handleButtonDown",value:function(e,t){return this.scaling||(this.scaleAnchor=this.intersect(e),this.scaling=!!this.scaleAnchor,this.scaling&&(this.originalPoint=e.clone(),this.editStart())),this.scaling}},{key:"handleButtonUp",value:function(e,t){return!!this.scaling&&(this.scaleAnchor=null,this.scaling=!1,this.isSamePoint(e,this.originalPoint)?this.cancelTransformEditing():(this.submitChanges(),this.editEnd()),!0)}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:if(this.scaling)return this.cancelTransformEditing(),!0}return!1}},{key:"handleDoubleClick",value:function(e,t){return this.scaling}},{key:"getCursor",value:function(){if(this.cursor&&this.scaling)return this.cursor;var e=this.markup.getClientCenter(),t=this.lastIntersectPoint.clone().sub(e).normalize(),n=new THREE.Vector3(1,0,0),r=this.lastIntersectPoint.y<e.y?1:-1,i=st.radiansToDegrees(t.angleTo(n))*r,a=45*Math.ceil((i-22.5)/45);switch(this.cursor=null,a){case 180:case-180:case 0:this.cursor="ew-resize";break;case 90:case-90:this.cursor="ns-resize";break;case 135:case-45:this.cursor="nwse-resize";break;case-135:case 45:this.cursor="nesw-resize"}return this.cursor}},{key:"cancelTransformEditing",value:function(){this.markup.syncEditState(),this.scaleAnchor=null,this.scaling=!1,this.editEnd()}},{key:"handleScaling",value:function(e){var t=this,n=this.markupsExtension.renderer.worldToClient(e);this.originalBoundingBox=st.swapBoundingBoxY(this.markup.getWorldBoundingBox().clone()),this.scaleAnchor.axisList.forEach((function(e){var r=t.getAnchorPosByAxisList([e],!1),i=n.clone().sub(e.clone().multiplyScalar(t.markup.getMarginSize()));t.resize(i,r,e)})),this.updateTranslation()}},{key:"updateTranslation",value:function(){var e=this.scaleAnchor.axisList.reduce((function(e,t){return e.clone().add(t)})),t=st.swapBoundingBoxY(this.markup.getWorldBoundingBox().clone()).size().sub(this.originalBoundingBox.size()).multiply(e).multiplyScalar(.5),n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(t,this.markup.getRotation(),new THREE.Vector3,n);var r=t.add(this.markup.editState.translation);this.updateEditState({translation:r}),this.originalBoundingBox=st.swapBoundingBoxY(this.markup.getWorldBoundingBox().clone())}},{key:"resize",value:function(e,t,n,r){var i=t.clone().add(n),a=Ot(e,t,i),A=this.markup.getClientBoundingBox(!1),o=this.getOppositePoint(t,A),s=a.clone().sub(o),u=n.clone().multiply(s),c=A.size().multiply(n).length(),l=s.length();if(r||!(l<this.markup.getMinimumSize())){if(!r&&u.x+u.y<0){var h=o.clone().add(n);return this.resize(h,t,n,!0),this.updateTranslation(),n.negate(),this.applyReflection(n),void this.resize(e,h,n,!0)}var d=l/c-1,f=(this.markupsExtension.markupsTool.shiftDown?new THREE.Vector3(1,1,0):new THREE.Vector3(Math.abs(n.x),Math.abs(n.y),Math.abs(n.z))).clone().multiplyScalar(d).addScalar(1).clone().multiply(this.markup.editState.scale);this.updateEditState({scale:f})}}},{key:"intersect",value:function(e){var t=this.getScaleAnchors(),n=e.clone();this.markup.applyInverseRotation(n),this.markup.applyInverseCameraRotation(n);var r=this.markupsExtension.renderer.worldToClient(n);return this.lastIntersectPoint=r,t.find((function(e){return e.pos.distanceTo(r)<=Ce}))}},{key:"isDragging",value:function(){return this.scaling}},{key:"getOppositePoint",value:function(e,t){var n=t.center(),r=e.clone().distanceTo(n),i=e.clone().sub(n).normalize();return e.clone().sub(i.multiplyScalar(2*r))}},{key:"applyReflection",value:function(e){var t=new THREE.Vector3(1,1,1).sub(e.clone().multiply(e).multiplyScalar(2)),n=this.markup.editState.scale.clone();n.multiply(t),this.updateEditState({scale:n})}},{key:"getScaleAnchors",value:function(){return this.getEditState().anchors.length<2?[]:this.options.onlyHorizontal?[this.getEastAnchor(),this.getWestAnchor()]:[this.getEastAnchor(),this.getWestAnchor(),this.getNorthAnchor(),this.getSouthAnchor(),this.getNorthWestAnchor(),this.getSouthWestAnchor(),this.getNorthEastAnchor(),this.getSouthEastAnchor()]}},{key:"getAnchorPosByAxisList",value:function(e,t){var n=this.markup.getClientBoundingBox(t),r=n.center();return e.forEach((function(e){var t=e.clone().multiply(n.size().multiplyScalar(.5));r.add(t)})),r}},{key:"getAnchor",value:function(e,t){return{pos:this.getAnchorPosByAxisList(e,!this.markup.belongsToGroup()),axisList:e,id:t}}},{key:"getNorthAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,1,0)],"n")}},{key:"getSouthAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,-1,0)],"s")}},{key:"getEastAnchor",value:function(){return this.getAnchor([new THREE.Vector3(1,0,0)],"e")}},{key:"getWestAnchor",value:function(){return this.getAnchor([new THREE.Vector3(-1,0,0)],"w")}},{key:"getNorthWestAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,1,0),new THREE.Vector3(-1,0,0)],"nw")}},{key:"getSouthWestAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,-1,0),new THREE.Vector3(-1,0,0)],"sw")}},{key:"getNorthEastAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,1,0),new THREE.Vector3(1,0,0)],"ne")}},{key:"getSouthEastAnchor",value:function(){return this.getAnchor([new THREE.Vector3(0,-1,0),new THREE.Vector3(1,0,0)],"se")}}])&&Gn(t.prototype,n),r&&Gn(t,r),a}(en);function qn(e){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $n(e,t){return($n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function er(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nr(e);if(t){var i=nr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return tr(this,n)}}function tr(e,t){return!t||"object"!==qn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$n(e,t)}(a,Autodesk.Viewing.EventDispatcher);var t,n,r,i=er(a);function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this)).undoStack=[],e.redoStack=[],e.isGroupOpen=!1,e.nextActionId=0,e}return t=a,(n=[{key:"execute",value:function(e){this.clearStack(this.redoStack),e.id=this.nextActionId,this.nextActionId+=1,e.redo(),this.isGroupOpen?this.group.push(e):this.undoStack.push(e),e.trigger=a.EXECUTE,this.notify(e)}},{key:"undo",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(0!==this.undoStack.length)if(this.isGroupOpen)console.warn("Cannot undo while action group is open!");else{var t=this.undoStack.pop();if(e&&this.redoStack.push(t),t instanceof dt)t.undo();else for(var n=t.length-1;n>=0;n--)t[n].undo();t.trigger=a.UNDO,this.notify(t)}}},{key:"redo",value:function(){if(0!==this.redoStack.length)if(this.isGroupOpen)console.warn("Cannot redo while action group is open!");else{var e=this.redoStack.pop();if(this.undoStack.push(e),e instanceof dt)e.redo();else for(var t=0;t<e.length;t++)e[t].redo();e.trigger=a.REDO,this.notify(e)}}},{key:"clear",value:function(){this.clearStack(this.undoStack),this.clearStack(this.redoStack),this.isGroupOpen=!1,this.group=[],this.notify([])}},{key:"clearStack",value:function(e){e.splice(0,e.length)}},{key:"isUndoStackEmpty",value:function(){return 0===this.undoStack.length}},{key:"isRedoStackEmpty",value:function(){return 0===this.redoStack.length}},{key:"notify",value:function(e){e=e instanceof dt?[e]:e,this.dispatchEvent({type:a.HISTORY_CHANGED_EVENT,actionGroup:e,hasUndo:!this.isUndoStackEmpty(),hasRedo:!this.isRedoStackEmpty()})}},{key:"openActionGroup",value:function(){this.isGroupOpen?console.warn("Cannot open a new action group while another one is still open"):(this.group=[],this.undoStack.push(this.group),this.isGroupOpen=!0)}},{key:"closeActionGroup",value:function(){0===this.group.length&&this.undoStack.pop(),this.isGroupOpen=!1}}])&&Zn(t.prototype,n),r&&Zn(t,r),a}();rr.HISTORY_CHANGED_EVENT="action-manager.history.changed.event",rr.UNDO="action-manager.undo",rr.REDO="action-manager.redo",rr.EXECUTE="action-manager.execute";var ir=n(277),ar=n.n(ir);n(64);function Ar(e){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function or(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sr(e,t){return(sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ur(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hr(e);if(t){var i=hr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return cr(this,n)}}function cr(e,t){return!t||"object"!==Ar(t)&&"function"!=typeof t?lr(e):t}function lr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hr(e){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sr(e,t)}(A,e);var t,n,r,i=ur(A);function A(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,A),(r=i.call(this,e,t,n)).textboxActive=!1,r.submitChangesDebounced=lt.debounce(r.options.submitChanges||r.submitChanges,Ve),Autodesk.Viewing.isIOSDevice()&&(r.onMarkupEditEnabledBinded=r.onMarkupEditEnabled.bind(lr(r)),r.onMarkupEditDisabledBinded=r.onMarkupEditDisabled.bind(lr(r)),r.onMarkupEditStartBinded=r.onMarkupEditStart.bind(lr(r)),r.onMarkupEditEndBinded=r.onMarkupEditEnd.bind(lr(r)),r.onTouchEndBinded=r.onTouchEnd.bind(lr(r)),r.markupsExtension.markupsManager.addEventListener(a.MARKUP_ENABLE_EDIT,r.onMarkupEditEnabledBinded),r.markupsExtension.markupsManager.addEventListener(a.MARKUP_DISABLE_EDIT,r.onMarkupEditDisabledBinded)),r}return t=A,(n=[{key:"intersect",value:function(e){if(!this.markup.isTextMarkup())return!1;e=e.clone(),this.markup.applyInverseRotation(e),this.markup.applyInverseCameraRotation(e);var t=this.markupsExtension.renderer.worldToClient(e);return this.markup.getClientBoundingBox(!0).containsPoint(t)}},{key:"updateCaretPosition",value:function(){var e=this.markupsExtension.renderer.textRenderer.getLabel(this.markup),t=this.getUpdatedCaretPosition(e);0===t.start&&0===t.end||(this.lastCaretPosition=t)}},{key:"getCursor",value:function(){return"pointer"}},{key:"handleDoubleClick",value:function(e,t){if(Autodesk.Viewing.isIOSDevice())return!1;if(this.intersect(e)){var n=this.markupsExtension.renderer.textRenderer.getLabel(this.markup);return this.lastCaretPosition={start:n.innerText.length,end:n.innerText.length},this.startTextEditing(),!0}return!1}},{key:"handleButtonDown",value:function(e){return this.textboxActive?(this.submitChangesDebounced.flush(),this.endTextEditing(),!0):this.isEmpty()}},{key:"handleButtonUp",value:function(e){return!!this.isEmpty()&&(this.onEmptyTextMarkup(),!0)}},{key:"isEmpty",value:function(){return""===this.markup.editState.text.trim()}},{key:"onEmptyTextMarkup",value:function(){this.options.onEmptyTextMarkup?(this.textboxActive=!1,this.options.onEmptyTextMarkup()):this.deleteEmptyTextMarkup()}},{key:"deleteEmptyTextMarkup",value:function(){this.textboxActive=!1,this.markupsExtension.markupsManager.actionManager.undo(),this.markupsExtension.markupsManager.deleteMarkup(this.markup)}},{key:"onCameraChanged",value:function(e){this.markupsExtension.renderer.textRenderer.getLabel(this.markup).focus()}},{key:"startTextEditing",value:function(e){var t=this,n=this.markupsExtension.renderer.textRenderer.getLabel(this.markup);if(this.label=n,n){this.textboxActive=!0,n.style.position="fixed",n.setAttribute("contenteditable",!0),n.style.webkitUserSelect="text",n.style.userSelect="text",n.style.pointerEvents="auto",n.setAttribute("spellcheck",!1),this.setCaretPosition(n),n.blur(),n.focus();var r=this.getDocument();e&&r.execCommand("selectAll",!1,null),this.onCameraChanged=function(){n.focus()};var i=Autodesk.Viewing.isSafari()||Autodesk.Viewing.isIOSDevice();this.onCameraChangedDebounced=lt.debounce(this.onCameraChanged,5),i&&this.markupsExtension.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedDebounced),this.onKeyDown=function(e){n.focus();var r=n.getBoundingClientRect(),a=t.markupsExtension.viewer.impl.getCanvasBoundingClientRect(),A=t.markup.getTextStyle(),o=Pt("AA",A),s=t.markupsExtension.renderer.getFontToWorldScale(),u=t.markupsExtension.renderer.sizeFromWorldToClient(s),c=function(){return r.bottom+o.height*u>a.bottom-30},l=t.getWindow();switch(e.keyCode){case Autodesk.Viewing.KeyCode.ESCAPE:t.submitChangesDebounced.flush(),t.endTextEditing(),t.textboxActive=!0;break;case Autodesk.Viewing.KeyCode.ENTER:i&&c()||t.options.singleLine?e.preventDefault():l.getSelection().anchorNode.firstChild&&"BR"===l.getSelection().anchorNode.firstChild.tagName||0===l.getSelection().anchorOffset?(e.preventDefault(),Autodesk.Viewing.isIE11&&(t.enterPressed=!0)):t.enterPressed=!0;break;case Autodesk.Viewing.KeyCode.BACKSPACE:t.backspacePressed=!0;break;default:i&&(function(){var e=t.getUpdatedCaretPosition(n),i=t.getWindow().getSelection().anchorNode.parentElement;i.value=i.innerText;var A=ar()(i,e.end);return r.left+(A.left+o.width*u)>a.right-30}()?c()||t.options.singleLine?e.preventDefault():r.right<a.right?t.addNewline=!0:e.preventDefault():c()&&e.preventDefault())}var h=t.lastCaretPosition.end-t.lastCaretPosition.start;!e.metaKey&&e.keyCode>47&&n.innerText.length-h>Je&&e.preventDefault(),Autodesk.Viewing.isIE11&&t.onInput(!0)},this.onKeyUp=function(){t.onInput(!0)},this.onInput=function(e){n.innerText||(n.innerText=Autodesk.Viewing.isIE11?" ":String.fromCharCode(10)),t.lastCaretPosition=t.getUpdatedCaretPosition(n);var r=n.innerText;t.addNewline&&(r+="\r\n"),Autodesk.Viewing.isIE11&&!0===e&&(r=r.replace(/(\r\n){2,}/g,"\r\n"),t.enterPressed&&(r+="\r\n\r\n")),t.options.singleLine||t.expandBoundingBox(r),t.updateEditState({text:r}),t.submitChangesDebounced(),t.enterPressed=!1,t.addNewline=!1,t.backspacePressed=!1},this.onPaste=function(e){e.preventDefault();var r=t.getWindow(),i=t.getDocument(),a=e.clipboardData&&e.clipboardData.getData("text")||r.clipboardData&&r.clipboardData.getData&&r.clipboardData.getData("Text");if(a){var A=t.lastCaretPosition.end-t.lastCaretPosition.start,o=Je+A-n.innerText.length;if(a.length>o&&(a=a.substr(0,o)+"…"),Autodesk.Viewing.isIE11){var s=r.getSelection(),u=s.getRangeAt(0),c=i.createDocumentFragment();c.appendChild(i.createElement("br"));var l=i.createElement("span");l.innerText=a,c.appendChild(l),u.insertNode(c),u.selectNodeContents(l),s.removeAllRanges(),s.addRange(u),i.execCommand("ms-endUndoUnit",!1,null)}else i.execCommand("insertText",!1,a)}},this.onMouseWheel=function(e){var n=new MouseEvent(e.type,e);n.wheelDelta=e.wheelDelta,n.deltaY=e.deltaY,t.markupsExtension.viewer.toolController.domElement.dispatchEvent(n),n.defaultPrevented&&e.preventDefault()},this.onDOMMouseScroll=function(e){var n=new MouseEvent(e.type,e);n.wheelDelta=e.wheelDelta,n.deltaY=e.deltaY,t.markupsExtension.viewer.toolController.domElement.dispatchEvent(n),n.defaultPrevented&&e.preventDefault()},this.onMouseMove=function(e){var n=new MouseEvent(e.type,e);t.markupsExtension.viewer.toolController.domElement.dispatchEvent(n),n.defaultPrevented&&e.preventDefault()},n.addEventListener("keydown",this.onKeyDown),n.addEventListener("keypress",this.onKeyPress),n.addEventListener("input",this.onInput),n.addEventListener("paste",this.onPaste),Autodesk.Viewing.isIE11&&n.addEventListener("keyup",this.onKeyUp),n.addEventListener("mousewheel",this.onMouseWheel),n.addEventListener("DOMMouseScroll",this.onDOMMouseScroll),n.addEventListener("mousemove",this.onMouseMove),n.addEventListener("mouseup",(function(){setTimeout((function(){t.lastCaretPosition=t.getUpdatedCaretPosition(n)}),25)})),n.addEventListener("touchend",(function(){setTimeout((function(){t.lastCaretPosition=t.getUpdatedCaretPosition(n)}),25)})),this.onHistoryChangedBinded=this.onHistoryChanged.bind(this),this.endTextEditingBinded=this.endTextEditing.bind(this),this.onStyleChangedBinded=this.onStyleChanged.bind(this),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_DISABLE_EDIT,this.endTextEditingBinded,{once:!0}),this.markupsExtension.markupsManager.addEventListener(rr.HISTORY_CHANGED_EVENT,this.onHistoryChangedBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_STYLE_PROPERTY_CHANGED,this.onStyleChangedBinded),this.markupsExtension.markupsManager.dispatchEvent({type:a.TEXT_EDITING_STARTED})}}},{key:"removeSelection",value:function(){this.getWindow().getSelection().removeAllRanges(),this.label.style.position="absolute",this.label.style.pointerEvents="none",this.label.setAttribute("contenteditable",!1),this.label.style.webkitUserSelect="none",this.label.style.userSelect="none"}},{key:"setCaretPosition",value:function(e){this.lastCaretPosition||(this.lastCaretPosition={start:0,end:e.innerText.length});var t=this.getWindow(),n=this.getDocument().createRange(),r=t.getSelection(),i=Math.min(this.lastCaretPosition.start,e.childNodes[0].length),a=Math.min(this.lastCaretPosition.end,e.childNodes[0].length);n.setStart(e.childNodes[0],i),n.setEnd(e.childNodes[0],a),r.removeAllRanges(),r.addRange(n)}},{key:"getUpdatedCaretPosition",value:function(e){var t,n,r={start:0,end:0},i=this.getWindow();return i.getSelection?(t=i.getSelection()).rangeCount&&((n=t.getRangeAt(0)).commonAncestorContainer.parentNode===e||n.commonAncestorContainer.parentNode.parentNode===e)&&(r={start:n.startOffset,end:n.endOffset}):r={start:e.innerText.length,end:e.innerText.length},r}},{key:"onHistoryChanged",value:function(e){var t=this;e.actionGroup.forEach((function(e){e.trigger!==rr.UNDO&&e.trigger!==rr.REDO||t.markupsExtension.renderer&&t.markupsExtension.renderer.textRenderer.getLabel(t.markup)&&t.endTextEditing()}))}},{key:"endTextEditing",value:function(){if(this.textboxActive&&this.markupsExtension.renderer){var e=this.markupsExtension.renderer.textRenderer.getLabel(this.markup);e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("input",this.onInput),e.removeEventListener("paste",this.onPaste),Autodesk.Viewing.isIE11&&e.removeEventListener("keyup",this.onKeyUp),e.removeEventListener("mousewheel",this.onMouseWheel),e.removeEventListener("DOMMouseScroll",this.onDOMMouseScroll),e.removeEventListener("mousemove",this.onMouseMove),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_DISABLE_EDIT,this.endTextEditingBinded),this.markupsExtension.markupsManager.removeEventListener(rr.HISTORY_CHANGED_EVENT,this.onHistoryChangedBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_STYLE_PROPERTY_CHANGED,this.onStyleChangedBinded),this.markupsExtension.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedDebounced),this.getWindow().getSelection().removeAllRanges(),e.style.position="absolute",e.style.pointerEvents="none",e.blur(),e.setAttribute("contenteditable",!1),e.style.webkitUserSelect="none",e.style.userSelect="none",this.textboxActive=!1,this.isEmpty()?this.onEmptyTextMarkup():(this.markup.syncEditState(),this.editEnd()),this.markupsExtension.markupsManager.dispatchEvent({type:a.TEXT_EDITING_ENDED})}}},{key:"onStyleChanged",value:function(){this.textboxActive&&this.onCameraChanged()}},{key:"handleKeyDown",value:function(e,t){return!(!this.textboxActive||e.keyCode!==Autodesk.Viewing.KeyCode.ESCAPE||(this.isEmpty()&&this.onEmptyTextMarkup(),this.textboxActive=!1,0))}},{key:"expandBoundingBox",value:function(e){var t=this.getEditState(),n=t.translation,r=t.scale,i=this.markup.getTextStyle(),a=this.markup.getWorldBoundingBoxTextOnly().size(),A=this.markupsExtension.renderer.getFontToWorldScale(),o=this.markup.getTextWidthInFontScale().width;i.width="".concat(o,"px");var s=Pt(this.markup.editState.text,i),u=Pt(e,i);if((this.enterPressed||this.backspacePressed||this.addNewline)&&u.height!==s.height){var c=(u.height-s.height)*A;this.translateBoundingBox(c)}else if(u.height>s.height){i.width=null;var l=Pt("A",i).width*A;r.multiply(new THREE.Vector3((a.x+l)/a.x,1,1));var h=this.markup.getRotation(),d=new THREE.Vector3(l/2,0,0);if(0!==h){var f=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(d,h,new THREE.Vector3,f)}n.add(d),this.updateEditState({scale:r,translation:n})}}},{key:"translateBoundingBox",value:function(e){var t=this.getEditState().translation,n=this.markup.getBoundingBoxVerticalTranslation(e);t.add(n),this.updateEditState({translation:t})}},{key:"destroy",value:function(){this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_ENABLE_EDIT,this.onMarkupEditStartBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_EDIT_END,this.onMarkupEditEndBinded)}},{key:"onMarkupEditEnabled",value:function(e){var t=this;e.markup===this.markup&&(this.markupsExtension.markupsManager.hasEventListener(a.MARKUP_EDIT_START,this.onMarkupEditStartBinded)||this.markupsExtension.markupsManager.addEventListener(a.MARKUP_EDIT_START,this.onMarkupEditStartBinded),this.markupsExtension.markupsManager.hasEventListener(a.MARKUP_EDIT_END,this.onMarkupEditEndBinded)||this.markupsExtension.markupsManager.addEventListener(a.MARKUP_EDIT_END,this.onMarkupEditEndBinded),setTimeout((function(){var e=t.markupsExtension.renderer.textRenderer.getLabel(t.markup);e&&(e.addEventListener("touchend",t.onTouchEndBinded),e.style.pointerEvents="auto")}),10))}},{key:"onTouchEnd",value:function(e){e.preventDefault(),e.stopPropagation(),this.startTextEditing()}},{key:"onMarkupEditDisabled",value:function(e){if(e.markup===this.markup){var t=this.markupsExtension.renderer.textRenderer.getLabel(this.markup);t&&(t.removeEventListener("touchend",this.onTouchEndBinded),t.style.pointerEvents="none")}}},{key:"onMarkupEditStart",value:function(e){this.textboxActive&&(this.textboxWasActive=!0),e.markup===this.markup&&e.handler instanceof Kn&&this.removeSelection()}},{key:"onMarkupEditEnd",value:function(e){e.handler instanceof A||e.markup===this.markup&&this.textboxWasActive&&e.handler instanceof Kn&&(this.textboxWasActive=!1,this.startTextEditing())}}])&&or(t.prototype,n),r&&or(t,r),A}(en);function fr(e){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yr(e,t){return(yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Er(e);if(t){var i=Er(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return mr(this,n)}}function mr(e,t){return!t||"object"!==fr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Er(e){return(Er=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Br=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yr(e,t)}(a,e);var t,n,r,i=vr(a);function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return pr(this,a),i.call(this,e,t,n)}return t=a,(n=[{key:"handleMouseMove",value:function(e){return this.translating&&this.handleMouseTranslation(e),this.translating}},{key:"handleButtonDown",value:function(e,t){if(!this.translating){if(this.translating=this.intersect(e),this.translating){var n=this.markup.getAnchors(),r=n[1].clone().sub(n[0]).normalize(),i=this.markupsExtension.renderer.getCameraEyeVector();this.normal=r.clone().cross(i).normalize(),this.editStart()}return this.translating}return!0}},{key:"getPointOnNormal",value:function(e){var t=this.markup.getAnchors(),n=t[0].clone().add(this.normal);return Ot(e,t[0],n)}},{key:"handleButtonUp",value:function(e,t){if(this.translating){var n=this.getPointOnNormal(e);return Dt(n,this.lastTranslationPoint,this.getMinChangeDistanceWorld())?this.cancelTransformEditing():this.lastTranslationPoint&&(this.submitChanges(),this.editEnd()),this.translating=!1,this.lastTranslationPoint=null,!0}return!1}},{key:"handleDoubleClick",value:function(e,t){return this.translating}},{key:"getCursor",value:function(){return"move"}},{key:"cancelTransformEditing",value:function(){this.markup.syncEditState(),this.translating=!1,this.lastTranslationPoint=null,this.editEnd()}},{key:"handleMouseTranslation",value:function(e){var t=this.getPointOnNormal(e);this.lastTranslationPoint||(this.lastTranslationPoint=t);var n=t.clone().sub(this.lastTranslationPoint).clone().add(this.markup.state.translation);this.updateEditState({translation:n})}},{key:"intersect",value:function(e){e=e.clone(),this.markup.applyInverseRotation(e);var t=this.markupsExtension.renderer.worldToClient(e);return this.markup.getClientBoundingBox(!0).containsPoint(t)}},{key:"isDragging",value:function(){return this.translating}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:if(this.translating)return this.cancelTransformEditing(),!0}return!1}}])&&gr(t.prototype,n),r&&gr(t,r),a}(en);function wr(e){return(wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function br(e,t){return(br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mr(e);if(t){var i=Mr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Tr(this,n)}}function Tr(e,t){return!t||"object"!==wr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mr(e){return(Mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ur=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&br(e,t)}(A,e);var t,n,r,i=Sr(A);function A(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return kr(this,A),(n=i.call(this,e,t,r)).onCreationStartCB=r.onCreationStart,n.onCreationEndCB=r.onCreationEnd,n}return t=A,(n=[{key:"creationStart",value:function(){this.creationStarted=!0,this.onCreationStartCB?this.onCreationStartCB():(this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_DRAWING_START,markup:this.markup}),this.markupsExtension.markupsManager.deselectAllMarkups(),this.markupsExtension.markupsManager.deselectAllLinks(),this.editStart())}},{key:"fixInitialRotation",value:function(){var e,t=this;(this.markup.rotationHandler||this.markup.options.rotationNotAllowed)&&(e=t.markupsExtension.renderer.getCameraRotation(),Math.abs(e)>ke&&function(){for(var n=t.markupsExtension.renderer.getCameraEyeVector(),r=t.markupsExtension.markupsManager.actionManager;!r.isUndoStackEmpty();){var i=r.undoStack[r.undoStack.length-1];if(Array.isArray(i)&&(i=i[i.length-1]),i.markup!==t.markup)break;t.getEditState().anchors.forEach((function(r){st.applyRotation(r,e,t.markup.getWorldCenter(),n)})),t.prevCenter=t.markup.center.clone(),t.markup.setLocked(!0),t.updateEditStateAnchors(),t.updateEditState({rotation:-e}),t.markup.setLocked(!1),t.handleCompensation();var a=lt.cloneDeep(t.getEditState());if(i.markup.state=a,i.markup.editState=a,i.newState&&(i.newState=a),r.isRedoStackEmpty()||(r.redoStack[r.redoStack.length-1].oldState=a),r.isGroupOpen)break;r.undo()}for(;!r.isRedoStackEmpty();)r.redo()}())}},{key:"creationEnd",value:function(e){this.fixInitialRotation(),this.onCreationEndCB?this.onCreationEndCB(e):(this.markup.disableEdit(),this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_DRAWING_END,markup:this.markup}),this.markupsExtension.markupsManager.duringCreationMarkup=null,this.editEnd(),this.markup.complete())}},{key:"creationCancel",value:function(){this.markup.anchorHandler&&this.markup.anchorHandler.cancelAnchorEditing(),this.markup.disableEdit(),this.markup.remove(),this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_DRAWING_CANCEL,markup:this.markup}),this.markupsExtension.markupsManager.duringCreationMarkup=null,this.editEnd()}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:return this.creationCancel(),!0;case Autodesk.Viewing.KeyCode.ESCAPE:return this.onEscape()}return!1}},{key:"onEscape",value:function(){return this.creationCancel(),!0}}])&&Cr(t.prototype,n),r&&Cr(t,r),A}(en);function Qr(e){return(Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _r(e,t){return(_r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lr(e);if(t){var i=Lr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Rr(this,n)}}function Rr(e,t){return!t||"object"!==Qr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lr(e){return(Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_r(e,t)}(a,e);var t,n,r,i=Hr(a);function a(){return xr(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"handleMouseMove",value:function(e){var t=this.getEditState().anchors;return t[0]&&(this.creationStarted||this.creationStart(),this.updateRectPoints(t,e)),!0}},{key:"updateRectPoints",value:function(e,t){this.markupsExtension.markupsTool.shiftDown&&this.snapPointToAxis(t,e[0],90,45);var n=this.markupsExtension.renderer.getCameraRightVector(),r=this.markupsExtension.renderer.getCameraUpVector();e[2]=t;var i=e[2].clone().sub(e[0]),a=i.dot(n);e[1]=e[0].clone().add(n.multiplyScalar(a));var A=i.dot(r);e[3]=e[0].clone().add(r.multiplyScalar(A)),this.updateEditStateAnchors()}},{key:"handleButtonDown",value:function(e,t){var n=this.getEditState().anchors;return n[0]||(n[0]=e,this.updateEditStateAnchors()),!0}},{key:"handleButtonUp",value:function(e,t){var n=this.getEditState().anchors;return n[1]?this.isSamePoint(e,n[0])?(this.creationCancel(),!1):(this.updateRectPoints(n,e),this.submitChanges(),this.creationEnd(e),!0):this.handleMouseMove(e,t)}}])&&Fr(t.prototype,n),r&&Fr(t,r),a}(Ur);function Ir(e){return(Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Or(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pr(e,t){return(Pr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jr(e);if(t){var i=jr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Vr(this,n)}}function Vr(e,t){return!t||"object"!==Ir(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jr(e){return(jr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pr(e,t)}(a,e);var t,n,r,i=Kr(a);function a(){return Or(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"handleMouseMove",value:function(e){var t=this.getEditState().anchors;if(this.creationStarted||this.creationStart(),t.length>0){this.popTemporaryPoint(),this.markupsExtension.markupsTool.shiftDown&&t.length>0&&this.snapPointToAxis(e,t[t.length-1],xe);var n=this.isClosingLoop(e);n||(t.push(e),this.needPop=!0),this.updateEditState({anchors:t,closed:n})}return!0}},{key:"handleButtonDown",value:function(e,t){var n=this.getEditState().anchors;return 0===n.length&&(n.push(e),this.updateEditStateAnchors()),!0}},{key:"handleButtonUp",value:function(e,t){var n=this.getEditState().anchors;this.creationStarted||this.creationStart(),this.popTemporaryPoint();var r=this.isClosingLoop(e);return(r||this.isNewLocation(e))&&(this.markupsExtension.markupsTool.shiftDown&&n.length>0&&this.snapPointToAxis(e,n[n.length-1],xe),r||n.push(e),this.updateEditState({anchors:n,closed:r}),n.length>1&&this.submitChanges(),r&&this.creationEnd(e)),!0}},{key:"beforeCreationEnd",value:function(){return!0}},{key:"handleDoubleClick",value:function(e,t){return this.getEditState().anchors.length>=this.getMinimumPoints()?(this.popTemporaryPoint(),this.beforeCreationEnd(),this.creationEnd(e)):this.markupsExtension.markupsManager.getMarkupById(this.markup.id)?this.deleteMarkup():this.creationCancel(),!0}},{key:"getMinimumPoints",value:function(){return 2}},{key:"handleKeyDown",value:function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:var n=this.getEditState().anchors;return n.length>0&&(this.popTemporaryPoint(),n.pop(),this.updateEditStateAnchors(),n.length>1?this.submitChanges():this.markupsExtension.markupsManager.getMarkupById(this.markup.id)?this.deleteMarkup():this.creationCancel()),!0;case Autodesk.Viewing.KeyCode.ESCAPE:return this.onEscape()}return!1}},{key:"onEscape",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.getEditState(),n=t.anchors;return n.length>0&&(this.popTemporaryPoint(),n.length>=this.getMinimumPoints()?(e&&this.beforeCreationEnd(),this.creationEnd()):this.markupsExtension.markupsManager.getMarkupById(this.markup.id)?this.deleteMarkup():this.creationCancel(),!0)}},{key:"isClosingLoop",value:function(e){var t=this.getEditState().anchors;return t.length>2&&Dt(e,t[0],this.snapDistance())}},{key:"isNewLocation",value:function(e){var t=this.getEditState().anchors;return!(t.length>0&&this.isSamePoint(e,t[t.length-1]))}},{key:"popTemporaryPoint",value:function(){this.needPop&&(this.getEditState().anchors.pop(),this.needPop=!1,this.updateEditStateAnchors())}}])&&Nr(t.prototype,n),r&&Nr(t,r),a}(Ur);function zr(e){return(zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xr(e,t){return(Xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zr(e);if(t){var i=Zr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return qr(this,n)}}function qr(e,t){return!t||"object"!==zr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zr(e){return(Zr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xr(e,t)}(a,e);var t,n,r,i=Jr(a);function a(){return Yr(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"beforeCreationEnd",value:function(){this.updateEditState({closed:!0}),this.submitChanges()}},{key:"getMinimumPoints",value:function(){return 3}}])&&Wr(t.prototype,n),r&&Wr(t,r),a}(Gr);function ei(e){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ti(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ni(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ri(e,t){return(ri=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ii(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ai(e);if(t){var i=Ai(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ai(this,n)}}function ai(e,t){return!t||"object"!==ei(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ai(e){return(Ai=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var oi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ri(e,t)}(a,e);var t,n,r,i=ii(a);function a(){return ti(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"handleMouseMove",value:function(e){return 1===this.getEditState().anchors.length&&this.creationStart(),this.addPoint(e),!0}},{key:"handleButtonDown",value:function(e,t){return this.addPoint(e),!0}},{key:"handleButtonUp",value:function(e,t){return this.addPoint(e),this.submitChanges(),this.creationEnd(e),!0}},{key:"addPoint",value:function(e){var t=this.getEditState().anchors;0!==t.length&&Dt(e,t[t.length-1],this.markupsExtension.renderer.sizeFromClientToWorld(Me))||(t.push(e),t=Wt(t,this.markupsExtension.renderer.sizeFromClientToWorld(.5),!0),this.updateEditStateAnchors(t))}},{key:"handleKeyDown",value:function(e,t){var n=this.getEditState().anchors;switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:return n.length>0&&this.creationCancel(),!0}return!1}}])&&ni(t.prototype,n),r&&ni(t,r),a}(Ur);function si(e){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ui(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ci(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function li(e,t){return(li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fi(e);if(t){var i=fi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return di(this,n)}}function di(e,t){return!t||"object"!==si(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fi(e){return(fi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&li(e,t)}(a,e);var t,n,r,i=hi(a);function a(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ui(this,a),(n=i.call(this,e,t,r)).tailIndex=r.reverseHead?1:0,n.headIndex=r.reverseHead?0:1,n}return t=a,(n=[{key:"handleMouseMove",value:function(e){var t=this.getEditState().anchors;return t[this.headIndex]||(t[this.headIndex]=t[this.tailIndex]),this.creationStarted||this.creationStart(),t[this.tailIndex]&&(this.markupsExtension.markupsTool.shiftDown&&this.snapPointToAxis(e,t[this.tailIndex],xe),t[this.headIndex]=e,this.updateEditStateAnchors()),!0}},{key:"handleButtonDown",value:function(e,t){var n=this.getEditState().anchors;return n[this.tailIndex]||(n[this.tailIndex]=e,this.updateEditStateAnchors()),!0}},{key:"handleButtonUp",value:function(e,t){var n=this.getEditState().anchors;return n[this.headIndex]?this.isSamePoint(e,n[this.tailIndex])?(this.creationCancel(),!1):(this.markupsExtension.markupsTool.shiftDown&&this.snapPointToAxis(e,n[this.tailIndex],xe),n[this.headIndex]=e,this.updateEditStateAnchors(),this.submitChanges(),this.creationEnd(e),!0):this.handleMouseMove(e,t)}}])&&ci(t.prototype,n),r&&ci(t,r),a}(Ur);function gi(e){return(gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mi(e,t){return(mi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ei(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wi(e);if(t){var i=wi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Bi(this,n)}}function Bi(e,t){return!t||"object"!==gi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wi(e){return(wi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ki=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mi(e,t)}(a,e);var t,n,r,i=Ei(a);function a(){return yi(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"calculateAnchorsByCenterPoint",value:function(e){var t=this.getEditState(),n=t.anchors,r=t.text,i=this.markupsExtension.renderer.getCameraRightVector(),a=this.markupsExtension.renderer.getCameraUpVector(),A=this.markup.getTextStyle(),o=Pt(r,A),s=this.markupsExtension.renderer.getFontToWorldScale(),u=Math.ceil(o.width)*s,c=o.height*s;n[0]=e.clone().sub(a.clone().multiplyScalar(c/2)).sub(i.clone().multiplyScalar(u/2)),n[1]=n[0].clone().add(i.multiplyScalar(u)),n[2]=n[1].clone().add(a.clone().multiplyScalar(c)),n[3]=n[0].clone().add(a.clone().multiplyScalar(c))}},{key:"handleButtonDown",value:function(e,t){return!0}},{key:"handleButtonUp",value:function(e,t){return!this.didMouseMove()&&this.handleClick(e,t)}},{key:"handleClick",value:function(e,t){return this.calculateAnchorsByCenterPoint(e),this.creationStart(),this.updateEditStateAnchors(),this.submitChanges(),this.creationEnd(e),Autodesk.Viewing.isIOSDevice()||this.markup.textInputHandler.startTextEditing(!0),!0}}])&&vi(t.prototype,n),r&&vi(t,r),a}(Ur);function Ci(e){return(Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Si(e,t,n){return(Si="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qi(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Ti(e,t){return(Ti=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qi(e);if(t){var i=Qi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ui(this,n)}}function Ui(e,t){return!t||"object"!==Ci(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qi(e){return(Qi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ti(e,t)}(A,e);var t,n,r,i=Mi(A);function A(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,A),(r=i.call(this,e,t,n)).measurement=new Autodesk.Viewing.MeasureCommon.Measurement(Autodesk.Viewing.MeasureCommon.MeasurementTypes.MEASUREMENT_DISTANCE),r.snapper=r.markupsExtension.markupsTool.snapper,r.viewer=r.markupsExtension.viewer,r}return t=A,(n=[{key:"getMeasureExtension",value:function(){return this.measureExtension||(this.measureExtension=this.markupsExtension.viewer.getExtension("Autodesk.Measure"),this.measureExtension||console.error("Measure extension not available!")),this.measureExtension}},{key:"handleMouseMove",value:function(e){var t=this.getEditState().anchors;return this.creationStarted||this.creationStart(),t[0]&&(this.markupsExtension.markupsTool.shiftDown&&this.viewer.impl.is2d&&this.snapPointToAxis(e,t[0],90),t[1]||this.updateViewportId(this.measurement.getPick(1).viewportIndex2d),this.pickSecondAnchor(e)),!0}},{key:"handleButtonDown",value:function(e,t){var n=this.getMeasureExtension();if((n.forceCalibrate||this.viewer.model.isLeaflet()||this.viewer.model.isPdf(!0))&&!n.calibrationTool.isCalibrated())return n.openCalibrationRequiredDialog("dimension"),this.markupsExtension.markupsManager.dispatchEvent({type:a.CALIBRATION_REQUIRED}),this.creationCancel(),!0;var r=this.getEditState().anchors;if(!r[0]){if(!this.snapper.isSnapped())return!1;this.snapper.copyResults(this.measurement.getPick(1));var i=Autodesk.Viewing.MeasureCommon.getSnapResultPosition(this.snapper.getSnapResult(),this.viewer);r[0]=this.markupsExtension.renderer.documentCameraToMarkupsCamera(i),this.updateEditStateAnchors()}return!0}},{key:"handleButtonUp",value:function(e,t){var n=this.getEditState().anchors;return n[1]?this.isSamePoint(e,n[0])?(this.creationCancel(),!1):(this.markupsExtension.markupsTool.shiftDown&&this.viewer.impl.is2d&&this.snapPointToAxis(e,n[0],90),!!this.pickSecondAnchor(e)&&(this.updateViewportId(),this.submitChanges(),this.creationEnd(e),this.markup.dimensionEditHandler&&this.markup.dimensionEditHandler.handleButtonDown(e,t),!0)):this.handleMouseMove(e,t)}},{key:"pickSecondAnchor",value:function(e){var t=this.getEditState().anchors;if(this.markupsExtension.markupsTool.shiftDown&&this.viewer.impl.is2d){var n=this.markupsExtension.renderer.worldToClient(e);this.snapper.onMouseMove({x:n.x,y:n.y})}var r=this.measurement.getPick(2),i=this.snapper.isSnapped();i?(this.snapper.copyResults(r),t[1]=Autodesk.Viewing.MeasureCommon.getSnapResultPosition(this.snapper.getSnapResult(),this.viewer)):(t[1]=e,r.geomType=Autodesk.Viewing.MeasureCommon.SnapType.SNAP_VERTEX,r.geomVertex=e,r.intersectPoint=e),Autodesk.Viewing.MeasureCommon.correctPerpendicularPicks(this.measurement.getPick(1),this.measurement.getPick(2),this.viewer,this.snapper)&&(t[1]=Autodesk.Viewing.MeasureCommon.getSnapResultPosition(this.measurement.getPick(2),this.viewer),this.snapper.indicator.render()),i&&(t[1]=this.markupsExtension.renderer.documentCameraToMarkupsCamera(t[1]));var a=i||this.viewer.impl.is2d?this.getDistance():"";return this.updateEditState({text:a,anchors:t}),i}},{key:"creationCancel",value:function(){Si(Qi(A.prototype),"creationCancel",this).call(this),this.updateViewportId()}},{key:"updateViewportId",value:function(e){this.viewer.model&&this.viewer.impl.is2d&&(e?(this.viewer.impl.updateViewportId(e),this.snapper.setViewportId(e)):(this.viewer.impl.updateViewportId(0),this.snapper.setViewportId(null)))}},{key:"getDistance",value:function(){var e=this.getMeasureExtension().sharedMeasureConfig;if(this.measurement.computeResult(this.measurement.picks,this.markupsExtension.viewer),this.markupsExtension.viewer.model&&this.measurement.distanceXYZ){var t=Autodesk.Viewing.Private.convertUnits(this.markupsExtension.viewer.model.getUnitString(),e.units,e.calibrationFactor,this.measurement.distanceXYZ);return Autodesk.Viewing.Private.formatValueWithUnits(t,e.units,3,e.precision)}return null}}])&&bi(t.prototype,n),r&&bi(t,r),A}(Ur);function Fi(e){return(Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ri(e,t,n){return(Ri="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Oi(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Li(e,t){return(Li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Di(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Oi(e);if(t){var i=Oi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ii(this,n)}}function Ii(e,t){return!t||"object"!==Fi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oi(e){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ni(e){return(Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ki(e,t){return(Ki=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gi(e);if(t){var i=Gi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ji(this,n)}}function ji(e,t){return!t||"object"!==Ni(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gi(e){return(Gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ki(e,t)}(a,e);var t,n,r,i=Vi(a);function a(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e,t,n,r)}return t=a,(n=[{key:"afterNextMarkupCreated",value:function(e){if(e===this.getTextIndex()){var t,n=this.getArrow(),r=this.getText(),i=r.getWorldBoundingBox(!0),a=r.editState.style[c.THICKNESS]/2,A=i.size().y/2-a,o=i.size().x/2-a,s=n.getHead(),u=n.getTail(),l=Math.atan2(s.y-u.y,s.x-u.x);switch(this.markup.getTextQuadrant(l)){case 1:t=new THREE.Vector3(0,A,0);break;case 2:t=new THREE.Vector3(-o,0,0);break;case 3:t=new THREE.Vector3(0,-A,0);break;case 4:t=new THREE.Vector3(o,0,0)}if(r.editState.frameType===E){var h=t.clone().negate(),d=this.markup.getVectorToClosestPointOnCloud(h);t.add(d)}r.creationHandler.updateEditState({translation:t}),r.creationHandler.submitChanges()}}},{key:"getArrowIndex",value:function(){throw new Error("getArrowIndex needs implementation")}},{key:"getTextIndex",value:function(){throw new Error("getTextIndex needs implementation")}},{key:"getArrow",value:function(){return this.markup.markups[this.getArrowIndex()]}},{key:"getText",value:function(){return this.markup.markups[this.getTextIndex()]}}])&&Pi(t.prototype,n),r&&Pi(t,r),a}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Li(e,t)}(a,e);var t,n,r,i=Di(a);function a(e,t,n){var r,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];_i(this,a),(r=i.call(this,e,t,n)).creationHandlers=[],r.currentStep=0,r.lastCompleted=-1,r.markup.markups=[];var o=[];r.markup.state.uuid?o=r.markup.state.componentsState.sort((function(e,t){return e.groupOrder-t.groupOrder})):r.markup.state.uuid=r.markup.editState.uuid=THREE.Math.generateUUID(),r.markupClasses=A,r.numMarkups=A.length;for(var s=0;s<r.numMarkups;s++){var u=A[s].class,c=A[s].options||{};r._restoreFill(o[s],A[s],o);var l=s===A.length-1;c.onCreationEnd=function(e){r.onCreationEnd(e)},c.onCreationStart=function(){r.onCreationStart()};var h=Object.assign({},o[s],{groupId:r.markup.state.uuid,groupOrder:s}),d=r.markupsExtension.markupsManager.createMarkup(u,h,c);l||(d.selectWhenCompleted=function(){return!1}),d.markupGroup=r.markup,r.markup.markups.push(d),r.creationHandlers.push(d.creationHandler)}return delete r.markup.state.componentsState,r}return t=a,(n=[{key:"_restoreFill",value:function(e,t,n){if(e&&t.options.fillNotAllowed)for(var r=0;r<this.numMarkups;r++)if(!(t===this.markupClasses[r]||this.markupClasses[r].options&&this.markupClasses[r].options.fillNotAllowed)){e.style[c.FILL_OPACITY]=n[r].style[c.FILL_OPACITY],e.style[c.FILL_COLOR]=n[r].style[c.FILL_COLOR];break}}},{key:"handleMouseMove",value:function(e){return this.creationHandlers[this.currentStep].handleMouseMove(e)}},{key:"handleButtonDown",value:function(e,t){return this.creationHandlers[this.currentStep].handleButtonDown(e,t)}},{key:"handleButtonUp",value:function(e,t){return this.creationHandlers[this.currentStep].handleButtonUp(e,t)}},{key:"handleDoubleClick",value:function(e,t){return this.creationHandlers[this.currentStep].handleDoubleClick(e,t)}},{key:"creationCancel",value:function(){for(Ri(Oi(a.prototype),"creationCancel",this).call(this),this.markupsExtension.markupsManager.closeActionGroup();this.currentStep-- >0;)this.markupsExtension.markupsManager.actionManager.undo(!1)}},{key:"onCreationStart",value:function(){0===this.currentStep&&(this.markupsExtension.markupsManager.openActionGroup(),this.creationStart()),this.markup.markups[this.currentStep].setVisible(!0),this.markup.markups[this.currentStep].enableEdit()}},{key:"closeGroup",value:function(){this.lastCompleted===this.currentStep&&this.markupsExtension.markupsManager.closeActionGroup(),this.lastCompleted=this.currentStep}},{key:"onCreationEnd",value:function(e){if(this.markup.markups[this.currentStep].disableEdit(),this.markup.markups[this.currentStep].complete(),this.currentStep===this.numMarkups-1)this.submitChanges(),this.creationEnd(e);else{var t=this.markup.markups[this.currentStep].getStartPointForNextMarkup();this.currentStep+=1,this.markupClasses[this.currentStep].options.requiresClick?this.creationHandlers[this.currentStep].handleClick(t):this.creationHandlers[this.currentStep].handleButtonDown(t),this.afterNextMarkupCreated(this.currentStep)}this.closeGroup()}},{key:"afterNextMarkupCreated",value:function(e){}}])&&Hi(t.prototype,n),r&&Hi(t,r),a}(Ur));function Yi(e){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xi(e,t){return(Xi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ji(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zi(e);if(t){var i=Zi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return qi(this,n)}}function qi(e,t){return!t||"object"!==Yi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zi(e){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $i=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xi(e,t)}(a,e);var t,n,r,i=Ji(a);function a(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e,t,n,[{class:y,options:{reverseHead:!0,tailHandlingNotAllowed:!0}},{class:S,options:{requiresClick:!0,rotationNotAllowed:!0,frameType:n.calloutFrameType?n.calloutFrameType:v}}])}return t=a,(n=[{key:"getArrowIndex",value:function(){return 0}},{key:"getTextIndex",value:function(){return 1}}])&&Wi(t.prototype,n),r&&Wi(t,r),a}(zi);function ea(e){return(ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ta(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function na(e,t){return(na=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ra(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=aa(e);if(t){var i=aa(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ia(this,n)}}function ia(e,t){return!t||"object"!==ea(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aa(e){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Aa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&na(e,t)}(a,e);var t,n,r,i=ra(a);function a(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e,t,n,[{class:E,options:{fillNotAllowed:!0,rotationNotAllowed:!0}},{class:y,options:{reverseHead:!0,headHandlingNotAllowed:!0,tailHandlingNotAllowed:!0}},{class:S,options:{requiresClick:!0,rotationNotAllowed:!0,frameType:n.calloutFrameType?n.calloutFrameType:v}}])}return t=a,(n=[{key:"getArrowIndex",value:function(){return 1}},{key:"getTextIndex",value:function(){return 2}}])&&ta(t.prototype,n),r&&ta(t,r),a}(zi);function oa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var sa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getCreationHandler",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};switch(e){case y:case Q:return new pi(t,n,r);case v:case m:case E:return new Dr(t,n,r);case B:case w:return new oi(t,n,r);case C:return new $r(t,n,r);case k:return new Gr(t,n,r);case S:return new ki(t,n,r);case U:return new xi(t,n,r);case T:return new $i(t,n,r);case M:return new Aa(t,n,r)}throw new Error("".concat(e," creation handler does not exist"))}}],(n=null)&&oa(t.prototype,n),r&&oa(t,r),e}(),ua=n(278),ca=n.n(ua),la=n(279),ha=n.n(la);function da(e){this.supportsInt32Index=e}function fa(e){function t(e,t){return void 0===e?t:e}THREE.Material.call(this),e=e||{},this.lineWidth=t(e.lineWidth,1),this.miter=t(e.miter,!0),this.color=t(e.color,new THREE.Color(16777215)),this.opacity=t(e.opacity,1),this.resolution=t(e.resolution,new THREE.Vector2(1,1));var n=new THREE.RawShaderMaterial({uniforms:{lineWidth:{type:"f",value:this.lineWidth},color:{type:"c",value:this.color},opacity:{type:"f",value:this.opacity},resolution:{type:"v2",value:this.resolution}},vertexShader:ca.a,fragmentShader:ha.a,attributes:{previous:{type:"v2",value:new THREE.Vector2},next:{type:"v2",value:new THREE.Vector2},side:{type:"f",value:0},width:{type:"f",value:0},counters:{type:"f",value:0}}});return n.type="MeshLineMaterial",Autodesk.Viewing.isIE11&&(n.defines.IS_IE_11=1),this.miter&&(n.defines.MITER=1),delete e.lineWidth,delete e.color,delete e.opacity,delete e.resolution,delete e.miter,n.setValues(e),n}function pa(e,t,n,r,i,a){var A=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.333,o=Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2)),s=Math.sqrt(Math.pow(i-n,2)+Math.pow(a-r,2)),u=A*o/(o+s),c=A-u,l=n+u*(e-i),h=r+u*(t-a),d=n-c*(e-i),f=r-c*(t-a);return[{x:l,y:h},{x:d,y:f}]}function ga(e,t,n,r){var i=r*r,a=1-r,A=a*a,o=A*e.x;o+=2*a*r*t.x,o+=i*n.x;var s=A*e.y;return s+=2*a*r*t.y,{x:o,y:s+=i*n.y,z:0}}function ya(e,t,n,r,i){var a=i*i,A=a*i,o=1-i,s=o*o,u=s*o,c=u*e.x;c+=3*s*i*t.x,c+=3*o*a*n.x,c+=A*r.x;var l=u*e.y;return l+=3*s*i*t.y,l+=3*o*a*n.y,{x:c,y:l+=A*r.y,z:0}}da.prototype.create=function(){this.geometry=new THREE.BufferGeometry},da.prototype.dispose=function(){if(this.geometry&&(this.geometry.dispose(),this.geometry=null),this.attributes){for(var e in this.attributes)delete this.attributes[e].array;this.attributes=null}this.positions=null,this.previous=null,this.next=null,this.side=null,this.width=null,this.counters=null,this.indices_array=null},da.prototype.setGeometry=function(e,t,n,r){var i=this;this.sourceGeo=e,Array.isArray(t)?(this.widthArray=t,this.widthCallback=function(e){return i.widthArray[e]}):this.widthCallback=t,this.sourceConnectivity=n||[],this.connectivity={},this.options=Object.assign({},{capType:g,joinType:g,useExactSize:!1},r),this.isClosed=!!this.options.isClosed,this.process()},da.prototype.isPointNear=function(){var e=new THREE.Vector3,t=new THREE.Vector3;function n(n){var r=e.x,i=e.y,a=t.x-r,A=t.y-i;if(0!==a||0!==A){var o=((n.x-r)*a+(n.y-i)*A)/(a*a+A*A);o>1?(r=t.x,i=t.y):o>0&&(r+=a*o,i+=A*o)}return(a=n.x-r)*a+(A=n.y-i)*A}return function(r,i,a){for(var A=0,o=this.numPoints-1;A<o;A++)if(this.connectivity[A]!==d&&(e.fromArray(this.positions,6*A).applyMatrix4(a),t.fromArray(this.positions,6*(A+1)).applyMatrix4(a),n(r)<i))return!0;return!1}}(),da.prototype.getPositionV3=function(e){var t=6*e;return[this.positions[t],this.positions[t+1],this.positions[t+2]]},da.prototype.initArrays=function(e){var t=this.options.useExactSize;if(!this.capacity||this.capacity<e||t&&this.capacity!==e){this.dispose();var n=t?e:Math.ceil(1.5*e);this.positions=new Float32Array(6*n),this.previous=new Float32Array(4*n),this.next=new Float32Array(4*n),this.side=new Float32Array(2*n),this.width=new Float32Array(2*n),this.counters=new Float32Array(2*n);var r=6*(n-1);this.indices_array=this.supportsInt32Index&&r>65535?new Uint32Array(r):new Uint16Array(r),this.capacity=n}this.numPoints=e},da.prototype.getWidth=function(e,t){return this.widthCallback?this.widthCallback(e,t):1},da.prototype.process=function(){var e=this,t=this.sourceGeo.length,n=Math.max(1,t-1),r=function(t,r,i,a){var A=e.sourceGeo[t];e.positions.set([A.x,A.y,A.z,A.x,A.y,A.z],6*r),e.counters.set([i,i],2*r),e.side.set([a,-a],2*r);var o=e.getWidth(t,t/n);e.width.set([o,o],2*r)},i=0,a=function(){e.attributes?(e.attributes.position.array=e.positions,e.attributes.position.needsUpdate=!0,e.attributes.previous.array=e.previous,e.attributes.previous.needsUpdate=!0,e.attributes.next.array=e.next,e.attributes.next.needsUpdate=!0,e.attributes.side.array=e.side,e.attributes.side.needsUpdate=!0,e.attributes.width.array=e.width,e.attributes.width.needsUpdate=!0,e.attributes.index.array=e.indices_array,e.attributes.index.needsUpdate=!0,e.attributes.counters.array=e.counters,e.attributes.counters.needsUpdate=!0):(e.create(),e.attributes={position:new THREE.BufferAttribute(e.positions,3),previous:new THREE.BufferAttribute(e.previous,2),next:new THREE.BufferAttribute(e.next,2),side:new THREE.BufferAttribute(e.side,1),width:new THREE.BufferAttribute(e.width,1),index:new THREE.BufferAttribute(e.indices_array,1),counters:new THREE.BufferAttribute(e.counters,1)},e.geometry.addAttribute("position",e.attributes.position),e.geometry.addAttribute("previous",e.attributes.previous),e.geometry.addAttribute("next",e.attributes.next),e.geometry.addAttribute("side",e.attributes.side),e.geometry.addAttribute("width",e.attributes.width),e.geometry.addAttribute("index",e.attributes.index),e.geometry.addAttribute("counters",e.attributes.counters))};if(0!==t){this.isClosed&&this.options.joinType!==p||(this.sourceConnectivity[0]=h,this.sourceConnectivity[t-1]=d);var A=t+this.sourceConnectivity.reduce((function(e){return e+1}),0);this.initArrays(A);for(var o=0,s=0;s<t;s++)if(this.sourceConnectivity[s]===h){var u=0!==s||this.isClosed?this.options.joinType:this.options.capType;this.connectivity[o]=h,r(s,o++,-1,u),r(s,o++,0,u)}else if(this.sourceConnectivity[s]===d){var c=s!==t-1||this.isClosed?this.options.joinType:this.options.capType;r(s,o++,1,c),this.connectivity[o]=d,r(s,o++,2,c)}else r(s,o++,s/n,f);!function(){var t;t=e.isClosed?e.getPositionV3(A-2):e.getPositionV3(0),e.previous.set([t[0],t[1],t[0],t[1]],0);for(var n=1;n<A;n++)t=e.connectivity[n]===h?e.getPositionV3(n):e.connectivity[n]===d?e.getPositionV3(n-2):e.getPositionV3(n-1),e.previous.set([t[0],t[1],t[0],t[1]],4*n)}(),function(){for(var t,n=0;n<A-1;n++)t=e.connectivity[n]===d?e.getPositionV3(n):e.connectivity[n]===h?e.getPositionV3(n+2):e.getPositionV3(n+1),e.next.set([t[0],t[1],t[0],t[1]],4*n);t=e.isClosed?e.getPositionV3(1):e.getPositionV3(A-1),e.next.set([t[0],t[1],t[0],t[1]],4*(A-1))}(),function(){for(var t=0;t<A-1;t++)if(e.connectivity[t]!==d){var n=2*t;e.indices_array.set([n,n+1,n+2,n+2,n+1,n+3],i),i+=6}}(),a(),this.geometry.offsets[0]={index:0,start:0,count:i}}else a()},fa.prototype=Object.create(THREE.Material.prototype),fa.prototype.constructor=fa,fa.prototype.copy=function(e){return THREE.Material.prototype.copy.call(this,e),this.lineWidth=e.lineWidth,this.color.copy(e.color),this.opacity=e.opacity,this.resolution.copy(e.resolution),this.miter=e.miter,this};var va=function(e){for(var t,n,r,i,a=0,A=1;A<e.length;A++)a+=(t=e[A],n=e[A-1],r=void 0,i=void 0,r=t.x-n.x,i=t.y-n.y,Math.sqrt(r*r+i*i));return a};function ma(e,t,n,r,i,a){for(var A=Math.max(Math.round(va([e,t,n])/r),4),o=0;o<A;o++){var s=o/A,u=ga(e,t,n,s);i.push(u),a&&a.push(e.width+s*s*(n.width-e.width))}}function Ea(e,t,n,r,i,a,A){for(var o=Math.max(Math.round(va([e,t,n,r])/i),4),s=0;s<o;s++){var u=s/o,c=ya(e,t,n,r,u);a.push(c),A&&A.push(e.width+u*u*u*(r.width-e.width))}}function Ba(e,t,n){if(e.length<3)return{anchors:e};for(var r=[],i=[],a=n?[]:null,A=e.length,o=0;o<A-2;o++)r=r.concat(pa(e[o].x,e[o].y,e[o+1].x,e[o+1].y,e[o+2].x,e[o+2].y));ma(e[0],r[0],e[1],t,i,a);for(var s=1;s<A-3;s++)Ea(e[s],r[2*s-1],r[2*s],e[s+1],t,i,a);return ma(e[A-2],r[2*A-5],e[A-1],t,i,a),i.push(e[A-1]),a&&a.push(e[A-1].width),{anchors:i,widths:a}}function wa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ka=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.geoCache={}}var t,n,r;return t=e,r=[{key:"areAllAnchorsEqual",value:function(e){for(var t=e[0],n=1;n<e.length;n++)if(!e[n].equals(t))return!1;return!0}}],(n=[{key:"getStrokeGeometry",value:function(t){return this._isCacheSupported(t.type)?this._getCachedStrokeGeometry(t.type):e.areAllAnchorsEqual(t.editState.anchors)?this._createPointGeometry(t):this._createStrokeGeometry(t)}},{key:"getFillGeometry",value:function(e){switch(e.type){case E:case C:var t={innerGeometry:this._getFillInnerGeometryFromAnchors(e)};return e.meshLine.type!==m&&(t.arcGeometry=this._getFillCircleGeometry(e.meshLine.radius),t.fillGapGeometries=this._getFillingGapsGeometry(e)),t;case k:return this._getFillInnerGeometryFromAnchors(e);case m:return this._getFillCircleGeometry(.5,72);case v:return this._getFillRectangleGeometry();default:return null}}},{key:"_getFillingGapsGeometry",value:function(e){for(var t=[],n=0;n<e.meshLine.intersectionObjects.length;n++){var r=e.meshLine.intersectionObjects[n],i=r.beginPoint,a=r.endPoint,A=r.newCircle,o=r.anchorPoint,s=r.beginCircle,u=r.endCircle;if(!(i&&a&&o&&s&&u&&A))return null;var c=[];c.push(new THREE.Vector3(o.x,o.y,0)),c.push(new THREE.Vector3(s.x,s.y,0)),c.push(new THREE.Vector3(i.x,i.y,0)),c.push(new THREE.Vector3(A.x,A.y,0)),c.push(new THREE.Vector3(a.x,a.y,0)),c.push(new THREE.Vector3(u.x,u.y,0)),t.push(new THREE.ShapeGeometry(new THREE.Shape(c)))}return t}},{key:"_getFillCircleGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n="circle-fill|r:"+e+"|s:"+t;return this.geoCache[n]||(this.geoCache[n]=new THREE.CircleGeometry(e,t)),this.geoCache[n]}},{key:"_getFillRectangleGeometry",value:function(){return this.geoCache["rectangle-fill"]||(this.geoCache["rectangle-fill"]=new THREE.PlaneBufferGeometry(1,1,1,1)),this.geoCache["rectangle-fill"]}},{key:"_getFillInnerGeometryFromAnchors",value:function(e){if(e.meshLine.type===m)return this._getFillCircleGeometry(.5,10);var t=lt.cloneDeep(e.getAnchors());return this._centerAndScaleLocations(t,e.center,e.scaleMatrix),e.meshLine.type===E&&this._shiftAnchorsInsideBox(e,t,e.meshLine.radius),t.length>2?new THREE.ShapeGeometry(new THREE.Shape(t)):null}},{key:"_getCachedStrokeGeometry",value:function(e){var t=e;return this.geoCache[t]||(this.geoCache[t]=this._createCachedStrokeGeometry(e)),this.geoCache[t]}},{key:"_isCacheSupported",value:function(e){return[v,m].includes(e)}},{key:"isCachedGeometry",value:function(e){for(var t in this.geoCache)if(e===this.geoCache[t])return!0;return!1}},{key:"_createCachedStrokeGeometry",value:function(e){switch(e){case v:return this._createRectangleStrokeGeometry();case m:return this._createCircleStrokeGeometry();default:return null}}},{key:"_createStrokeGeometry",value:function(e){switch(e.type){case E:case C:var t=this._createCloudGeometry(e);return t||(t=this._getCachedStrokeGeometry(m)),t;case k:case Q:return this._createLineGeometry(e,179);case B:case w:return this._createLineGeometry(e,120);case y:return this._createArrowGeometry(e);case U:return this._createDimensionGeometry(e);default:return null}}},{key:"_createPointGeometry",value:function(e){var t,n;switch(e.type){case E:case C:case B:case w:t=p,n=rt*this.markupsExtension.renderer.mmToWorldUnitFactor;break;default:t=g,n=this.markupsExtension.renderer.getNormaStrokeWidth()}var r=[{x:0,y:0,z:0},{x:n,y:0,z:0}];return this._createMeshLine(r,e.type,e,null,{capType:t})}},{key:"_createMeshLine",value:function(e,t,n,r){var i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},A=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return n?(i=n.meshLine,a.useExactSize=n.completed):a.useExactSize=!0,i&&i.type===t||(i=new da(this.markupsExtension.renderer.supportsInt32Index())),i.type=t,i.setGeometry(e,A,r,a),i}},{key:"_createRectangleStrokeGeometry",value:function(){return this._createMeshLine([{x:-.5,y:-.5,z:0},{x:.5,y:-.5,z:0},{x:.5,y:.5,z:0},{x:-.5,y:.5,z:0},{x:-.5,y:-.5,z:0}],v,null,null,{isClosed:!0})}},{key:"_createCircleStrokeGeometry",value:function(){var e=Kt(0,0,.5,0,2*Math.PI,!1,72);return this._createMeshLine(e,m,null,null,{isClosed:!0})}},{key:"_centerAndScaleLocations",value:function(e,t,n){e.forEach((function(e){e.sub(t),e.applyMatrix4(n)}))}},{key:"_createLineGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:29,n=e.type===B||e.type===w,r=lt.cloneDeep(e.getEditState().anchors);this._centerAndScaleLocations(r,e.center,e.scaleMatrix);var i=[],a=null;if(e.editState.closed&&r.push(r[0]),n){var A=.5*e.markupsExtension.renderer.mmToWorldUnitFactor,o=!1,s=Ba(r,A,o);r=s.anchors,a=s.widths}for(var u=new THREE.Vector3,c=new THREE.Vector3,l=Math.cos(t*Math.PI/180),h=1;h<r.length-1;h++)u.copy(r[h-1]).sub(r[h]).normalize(),c.copy(r[h+1]).sub(r[h]).normalize(),c.dot(u)>l&&(r.splice(h,0,r[h]),a&&a.splice(h,0,a[h]),i[h]=d,h++);return e.editState.closed&&(u.copy(r[r.length-2]).sub(r[r.length-1]).normalize(),c.copy(r[1]).sub(r[0]).normalize(),c.dot(u)>l&&(r.push(r[0]),a&&a.push(a[0]))),this._createMeshLine(r,e.type,e,i,{capType:n?p:g,joinType:p,isClosed:e.editState.closed},a)}},{key:"_createArrowGeometry",value:function(e){var t=e.editState.style[c.THICKNESS],n=lt.cloneDeep(e.getEditState().anchors);n[0].sub(e.center),n[1].sub(e.center);var r=n[1].clone().sub(n[0]),i=this.markupsExtension.renderer.getCameraEyeVector(),a=Math.min(t*we,r.length()/2),A=[],o=a>t;if(o){var s=r.clone().normalize(),u=n[1].clone().sub(s.multiplyScalar(a)),l=st.degreesToRadians(30);n[2]=u.clone(),st.applyRotation(n[2],l,n[1],i),n[3]=n[1].clone(),n[4]=u.clone(),st.applyRotation(n[4],-l,n[1],i),A[1]=d,A[2]=h}var f=this._createMeshLine(n,e.type,e,A);return o&&(n[0].add(e.center),n[1].add(e.center),n[2].add(e.center),n[4].add(e.center),f.boundingPoints=[n[0],n[2],n[1],n[4]]),f}},{key:"_createDimensionGeometry",value:function(e){var t=e.editState.style[c.THICKNESS]*Ge,n=lt.cloneDeep(e.getEditState().anchors),r=[],i=[];function a(e,t){r=r.concat([e,t]),i=i.concat([h,d])}n[0].sub(e.center),n[1].sub(e.center),a(n[0],n[1]);var A=n[0].clone().sub(n[1]),o=this.markupsExtension.renderer.getCameraEyeVector(),s=A.clone().cross(o).normalize(),u=t*je,l=s.clone().multiplyScalar(u),f=st.degreesToRadians(45);return n[2]=n[0].clone().add(l),n[3]=n[0].clone().sub(l),st.applyRotation([n[2],n[3]],f,n[0],o),a(n[2],n[3]),n[4]=n[1].clone().add(l),n[5]=n[1].clone().sub(l),st.applyRotation([n[4],n[5]],f,n[1],o),a(n[4],n[5]),n[6]=n[0].clone(),e.applyInverseScaleAndTranslation(n[6]),Dt(n[6],n[0])||(n[7]=n[0].clone().sub(n[0].clone().sub(n[6]).normalize().multiplyScalar(u)),a(n[6],n[7])),n[8]=n[1].clone(),e.applyInverseScaleAndTranslation(n[8]),Dt(n[8],n[1])||(n[9]=n[1].clone().sub(n[1].clone().sub(n[8]).normalize().multiplyScalar(u)),a(n[8],n[9])),n[10]=n[0].clone().add(l),n[11]=n[0].clone().sub(l),a(n[10],n[11]),n[12]=n[1].clone().add(l),n[13]=n[1].clone().sub(l),a(n[12],n[13]),this._createMeshLine(r,e.type,e,i)}},{key:"_createCloudGeometry",value:function(e){var t=lt.cloneDeep(e.getEditState().anchors);(function(e,t){for(var n=0,r=0;r<e.length;r++){var i=e[r],a=e[(r+1)%e.length];n+=(a.x-i.x)*(a.y+i.y)}return n*t.scaleMatrix.elements[0]*t.scaleMatrix.elements[5]>0})(t,e)&&t.reverse();var n=this.getCloudMinimumRadius(e.editState.style[c.THICKNESS]),r=n/this.markupsExtension.renderer.mmToWorldUnitFactor;this._centerAndScaleLocations(t,e.center,e.scaleMatrix);var i,a=e.editState.closed;if(e.type===E){if(a=!0,!this._shiftAnchorsInsideBox(e,t,n))return null}else(i=new THREE.Box3).min.z=i.max.z=0;var A=function(e,t,n){for(var r=e.length,i=[],a=0;a<r;a++){var A=e[0===a?r-1:a-1],o=e[a],s=e[(a+1)%r];if(!o||!s)break;var u=Math.atan2(o.y-A.y,o.x-A.x),c={};c.p1=new THREE.Vector3(A.x+Math.cos(u-Math.PI/2)*t,A.y+Math.sin(u-Math.PI/2)*t,1),c.p2=new THREE.Vector3(o.x+Math.cos(u-Math.PI/2)*t,o.y+Math.sin(u-Math.PI/2)*t,1);var l=Math.atan2(s.y-o.y,s.x-o.x),h={};h.p1=new THREE.Vector3(o.x+Math.cos(l-Math.PI/2)*t,o.y+Math.sin(l-Math.PI/2)*t,1),h.p2=new THREE.Vector3(s.x+Math.cos(l-Math.PI/2)*t,s.y+Math.sin(l-Math.PI/2)*t,1);var d=zt(c.p1,c.p2,h.p1,h.p2);if(d.onBothLines){var f=new THREE.Vector3(o.x-A.x,o.y-A.y,0),p=new THREE.Vector3(s.x-o.x,s.y-o.y,0);f.normalize(),p.normalize(),f.multiplyScalar(-1);var g=(new THREE.Vector3).crossVectors(f,p),y=Math.asin(g.z),v=f.dot(p);Math.atan2(y,v)<Math.PI/2&&(o["isCurrentIntersection"+i.length]=!0,s["isNextIntersection"+i.length]=!0,o.intersects=i,s.intersects=i,i.push(d))}}return i}(t,n),o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.8,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,A=arguments.length>6&&void 0!==arguments[6]&&arguments[6];function o(e,t,n){var r=t.x-e.x,i=t.y-e.y,a=.5*Math.sqrt(r*r+i*i)/n;a<-1&&(a=-1),a>1&&(a=1);var A=Math.atan2(i,r),o=Math.acos(a);return[A-o,Math.PI+A+o]}var s=[],u=2*t*i,c=n?e[e.length-1]:e[0];A=A||!n;for(var l=n?0:1;l<e.length;l++){var h=e[l],d=h.x-c.x,f=h.y-c.y,p=Math.sqrt(d*d+f*f);d/=p,f/=p;var g=0,y=0;n||(1===l?(p-=t,c.x+=d*t,c.y+=f*t,g=Math.atan2(f,d)+Math.PI):l===e.length-1&&(y=Math.atan2(f,d)));var v=u;if(A){var m=p/u+.5|0;m<1&&(m=1),v=p/m}for(var E=0;E+.1*v<p;E+=v){s.push({x:c.x+E*d,y:c.y+E*f,begin:g,end:y,isAnchor:0===E});for(var B=0;B<r.length;B++)s[s.length-1]["isNextIntersection"+B]=h["isNextIntersection"+B],s[s.length-1]["isCurrentIntersection"+B]=h["isCurrentIntersection"+B],h["isNextIntersection"+B]&&0===E&&(r[B].anchorPoint=s[s.length-1])}c=h}var w=st.degreesToRadians(a);c=s[s.length-1];for(var k=0;k<s.length;k++){var C=s[k],b=o(c,C,t);(n||0!==k)&&(c.end=b[0]+w,C.begin=b[1]),c=C}jt(s,t,r);for(var S=r.length-1;S>-1;S--)if(s[r[S].begin]&&s[r[S].end]){r[S].beginCircle=s[r[S].begin],r[S].endCircle=s[r[S].end];var T=Vt(s,t,r[S].begin,r[S].end),M=T.newCircle,U=T.beginPoint,Q=T.endPoint;r[S].newCircle=M,r[S].beginPoint=U,r[S].endPoint=Q}return s=s.filter((function(e){return!e.hide}))}(t,n,a,A);if(0===o.length)return null;for(var s,u,l,f=[],g=[],y=0,v=0;v<o.length;v++){var m=o[v];m.isAnchor&&(s=m,u=void 0,l=void 0,(l=Math.abs(s.begin-s.end))>2*Math.PI&&(l-=2*Math.PI),(!u&&s.begin>s.end||u&&s.end>s.begin)&&(l=2*Math.PI-l),l>1.9*Math.PI&&(m.begin=m.end)),Kt(m.x,m.y,n,m.begin,m.end,!1,null,f,r,i);var B=f.length-y;g[y]=h,g[y+B-1]=d,y+=B}var w=this._createMeshLine(f,e.type,e,g,{capType:p,joinType:p});return w.arcs=o,w.radius=n,w.intersectionObjects=A,i&&(i.applyMatrix4(e.invScaleMatrix),i.translate(e.center),w.boundingPoints=[i.min.clone(),i.max.clone(),i.max.clone(),i.min.clone()],w.boundingPoints[1].y=i.min.y,w.boundingPoints[3].y=i.max.y),w}},{key:"_shiftAnchorsInsideBox",value:function(e,t,n){var r=t[0].clone().sub(t[1]).normalize(),i=t[2].clone().sub(t[1]).normalize(),a=t[0].distanceTo(t[1])/2;if(t[2].distanceTo(t[1])/2<n||a<n)return!1;for(var A=0;A<t.length;A++){var o=t[A],s=n*Math.sign(o.dot(i));o.sub(i.clone().multiplyScalar(s)),s=n*Math.sign(o.dot(r)),o.sub(r.clone().multiplyScalar(s))}return!0}},{key:"getCloudMinimumRadius",value:function(e){var t=this.markupsExtension.renderer.mmToWorldUnitFactor*(this.markupsExtension.viewer.impl.is2d?1:10);return Math.max(3*e,t)}},{key:"destroy",value:function(){for(var e in this.geoCache)this.geoCache[e].dispose();this.geoCache=null}}])&&wa(t.prototype,n),r&&wa(t,r),e}();function Ca(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ba(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ta=Autodesk.Viewing,Ma=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};ba(this,e),this.setGlobalManager(t.globalManager),this.id=n,this.type=r,this.options=a,this.markupsExtension=t,this.materialManager=this.markupsExtension.renderer.materialManager,this.layer=null,this.meshContainer=null,this.strokeMaterial=null,this.fillMaterial=null,this.center=new THREE.Vector3,this.matrix=new THREE.Matrix4,this.invMatrix=new THREE.Matrix4,this.scaleMatrix=new THREE.Matrix4,this.invScaleMatrix=new THREE.Matrix4,this.completed=!1,this.selected=!1,this.inEdit=!1,this.enabled=!0,this.transparent=!1,this.visible=!1,this.hover=!1,this.locked=!1,this.state=this.getDefaultState(),this.state.anchors=this.getDefaultAnchors(),this.state.style=this.getDefaultStyle(),i&&Object.assign(this.state,i),this.state.translation=this.state.translation||new THREE.Vector3,this.state.rotation=this.state.rotation||0,this.state.scale=this.state.scale||new THREE.Vector3(1,1,1),this.editState=lt.cloneDeep(this.state),this.updateMatrix(),this.registerSelectionHandler(),this.creationHandler=sa.getCreationHandler(this.type,this.markupsExtension,this,a)}var t,n,r;return t=e,r=[{key:"createMesh",value:function(e,t){var n=new THREE.Mesh(e,t);return n.frustumCulled=!1,n}}],(n=[{key:"updateMatrix",value:function(){this.scaleMatrix.makeScale(this.editState.scale.x,this.editState.scale.y,this.editState.scale.z),this.matrix.copy(this.scaleMatrix),this.matrix.setPosition(this.editState.translation),this.invMatrix.getInverse(this.matrix),this.invScaleMatrix.getInverse(this.scaleMatrix),this.updateCenter()}},{key:"updateCenter",value:function(){if(0!==this.editState.anchors.length){var e=(new THREE.Vector3).set(-1/0,-1/0,-1/0),t=(new THREE.Vector3).set(1/0,1/0,1/0);this.editState.anchors.forEach((function(n){e=e.max(n),t=t.min(n)})),this.center.x=(e.x+t.x)/2,this.center.y=(e.y+t.y)/2}}},{key:"getDefaultState",value:function(){return{}}},{key:"getDefaultAnchors",value:function(){return[]}},{key:"getDefaultStyle",value:function(){var e;return Ca(e={},c.COLOR,this.markupsExtension.getStyleProperty(c.LAST_COLOR)),Ca(e,c.FONT_SIZE,this.markupsExtension.getStyleProperty(c.FONT_SIZE)),Ca(e,c.FONT_WEIGHT,this.markupsExtension.getStyleProperty(c.FONT_WEIGHT)),Ca(e,c.FONT_FAMILY,this.markupsExtension.getStyleProperty(c.FONT_FAMILY)),Ca(e,c.FONT_STYLE,this.markupsExtension.getStyleProperty(c.FONT_STYLE)),Ca(e,c.FONT_COLOR,this.markupsExtension.getStyleProperty(c.FONT_COLOR)),Ca(e,c.THICKNESS,this.markupsExtension.getStyleProperty(c.THICKNESS)),Ca(e,c.FILL_OPACITY,this.markupsExtension.getStyleProperty(c.FILL_OPACITY)),Ca(e,c.FILL_COLOR,this.markupsExtension.getStyleProperty(c.FILL_COLOR)),Ca(e,c.OPACITY,this.markupsExtension.getStyleProperty(c.OPACITY)),e}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(e){this.state=lt.cloneDeep(e),this.rotatedBoundingBox=null,this.boundingBox=null}},{key:"getEditState",value:function(){return this.editState}},{key:"setEditState",value:function(e,t,n){var r=this.editState;this.editState=t?Object.assign({},e,t):lt.cloneDeep(e),this.updateMatrix(),this.rotatedBoundingBox=null,this.boundingBox=null,this.visible&&this.markupsExtension.renderer&&this.render(t),this.belongsToGroup()&&!this.isLocked()&&this.syncGroup(r,this.editState,t,n)}},{key:"isLocked",value:function(){return this.locked}},{key:"setLocked",value:function(e){this.locked=e}},{key:"render",value:function(e){this.meshContainer||(this.meshContainer=new THREE.Group,this.markupsExtension.renderer.addToScene(this))}},{key:"syncEditState",value:function(){this.setEditState(this.getState())}},{key:"syncState",value:function(){this.setState(this.getEditState())}},{key:"syncGroup",value:function(e,t,n,r){this.markupGroup.rotatedBoundingBox=null,this.markupGroup.boundingBox=null,n&&this.markupGroup.syncGroupMarkups(this,e,t,n,r)}},{key:"select",value:function(){this.layer&&!this.markupsExtension.permissionManager.canEditMarkup(this.layer.layerData)||(this.selected=!0,this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_SELECTED,markup:this}),this.enableEdit(),this.belongsToGroup()&&!this.markupGroup.locked&&this.markupGroup.select(this))}},{key:"deselect",value:function(){this.selected=!1,this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_DESELECTED,markup:this}),this.disableEdit()}},{key:"setVisible",value:function(e,t){(this.visible!==e||t)&&(this.visible=e,this.meshContainer&&(this.meshContainer.visible=e),this.markupsExtension.renderer&&(this.visible?this.render():this.markupsExtension.renderer.invalidate()),this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_VISIBILITY_CHANGED,markup:this,visible:e}))}},{key:"isVisible",value:function(){return this.visible}},{key:"isSelected",value:function(){return this.selected}},{key:"enableEdit",value:function(){this.inEdit=!0,this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_ENABLE_EDIT,markup:this}),this.setDirty()}},{key:"disableEdit",value:function(){this.inEdit=!1,this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_DISABLE_EDIT,markup:this}),this.setDirty()}},{key:"enable",value:function(){this.enabled=!0,this.changeTransparency(!1)}},{key:"disable",value:function(){this.enabled=!1,this.changeTransparency(!0)}},{key:"isEnabled",value:function(){return this.enabled}},{key:"changeTransparency",value:function(e){this.transparent!==e&&(this.transparent=e,this.visible&&this.markupsExtension.renderer&&this.render({style:{}}),this.setDirty())}},{key:"isTransparent",value:function(){return this.transparent}},{key:"setHover",value:function(e){this.hover!==e&&(this.hover=e,this.belongsToGroup()&&!this.markupGroup.locked&&this.markupGroup.setHover(e,this),this.setDirty())}},{key:"isHovered",value:function(){return this.hover}},{key:"isInEdit",value:function(){return this.inEdit}},{key:"setDirty",value:function(){this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_DIRTY,markup:this})}},{key:"isCompleted",value:function(){return this.completed}},{key:"complete",value:function(){this.completed=!0,this.selectWhenCompleted()?this.select():this.setDirty(),this.visible&&this.markupsExtension.renderer&&this.render(),this.markupsExtension.markupsManager.selectLayer(this.layer,!1,!1)}},{key:"selectWhenCompleted",value:function(){return!0}},{key:"registerAnchorHandler",value:function(e){this.anchorHandler=new Hn(this.markupsExtension,this,e)}},{key:"registerTranslationHandler",value:function(e){this.translationHandler=new Sn(this.markupsExtension,this,e)}},{key:"registerRotationHandler",value:function(e){this.rotationHandler=new Kn(this.markupsExtension,this,e)}},{key:"registerScaleHandler",value:function(e){this.scaleHandler=new Jn(this.markupsExtension,this,e)}},{key:"registerSelectionHandler",value:function(e){this.selectionHandler=new vn(this.markupsExtension,this,e)}},{key:"registerTextInputHandler",value:function(e){this.textInputHandler=new dr(this.markupsExtension,this,e)}},{key:"registerDimensionEditHandler",value:function(e){this.dimensionEditHandler=new Br(this.markupsExtension,this,e)}},{key:"applyCameraRotation",value:function(e){var t=this.markupsExtension.renderer.getCameraRotation(),n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(e,t,this.getWorldCenter(),n)}},{key:"applyInverseCameraRotation",value:function(e){var t=this.markupsExtension.renderer.getCameraRotation(),n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(e,-t,this.getWorldCenter(),n)}},{key:"applyInverseRotation",value:function(e){var t=this.getRotation();if(0!==t){var n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(e,-t,this.getWorldCenter(),n)}}},{key:"applyRotation",value:function(e){var t=this.getRotation();if(0!==t){var n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(e,t,this.getWorldCenter(),n)}}},{key:"applyRotationForAnchors",value:function(e){var t=this.getRotation();if(0!==t){var n=this.markupsExtension.renderer.getCameraEyeVector(),r=this.getWorldCenter();e.forEach((function(e){st.applyRotation(e,t,r,n)}))}}},{key:"applyScaleAndTranslation",value:function(e){e.sub(this.center),e.applyMatrix4(this.matrix),e.add(this.center)}},{key:"applyInverseScaleAndTranslation",value:function(e){e.sub(this.center),e.applyMatrix4(this.invMatrix),e.add(this.center)}},{key:"calculateWorldBoundingBox",value:function(e){var t,n=this,r=new THREE.Box3;(t=this.meshLine&&this.meshLine.boundingPoints?lt.cloneDeep(this.meshLine.boundingPoints):lt.cloneDeep(this.editState.anchors)).forEach((function(e){n.applyScaleAndTranslation(e)})),e&&this.applyRotationForAnchors(t),t.forEach((function(e){r.expandByPoint(e)}));var i=this.editState.style[c.THICKNESS]/2;return r.expandByVector(new THREE.Vector3(i,i,0)),r}},{key:"getWorldBoundingBox",value:function(e){return e?(this.rotatedBoundingBox||(this.rotatedBoundingBox=this.calculateWorldBoundingBox(e)),this.rotatedBoundingBox):(this.boundingBox||(this.boundingBox=this.calculateWorldBoundingBox(e)),this.boundingBox)}},{key:"getClientBoundingBox",value:function(e,t){var n=this.getWorldBoundingBox(t).clone();n.min=this.markupsExtension.renderer.worldToClient(n.min),n.max=this.markupsExtension.renderer.worldToClient(n.max);var r=this.markupsExtension.renderer.getCameraEyeVector(),i=n.center(),a=this.markupsExtension.renderer.getCameraRotation();if(st.applyRotation(n.min,a,i,r),st.applyRotation(n.max,a,i,r),st.swapBoundingBoxY(n),e){var A=this.getMarginSize();n.expandByVector(new THREE.Vector3(A,A,0))}return n.min.z=0,n.max.z=0,n}},{key:"getMarginSize",value:function(){return Pe}},{key:"getMinimumSize",value:function(){return Math.max(this.markupsExtension.renderer.sizeFromWorldToClient(this.editState.style[c.THICKNESS]),this.getMarginSize())}},{key:"getCenter",value:function(){return this.center}},{key:"setPosition",value:function(){var e=this.center.clone().add(this.editState.translation);this.meshContainer.position.copy(e)}},{key:"setRotation",value:function(){this.meshContainer.rotation.z=this.editState.rotation*this.markupsExtension.renderer.getCameraEyeVector().z}},{key:"getWorldCenter",value:function(){return this.center.clone().add(this.editState.translation)}},{key:"getClientCenter",value:function(){return this.markupsExtension.renderer.worldToClient(this.getWorldCenter())}},{key:"getRotation",value:function(){return this.editState.rotation}},{key:"getScale",value:function(){return this.editState.scale}},{key:"getAnchors",value:function(){return this.editState.anchors}},{key:"isAnchorHandlingAllowed",value:function(e){return!0}},{key:"getTail",value:function(){return this.editState.anchors[this.editState.anchors.length-1]}},{key:"getHead",value:function(){return this.editState.anchors[0]}},{key:"getStartPointForNextMarkup",value:function(){return new THREE.Vector3}},{key:"intersect",value:function(e){var t=e.clone();this.applyInverseRotation(t);var n=this.markupsExtension.renderer.worldToClient(t),r=this.getClientBoundingBox(!0),i=this.markupsExtension.renderer.getCameraEyeVector(),a=this.markupsExtension.renderer.getCameraRotation();st.applyRotation(n,a,r.center(),i),n.z=0;var A=r.containsPoint(n);if(!A||this.isTextMarkup())return A;if(this.hasFill()&&this.fillMesh&&this.markupsExtension.renderer.raycaster.intersectObject(this.fillMesh).length>0)return!0;var o=this.strokeMaterial.uniforms.lineWidth.value/2;return o+=this.markupsExtension.renderer.sizeFromClientToWorld(Ke),this.meshLine.isPointNear(e,o*o,this.meshContainer.matrixWorld)}},{key:"isGroupMarkup",value:function(){return!1}},{key:"belongsToGroup",value:function(){return!!this.markupGroup}},{key:"isTextMarkup",value:function(){return!1}},{key:"isGeometricMarkup",value:function(){return!0}},{key:"isWithFillMarkup",value:function(){return!1}},{key:"isPoint",value:function(){return this.editState.anchors.length<2||ka.areAllAnchorsEqual(this.editState.anchors)}},{key:"hasFill",value:function(){return this.isWithFillMarkup()&&!this.options.fillNotAllowed&&this.editState.style[c.FILL_OPACITY]>0&&this.editState.style[c.FILL_COLOR]!==o.NO_COLOR}},{key:"needsMiter",value:function(){return!0}},{key:"showPath",value:function(){return!1}},{key:"hasThicknessChanged",value:function(){return this.strokeMaterial&&this.strokeMaterial.uniforms.lineWidth.value!==this.editState.style[c.THICKNESS]}},{key:"removeFill",value:function(){this.fillMaterial&&(this.materialManager.removeMaterial(this.fillMaterial),this.fillMaterial=null),this.fillMesh&&(this.meshContainer.remove(this.fillMesh),this.fillMesh=null)}},{key:"remove",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.markupsExtension.renderer&&(this.strokeMaterial&&(this.materialManager.removeMaterial(this.strokeMaterial),this.strokeMaterial=null),this.strokeMesh&&(this.meshContainer.remove(this.strokeMesh),this.strokeMesh=null),this.meshLine&&!this.markupsExtension.renderer.geometryManager.isCachedGeometry(this.meshLine)&&(this.meshLine.dispose(),this.meshLine=null),this.fillMaterial&&(this.materialManager.removeMaterial(this.fillMaterial),this.fillMaterial=null),this.fillMesh&&(this.markupsExtension.renderer.geometryManager.isCachedGeometry(this.fillMesh.geometry)||this.fillMesh.traverse((function(e){e.geometry&&e.geometry.dispose()})),this.meshContainer.remove(this.fillMesh),this.fillMesh=null),this.meshContainer&&(this.markupsExtension.renderer.removeFromScene(this),this.meshContainer=null),e&&this.markupsExtension.markupsManager.dispatchEvent({type:a.MARKUP_REMOVED,markup:this}))}},{key:"destroy",value:function(){this.anchorHandler&&(this.anchorHandler.destroy(),this.anchorHandler=null),this.translationHandler&&(this.translationHandler.destroy(),this.translationHandler=null),this.rotationHandler&&(this.rotationHandler.destroy(),this.rotationHandler=null),this.scaleHandler&&(this.scaleHandler.destroy(),this.scaleHandler=null),this.selectionHandler&&(this.selectionHandler.destroy(),this.selectionHandler=null),this.textInputHandler&&(this.textInputHandler.destroy(),this.textInputHandler=null),this.markupsExtension=null,this.state=null,this.editState=null,this.layer=null}}])&&Sa(t.prototype,n),r&&Sa(t,r),e}();function Ua(e){return(Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fa(e,t,n){return(Fa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=La(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _a(e,t){return(_a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ha(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=La(e);if(t){var i=La(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ra(this,n)}}function Ra(e,t){return!t||"object"!==Ua(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function La(e){return(La=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Ta.GlobalManagerMixin.call(Ma.prototype),Ma.singleClickMarkup=!1,Ma.withSnappingMarkup=!1,Ma.useTimerBeforeSelection=!1;var Da=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_a(e,t)}(a,e);var t,n,r,i=Ha(a);function a(e,t,n,r){var A,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return Qa(this,a),(A=i.call(this,e,t,n,r,o)).registerTranslationHandler(),A.registerAnchorHandler(),A}return t=a,(n=[{key:"createLine",value:function(){this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Ma.createMesh(this.meshLine.geometry,this.strokeMaterial),this.setPosition(),this.meshContainer.add(this.strokeMesh)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;Fa(La(a.prototype),"render",this).call(this);var t=e.anchors;if(t&&t.length>1&&this.createLine(),this.strokeMesh){if(e.style){var n=this.hasThicknessChanged(),r=this.materialManager.editMaterial(this.strokeMaterial,this,!1);r&&(this.strokeMaterial=r,this.strokeMesh.material=r,n&&this.createLine())}e.translation&&this.setPosition(),this.markupsExtension.renderer.invalidate()}}}])&&xa(t.prototype,n),r&&xa(t,r),a}(Ma);function Ia(e){return(Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Na(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pa(e,t){return(Pa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ja(e);if(t){var i=ja(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Va(this,n)}}function Va(e,t){return!t||"object"!==Ia(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ja(e){return(ja=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Da.withSnappingMarkup=!0;var Ga=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pa(e,t)}(a,e);var t,n,r,i=Ka(a);function a(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Oa(this,a),i.call(this,e,t,y,n,r)}return t=a,(n=[{key:"getTail",value:function(){return this.editState.anchors[0]}},{key:"getHead",value:function(){return this.editState.anchors[1]}},{key:"getStartPointForNextMarkup",value:function(){return this.getTail().clone()}},{key:"isAnchorHandlingAllowed",value:function(e){return!(this.options.headHandlingNotAllowed&&e===this.getHead()||this.options.tailHandlingNotAllowed&&e===this.getTail())}}])&&Na(t.prototype,n),r&&Na(t,r),a}(Da);function za(e){return(za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ya(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xa(e,t,n){return(Xa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$a(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Ja(e,t){return(Ja=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$a(e);if(t){var i=$a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Za(this,n)}}function Za(e,t){return!t||"object"!==za(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $a(e){return($a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ja(e,t)}(a,e);var t,n,r,i=qa(a);function a(e,t,n){var r,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Ya(this,a),(r=i.call(this,e,t,k,n,A)).registerTranslationHandler(),r.registerAnchorHandler(),r.registerRotationHandler(),r.registerScaleHandler(),r}return t=a,(n=[{key:"getDefaultState",value:function(){return{closed:!1}}},{key:"createPolyline",value:function(){if(this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.fillMesh&&(this.meshContainer.remove(this.fillMesh),this.fillMesh=null),this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Ma.createMesh(this.meshLine.geometry,this.strokeMaterial),this.hasFill()&&!this.isPoint()&&Xt(this.editState.anchors)){this.fillMaterial||(this.fillMaterial=this.materialManager.addMaterial(this,!0));var e=this.markupsExtension.renderer.geometryManager.getFillGeometry(this);e&&(this.fillMesh=Ma.createMesh(e,this.fillMaterial),this.meshContainer.add(this.fillMesh))}this.meshContainer.add(this.strokeMesh),this.setPosition(),this.setRotation()}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;Xa($a(a.prototype),"render",this).call(this);var t=e.anchors;if((t&&t.length>0||this.editState.anchors.length>0&&e.scale)&&this.createPolyline(),this.strokeMesh){if(e.style){var n=this.materialManager.editMaterial(this.strokeMaterial,this,!1);n&&(this.strokeMaterial=n,this.strokeMesh.material=n);var r=!1;if(this.hasFill())if(this.fillMesh){var i=this.materialManager.editMaterial(this.fillMaterial,this,!0);i&&(this.fillMaterial=i,this.fillMesh.material=i)}else r=!0;else this.removeFill();r&&this.createPolyline()}e.translation&&this.setPosition(),void 0!==e.rotation&&this.setRotation(),this.markupsExtension.renderer.invalidate()}}},{key:"isWithFillMarkup",value:function(){return this.editState.closed}},{key:"showPath",value:function(){return!0}}])&&Wa(t.prototype,n),r&&Wa(t,r),a}(Ma);function tA(e){return(tA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iA(e,t,n){return(iA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sA(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function aA(e,t){return(aA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sA(e);if(t){var i=sA(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return oA(this,n)}}function oA(e,t){return!t||"object"!==tA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sA(e){return(sA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}eA.withSnappingMarkup=!0;var uA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aA(e,t)}(a,e);var t,n,r,i=AA(a);function a(e,t,n){var r,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return nA(this,a),(r=i.call(this,e,t,C,n,A)).registerTranslationHandler(),r.registerAnchorHandler(),r.registerRotationHandler(),r.registerScaleHandler(),r}return t=a,(n=[{key:"getDefaultState",value:function(){return{closed:!1}}},{key:"needsMiter",value:function(){return!1}},{key:"createCloud",value:function(){if(this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.fillMesh&&(this.meshContainer.remove(this.fillMesh),this.fillMesh=null),this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.meshLine.type===m){var e=this.markupsExtension.renderer.getNormaStrokeWidth();this.meshContainer.scale.x=e,this.meshContainer.scale.y=e}else this.meshContainer.scale.x=1,this.meshContainer.scale.y=1;this.strokeMesh=Ma.createMesh(this.meshLine.geometry,this.strokeMaterial),this.hasFill()&&!this.isPoint()&&Xt(this.editState.anchors)&&this.createFillMesh(),this.meshContainer.add(this.strokeMesh),this.setPosition(),this.setRotation()}},{key:"createFillMesh",value:function(){var e=this,t=this.markupsExtension.renderer.geometryManager.getFillGeometry(this);t.innerGeometry&&(this.fillMaterial||(this.fillMaterial=this.materialManager.addMaterial(this,!0)),this.fillMesh=Ma.createMesh(t.innerGeometry,this.fillMaterial),this.meshContainer.add(this.fillMesh),t.arcGeometry&&this.meshLine.arcs.forEach((function(n){var r=Ma.createMesh(t.arcGeometry,e.fillMaterial);e.fillMesh.add(r),r.position.x=n.x,r.position.y=n.y})),t.fillGapGeometries&&t.fillGapGeometries.forEach((function(t){var n=Ma.createMesh(t,e.fillMaterial);e.fillMesh.add(n)})))}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;iA(sA(a.prototype),"render",this).call(this);var t=e.anchors;if((t&&t.length>0||this.editState.anchors.length>0&&e.scale)&&this.createCloud(),this.strokeMesh){if(e.style){var n=this.hasThicknessChanged(),r=this.materialManager.editMaterial(this.strokeMaterial,this,!1);if(r&&(this.strokeMaterial=r,this.strokeMesh.material=r),this.hasFill())if(this.fillMesh){var i=this.materialManager.editMaterial(this.fillMaterial,this,!0);i&&(this.fillMaterial=i,this.fillMesh.traverse((function(e){return e.material=i})))}else n=!0;else this.removeFill();n&&this.createCloud()}e.translation&&this.setPosition(),void 0!==e.rotation&&this.setRotation(),this.markupsExtension.renderer.invalidate()}}},{key:"showPath",value:function(){return!0}},{key:"isWithFillMarkup",value:function(){return this.editState.closed}}])&&rA(t.prototype,n),r&&rA(t,r),a}(Ma);function cA(e){return(cA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dA(e,t,n){return(dA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yA(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function fA(e,t){return(fA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yA(e);if(t){var i=yA(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gA(this,n)}}function gA(e,t){return!t||"object"!==cA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yA(e){return(yA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}uA.withSnappingMarkup=!0;var vA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fA(e,t)}(a,e);var t,n,r,i=pA(a);function a(e,t,n,r){var A,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return lA(this,a),(A=i.call(this,e,t,n,r,o)).width=0,A.height=0,A.registerTranslationHandler(),A.registerRotationHandler(),A.registerScaleHandler(),A}return t=a,(n=[{key:"setSize",value:function(){var e=this.markupsExtension.renderer.getNormaStrokeWidth();this.meshContainer.scale.x=Math.max(Math.abs(this.width*this.editState.scale.x),e)*Math.sign(this.editState.scale.x),this.meshContainer.scale.y=Math.max(Math.abs(this.height*this.editState.scale.y),e)*Math.sign(this.editState.scale.y)}},{key:"createShape",value:function(e){this.strokeMesh||(this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Ma.createMesh(this.meshLine.geometry,this.strokeMaterial),this.meshContainer.add(this.strokeMesh),this.meshContainer.rotation.z=-this.markupsExtension.renderer.getCameraRotation()*this.markupsExtension.renderer.getCameraEyeVector().z),!this.fillMesh&&this.hasFill()&&this.createFill(),this.width=e[0].distanceTo(e[1]),this.height=e[2].distanceTo(e[1]),this.setPosition(),this.setSize()}},{key:"createFill",value:function(){this.fillGeometry=this.markupsExtension.renderer.geometryManager.getFillGeometry(this),this.fillGeometry&&(this.fillMaterial||(this.fillMaterial=this.materialManager.addMaterial(this,!0)),this.fillMesh=Ma.createMesh(this.fillGeometry,this.fillMaterial),this.meshContainer.add(this.fillMesh),this.meshContainer.add(this.strokeMesh))}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;dA(yA(a.prototype),"render",this).call(this);var t=e.anchors;if(t&&t.length>1&&this.createShape(t),this.strokeMesh){if(e.style){var n=this.materialManager.editMaterial(this.strokeMaterial,this,!1);if(n&&(this.strokeMaterial=n,this.strokeMesh.material=n),this.hasFill())if(this.fillMesh){var r=this.materialManager.editMaterial(this.fillMaterial,this,!0);r&&(this.fillMaterial=r,this.fillMesh.material=r)}else this.createFill();else this.removeFill()}e.translation&&this.setPosition(),void 0!==e.rotation&&this.setRotation(),e.scale&&this.setSize(),this.markupsExtension.renderer.invalidate()}}},{key:"isWithFillMarkup",value:function(){return!0}}])&&hA(t.prototype,n),r&&hA(t,r),a}(Ma);function mA(e){return(mA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wA(e,t){return(wA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bA(e);if(t){var i=bA(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return CA(this,n)}}function CA(e,t){return!t||"object"!==mA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bA(e){return(bA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var SA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wA(e,t)}(a,e);var t,n,r,i=kA(a);function a(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return EA(this,a),i.call(this,e,t,v,n,r)}return t=a,(n=[{key:"isWithFillMarkup",value:function(){return!0}}])&&BA(t.prototype,n),r&&BA(t,r),a}(vA);function TA(e){return(TA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function QA(e,t){return(QA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_A(e);if(t){var i=_A(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return FA(this,n)}}function FA(e,t){return!t||"object"!==TA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _A(e){return(_A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var HA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QA(e,t)}(a,e);var t,n,r,i=xA(a);function a(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return MA(this,a),i.call(this,e,t,m,n,r)}return t=a,(n=[{key:"isWithFillMarkup",value:function(){return!0}},{key:"needsMiter",value:function(){return!1}}])&&UA(t.prototype,n),r&&UA(t,r),a}(vA);function RA(e){return(RA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IA(e,t,n){return(IA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KA(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function OA(e,t){return(OA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=KA(e);if(t){var i=KA(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return PA(this,n)}}function PA(e,t){return!t||"object"!==RA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KA(e){return(KA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var VA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OA(e,t)}(a,e);var t,n,r,i=NA(a);function a(e,t,n){var r,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return LA(this,a),(r=i.call(this,e,t,E,n,A)).registerTranslationHandler(),A.rotationNotAllowed||r.registerRotationHandler(),r.registerScaleHandler(),r}return t=a,(n=[{key:"createCloud",value:function(){if(this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.fillMesh&&(this.meshContainer.remove(this.fillMesh),this.fillMesh=null),this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Ma.createMesh(this.meshLine.geometry,this.strokeMaterial),this.hasFill()&&!this.isPoint()&&this.createFillMesh(),this.meshContainer.add(this.strokeMesh),this.meshLine.type===m){var e=this.editState.anchors[0].distanceTo(this.editState.anchors[1]),t=this.editState.anchors[2].distanceTo(this.editState.anchors[1]),n=this.markupsExtension.renderer.getNormaStrokeWidth();this.meshContainer.scale.x=Math.max(Math.abs(e*this.editState.scale.x),n)*Math.sign(this.editState.scale.x),this.meshContainer.scale.y=Math.max(Math.abs(t*this.editState.scale.y),n)*Math.sign(this.editState.scale.y),this.isCompleted()?this.setRotation():this.meshContainer.rotation.z=-this.markupsExtension.renderer.getCameraRotation()*this.markupsExtension.renderer.getCameraEyeVector().z}else this.meshContainer.scale.x=1,this.meshContainer.scale.y=1,this.setRotation();this.setPosition()}},{key:"createFillMesh",value:function(){var e=this,t=this.markupsExtension.renderer.geometryManager.getFillGeometry(this);t.innerGeometry&&(this.fillMaterial||(this.fillMaterial=this.materialManager.addMaterial(this,!0)),this.fillMesh=Ma.createMesh(t.innerGeometry,this.fillMaterial),this.meshContainer.add(this.fillMesh),t.arcGeometry&&this.meshLine.arcs.forEach((function(n){var r=Ma.createMesh(t.arcGeometry,e.fillMaterial);e.fillMesh.add(r),r.position.x=n.x,r.position.y=n.y})))}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;IA(KA(a.prototype),"render",this).call(this);var t=e.anchors;if((t&&t.length>1||this.editState.anchors.length>1&&e.scale)&&this.createCloud(),this.strokeMesh){if(e.style){var n=this.hasThicknessChanged(),r=this.materialManager.editMaterial(this.strokeMaterial,this,!1);if(r&&(this.strokeMaterial=r,this.strokeMesh.material=r),this.hasFill())if(this.fillMesh){var i=this.materialManager.editMaterial(this.fillMaterial,this,!0);i&&(this.fillMaterial=i,this.fillMesh.traverse((function(e){return e.material=i})))}else n=!0;else this.removeFill();n&&this.createCloud()}e.translation&&this.setPosition(),void 0!==e.rotation&&this.setRotation(),this.markupsExtension.renderer.invalidate()}}},{key:"isWithFillMarkup",value:function(){return!0}},{key:"needsMiter",value:function(){return!1}}])&&DA(t.prototype,n),r&&DA(t,r),a}(Ma);function jA(e){return(jA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YA(e,t,n){return(YA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qA(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function WA(e,t){return(WA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qA(e);if(t){var i=qA(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return JA(this,n)}}function JA(e,t){return!t||"object"!==jA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qA(e){return(qA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}VA.withSnappingMarkup=!0;var ZA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WA(e,t)}(a,e);var t,n,r,i=XA(a);function a(e,t,n,r){var A,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return GA(this,a),(A=i.call(this,e,t,n,r,o)).registerTranslationHandler(),A.registerRotationHandler(),A.registerScaleHandler(),A}return t=a,(n=[{key:"selectWhenCompleted",value:function(){return!1}},{key:"needsMiter",value:function(){return!0}},{key:"createPen",value:function(){this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.strokeMaterial||(this.strokeMaterial=this.materialManager.addMaterial(this,!1)),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Ma.createMesh(this.meshLine.geometry,this.strokeMaterial),this.meshContainer.add(this.strokeMesh),this.setPosition(),this.setRotation()}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;YA(qA(a.prototype),"render",this).call(this);var t=e.anchors;if((t&&t.length>0||this.editState.anchors.length>0&&e.scale)&&this.createPen(),this.strokeMesh){if(e.style){var n=this.materialManager.editMaterial(this.strokeMaterial,this,!1);n&&(this.strokeMaterial=n,this.strokeMesh.material=n)}e.translation&&this.setPosition(),void 0!==e.rotation&&this.setRotation(),this.markupsExtension.renderer.invalidate()}}}])&&zA(t.prototype,n),r&&zA(t,r),a}(Ma);function $A(e){return($A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function to(e,t){return(to=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function no(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=io(e);if(t){var i=io(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ro(this,n)}}function ro(e,t){return!t||"object"!==$A(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function io(e){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}ZA.singleClickMarkup=!0,ZA.useTimerBeforeSelection=!0;var ao=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&to(e,t)}(n,e);var t=no(n);function n(e,r,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return eo(this,n),t.call(this,e,r,B,i,a)}return n}(ZA);function Ao(e){return(Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function so(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uo(e,t,n){return(uo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fo(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function co(e,t){return(co=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fo(e);if(t){var i=fo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ho(this,n)}}function ho(e,t){return!t||"object"!==Ao(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fo(e){return(fo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var po=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&co(e,t)}(a,e);var t,n,r,i=lo(a);function a(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return oo(this,a),i.call(this,e,t,w,n,r)}return t=a,(n=[{key:"getDefaultStyle",value:function(){var e=uo(fo(a.prototype),"getDefaultStyle",this).call(this);return e[c.OPACITY]=he,e}}])&&so(t.prototype,n),r&&so(t,r),a}(ZA);function go(e){return(go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mo(e,t,n){return(mo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ko(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Eo(e,t){return(Eo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ko(e);if(t){var i=ko(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return wo(this,n)}}function wo(e,t){return!t||"object"!==go(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ko(e){return(ko=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Co=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eo(e,t)}(a,e);var t,n,r,i=Bo(a);function a(e,t,n){var r,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return yo(this,a),(r=i.call(this,e,t,S,n,A)).registerTranslationHandler(),r.registerScaleHandler({onlyHorizontal:!0}),r.registerTextInputHandler(),A.rotationNotAllowed||r.registerRotationHandler(),r}return t=a,(n=[{key:"getDefaultState",value:function(){return{text:"Default Text",isFrameUsed:!0,frameType:this.options.frameType?this.options.frameType:v}}},{key:"shouldRenderFrame",value:function(){return this.editState.isFrameUsed||this.hasFill()}},{key:"setVisible",value:function(e,t){mo(ko(a.prototype),"setVisible",this).call(this,e,t),this.frameMarkup?this.frameMarkup.setVisible(e,t):this.shouldRenderFrame()&&e&&this.renderFrame()}},{key:"render",value:function(){arguments.length>0&&void 0!==arguments[0]||this.editState,this.markupsExtension.renderer.textRenderer.renderMarkup(this),this.shouldRenderFrame()?this.renderFrame():(this.removeFrame(),this.setDirty())}},{key:"renderFrame",value:function(){this.frameMarkup||(this.frameMarkup=new ws[this.editState.frameType](this.markupsExtension,this.id),this.frameMarkup.layer=this.layer,this.frameMarkup.transparent=this.isTransparent(),this.frameMarkup.editState.anchors=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]);var e=this.frameMarkup.editState;e.style[c.THICKNESS]=this.editState.style[c.THICKNESS],e.style[c.OPACITY]=this.editState.style[c.OPACITY],e.style[c.FILL_COLOR]=this.editState.style[c.FILL_COLOR],e.style[c.FILL_OPACITY]=this.editState.style[c.FILL_OPACITY],this.editState.isFrameUsed?(e.style[c.COLOR]=this.editState.style[c.COLOR],e.style[c.OPACITY]=1):(e.style[c.COLOR]=this.editState.style[c.FILL_COLOR],e.style[c.OPACITY]=this.editState.style[c.FILL_OPACITY]);var t=this.getWorldBoundingBox(),n=e.style[c.THICKNESS]/2;this.frameMarkup.editState.anchors[0].set(t.min.x+n,t.min.y+n,0),this.frameMarkup.editState.anchors[1].set(t.max.x-n,t.min.y+n,0),this.frameMarkup.editState.anchors[2].set(t.max.x-n,t.max.y-n,0),this.frameMarkup.editState.anchors[3].set(t.min.x+n,t.max.y-n,0),e.rotation=this.editState.rotation,this.frameMarkup.updateMatrix(),this.frameMarkup.render()}},{key:"removeFrame",value:function(){this.frameMarkup&&(this.frameMarkup.remove(!1),this.frameMarkup=null)}},{key:"remove",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.removeFrame(),mo(ko(a.prototype),"remove",this).call(this,e)}},{key:"changeTransparency",value:function(e){this.frameMarkup&&(this.frameMarkup.transparent=e),mo(ko(a.prototype),"changeTransparency",this).call(this,e)}},{key:"resetFrameBoundingBox",value:function(){this.frameMarkup&&(this.frameMarkup.rotatedBoundingBox=null,this.frameMarkup.boundingBox=null)}},{key:"setState",value:function(e){this.resetFrameBoundingBox(),mo(ko(a.prototype),"setState",this).call(this,e)}},{key:"setEditState",value:function(e,t,n){if(t&&t.style){var r=Object.assign({},e,t),i=this.markupsExtension.renderer.getFontToWorldScale(),A=this.getTextWidthInFontScale().width,s=this.getTextStyle(this.editState),u=this.getTextStyle(r);s.width="".concat(A,"px"),u.width="".concat(A,"px");var l=Pt(this.editState.text,s),h=Pt(r.text,u);if(h.height!==l.height){var d=(h.height-l.height)*i,f=this.getBoundingBoxVerticalTranslation(d);if(this.shouldRenderFrame()){var p=this.calculateFrameSize(this.editState.style[c.FONT_SIZE]),g=this.calculateFrameSize(r.style[c.FONT_SIZE])-p,y=new THREE.Vector3(g,-g,0);this._rotateTranslationVector(y),f.add(y)}if(t.translation)t.translation.add(f);else{var v=this.getEditState().translation;v.add(f),t.translation=v}}t.isFrameUsed=r.style[c.COLOR]!==o.NO_COLOR}this.resetFrameBoundingBox(),mo(ko(a.prototype),"setEditState",this).call(this,e,t,n)}},{key:"getTextWidthInFontScale",value:function(){var e=Autodesk.Viewing.isSafari()||Autodesk.Viewing.isIOSDevice(),t=this.markupsExtension.renderer.getFontToWorldScale(),n=this.getWorldBoundingBoxTextOnly().size().x/t;return{preciseWidth:n,width:e?n:Math.ceil(n)||1}}},{key:"getBoundingBoxVerticalTranslation",value:function(e){var t=new THREE.Vector3(0,-e/2,0);return this._rotateTranslationVector(t),t}},{key:"_rotateTranslationVector",value:function(e){var t=this.getRotation();if(0!==t){var n=this.markupsExtension.renderer.getCameraEyeVector();st.applyRotation(e,t,new THREE.Vector3,n)}}},{key:"_rotateBoundingBox",value:function(e){var t=this.getRotation();if(0===t)return e;var n=e.center(),r=e.size(),i=this.markupsExtension.renderer.getCameraEyeVector(),a=new THREE.Box3;return[e.min,e.min.clone().add(new THREE.Vector3(r.x,0,0)),e.max,e.min.clone().add(new THREE.Vector3(0,r.y,0))].forEach((function(e){st.applyRotation(e,t,n,i),a.expandByPoint(e)})),a}},{key:"_calculateWorldBoundingBoxText",value:function(){var e=this,t=new THREE.Box3,n=lt.cloneDeep(this.editState.anchors);n.forEach((function(t){e.applyScaleAndTranslation(t)})),n.forEach((function(e){t.expandByPoint(e)}));var r=t.center(),i=this.getTextStyle(),a=this.markupsExtension.renderer.getFontToWorldScale(),A=Pt("A",i);t.size().x<A.width*a&&(t.min.x=r.x,t.max.x=r.x,t.expandByVector(new THREE.Vector3(A.width*a/2,0,0)));var o=Math.ceil(t.size().x/a);return i.width="".concat(o,"px"),A=Pt(this.editState.text,i),t.min.y=r.y,t.max.y=r.y,t.expandByVector(new THREE.Vector3(0,A.height*a/2,0)),t}},{key:"calculateWorldBoundingBox",value:function(e){var t=this._calculateWorldBoundingBoxText();if(this.shouldRenderFrame()){var n=this.getWorldFrameSize();t.expandByVector(new THREE.Vector3(n,n,0))}return e?this._rotateBoundingBox(t):t}},{key:"calculateFrameSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.editState.style[c.THICKNESS],n=this.markupsExtension.renderer.getFontToWorldScale(),r=e*n/2;return this.editState.isFrameUsed?this.editState.frameType===E&&(t+=this.markupsExtension.renderer.geometryManager.getCloudMinimumRadius(t)/2):t=0,r+t}},{key:"getWorldFrameSize",value:function(){return this.calculateFrameSize(this.editState.style[c.FONT_SIZE])}},{key:"getClientFrameSize",value:function(){var e=this.getWorldFrameSize();return this.markupsExtension.renderer.sizeFromWorldToClient(e)}},{key:"getWorldBoundingBoxTextOnly",value:function(e){if(!this.shouldRenderFrame())return this.getWorldBoundingBox(e).clone();var t=this.getWorldBoundingBox(!1).clone(),n=this.getWorldFrameSize();return t.expandByVector(new THREE.Vector3(-n,-n,0)),e?this._rotateBoundingBox(t):t}},{key:"getClientBoundingBoxTextOnly",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getWorldBoundingBoxTextOnly(e);return n.min=this.markupsExtension.renderer.worldToClient(n.min),n.max=this.markupsExtension.renderer.worldToClient(n.max),t&&st.swapBoundingBoxY(n),n}},{key:"getTextStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getEditState(),t=e.style,n={};return n.color=t[c.FONT_COLOR],n.fontFamily=t[c.FONT_FAMILY],n.opacity=t[c.OPACITY]*(this.isTransparent()?Ye:1),n.fontSize="".concat(t[c.FONT_SIZE],"px"),n.fontWeight=t[c.FONT_WEIGHT],n.fontStyle=t[c.FONT_STYLE],n.whiteSpace=e.isSingleLine?"nowrap":"pre-wrap",n.lineHeight=1,n.backgroundColor=null,n}},{key:"getMinimumSize",value:function(){var e=mo(ko(a.prototype),"getMinimumSize",this).call(this),t=this.getTextStyle(),n=Pt("A",t),r=this.markupsExtension.renderer.getFontToWorldScale();return Math.max(this.markupsExtension.renderer.sizeFromWorldToClient(n.width*r+2*this.getWorldFrameSize()),e)}},{key:"isTextMarkup",value:function(){return!0}},{key:"isGeometricMarkup",value:function(){return!1}},{key:"isWithFillMarkup",value:function(){return!0}},{key:"getStartPointForNextMarkup",value:function(){return this.getWorldBoundingBox().center().clone()}}])&&vo(t.prototype,n),r&&vo(t,r),a}(Ma);function bo(e){return(bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function So(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function To(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mo(e,t,n){return(Mo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_o(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Uo(e,t){return(Uo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_o(e);if(t){var i=_o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xo(this,n)}}function xo(e,t){return!t||"object"!==bo(t)&&"function"!=typeof t?Fo(e):t}function Fo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _o(e){return(_o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Co.singleClickMarkup=!0;var Ho=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uo(e,t)}(a,e);var t,n,r,i=Qo(a);function a(e,t,n){var r,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};So(this,a),(r=i.call(this,e,t,U,n,A)).markupsExtension.viewer.impl.is2d&&r.registerDimensionEditHandler(),r.textMarkup=new Co(e,t),r.textMarkup.editState.isFrameUsed=!1,r.registerTextInputHandler({singleLine:!0,onEmptyTextMarkup:r.onEmptyTextMarkup.bind(Fo(r)),submitChanges:r.onSubmitChanges.bind(Fo(r))}),r.getTextStyle=r.textMarkup.getTextStyle.bind(r.textMarkup);var o=r.textInputHandler.editStart;r.textInputHandler.editStart=function(){o.bind(r.textInputHandler)(),r.onTextMarkupEditStart()};var s=r.textInputHandler.editEnd;return r.textInputHandler.editEnd=function(){s.bind(r.textInputHandler)(),r.onTextMarkupEditEnd()},r.textMarkup.textInputHandler=r.textInputHandler,r}return t=a,(n=[{key:"setVisible",value:function(e,t){Mo(_o(a.prototype),"setVisible",this).call(this,e,t),this.textMarkup.setVisible(e,t)}},{key:"setState",value:function(e){Mo(_o(a.prototype),"setState",this).call(this,e),this.textMarkup.rotatedBoundingBox=null,this.textMarkup.boundingBox=null,this.textMarkup.resetFrameBoundingBox()}},{key:"setEditState",value:function(e,t,n){this.textMarkup.rotatedBoundingBox=null,this.textMarkup.boundingBox=null,this.textMarkup.resetFrameBoundingBox(),Mo(_o(a.prototype),"setEditState",this).call(this,e,t,n)}},{key:"createDimension",value:function(){this.strokeMesh&&this.meshContainer.remove(this.strokeMesh),this.strokeMaterial||(this.editState.style[c.THICKNESS]*=Ge,this.strokeMaterial=this.materialManager.addMaterial(this,!1),this.editState.style[c.THICKNESS]/=Ge),this.meshLine=this.markupsExtension.renderer.geometryManager.getStrokeGeometry(this),this.strokeMesh=Ma.createMesh(this.meshLine.geometry,this.strokeMaterial),this.meshContainer.add(this.strokeMesh),this.setPosition()}},{key:"calculateWorldBoundingBox",value:function(e){var t=Mo(_o(a.prototype),"calculateWorldBoundingBox",this).call(this,e),n=this.textMarkup.calculateWorldBoundingBox(!0);return t.union(n)}},{key:"renderText",value:function(){var e=this.getEditState(),t=e.anchors,n=e.text,r=e.style,i=lt.cloneDeep(r);i[c.FONT_SIZE]*=ze,this.textMarkup.enabled=this.enabled,this.textMarkup.transparent=this.isTransparent(),this.textMarkup.editState.style=i,this.textMarkup.editState.text=n,this.textMarkup.editState.isSingleLine=!0;var a=t[0].clone().add(t[1]).multiplyScalar(.5);this.applyScaleAndTranslation(a),this.textMarkup.creationHandler.calculateAnchorsByCenterPoint(a);var A=this.markupsExtension.renderer.getCameraRotation(),o=this.markupsExtension.renderer.getCameraEyeVector(),s=this.textMarkup.editState.anchors;s.forEach((function(e){st.applyRotation(e,A,a,o)}));var u=st.getSignedAngle(this.markupsExtension.renderer.getCameraRightVector(),t[1].clone().sub(t[0]),this.markupsExtension.renderer.getCameraEyeVector());Math.abs(u)>Math.PI/2&&(u+=Math.PI),this.textMarkup.editState.rotation=u-A;var l=s[1].clone(),h=s[2].clone();st.applyRotation([l,h],this.textMarkup.editState.rotation,a,o);var d=this.editState.style[c.THICKNESS]*Ge*je,f=h.clone().sub(l),p=f.clone().normalize().multiplyScalar(d).add(f.multiplyScalar(.5));s.forEach((function(e){e.add(p)})),this.textMarkup.render()}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editState;Mo(_o(a.prototype),"render",this).call(this);var t=e.anchors;if(t&&t.length>1&&this.createDimension(),this.strokeMesh){if(e.style){this.editState.style[c.THICKNESS]*=Ge;var n=this.hasThicknessChanged(),r=this.materialManager.editMaterial(this.strokeMaterial,this,!1);this.editState.style[c.THICKNESS]/=Ge,r&&(this.strokeMaterial=r,this.strokeMesh.material=r,n&&this.createDimension())}e.translation&&(this.createDimension(),this.setPosition()),this.renderText(),this.markupsExtension.renderer.invalidate()}}},{key:"isTextMarkup",value:function(){return!0}},{key:"isWithFillMarkup",value:function(){return!0}},{key:"onEmptyTextMarkup",value:function(){this.markupsExtension.markupsManager.actionManager.undo();var e=this.creationHandler.getDistance();this.creationHandler.updateEditState({text:e}),this.creationHandler.submitChanges()}},{key:"onSubmitChanges",value:function(){this.textInputHandler.submitChanges(),this.hasChanges=!0}},{key:"remove",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.textMarkup.remove(!1),Mo(_o(a.prototype),"remove",this).call(this,e)}},{key:"onTextMarkupEditStart",value:function(){var e=this.textMarkup.editState.text;"("===e[0]&&")"===e[e.length-1]&&(e=e.slice(1,e.length-1)),this.hasChanges=!1,this.creationHandler.updateEditState({text:e})}},{key:"onTextMarkupEditEnd",value:function(){var e=this.textMarkup.editState.text;"("===e[0]&&")"===e[e.length-1]&&(e=e.slice(1,e.length-1)),""!==e&&(this.hasChanges?(this.markupsExtension.markupsManager.actionManager.undo(),this.creationHandler.updateEditState({text:"(".concat(e,")")}),this.creationHandler.submitChanges()):e!==this.creationHandler.getDistance()&&this.creationHandler.updateEditState({text:"(".concat(e,")")}))}}])&&To(t.prototype,n),r&&To(t,r),a}(Ma);function Ro(e){return(Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Do(e,t){return(Do=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Io(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=No(e);if(t){var i=No(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Oo(this,n)}}function Oo(e,t){return!t||"object"!==Ro(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function No(e){return(No=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Ho.withSnappingMarkup=!0;var Po=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Do(e,t)}(n,e);var t=Io(n);function n(e,r,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Lo(this,n),t.call(this,e,r,Q,i,a)}return n}(Da);function Ko(e){return(Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jo(e,t,n){return(jo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Wo(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Go(e,t){return(Go=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Wo(e);if(t){var i=Wo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yo(this,n)}}function Yo(e,t){return!t||"object"!==Ko(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wo(e){return(Wo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xo(e){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zo(e,t){return(Zo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ns(e);if(t){var i=ns(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return es(this,n)}}function es(e,t){return!t||"object"!==Xo(t)&&"function"!=typeof t?ts(e):t}function ts(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ns(e){return(ns=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zo(e,t)}(a,e);var t,n,r,i=$o(a);function a(e,t,n,r){var A,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};Jo(this,a);var s=(A=i.call(this,e,t,n,r,o)).getTextMarkup();return s.textInputHandler.onEmptyTextMarkup=A.onEmptyTextMarkup.bind(ts(A)),A}return t=a,(n=[{key:"getArrowMarkup",value:function(){throw new Error("getArrowMarkup should be implemented")}},{key:"getTextMarkup",value:function(){throw new Error("getTextMarkup should be implemented")}},{key:"getShapeMarkup",value:function(){throw new Error("getShapeMarkup should be implemented")}},{key:"getQuadrant",value:function(e,t){var n=e.getWorldBoundingBox(!0),r=Math.atan2(n.size().y,n.size().x);return t>=-(Math.PI-r)&&t<-r?1:t>=-r&&t<r?2:t>=r&&t<Math.PI-r?3:4}},{key:"getTextQuadrant",value:function(e){return this.getQuadrant(this.getTextMarkup(),e)}},{key:"getShapeQuadrant",value:function(e){return this.getQuadrant(this.getShapeMarkup(),e)}},{key:"getVectorToClosestPointOnCloud",value:function(e){var t=this.getTextMarkup().frameMarkup.meshLine.sourceGeo,n=1/0,r=null;return t.forEach((function(t){var i=e.distanceToSquared(t);i<n&&(n=i,r=t)})),e.clone().sub(r)}},{key:"applyArrowTextConstraint",value:function(e){var t=this.getArrowMarkup(),n=this.getTextMarkup();if((e=e||t.getEditState()).anchors[0]&&e.anchors[1]){var r=n.getWorldBoundingBox(!0),i=r.center(),a=n.editState.style[c.THICKNESS]/2,A=r.size().y/2-a,o=r.size().x/2-a,s=e.anchors[0],u=e.anchors[1].clone();t.applyScaleAndTranslation(u);var l=Math.atan2(u.y-i.y,u.x-i.x);switch(this.getTextQuadrant(l)){case 1:s.set(i.x,i.y-A,0);break;case 2:s.set(i.x+o,i.y,0);break;case 3:s.set(i.x,i.y+A,0);break;case 4:s.set(i.x-o,i.y,0)}if(n.editState.frameType===E){var h=s.clone().sub(i),d=this.getVectorToClosestPointOnCloud(h).negate();s.add(d)}t.applyInverseScaleAndTranslation(s),t.creationHandler.updateEditStateAnchors()}}},{key:"applyShapeArrowConstraint",value:function(e){var t=this.getArrowMarkup(),n=this.getShapeMarkup();if((e=e||t.getEditState()).anchors[0]&&e.anchors[1]){var r=n.getWorldBoundingBox(!0),i=r.center(),a=r.size().y/2,A=r.size().x/2,o=e.anchors[1],s=e.anchors[0].clone();t.applyScaleAndTranslation(s);var u,c=s.x-i.x,l=s.y-i.y,h=Math.atan2(l,c),d=function(e){return e>0?1:-1};switch(this.getShapeQuadrant(h)){case 1:u=d(c)*A/3,o.set(i.x+u,i.y-a,0);break;case 2:u=d(l)*a/3,o.set(i.x+A,i.y+u,0);break;case 3:u=d(c)*A/3,o.set(i.x+u,i.y+a,0);break;case 4:u=d(l)*a/3,o.set(i.x-A,i.y+u,0)}t.applyInverseScaleAndTranslation(o),t.creationHandler.updateEditStateAnchors()}}},{key:"applyArrowConstraints",value:function(e){throw new Error("applyArrowTextConstraint must be implemented")}},{key:"applyConstraints",value:function(e,t,n){throw new Error("applyConstraints must be implemented")}},{key:"applyTranslation",value:function(e,t,n){var r=this;this.markups.forEach((function(i){if(i!==e&&i.isCompleted()){if(i.setLocked(!0),e.type===y){var a=n.translation.clone().sub(t.translation);a=i.editState.translation.clone().add(a),i.creationHandler.updateEditState({translation:a})}else r.applyArrowConstraints();i.setLocked(!1)}}))}},{key:"applyStyle",value:function(e,t,n,r){var i=this;this.markups.forEach((function(t){t!==e&&t.isCompleted()&&(t.setLocked(!0),t.creationHandler.updateEditState({style:r.style}),i.applyArrowConstraints(),t.setLocked(!1))}))}},{key:"applyScale",value:function(e,t,n){var r=this;this.markups.forEach((function(t){t!==e&&t.isCompleted()&&t.type===y&&(t.setLocked(!0),r.applyArrowConstraints(),t.setLocked(!1))}))}},{key:"applyTextChange",value:function(e,t,n){this.applyArrowConstraints()}},{key:"onEmptyTextMarkup",value:function(){this.markupsExtension.markupsManager.actionManager.undo();var e=this.getTextMarkup();e.creationHandler.updateEditState({text:e.getDefaultState().text}),e.creationHandler.submitChanges()}}])&&qo(t.prototype,n),r&&qo(t,r),a}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Go(e,t)}(a,e);var t,n,r,i=zo(a);function a(e,t,n,r,A){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e,t,n,r,A)}return t=a,(n=[{key:"render",value:function(){arguments.length>0&&void 0!==arguments[0]||this.editState}},{key:"intersect",value:function(e){return!1}},{key:"isGroupMarkup",value:function(){return!0}},{key:"select",value:function(e){this.selected=!0,this.enableEdit(),e&&(this.setLocked(!0),this.markups.forEach((function(t){return t!==e&&!t.isSelected()&&t.select()})),this.setLocked(!1)),this.setDirty()}},{key:"setHover",value:function(e,t){this.hover!==e&&(this.hover=e,t&&(this.setLocked(!0),this.markups.forEach((function(n){return n!==t&&n.isHovered()!==e&&n.setHover(e)})),this.setLocked(!1)),this.setDirty())}},{key:"calculateWorldBoundingBox",value:function(){var e=new THREE.Box3;return this.markups.forEach((function(t){var n=t.getWorldBoundingBox(!0);e.union(n)})),e}},{key:"remove",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.markups.forEach((function(t){return t.remove(e)})),jo(Wo(a.prototype),"remove",this).call(this,e)}},{key:"syncGroupMarkups",value:function(e,t,n,r,i){r.anchors&&this.applyConstraints(e,t,n),r.translation&&i instanceof Sn&&0===i.keyTranslation.length()&&this.applyTranslation(e,t,n),r.scale&&i instanceof Jn&&this.applyScale(e,t,n),r.style&&this.applyStyle(e,t,n,r),r.text&&this.applyTextChange(e,t,n)}},{key:"applyConstraints",value:function(e,t,n){}},{key:"applyTranslation",value:function(e,t,n){}},{key:"applyStyle",value:function(e,t,n,r){}},{key:"applyScale",value:function(e,t,n){}},{key:"applyTextChange",value:function(e,t,n){}}])&&Vo(t.prototype,n),r&&Vo(t,r),a}(Ma));function is(e){return(is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function as(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function As(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function os(e,t){return(os=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ss(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cs(e);if(t){var i=cs(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return us(this,n)}}function us(e,t){return!t||"object"!==is(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cs(e){return(cs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}rs.withSnappingMarkup=!0;var ls=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&os(e,t)}(a,e);var t,n,r,i=ss(a);function a(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return as(this,a),i.call(this,e,t,T,n,r)}return t=a,(n=[{key:"getTextMarkup",value:function(){return this.markups[1]}},{key:"getArrowMarkup",value:function(){return this.markups[0]}},{key:"applyArrowConstraints",value:function(e){this.applyArrowTextConstraint(e)}},{key:"applyConstraints",value:function(e,t,n){var r=this;this.markups.forEach((function(t){t!==e&&t.isCompleted()&&e.type===y&&e.anchorHandler.activeAnchor===e.getHead()&&(e.setLocked(!0),r.applyArrowConstraints(n),e.setLocked(!1))}))}}])&&As(t.prototype,n),r&&As(t,r),a}(rs);function hs(e){return(hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ds(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ps(e,t){return(ps=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vs(e);if(t){var i=vs(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ys(this,n)}}function ys(e,t){return!t||"object"!==hs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vs(e){return(vs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ms,Es=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ps(e,t)}(a,e);var t,n,r,i=gs(a);function a(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return ds(this,a),i.call(this,e,t,M,n,r)}return t=a,(n=[{key:"getTextMarkup",value:function(){return this.markups[2]}},{key:"getArrowMarkup",value:function(){return this.markups[1]}},{key:"getShapeMarkup",value:function(){return this.markups[0]}},{key:"applyArrowConstraints",value:function(e){this.applyArrowTextConstraint(e),this.applyShapeArrowConstraint(e)}},{key:"applyConstraints",value:function(e,t,n){var r=this;this.markups.forEach((function(t){t!==e&&t.isCompleted()&&e.type===y&&(e.setLocked(!0),t.type===E?r.applyShapeArrowConstraint(n):r.applyArrowTextConstraint(n),e.setLocked(!1))}))}}])&&fs(t.prototype,n),r&&fs(t,r),a}(rs);function Bs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ws=(Bs(ms={},y,Ga),Bs(ms,k,eA),Bs(ms,C,uA),Bs(ms,v,SA),Bs(ms,m,HA),Bs(ms,E,VA),Bs(ms,B,ao),Bs(ms,w,po),Bs(ms,T,ls),Bs(ms,M,Es),Bs(ms,S,Co),Bs(ms,b,Co),Bs(ms,U,Ho),Bs(ms,Q,Po),ms);function ks(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Cs=Autodesk.Viewing,bs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.setGlobalManager(t.globalManager),this.viewer=t.viewer,this.names=["markups"],this.isActive=!1,this.onCameraChangedBinded=this.onCameraChanged.bind(this),this.onEditStartBinded=this.onEditStart.bind(this),this.onEditEndBinded=this.onEditEnd.bind(this),this.onDrawEndBinded=this.onDrawEnd.bind(this),this.onCreationTypeChangedBinded=this.onCreationTypeChanged.bind(this),this.onSelectionChangedBinded=this.onSelectionChanged.bind(this),this.rectSelector=new cn(this.markupsExtension),this.lastDrawEndTime=-1/0}var t,n,r;return t=e,(n=[{key:"getNames",value:function(){return this.names}},{key:"getName",value:function(){return this.names[0]}},{key:"getPriority",value:function(){return this.markupsExtension.markupsManager.isMarkupSessionOpen()?200:60}},{key:"updateToolPriority",value:function(){this.markupsExtension.viewer.toolController.rearrangeByPriorities()}},{key:"intersectHandler",value:function(e,t){if(this.lastMousePos)for(var n=e.length-1;n>=0;n--){var r=e[n];if(r.isCompleted()){var i=r[t];if(i){var a=this.lastMousePos.clone();if(i.intersect(a)||i.isDragging())return i.getCursor()}}}return null}},{key:"getCursor",value:function(){var e=this.markupsExtension.markupsManager.getDuringCreationMarkup(!1),t=this.markupsExtension.markupsManager.getEnabledMarkups(),n=this.markupsExtension.markupsManager.getActiveLayer(),r=this.hasSelection(),i=null;if(this.markupsExtension.markupsManager.isMarkupSessionOpen()){var a=this.markupsExtension.markupsManager.getInEditMarkups(),A=n.getAllLinks();i=(i=(i=(i=(i=(i=(i=e&&e.creationHandler.getCursor())||this.intersectHandler(A,"anchorHandler"))||this.intersectHandler(a,"anchorHandler"))||this.intersectHandler(a,"scaleHandler"))||this.intersectHandler(a,"rotationHandler"))||this.intersectHandler(a,"translationHandler"))||this.intersectHandler(a,"dimensionEditHandler")}if(i=i||this.intersectHandler(t,"selectionHandler"),!this.markupsExtension.markupsManager.isMarkupSessionOpen()){var o=this.markupsExtension.markupsManager.getVisibleLinks();i=i||this.intersectHandler(o,"selectionHandler")}var s=this.markupsExtension.markupsManager.getMarkupCreationType();return i||s!==x||this.isRectSelectorActive()||(i="auto"),i=i||s&&(r&&!this.isRectSelectorActive()?"auto":at[s]||"crosshair")}},{key:"register",value:function(){this.snapper=new Autodesk.Viewing.Extensions.Snapping.Snapper(this.viewer,{markupMode:!0}),this.viewer.toolController.registerTool(this.snapper)}},{key:"deregister",value:function(){this.snapper&&(this.viewer.toolController.deregisterTool(this.snapper),this.snapper=null)}},{key:"activate",value:function(e){e!==this.getName()||this.isActive||(this.isActive=!0,this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_EDIT_START,this.onEditStartBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_EDIT_END,this.onEditEndBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_DRAWING_END,this.onDrawEndBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_CREATION_TYPE_CHANGED,this.onCreationTypeChangedBinded),this.addDocumentEventListener("selectionchange",this.onSelectionChangedBinded))}},{key:"deactivate",value:function(e){e===this.getName()&&this.isActive&&(this.isActive=!1,this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_EDIT_START,this.onEditStartBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_EDIT_END,this.onEditEndBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_DRAWING_END,this.onDrawEndBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_CREATION_TYPE_CHANGED,this.onCreationTypeChangedBinded),this.removeDocumentEventListener("selectionchange",this.onSelectionChangedBinded),this.onCreationTypeChanged())}},{key:"onSelectionChanged",value:function(){this.markupsExtension.markupsManager.getSelectedMarkups().forEach((function(e){e.isTextMarkup()&&e.isInEdit()&&e.textInputHandler.updateCaretPosition()}))}},{key:"eventToWorld",value:function(e){var t={x:e.canvasX,y:e.canvasY};return this.markupsExtension.renderer.clientToWorld(t)}},{key:"getSnappedPosition",value:function(){if(!this.lastSnapPoint)if(this.viewer.impl.is2d||this.isSnappingAllowed()){var e={x:this.originalEvent.canvasX,y:this.originalEvent.canvasY};if(this.snapper.onMouseMove(e),this.viewer.model.isLeaflet()||this.snapper.indicator.render(),this.snapper.isSnapped()){var t=Autodesk.Viewing.MeasureCommon.getSnapResultPosition(this.snapper.getSnapResult(),this.viewer);this.lastSnapPoint=this.markupsExtension.renderer.documentCameraToMarkupsCamera(t)}else this.lastSnapPoint=this.lastMousePos}else this.lastSnapPoint=this.lastMousePos;return this.lastSnapPoint.clone()}},{key:"applyHandler",value:function(e,t,n,r){for(var i=e.length-1;i>=0;i--){var a=e[i];if(a.isCompleted()){var A=a[t];if(A&&A[n](this.lastMousePos,r))return!0}}return!1}},{key:"isNavigationToolActive",value:function(){return this.viewer.getActiveNavigationTool()!==this.getName()}},{key:"isSnappingAllowed",value:function(){var e=this.markupsExtension.markupsManager.getMarkupCreationType();return e&&ws[e].withSnappingMarkup&&(e===U||!this.viewer.model.isLeaflet())}},{key:"isRectSelectorActive",value:function(){return this.markupsExtension.markupsManager.isMarkupSessionOpen()&&this.markupsExtension.markupsManager.getMarkupCreationType()===x}},{key:"hasSelection",value:function(){var e=this.markupsExtension.markupsManager.isMarkupSessionOpen();return this.markupsExtension.markupsManager.getSelectedMarkups().length>0||!e&&(this.markupsExtension.markupsManager.getSelectedLayers().length>0||this.markupsExtension.markupsManager.getSelectedLinks().length>0)}},{key:"handleMouseEvent",value:function(e,t,n,r){if(!this.markupsExtension.isToolEnabled())return!1;this.lastMousePos=this.eventToWorld(e),this.originalEvent=e,this.markupsExtension.renderer.updateRaycaster({x:e.canvasX,y:e.canvasY});var i,a,A=this.markupsExtension.markupsManager.getMarkupCreationType(),o=this.markupsExtension.markupsManager.isMarkupSessionOpen();if(!this.markupInEdit&&(!A||!ws[A].useTimerBeforeSelection||ws[A].useTimerBeforeSelection&&performance.now()-this.lastDrawEndTime>it)){var s=this.markupsExtension.markupsManager.getEnabledMarkups().filter((function(e){return!e.isSelected()}));i=i||this.applyHandler(s,"selectionHandler",n,t)}var u=this.markupsExtension.markupsManager.getActiveLayer();if(A&&(a=this.markupsExtension.markupsManager.getDuringCreationMarkup(!1))&&!a.isCompleted())if(i)a.creationHandler.creationCancel();else{var c=a.creationHandler.getSnappedPosition();i="handleMouseMove"===n&&!this.mouseMoved&&!a.creationHandler.creationStarted||a.creationHandler[n](c,t)}if(o){var l=u.getAllLinks();i=i||this.applyHandler(l,"anchorHandler",n,t);var h=this.markupsExtension.markupsManager.getInEditMarkups();i=(i=(i=(i=(i=(i=i||this.applyHandler(h,"scaleHandler",n,t))||this.applyHandler(h,"anchorHandler",n,t))||this.applyHandler(h,"rotationHandler",n,t))||this.applyHandler(h,"translationHandler",n,t))||this.applyHandler(h,"dimensionEditHandler",n,t))||this.applyHandler(h,"textInputHandler",n,t)}if(!i&&"handleMouseMove"===n&&this.isSnappingAllowed()&&this.getSnappedPosition(),this.isRectSelectorActive()&&(i=i||this.rectSelector[n](this.lastMousePos)),!o){var d=this.markupsExtension.markupsManager.getVisibleLinks();i=i||this.applyHandler(d,"selectionHandler",n,t)}if(!i&&("handleButtonUp"===n||"handleButtonDown"===n&&A&&ws[A].singleClickMarkup)&&(!this.hasSelection()||this.shiftDown||this.mouseMoved||this.isRectSelectorActive()||(this.markupsExtension.markupsManager.deselectAllMarkups(),this.markupsExtension.markupsManager.deselectAllLinks(),o||this.markupsExtension.markupsManager.deselectAllLayers(null),i=!0)),!i&&r&&A&&!this.isNavigationToolActive()&&(a=this.markupsExtension.markupsManager.getDuringCreationMarkup(!0))){var f=a.creationHandler.getSnappedPosition();(i=a.creationHandler[n](f,t))||a.creationHandler.creationCancel()}return this.lastSnapPoint=null,i}},{key:"handleButtonDown",value:function(e,t){if(this.dragging=!0,this.buttonDownPos=new THREE.Vector2(e.canvasX,e.canvasY,0),this.mouseMoved=!1,this.buttonDownConsumed=!1,this.selectedOnDown=!1,this.panning=!Autodesk.Viewing.isMobileDevice()&&(this.isRightClick(e)||this.isMiddleClick(e)),this.panning)return!1;this.markupsExtension.markupsManager.dispatchEvent({type:a.BUTTON_DOWN}),this.buttonDownConsumed=this.handleMouseEvent(e,t,"handleButtonDown",!0);var n=this.markupsExtension.markupsManager.getSelectedMarkups();return this.selectedOnDown=n.length>0,this.buttonDownConsumed}},{key:"handleButtonUp",value:function(e,t){if(this.dragging=!1,this.buttonDownPos=null,this.buttonUpConsumed=!1,this.buttonUpCalled=!0,this.panning||this.mouseMoved&&!this.buttonDownConsumed)return this.panning=!1,this.mouseMoved=!1,!1;var n=this.handleMouseEvent(e,t,"handleButtonUp",!1),r=this.markupsExtension.markupsManager.getSelectedMarkups();if(!this.mouseMoved&&this.selectedOnDown&&!r[0]){var i=this.markupsExtension.markupsManager.getDuringCreationMarkup(!1);i&&i.creationHandler.creationCancel(),this.markupsExtension.markupsManager.deselectAllMarkups()}this.buttonUpConsumed=n;var a=this.mouseMoved;return this.mouseMoved=!1,n&&a||this.isRectSelectorActive()}},{key:"handleDoubleClick",value:function(e,t){var n=this.handleMouseEvent(e,t,"handleDoubleClick",!1),r=this.markupsExtension.markupsManager.isMarkupSessionOpen()&&this.markupsExtension.markupsManager.getMarkupCreationType();return n||r}},{key:"handleMouseMove",value:function(e){if(this.panning)return!1;this.buttonDownPos&&!this.mouseMoved&&(this.mouseMoved=new THREE.Vector2(e.canvasX,e.canvasY,0).distanceTo(this.buttonDownPos)>Se),this.markupsExtension.markupsManager.unhoverAllLayers(),this.markupsExtension.markupsManager.unhoverAllMarkups();var t=this.handleMouseEvent(e,null,"handleMouseMove",!1);return this.dragging&&t}},{key:"handleKeyDown",value:function(e,t){var n=this,r=this.markupsExtension.markupsManager.getInEditMarkups(),i=!1,A=this.markupsExtension.markupsManager.getDuringCreationMarkup(!1);if(A)i=A.creationHandler.handleKeyDown(e,t);else{var o;this.markupsExtension.markupsManager.openActionGroup();for(var s=r.length-1;s>=0;s--){var u=r[s];u&&u.isCompleted()&&((o=u.anchorHandler&&u.anchorHandler.handleKeyDown(e,t))||(o=u.textInputHandler&&u.textInputHandler.handleKeyDown(e,t)),o||(o=u.scaleHandler&&u.scaleHandler.handleKeyDown(e,t)),o||(o=u.rotationHandler&&u.rotationHandler.handleKeyDown(e,t)),o||(o=u.translationHandler&&u.translationHandler.handleKeyDown(e,t)),o||(o=u.dimensionEditHandler&&u.dimensionEditHandler.handleKeyDown(e,t)),o||(o=u.selectionHandler&&u.selectionHandler.handleKeyDown(e,t))),i=i||o}this.markupsExtension.markupsManager.closeActionGroup()}for(var c=this.markupsExtension.markupsManager.getVisibleLinks(),l=c.length-1;l>=0;l--){var h=c[l];i=(i=i||h.anchorHandler&&h.anchorHandler.handleKeyDown(e,t))||h.selectionHandler&&h.selectionHandler.handleKeyDown(e,t)}if(!i)switch(t){case Autodesk.Viewing.KeyCode.CONTROL:this.ctrlDown=!0;break;case Autodesk.Viewing.KeyCode.SHIFT:this.shiftDown=!0,i=!0;break;case Autodesk.Viewing.KeyCode.a:this.ctrlDown&&this.markupsExtension.markupsManager.isMarkupSessionOpen()&&(this.markupsExtension.markupsManager.getActiveLayer().selectAllMarkups(),i=!0);break;case Autodesk.Viewing.KeyCode.x:this.ctrlDown&&(this.markupsExtension.cut(),i=!0);break;case Autodesk.Viewing.KeyCode.c:this.ctrlDown&&(this.markupsExtension.copy(),i=!0);break;case Autodesk.Viewing.KeyCode.v:this.ctrlDown&&(this.markupsExtension.paste(),i=!0);break;case Autodesk.Viewing.KeyCode.d:this.ctrlDown&&(this.markupsExtension.copy(),this.markupsExtension.paste(),i=!0);break;case Autodesk.Viewing.KeyCode.z:this.ctrlDown&&!this.shiftDown?(this.markupsExtension.undo(),i=!0):this.ctrlDown&&this.shiftDown&&(this.markupsExtension.redo(),i=!0);break;case Autodesk.Viewing.KeyCode.y:this.ctrlDown&&(this.markupsExtension.redo(),i=!0);break;case Autodesk.Viewing.KeyCode.ESCAPE:this.markupsExtension.markupsManager.getSelectedMarkups().length>0?(this.markupsExtension.markupsManager.deselectAllMarkups(),i=!0):this.markupsExtension.markupsManager.isMarkupSessionOpen()?(this.markupsExtension.markupsManager.getActiveLayer().isEmpty()?this.markupsExtension.endMarkupSession(!1):this.markupsExtension.markupsManager.dispatchEvent({type:a.LAYER_DISCARD_PRESSED,onConfirmCB:function(){n.markupsExtension.endMarkupSession(!1)}}),i=!0):this.markupsExtension.markupsManager.getSelectedLayers().length>0&&(this.markupsExtension.markupsManager.deselectAllLayers(),i=!0);break;case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:this.markupsExtension.markupsManager.deleteInEditMarkups()}return i}},{key:"handleSingleClick",value:function(e,t){return this.buttonUpConsumed}},{key:"handleKeyUp",value:function(e,t){var n=this.markupsExtension.markupsManager.getInEditMarkups(),r=this.markupsExtension.markupsManager.getDuringCreationMarkup(!1);if(r)r.creationHandler.handleKeyUp(e,t);else{this.markupsExtension.markupsManager.openActionGroup();for(var i=n.length-1;i>=0;i--){var a=n[i];a&&a.isCompleted()&&(e.isDuringEdit=i<n.length-1,a.anchorHandler&&a.anchorHandler.handleKeyUp(e,t)||a.translationHandler&&a.translationHandler.handleKeyUp(e,t))}this.markupsExtension.markupsManager.closeActionGroup()}switch(t){case Autodesk.Viewing.KeyCode.CONTROL:this.ctrlDown=!1;break;case Autodesk.Viewing.KeyCode.SHIFT:this.shiftDown=!1}return!1}},{key:"onCameraChanged",value:function(){this.isSnappingAllowed()&&!this.viewer.model.isLeaflet()&&this.snapper.indicator.render()}},{key:"onCreationTypeChanged",value:function(){this.snapper.indicator.clearOverlays()}},{key:"onEditStart",value:function(){this.markupInEdit=!0,this.snapper.indicator.clearOverlays()}},{key:"onEditEnd",value:function(){this.markupInEdit=!1,this.snapper.indicator.clearOverlays()}},{key:"onDrawEnd",value:function(){this.lastDrawEndTime=performance.now()}},{key:"isMiddleClick",value:function(e){return Autodesk.Viewing.Private.isMiddleClick(e)}},{key:"isRightClick",value:function(e){return Autodesk.Viewing.Private.isRightClick(e,this.viewer.navigation)}},{key:"handleBlur",value:function(){this.ctrlDown=!1,this.shiftDown=!1}},{key:"handleSingleTap",value:function(e){var t=this.buttonUpConsumed;return this.buttonUpCalled||(this.handleButtonDown(e,0),t=this.handleButtonUp(e,0)||this.buttonUpConsumed),this.buttonUpCalled=!1,t}},{key:"handleDoubleTap",value:function(e){return this.handleDoubleClick(e,0)}},{key:"isNavigationJustEnded",value:function(){return this.navigationEndTime&&Date.now()-this.navigationEndTime<We}},{key:"handleGesture",value:function(e){var t;switch(e.type){case"dragstart":return!this.isNavigationJustEnded()&&this.handleButtonDown(e,0);case"dragmove":return!this.isNavigationJustEnded()&&this.handleMouseMove(e);case"dragend":return!this.isNavigationJustEnded()&&(t=this.handleButtonUp(e,0),this.buttonUpCalled=!1,t);case"pinchend":case"panend":this.navigationEndTime=Date.now()}return!1}}])&&ks(t.prototype,n),r&&ks(t,r),e}();function Ss(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Cs.GlobalManagerMixin.call(bs.prototype);var Ts=Autodesk.Viewing,Ms=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t.viewer,this.setGlobalManager(t.globalManager),this.options=t.options,this.markupsExtension=t,this.createUI()}var t,n,r;return t=e,(n=[{key:"createUI",value:function(){var e=this.options.uiClasses;if(e){var t=this.getDocument();this.uiContainer=t.createElement("div"),this.uiContainer.id="MarkupsUI_Container",this.uiContainer.className="MarkupsUI_Container",this.viewer.container.appendChild(this.uiContainer);var n=e.ToolbarClass;this.toolbar=n&&new n(this.markupsExtension,this.uiContainer,this.viewer,this.options);var r=e.CreationToastClass;this.creationToast=r&&new r(this.markupsExtension,this.uiContainer,this.viewer,this.options);var i=e.ContextualMenuClass;this.contextualMenu=i&&new i(this.markupsExtension,this.uiContainer,this.viewer,this.options);var a=e.AttachmentsPreviewPanelClass;this.attachmentsPreviewPanel=a&&new a(this.markupsExtension,this.uiContainer,this.viewer,this.options);var A=e.MarkupsDialogModalsClass;if(this.MarkupsDialogModals=A&&new A(this.markupsExtension,this.uiContainer,this.viewer,this.options),this.viewer.impl.is2d){var o=e.MarkupsVisibilityButtonClass;this.markupsVisibilityButton=o&&new o(this.markupsExtension,this.uiContainer,this.viewer,this.options)}else{var s=e.ExitMarkupViewClass;this.exitMarkupView=s&&new s(this.markupsExtension,this.uiContainer,this.viewer,this.options)}this.registerEventListeners()}}},{key:"destroy",value:function(){this.toolbar&&(this.toolbar.destroy(),this.toolbar=null),this.creationToast&&(this.creationToast.destroy(),this.creationToast=null),this.contextualMenu&&(this.contextualMenu.destroy(),this.contextualMenu=null),this.attachmentsPreviewPanel&&(this.attachmentsPreviewPanel.destroy(),this.attachmentsPreviewPanel=null),this.markupsVisibilityButton&&(this.markupsVisibilityButton.destroy(),this.markupsVisibilityButton=null),this.exitMarkupView&&(this.exitMarkupView.destroy(),this.exitMarkupView=null),this.unregisterEventListeners(),this.uiContainer&&(this.viewer.container.removeChild(this.uiContainer),this.uiContainer=null),this.markupsExtension=null,this.viewer=null,this.options=null}},{key:"registerEventListeners",value:function(){this.onSessionStartBinded=this.onSessionStart.bind(this),this.onSessionEndBinded=this.onSessionEnd.bind(this),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_SESSION_START,this.onSessionStartBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_SESSION_END,this.onSessionEndBinded),this.markupsExtension.markupsManager.addEventListener(a.LAYER_SELECTED,this.onSessionStartBinded),this.markupsExtension.markupsManager.addEventListener(a.LAYER_DESELECTED,this.onSessionEndBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_CREATION_TYPE_CHANGED,this.onSessionStartBinded)}},{key:"unregisterEventListeners",value:function(){this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_SESSION_START,this.onSessionStartBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_SESSION_END,this.onSessionEndBinded),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_SELECTED,this.onSessionStartBinded),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_DESELECTED,this.onSessionEndBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_CREATION_TYPE_CHANGED,this.onSessionStartBinded)}},{key:"onSessionStart",value:function(){this.selectNavigationButton(null),this.viewer.impl.is2d&&this.handleNavButtonEvents(!0)}},{key:"onSessionEnd",value:function(){this.viewer.impl.is2d&&this.handleNavButtonEvents(!1),this.selectNavigationButton(this.markupsExtension.markupsManager.navigationToolBackup)}},{key:"getNavigationControls",value:function(){return this.viewer.getToolbar().getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID)._controls}},{key:"handleNavButtonEvents",value:function(e){var t=this;this.onNavButtonClickBinded=this.onNavButtonClick.bind(this);var n=this.getNavigationControls(),r=function(n){e?n.hasEventListener(Autodesk.Viewing.UI.Button.Event.CLICK,t.onNavButtonClickBinded)||n.addEventListener(Autodesk.Viewing.UI.Button.Event.CLICK,t.onNavButtonClickBinded):n.removeEventListener(Autodesk.Viewing.UI.Button.Event.CLICK,t.onNavButtonClickBinded)};n.forEach((function(e){r(e),e.subMenu&&e.subMenu._controls.forEach((function(e){r(e)}))}))}},{key:"onNavButtonClick",value:function(e){var t=this;this.getNavigationControls().forEach((function(n){n._id!==e.target._id?n.setState(Autodesk.Viewing.UI.Button.State.INACTIVE):n.getState()===Autodesk.Viewing.UI.Button.State.INACTIVE&&(t.markupsExtension.markupsManager.changeMarkupCreationType(null),n.setState(Autodesk.Viewing.UI.Button.State.ACTIVE),setTimeout((function(){t.markupsExtension.markupsManager.navigationToolBackup=t.viewer.getActiveNavigationTool()})))}))}},{key:"selectNavigationButton",value:function(e){var t=function(t){var n=-1!==t._id.toLowerCase().indexOf(e);t.setState(n?Autodesk.Viewing.UI.Button.State.ACTIVE:Autodesk.Viewing.UI.Button.State.INACTIVE)};this.getNavigationControls().forEach((function(e){t(e),e.subMenu&&e.subMenu._controls.forEach((function(e){t(e)}))}))}}])&&Ss(t.prototype,n),r&&Ss(t,r),e}();function Us(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ts.GlobalManagerMixin.call(Ms.prototype);var Qs=function(){function e(t,n,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.guid=t,this.resources=n||[],this.attachments=r||[],this.status=i,this.metadata=a||{}}var t,n,r;return t=e,(n=[{key:"getSvgResource",value:function(){return this.resources[0]&&this.resources[0].data}},{key:"getScreenCaptureResource",value:function(){return this.resources[1]&&this.resources[1].data}},{key:"getLinksMetadata",value:function(){return this.metadata&&this.metadata.markup_metadata&&this.metadata.markup_metadata.links}},{key:"getMetadata",value:function(){return this.metadata}}])&&Us(t.prototype,n),r&&Us(t,r),e}();function xs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Fs=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.viewer=t.viewer,this.link=n,this.link.syncEditState()}var t,n,r;return t=e,(n=[{key:"getEditState",value:function(){return this.link.getEditState()}},{key:"setEditState",value:function(e){this.link.setEditState(e)}},{key:"updateEditState",value:function(e){this.setEditState(Object.assign({},this.getEditState(),e))}},{key:"submitChanges",value:function(){new Tt(this.markupsExtension.markupsManager,this.link,this.getEditState()).execute()}},{key:"isDragging",value:function(){return!1}},{key:"getTouchRadiusWorld",value:function(){return this.markupsExtension.renderer.sizeFromClientToWorld(Ce)}},{key:"getMinChangeDistanceWorld",value:function(){return this.markupsExtension.renderer.sizeFromClientToWorld(Se)}},{key:"didMouseMove",value:function(){return this.markupsExtension.markupsTool.mouseMoved}},{key:"handleDoubleClick",value:function(e,t){}},{key:"handleButtonDown",value:function(e,t){}},{key:"handleButtonUp",value:function(e,t){}},{key:"handleKeyDown",value:function(e,t){}},{key:"handleKeyUp",value:function(e,t){}},{key:"handleMouseMove",value:function(e){}},{key:"handleGesture",value:function(e){}},{key:"handleResize",value:function(){}},{key:"destroy",value:function(){this.markupsExtension=null,this.viewer=null,this.link=null}}])&&xs(t.prototype,n),r&&xs(t,r),e}();function _s(e){return(_s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ls(e,t){return(Ls=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ds(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Os(e);if(t){var i=Os(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Is(this,n)}}function Is(e,t){return!t||"object"!==_s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Os(e){return(Os=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ns=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ls(e,t)}(a,e);var t,n,r,i=Ds(a);function a(){return Hs(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"handleMouseMove",value:function(e){var t=this.grabbing||this.intersect(e);return this.link.setHover(t),!!this.grabbing&&(this.updatePosition(e),!0)}},{key:"handleButtonDown",value:function(e,t){return!!this.grabbing||(this.grabbing=this.intersect(e),this.grabbing&&(this.originalPosition=e.clone(),this.lastTranslationPoint=e),!!this.grabbing)}},{key:"handleButtonUp",value:function(e,t){return!!this.grabbing&&(this.updatePosition(e),Dt(e,this.originalPosition,this.getMinChangeDistanceWorld())?(this.cancelAnchorEditing(),!1):(this.submitChanges(),this.grabbing=!1,this.lastTranslationPoint=null,!0))}},{key:"handleKeyDown",value:function(e,t){if(this.grabbing)switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:case Autodesk.Viewing.KeyCode.ESCAPE:return this.cancelAnchorEditing(),!0}return!1}},{key:"updateEditStatePosition",value:function(){this.updateEditState({position:this.getEditState().position})}},{key:"updatePosition",value:function(e){var t=e.clone().sub(this.lastTranslationPoint);this.link.editState.position||(this.link.editState.position=this.link.getLinkBasePosition()),Nt(this.link.editState.position,t),this.lastTranslationPoint=e,this.updateEditStatePosition()}},{key:"cancelAnchorEditing",value:function(){this.grabbing=!1,this.link.syncEditState(),this.updateEditStatePosition()}},{key:"isDragging",value:function(){return this.grabbing}},{key:"intersect",value:function(e){var t=this.markupsExtension.renderer.worldToClient(e);return this.link.getClientBoundingBox().containsPoint(t)}},{key:"getCursor",value:function(){return this.grabbing?"grabbing":"grab"}}])&&Rs(t.prototype,n),r&&Rs(t,r),a}(Fs);function Ps(e){return(Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ks(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function js(e,t){return(js=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ys(e);if(t){var i=Ys(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return zs(this,n)}}function zs(e,t){return!t||"object"!==Ps(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ys(e){return(Ys=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ws=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&js(e,t)}(a,e);var t,n,r,i=Gs(a);function a(){return Ks(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"intersect",value:function(e){var t=this.markupsExtension.renderer.worldToClient(e);return this.link.getClientBoundingBox().containsPoint(t)}},{key:"handleMouseMove",value:function(e){if(this.markupsExtension.markupsTool.dragging||Autodesk.Viewing.isMobileDevice())return!1;var t=this.intersect(e);return this.link.setHover(t),t&&this.link.layer.setHover(!0),t}},{key:"getCursor",value:function(){return"pointer"}},{key:"handleButtonUp",value:function(e,t){return!(this.didMouseMove()||!this.intersect(e)||(this.markupsExtension.markupsManager.deselectAllLinks(),this.markupsExtension.markupsManager.selectLink(this.link),0))}}])&&Vs(t.prototype,n),r&&Vs(t,r),a}(Fs);function Xs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Js=function(){function e(t,n,r,i,a,A){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=n,this.guid=r,this.layer=i,this.type=a,this.markupsExtension=t,this.visible=!0,this.selected=!1,this.hover=!1,this.dirty=!1,A?this.state=A:(this.state=this.getDefaultState(),this.state.style=this.getDefaultStyle()),this.editState={},this.registerSelectionHandler(),this.registerAnchorHandler()}var t,n,r;return t=e,(n=[{key:"getDefaultState",value:function(){return{}}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(e){this.state=e}},{key:"getEditState",value:function(){return this.editState}},{key:"setEditState",value:function(e){this.editState=e,this.setDirty(!0)}},{key:"syncEditState",value:function(){this.setEditState(lt.cloneDeep(this.getState()))}},{key:"setDirty",value:function(e){this.dirty=e,e&&this.markupsExtension.markupsManager.dispatchEvent({type:a.LINK_DIRTY,link:this})}},{key:"isDirty",value:function(){return this.dirty}},{key:"isVisible",value:function(){return this.layer.isVisible()}},{key:"getLinkBasePosition",value:function(){var e=this.layer.getClientBoundingBox(!0),t=e.max.clone().setY(e.min.y),n=this.markupsExtension.renderer.getCameraUpVector(),r=this.markupsExtension.renderer.getCameraRightVector(),i=this.getClientBoundingBox().size(),a=n.multiplyScalar(this.markupsExtension.renderer.multiplyByNormaStrokeWidth(i.y/2)),A=r.multiplyScalar(this.markupsExtension.renderer.multiplyByNormaStrokeWidth(Re+i.x/2)),o=this.markupsExtension.renderer.getCameraEyeVector(),s=this.markupsExtension.renderer.getCameraRotation();return st.applyRotation(t,-s,e.center(),o),this.markupsExtension.renderer.clientToWorld(t).sub(a).add(A)}},{key:"getClientBoundingBox",value:function(){return this.markupsExtension.renderer.linksRenderer.getLinkBoundingBox(this)}},{key:"getPosition",value:function(){return this.editState.position?this.editState.position:this.getLinkBasePosition()}},{key:"select",value:function(){this.selected=!0,this.markupsExtension.markupsManager.dispatchEvent({type:a.LINK_SELECTED,link:this}),this.setDirty(!0)}},{key:"deselect",value:function(){this.selected=!1,this.markupsExtension.markupsManager.dispatchEvent({type:a.LINK_DESELECTED,link:this}),this.setDirty(!0)}},{key:"isSelected",value:function(){return this.selected}},{key:"setHover",value:function(e){this.hover!==e&&(this.hover=e,this.setDirty(!0))}},{key:"isHovered",value:function(){return this.hover}},{key:"isCompleted",value:function(){return!0}},{key:"registerSelectionHandler",value:function(){this.selectionHandler=new Ws(this.markupsExtension,this)}},{key:"registerAnchorHandler",value:function(){this.anchorHandler=new Ns(this.markupsExtension,this)}},{key:"destroy",value:function(){this.translationHandler&&(this.translationHandler.destroy(),this.translationHandler=null),this.markupsExtension=null,this.state=null,this.editState=null}}])&&Xs(t.prototype,n),r&&Xs(t,r),e}();function qs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zs=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.id=n,this.layerData=!r||r instanceof Qs?r:new Qs(r.guid,r.resources,r.attachments,r.status,r.metadata),this.markups={},this.links={},this.selected=!1,this.visible=!1,this.transparent=!1,this.hover=!1}var t,n,r;return t=e,(n=[{key:"addMarkup",value:function(e){this.markups[e.id]=e,e.layer=this,e.setVisible(this.visible,!0)}},{key:"deleteMarkup",value:function(e){var t=e instanceof Ma?e.id:e;this.markups[t]?(e.deselect(),delete this.markups[t],e.remove(),e.layer=null,this.setDirty()):console.warn("deleteMarkup - markup does not exist")}},{key:"deleteAllMarkups",value:function(){var e=this;Lt(this.markups,(function(t){e.deleteMarkup(t)}))}},{key:"getMarkupById",value:function(e){return this.markups[e]}},{key:"isEmpty",value:function(){return 0===Object.keys(this.markups).length}},{key:"addLink",value:function(e){this.links[e.id]=e}},{key:"deleteLink",value:function(e){var t=e instanceof Js?e.id:e;this.links[t]?(this.markupsExtension.markupsManager.dispatchEvent({type:a.LINK_REMOVED,link:e}),delete this.links[t]):console.warn("deleteLink - markup does not exist")}},{key:"deleteAllLinks",value:function(){var e=this;Lt(this.links,(function(t){e.deleteLink(t)}))}},{key:"getLinkById",value:function(e){return this.links[e]}},{key:"getClientBoundingBox",value:function(e){var t=this.getWorldBoundingBox();t.min=this.markupsExtension.renderer.worldToClient(t.min),t.max=this.markupsExtension.renderer.worldToClient(t.max);var n=this.markupsExtension.renderer.getCameraEyeVector(),r=t.center(),i=this.markupsExtension.renderer.getCameraRotation();if(st.applyRotation(t.min,i,r,n),st.applyRotation(t.max,i,r,n),st.swapBoundingBoxY(t),e){var a=this.getMarginSize();t.expandByVector(new THREE.Vector3(a,a,0))}return t.min.z=0,t.max.z=0,t}},{key:"getMarginSize",value:function(){return Pe}},{key:"getWorldBoundingBox",value:function(){var e=new THREE.Box3;return Lt(this.markups,(function(t){var n=t.getWorldBoundingBox(!0);e.union(n)})),e}},{key:"getRotation",value:function(){return 0}},{key:"getAllMarkups",value:function(){return It(this.markups)}},{key:"getAllLinks",value:function(){return It(this.links)}},{key:"hasSingleMarkup",value:function(){return 1===this.getAllMarkups().length}},{key:"select",value:function(){this.selected=!0,this.markupsExtension.markupsManager.dispatchEvent({type:a.LAYER_SELECTED,layer:this}),this.setDirty()}},{key:"deselect",value:function(){this.selected=!1,this.markupsExtension.markupsManager.dispatchEvent({type:a.LAYER_DESELECTED,layer:this}),this.setDirty()}},{key:"isSelected",value:function(){return this.selected}},{key:"setHover",value:function(e){this.hover!==e&&(this.hover=e,this.getAllLinks().forEach((function(t){t.setHover(e)})),this.setDirty())}},{key:"isHovered",value:function(){return this.hover}},{key:"unhoverAllMarkups",value:function(){this.getAllMarkups().forEach((function(e){e.setHover(!1)}))}},{key:"setVisible",value:function(e){this.visible=e,Lt(this.markups,(function(t){t.setVisible(e)})),this.setDirty()}},{key:"isVisible",value:function(){return this.visible}},{key:"setDirty",value:function(){this.markupsExtension.markupsManager.dispatchEvent({type:a.LAYER_DIRTY,layer:this})}},{key:"getGuid",value:function(){return this.layerData&&this.layerData.guid}},{key:"selectAllMarkups",value:function(){this.getAllMarkups().forEach((function(e){e.select()}))}},{key:"changeTransparency",value:function(e){this.transparent=e,this.getAllMarkups().forEach((function(t){t.changeTransparency(e)}))}},{key:"isTransparent",value:function(){return this.transparent}},{key:"enable",value:function(){this.getAllMarkups().forEach((function(e){e.enable()}))}},{key:"disable",value:function(){this.getAllMarkups().forEach((function(e){e.disable()}))}}])&&qs(t.prototype,n),r&&qs(t,r),e}();function $s(e){return($s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eu(e,t){return(eu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ru(e);if(t){var i=ru(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return nu(this,n)}}function nu(e,t){return!t||"object"!==$s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ru(e){return(ru=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var iu,au,Au,ou=(Au=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eu(e,t)}(n,e);var t=tu(n);function n(e,r,i,a,A){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e,r,i,a,ae,A)}return n}(Js),(au=ae)in(iu={})?Object.defineProperty(iu,au,{value:Au,enumerable:!0,configurable:!0,writable:!0}):iu[au]=Au,iu);function su(e,t,n,r,i,a,A){try{var o=e[a](A),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,i)}function uu(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function A(e){su(a,r,i,A,o,"next",e)}function o(e){su(a,r,i,A,o,"throw",e)}A(void 0)}))}}var cu=function(e,t){e&&t&&("eye"in e&&(e.eye[0]=(Number(e.eye[0])+t.x).toString(),e.eye[1]=(Number(e.eye[1])+t.y).toString(),e.eye[2]=(Number(e.eye[2])+t.z).toString()),"target"in e&&(e.target[0]=(Number(e.target[0])+t.x).toString(),e.target[1]=(Number(e.target[1])+t.y).toString(),e.target[2]=(Number(e.target[2])+t.z).toString()),"pivotPoint"in e&&(e.pivotPoint[0]=(Number(e.pivotPoint[0])+t.x).toString(),e.pivotPoint[1]=(Number(e.pivotPoint[1])+t.y).toString(),e.pivotPoint[2]=(Number(e.pivotPoint[2])+t.z).toString()))},lu=function(e,t){var n=e.model,r=n?n.getData().globalOffset:null,i=t.metadata.markup_metadata;if(r){var a=JSON.parse(JSON.stringify(i)),A=a.viewport,o={x:-r.x,y:-r.y,z:-r.z};return cu(A,o),a}return i},hu=function(){var e=uu(regeneratorRuntime.mark((function e(t,n,r){var i,a,A=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=A.length>3&&void 0!==A[3]?A[3]:function(){},n){e.next=4;break}return i(!1),e.abrupt("return");case 4:return a=lu(t,n),t.restoreState(a,null,r),function(){var e=uu(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=3;break}return e.next=3,Autodesk.Viewing.EventUtils.waitUntilTransitionEnded(t);case 3:n=t.navigation.getCamera(),t.navigation.updateCamera(),n.updateMatrixWorld(),n.matrixWorldInverse.getInverse(n.matrixWorld),t.impl.sceneUpdated(!0),i(!0);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),e.next=10,Autodesk.Viewing.EventUtils.waitUntilGeometryLoaded(t);case 10:t.impl.sceneUpdated(!0);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),du=function(e,t,n,r){var i=t.model.isPdf(!0);if(t.model.isLeaflet()||i){var a,A;if(i)a=Autodesk.Viewing.PDFUtils.getLeafletLoadOptions(t),A=Autodesk.Viewing.PDFUtils.getLeafletBoundingBox(t);else{var o=t.model.getData();a=o.loadOptions.loadOptions,A=o.bbox}var s=a,u=s.texWidth,c=s.texHeight,l=u/(r.metadata.markup_metadata&&r.metadata.markup_metadata.originalDocumentResolution&&r.metadata.markup_metadata.originalDocumentResolution[0]||u),h=e.x/(u/l)*A.size().x,d=e.y/(c/l)*A.size().y,f=new THREE.Vector3(h,d,0),p=new THREE.Vector3(A.min.x,A.max.y,0);return f.add(p),i&&Autodesk.Viewing.PDFUtils.leafletToPdfWorld(t,f),f}if(n.documentCamera.isPerspective){var g=t.impl.getCanvasBoundingClientRect();e.x=e.x/Oe*(.5*g.height)+.5*g.width,e.y=-e.y/Oe*(.5*g.height)+.5*g.height,e=n.clientToWorld(e)}else{e.applyMatrix4(n.documentCamera.matrixWorld),e.sub(n.documentCamera.position);var y=t.model&&t.model.getData().globalOffset;y&&e.sub(y),e=n.documentCameraToMarkupsCamera(e)}return e},fu=function(e,t,n,r){var i=du(new THREE.Vector3,t,n,r),a=du(new THREE.Vector3(e,0,0),t,n,r);return i.distanceTo(a)},pu=function(e,t,n,r,i){var a=e.childNodes[0].childNodes[0],A=function(e){return a.getAttribute(e)||a.getAttribute(e.toLowerCase())},s=A("type")||"",u=i<5,l=n.model.isLeaflet(),h=n.model.isPdf(!0),d={style:{},anchors:[]},f={type:s,state:d},p=function(){for(var e=[],t=A("locations"),n=t&&t.split(" ")||"",r=0;r<n.length;r+=2){var i=new THREE.Vector3(parseFloat(n[r]),parseFloat(n[r+1]),0);e.push(i)}return e},g=function(e){var t=new THREE.Vector3,n=A(e);if(n){var r=n.split(" ");t.x=r[0]&&parseFloat(r[0])||0,t.y=r[1]&&parseFloat(r[1])||0,t.z=r[2]&&parseFloat(r[2])||0}return t},x=function(){return A("text")||""},F=A("groupId");F&&(d.groupId=F,d.groupOrder=parseFloat(A("groupOrder")));var _,H,R,L=A("uuid");switch(L&&(d.uuid=L),d.style=function(e){for(var t=It(c),n={},r=0;r<t.length;r++){var i=e.getAttribute(t[r]);if(i)switch(t[r]){case c.THICKNESS:n[t[r]]=parseFloat(i);break;case c.FONT_SIZE:case c.OPACITY:case c.FILL_OPACITY:n[t[r]]=parseFloat(i);break;case c.STROKE_LINEJOIN:break;case c.FONT_FAMILY:case c.FONT_STYLE:case c.FONT_WEIGHT:case c.COLOR:case c.FONT_COLOR:case c.FILL_COLOR:n[t[r]]=i}}return n[c.FONT_COLOR]||(n[c.FONT_COLOR]=n[c.COLOR]),n[c.FILL_COLOR]||(n[c.FILL_COLOR]=o.NO_COLOR),n[c.FILL_COLOR]===o.NO_COLOR&&(n[c.FILL_OPACITY]=de),n}(a),d.position=g("position"),d.rotation=(_=A("rotation"))&&parseFloat(_)||0,d.size=g("size"),n.impl.is2d||hu(n,t,!0),s){case v:case E:case m:d.anchors[0]=new THREE.Vector3(-d.size.x/2,-d.size.y/2,0),d.anchors[1]=new THREE.Vector3(d.size.x/2,-d.size.y/2,0),d.anchors[2]=new THREE.Vector3(d.size.x/2,d.size.y/2,0),d.anchors[3]=new THREE.Vector3(-d.size.x/2,d.size.y/2,0),u&&s!==E&&(R=d.style[c.THICKNESS]/2,d.anchors[0].add(new THREE.Vector3(R,R,0)),d.anchors[1].add(new THREE.Vector3(-R,R,0)),d.anchors[2].add(new THREE.Vector3(-R,-R,0)),d.anchors[3].add(new THREE.Vector3(R,-R,0)));break;case y:case Q:d.anchors[0]=g("tail"),d.anchors[1]=g("head"),u&&(d.rotation=0);break;case b:case S:d.text=x(),d.isFrameUsed=!!parseInt(A("isFrameUsed"),10),d.frameType=A("frameType")||v,u&&(d.isFrameUsed||(d.style[c.FILL_OPACITY]=0)),d.anchors[0]=new THREE.Vector3(-d.size.x/2,-d.size.y/2,0),d.anchors[1]=new THREE.Vector3(d.size.x/2,-d.size.y/2,0),d.anchors[2]=new THREE.Vector3(d.size.x/2,d.size.y/2,0),d.anchors[3]=new THREE.Vector3(-d.size.x/2,d.size.y/2,0);break;case T:case M:break;case w:case B:d.anchors=p();break;case C:case k:d.anchors=p(),d.closed=function(){var t=e.childNodes[1]||"",n=!1;if("string"!=typeof t){var r=t.getAttribute("d").split(" ");"z"===r[r.length-1].toLowerCase()&&(n=!0)}return n}();break;case U:d.anchors[0]=g("firstAnchor"),d.anchors[1]=g("secondAnchor"),H=g("offset"),d.position.sub(H),d.translation=du(H,n,r,t).sub(du(new THREE.Vector3,n,r,t)),d.text=x(),u&&(d.style[c.THICKNESS]/=2),d.style[c.FONT_SIZE]/=ze,d.style[c.THICKNESS]/=Ge}return(u||l||h)&&function(){if(d.style.hasOwnProperty(c.FONT_SIZE)){var e=r.getFontToWorldScale();d.style[c.FONT_SIZE]/=e}}(),Nt(d.anchors,d.position),(u&&n.model.is3d()||l||h)&&(d.anchors.forEach((function(e){e.copy(du(e,n,r,t))})),d.style[c.THICKNESS]=fu(d.style[c.THICKNESS],n,r,t),d.style[c.FONT_SIZE]=fu(d.style[c.FONT_SIZE],n,r,t)),f},gu=function(e,t,n,r){try{return JSON.parse(e)}catch(l){for(var i=function(e){var t;try{t=(new DOMParser).parseFromString(e,"text/xml").firstChild}catch(e){console.warn("stringToSvgNode failed to generate an HTMLElement from its string representation.")}return t}(e).childNodes,a=[],A=function(e){var t=e.getAttribute("data-model-version");return"string"==typeof t?parseFloat(t):0}(i[0].childNodes[0]),o=n.impl.is2d?null:n.getState(),s=0;s<i.length;s++){var u=i[s];if(u.childNodes[0].childNodes[0]){var c=pu(u,t,n,r,A);a.push(c)}}return o&&n.restoreState(o,null,!0),a}};function yu(e){return(yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vu(e){return function(e){if(Array.isArray(e))return mu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return mu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mu(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Eu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wu(e,t){return(wu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ku(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bu(e);if(t){var i=bu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Cu(this,n)}}function Cu(e,t){return!t||"object"!==yu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bu(e){return(bu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Su=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wu(e,t)}(A,Autodesk.Viewing.EventDispatcher);var t,n,r,i=ku(A);function A(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,A),(t=i.call(this)).markupsExtension=e,t.actionManager=new rr,t.registerEvents(),t.reset(),t}return t=A,(n=[{key:"registerEvents",value:function(){this.onHistoryChangedBinded=this.onHistoryChanged.bind(this),this.actionManager.addEventListener(rr.HISTORY_CHANGED_EVENT,this.onHistoryChangedBinded),this.onAllMarkupsLoadedBinded=this.onAllMarkupsLoaded.bind(this),this.addEventListener(a.ALL_MARKUPS_LOADED,this.onAllMarkupsLoadedBinded),this.onMarkupLayerFetchedBinded=this.onMarkupLayerFetched.bind(this),this.addEventListener(a.LAYER_FETCHED,this.onMarkupLayerFetchedBinded),this.onMarkupResourceFetchedBinded=this.onMarkupResourceFetched.bind(this),this.addEventListener(a.LAYER_RESOURCE_FETCHED,this.onMarkupResourceFetchedBinded),this.onMarkupLinkSyncedBinded=this.onMarkupLinkSynced.bind(this),this.addEventListener(a.LINK_SYNCED,this.onMarkupLinkSyncedBinded),this.onLayerSyncedBinded=this.onLayerSynced.bind(this),this.addEventListener(a.LAYER_SYNCED,this.onLayerSyncedBinded),this.onLayerSyncingBinded=this.onLayerSyncing.bind(this),this.addEventListener(a.LAYER_SYNCING,this.onLayerSyncingBinded),this.onLayerSelectedBinded=this.onLayerSelected.bind(this),this.addEventListener(a.LAYER_SELECTED,this.onLayerSelectedBinded),this.onLayerDeselectedBinded=this.onLayerDeselected.bind(this),this.addEventListener(a.LAYER_DESELECTED,this.onLayerDeselectedBinded),this.onCalibrationEndedBinded=this.onCalibrationEnded.bind(this),this.markupsExtension.viewer.addEventListener(Autodesk.Viewing.MeasureCommon.Events.FINISHED_CALIBRATION_FOR_DIMENSION_EVENT,this.onCalibrationEndedBinded),this.onDrawingStartBinded=this.onDrawingStart.bind(this),this.addEventListener(a.MARKUP_DRAWING_START,this.onDrawingStartBinded),this.onDrawingEndBinded=this.onDrawingEnd.bind(this),this.addEventListener(a.MARKUP_DRAWING_END,this.onDrawingEndBinded),this.addEventListener(a.MARKUP_DRAWING_CANCEL,this.onDrawingEndBinded)}},{key:"unregisterEvents",value:function(){this.actionManager.removeEventListener(rr.HISTORY_CHANGED_EVENT,this.onHistoryChangedBinded),this.removeEventListener(a.ALL_MARKUPS_LOADED,this.onAllMarkupsLoadedBinded),this.removeEventListener(a.LAYER_FETCHED,this.onMarkupLayerFetchedBinded),this.removeEventListener(a.LAYER_RESOURCE_FETCHED,this.onMarkupResourceFetchedBinded),this.removeEventListener(a.LINK_SYNCED,this.onMarkupLinkSyncedBinded),this.removeEventListener(a.LAYER_SYNCED,this.onLayerSyncedBinded),this.removeEventListener(a.LAYER_SYNCING,this.onLayerSyncingBinded),this.markupsExtension.viewer.removeEventListener(Autodesk.Viewing.MeasureCommon.Events.FINISHED_CALIBRATION_FOR_DIMENSION_EVENT,this.onCalibrationEndedBinded),this.removeEventListener(a.MARKUP_DRAWING_START,this.onDrawingStartBinded),this.removeEventListener(a.MARKUP_DRAWING_END,this.onDrawingEndBinded),this.removeEventListener(a.MARKUP_DRAWING_CANCEL,this.onDrawingEndBinded)}},{key:"createLayer",value:function(e){var t=new Zs(this.markupsExtension,this.nextLayerId,e);return this.layers[t.id]=t,this.nextLayerId+=1,this.dispatchEvent({type:a.LAYER_CREATED}),t}},{key:"loadLayers",value:function(e,t,n){var r=this;n&&(this.removeAllLayers([this.getActiveLayer()]),this.markupsExtension.markupsCache&&this.markupsExtension.markupsCache.cleanCache()),(e=e instanceof Array?e:[e]).forEach((function(e){r.markupsExtension.markupsCache&&e.guid&&!r.markupsExtension.markupsCache.get(e.guid)&&r.markupsExtension.markupsCache.add(e.guid,e)}));var i=t?e:this.markupsExtension.filterManager.filterLayers(e);this.getLayersAsList().forEach((function(e){e!==r.getActiveLayer()&&-1===i.findIndex((function(t){return t.guid===e.getGuid()}))&&r.removeLayer(e)})),i.forEach((function(e){if(!r.getLayerByGuid(e.guid)){var t=r.createLayer(e);r.markupsExtension.viewer.impl.is2d&&(t.setVisible(!0),r.loadMarkupsToLayer(t)),r.loadLinksToLayer(t)}}))}},{key:"removeLayer",value:function(e){var t=e.id,n=this.layers[t];n?(this.isMarkupSessionOpen()&&n===this.getActiveLayer()?this.endMarkupSession(!1):this.markupsExtension.viewer.model&&this.markupsExtension.viewer.model.is3d()&&this.isInMarkupView()&&this.getVisibleLayers()[0]===n&&this.exitMarkupView(),this.deselectLayer(e),e.deleteAllMarkups(),e.deleteAllLinks(),e.setVisible(!1),this.dispatchEvent({type:a.LAYER_DELETED,layer:e}),delete this.layers[t]):console.warn("deleteLayer - layer does not exist")}},{key:"removeAllLayers",value:function(e){var t=this;this.getLayersAsList().forEach((function(n){e&&-1!==e.indexOf(n)||t.removeLayer(n)}))}},{key:"deleteLayer",value:function(e){this.dispatchEvent({type:a.LAYER_DELETE,layerData:e.layerData})}},{key:"getLayerById",value:function(e){return this.layers[e]}},{key:"getLayerByGuid",value:function(e){return null==e?null:this.getLayersAsList().find((function(t){return t.getGuid()===e}))}},{key:"addMarkupToLayer",value:function(e,t){return this.getLayerById(t.id)||(this.layers[t.id]=t),this.getSelectedLayers().length>0&&!t.isSelected()&&e.changeTransparency(!0),(this.isMarkupSessionOpen()&&t!==this.getActiveLayer()||!this.isToolEnabled())&&e.disable(),t.addMarkup(e),!0}},{key:"addLinkToLayer",value:function(e,t){return this.getLayerById(t.id)||(this.layers[t.id]=t),t.addLink(e),!0}},{key:"createMarkup",value:function(e,t,n){var r=ws[e];return r?new r(this.markupsExtension,this.nextMarkupId++,t,n):null}},{key:"createLink",value:function(e,t){var n=t.position?(new THREE.Vector3).copy(t.position):null;n&&this.markupsExtension.viewer.model.isPdf(!0)&&Autodesk.Viewing.PDFUtils.leafletToPdfWorld(this.markupsExtension.viewer,n);var r=new ou[t.type](this.markupsExtension,this.nextLinkId,t.id,e,{position:n});return this.nextLinkId+=1,r}},{key:"onAllMarkupsLoaded",value:function(e){var t=e.amount;console.log("All markups have been loaded. Amount: "+t)}},{key:"onMarkupLayerFetched",value:function(e){var t=this,n=e.layerData;this.markupsExtension.filterManager.filterLayers([n]).forEach((function(e){var n=t.createLayer(e);t.markupsExtension.viewer.impl.is2d&&n.setVisible(!0)}))}},{key:"onMarkupResourceFetched",value:function(e){var t=e.layerData;if(this.markupsExtension.viewer.impl.is2d){var n=this.getLayerByGuid(t.guid);n&&this.loadMarkupsToLayer(n)}}},{key:"onMarkupLinkSynced",value:function(e){var t=e.documentAttachment,n=e.layerData,r=this.getLayerByGuid(n.guid);r&&(t&&t.status===q&&0===n.attachments.length&&r.deleteAllLinks(),this.loadLinksToLayer(r))}},{key:"onDrawingStart",value:function(){var e=this.getDuringCreationMarkup(!1);this.polySaveDisabled=e&&e.inEdit&&(e.type===k||e.type===C),this.dispatchEvent({type:a.LAYER_READY_TO_SAVE,readyToSave:this.getReadyToSave()})}},{key:"onDrawingEnd",value:function(){this.polySaveDisabled=!1,this.dispatchEvent({type:a.LAYER_READY_TO_SAVE,readyToSave:this.getReadyToSave()})}},{key:"getReadyToSave",value:function(){var e,t,n=this.getActiveLayer();n&&((e=n.isEmpty())||(t=n.getAllMarkups().some((function(e){return e.isTextMarkup()&&e.textInputHandler.isEmpty()}))));var r=this.markupsExtension.options.isMobileApp?!e:!e||e&&this.markupsExtension.permissionManager.canDeleteMarkup(n.layerData);return!(!n||!r||this.polySaveDisabled||t)}},{key:"removeMarkupFromLayer",value:function(e){var t=e.layer;return t?(this.duringCreationMarkup=null,e.deselect(),e.disableEdit(),t.deleteMarkup(e),!0):(console.warn("removeMarkupFromLayer - markup does not exist"),!1)}},{key:"getMarkupById",value:function(e){var t=null;return Lt(this.layers,(function(n){var r=n.getMarkupById(e);r&&(t=r)})),t}},{key:"getSelectedMarkups",value:function(){return this.getMarkupsByProperty("selected",!0)}},{key:"getUnselectedMarkups",value:function(){return this.getMarkupsByProperty("selected",!1)}},{key:"getSelectedLayers",value:function(){return this.getLayersByProperty("selected",!0)}},{key:"getUnselectedLayers",value:function(){return this.getLayersByProperty("selected",!1)}},{key:"getSelectedLayer",value:function(){return this.getSelectedLayers()[0]}},{key:"getVisibleLayers",value:function(){return this.getLayersByProperty("visible",!0)}},{key:"getVisibleMarkups",value:function(){return this.getMarkupsByProperty("visible",!0)}},{key:"getEnabledMarkups",value:function(){return this.getMarkupsByProperty("enabled",!0).filter((function(e){return!e.layer||e.layer.isVisible()}))}},{key:"getDisabledMarkups",value:function(){return this.getMarkupsByProperty("enabled",!1)}},{key:"getVisibleLinks",value:function(){var e=this.getVisibleLayers(),t=[];return e.forEach((function(e){e.getAllLinks().forEach((function(e){t.push(e)}))})),t}},{key:"getDirtyLinks",value:function(){return this.getLinksByProperty("dirty",!0)}},{key:"getSelectedLinks",value:function(){return this.getLinksByProperty("selected",!0)}},{key:"getInEditMarkups",value:function(){var e=this.getMarkupsByProperty("inEdit",!0);return this.duringCreationMarkup&&-1===e.indexOf(this.duringCreationMarkup)&&e.push(this.duringCreationMarkup),e}},{key:"getMarkupsByProperty",value:function(e,t){var n=[];return Lt(this.layers,(function(r){Lt(r.markups,(function(r){r[e]===t&&n.push(r)}))})),n}},{key:"getLayersByProperty",value:function(e,t){var n=[];return Lt(this.layers,(function(r){r[e]===t&&n.push(r)})),n}},{key:"getLinksByProperty",value:function(e,t){var n=[];return Lt(this.layers,(function(r){Lt(r.links,(function(r){r[e]===t&&n.push(r)}))})),n}},{key:"selectMarkup",value:function(e){(e=e instanceof Ma?e:this.getMarkupById(e))?e.select():console.warn("selectMarkup - markup does not exist")}},{key:"deselectMarkup",value:function(e){(e=e instanceof Ma?e:this.getMarkupById(e))?e.deselect():console.warn("selectMarkup - markup does not exist")}},{key:"deselectAllMarkups",value:function(e){this.getSelectedMarkups().forEach((function(t){e&&-1!==e.indexOf(t)||!t.isSelected()||t.deselect()}))}},{key:"unhoverAllLayers",value:function(){this.getLayersAsList().forEach((function(e){e.setHover(!1)}))}},{key:"unhoverAllMarkups",value:function(){this.getAllMarkups().forEach((function(e){e.setHover(!1)}))}},{key:"enableAllMarkups",value:function(){this.getAllMarkups().forEach((function(e){e.enable()}))}},{key:"disableAllMarkups",value:function(){this.getAllMarkups().forEach((function(e){e.disable()}))}},{key:"lockNavigation",value:function(){this.lockSettings||(this.lockSettings=this.markupsExtension.viewer.getNavigationLockSettings(),this.markupsExtension.viewer.setNavigationLockSettings({orbit:!1,pan:!1,zoom:!1,roll:!1,fov:!1,gotoview:!1,walk:!1}),this.markupsExtension.viewer.navigation.setIsLocked(!0)),this.dispatchEvent({type:a.MARKUP_VIEW_ENTERED})}},{key:"unlockNavigation",value:function(){this.lockSettings&&(this.markupsExtension.viewer.setNavigationLockSettings(this.lockSettings),this.markupsExtension.viewer.setNavigationLock(!1),this.markupsExtension.viewer.toolController.setIsLocked(!1),this.lockSettings=null)}},{key:"loadLayerIfHidden",value:function(e){var t=e instanceof Zs?e:this.getLayerByGuid(e);if(!t&&this.markupsExtension.markupsCache){var n=this.markupsExtension.markupsCache.get(e);if(n)if(this.markupsExtension.filterManager.filterWithGUID&&!n.loadedByName){var r=n.metadata.markup_metadata.sheetGUID;this.markupsExtension.options.sheetGUID!==r&&(n=null)}else{var i=n.metadata.markup_metadata.sheetName;this.markupsExtension.options.sheetName!==i&&(n=null)}n&&(this.loadLayers([n],!0),t=this.getLayerByGuid(e))}return t}},{key:"selectLayer",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},A=this.loadLayerIfHidden(e),o=i.bind(this);if(A){var s=A.isSelected();if(this.deselectAllLayers([A]),this.exitMarkupView([A]),this.markupsExtension.viewer.impl.is2d){if(A.select(),t){var u={horizontal:this.markupsExtension.viewer.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN,vertical:this.markupsExtension.viewer.navigation.FIT_TO_VIEW_VERTICAL_MARGIN};this.markupsExtension.viewer.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN=De,this.markupsExtension.viewer.navigation.FIT_TO_VIEW_VERTICAL_MARGIN=De;var c=A.getWorldBoundingBox();this.markupsExtension.viewer.navigation.fitBounds(n,c),this.markupsExtension.viewer.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN=u.horizontal,this.markupsExtension.viewer.navigation.FIT_TO_VIEW_VERTICAL_MARGIN=u.vertical}o()}else this.loadMarkupsToLayer(A),A.select(),this.navigationToolBackup=this.markupsExtension.viewer.getActiveNavigationTool(),this.markupsExtension.viewer.setActiveNavigationTool(this.markupsExtension.markupsTool.getName()),hu(this.markupsExtension.viewer,A.layerData,n||s,(function(){A.isSelected()&&(A.setVisible(!0),r.lockNavigation()),o()}))}else{this.dispatchEvent({type:a.LAYER_SELECTED_FROM_DIFFERENT_SHEET,layerGuid:e});var l=this.markupsExtension.cache;l.layerToSelect=this.loadRelevantSheet(e)}}},{key:"deselectLayer",value:function(e){(e=e instanceof Zs?e:this.getLayerByGuid(e))?e.isSelected()&&(e.deselect(),e.layerData&&0===this.markupsExtension.filterManager.filterLayers([e.layerData]).length&&this.removeLayer(e)):console.warn("deselectLayer - layer does not exist")}},{key:"deselectAllLayers",value:function(e){var t=this;this.getSelectedLayers().forEach((function(n){e&&-1!==e.indexOf(n)||!n.isSelected()||t.deselectLayer(n)}))}},{key:"loadRelevantSheet",value:function(e){var t,n=this,r=function(t,r){for(var i=0;i<n.markupsExtension.sheetList.length;i++){var a=n.markupsExtension.sheetList[i].search(Eu({},t,r))[0];if(a)return n.markupsExtension.options.loadDocumentCallback?n.markupsExtension.options.loadDocumentCallback(a):n.markupsExtension.viewer.loadDocumentNode(n.markupsExtension.viewer.model.getDocumentNode().getDocument(),a,{loadAsHidden:!1,applyRefPoint:!1,keepCurrentModels:!1}),e}return console.warn("loadRelevantSheet - Sheet not found (by ".concat(t,")")),null},i=function(){var e=a.metadata.markup_metadata.sheetName;if(e&&n.sheetName!==e)return a.loadedByName=!0,r("name",e)},a=this.markupsExtension.markupsCache.get(e);return a?this.markupsExtension.options.hasMultiSheet?this.markupsExtension.filterManager.filterWithGUID&&((t=a.metadata.markup_metadata.sheetGUID)&&n.sheetGUID!==t?r("guid",t):null)||i():void console.warn("loadRelevantSheet - Something weird just happened. This method shouldnt be called on Plans folder."):(console.warn("loadRelevantSheet - Cant find selected layer."),null)}},{key:"isInMarkupView",value:function(){var e=this.getVisibleLayers();return!this.isMarkupSessionOpen()&&e.length>0}},{key:"exitMarkupView",value:function(e){var t=this;if(!this.markupsExtension.viewer.impl.is2d&&this.isInMarkupView()){var n=this.getVisibleLayers();if(e&&(n=n.filter((function(t){return-1===e.indexOf(t)}))),0!==n.length){n.forEach((function(e){t.deselectLayer(e),e.setVisible(!1)})),this.unlockNavigation(),this.markupsExtension.viewer.setActiveNavigationTool(this.navigationToolBackup);var r=this.markupsExtension.viewer.getExtension("Autodesk.Section");r&&1===r.getSectionPlanes().length?r.setSectionFromPlane(null):this.markupsExtension.viewer.impl.setCutPlaneSet("__set_view",void 0),this.dispatchEvent({type:a.MARKUP_VIEW_EXITED})}}}},{key:"changeAllLayersTransparency",value:function(e,t){this.markupsExtension.isToolEnabled()&&this.getLayersAsList().forEach((function(n){t&&-1!==t.indexOf(n)||n.changeTransparency(e)}))}},{key:"onLayerSynced",value:function(e){var t=e.layerData,n=e.layer;if(n=n||this.getLayerByGuid(t.guid)){if(!this.isMarkupSessionOpen()){n.enable();var r=this.getSelectedLayer();(r&&r!==n||!this.markupsExtension.isToolEnabled())&&n.changeTransparency(!0)}0===this.markupsExtension.filterManager.filterLayers([t]).length&&this.removeLayer(n)}this.markupsExtension.options.onMarkupsSyncCallback&&this.markupsExtension.options.onMarkupsSyncCallback({count:this.markupsExtension.markupsCache.length()})}},{key:"onLayerSyncing",value:function(e){var t=e.layerData,n=e.layer;(n=n||this.getLayerByGuid(t.guid))&&(this.markupsExtension.viewer.impl.is2d&&n.deselect(),n.disable())}},{key:"selectLink",value:function(e){e?e.select():console.warn("selectLink - link does not exist")}},{key:"deselectLink",value:function(e){e?e.deselect():console.warn("deselectLink - link does not exist")}},{key:"deselectAllLinks",value:function(){var e=this;this.getSelectedLinks().forEach((function(t){e.deselectLink(t)}))}},{key:"getDuringCreationMarkup",value:function(e){if(!this.duringCreationMarkup&&e){var t=this.getMarkupCreationType(),n=this.createMarkup(t);n&&(n.setVisible(!0),n.enableEdit(),this.duringCreationMarkup=n)}return this.duringCreationMarkup}},{key:"getActiveLayer",value:function(){return this.activeLayer}},{key:"setActiveLayer",value:function(e){e=e instanceof Zs?e:this.getLayerById(e),this.activeLayer=e}},{key:"isMarkupSessionOpen",value:function(){return this.sessionOpen}},{key:"changeMarkupCreationType",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae;Jt(this.markupsExtension.viewer,(function(){var n=e.getDuringCreationMarkup(!1);n&&n.creationHandler.onEscape(),e.markupCreationType=t,e.markupsExtension.viewer.setActiveNavigationTool(t?e.markupsExtension.markupsTool.getName():e.navigationToolBackup),e.dispatchEvent({type:a.MARKUP_CREATION_TYPE_CHANGED,creationType:t}),t&&!e.isMarkupSessionOpen()&&t!==x&&e.startMarkupSession()}))}},{key:"getMarkupCreationType",value:function(){return this.markupCreationType}},{key:"setToolEnabled",value:function(e){var t=this;this.toolEnabled=e,e?this.enableAllMarkups():(this.deselectAllLayers(),this.deselectAllLinks(),this.disableAllMarkups()),(Autodesk.Viewing.isSafari()||Autodesk.Viewing.isIE11)&&setTimeout((function(){t.markupsExtension.markupsUI&&t.markupsExtension.markupsUI.toolbar.renderToolbar()}),1),this.dispatchEvent({type:a.MARKUP_TOOL_ENABLED_CHANGED,enable:e})}},{key:"isToolEnabled",value:function(){return this.toolEnabled}},{key:"startMarkupSession",value:function(e,t){return!!this.isToolEnabled()&&(this.deselectAllLayers(t&&[t]),this.exitMarkupView([t]),this.deselectAllLinks(),this.sessionOpen=!0,this.markupsExtension.markupsTool.updateToolPriority(),(t=t||this.createLayer()).setVisible(!0),this.setActiveLayer(t),this.navigationToolBackup=this.markupsExtension.viewer.getActiveNavigationTool(),this.markupsExtension.viewer.setActiveNavigationTool(this.markupsExtension.markupsTool.getName()),this.markupsExtension.viewer.impl.is2d||this.lockNavigation(),!e&&this.getMarkupCreationType()||this.changeMarkupCreationType(e),this.getAllMarkups().forEach((function(e){e.layer!==t&&e.disable()})),this.creationStatusType=this.markupsExtension.options.defaultMarkupStatus||N,this.contextMenu=this.markupsExtension.viewer.contextMenu,this.markupsExtension.viewer.setContextMenu(null),this.markupsExtension.viewer.impl.pauseHighlight(!0),this.markupsExtension.viewer.impl.disableSelection(!0),n=this.markupsExtension.viewer,(r=n.toolController.getTool("gestures"))&&(r.setGestureParameter("singletap","time",250),r.setGestureParameter("drag","threshold",0)),this.dispatchEvent({type:a.MARKUP_SESSION_START,layer:t}),!0);var n,r}},{key:"endMarkupSession",value:function(e){var t=this;if(this.isMarkupSessionOpen()){var n=this.getActiveLayer(),r=!1;if(e&&n.isEmpty()){if(n.layerData)return void this.dispatchEvent({type:a.LAYER_DELETE_EMPTY_PRESSED,onConfirmCB:function(){return t.deleteLayer(n)}});r=!0,e=!1}if(this.sessionOpen=!1,e||this.exitMarkupView(),this.markupsExtension.markupsTool&&this.markupsExtension.markupsTool.updateToolPriority(),this.changeMarkupCreationType(null),this.setActiveLayer(null),this.duringCreationMarkup&&this.duringCreationMarkup.creationHandler.creationCancel(),this.deselectAllMarkups(),this.enableAllMarkups(),this.unhoverAllMarkups(),!e)for(;!this.actionManager.isUndoStackEmpty();)this.undo();this.actionManager.clear();var i,A,o=n.isEmpty()||!e&&!n.getGuid();r?this.deleteLayer(n):o&&this.removeLayer(n),n.deselect(),this.markupsExtension.viewer.setContextMenu(this.contextMenu),this.markupsExtension.viewer.impl.pauseHighlight(!1),this.markupsExtension.viewer.impl.disableSelection(!1),i=this.markupsExtension.viewer,(A=i.toolController.getTool("gestures"))&&(A.restoreGestureParameterDefault("singletap","time"),A.restoreGestureParameterDefault("drag","threshold")),this.dispatchEvent({type:a.MARKUP_SESSION_END,layer:n,save:e})}}},{key:"editLayer",value:function(e,t,n,r){var i=this;if(this.isToolEnabled()){var A=this.loadLayerIfHidden(e);A?this.markupsExtension.permissionManager.canEditMarkup(A.layerData)?this.selectLayer(A,t,r,(function(){i.startMarkupSession(Ae,A),n&&(Autodesk.Viewing.isMobileDevice()||A.selectAllMarkups())})):console.warn("editLayer - Cant edit layer, permissions not valid."):(this.dispatchEvent({type:a.LAYER_EDITED_FROM_DIFFERENT_SHEET,layerGuid:e}),this.markupsExtension.cache.layerToEdit=this.loadRelevantSheet(e))}}},{key:"onLayerSelected",value:function(e){var t=e.layer;this.changeAllLayersTransparency(!0,[t])}},{key:"onLayerDeselected",value:function(){this.getSelectedLayer()||this.changeAllLayersTransparency(!1)}},{key:"deleteMarkup",value:function(e){(e=e instanceof Ma?e:this.getMarkupById(e))?e.creationHandler.deleteMarkup():console.warn("deleteMarkup - markup does not exist")}},{key:"deleteInEditMarkups",value:function(){var e=this;this.markupsToDelete=this.getInEditMarkups(),this.openActionGroup(),this.markupsToDelete.forEach((function(t){e.deleteMarkup(t)})),this.closeActionGroup()}},{key:"undo",value:function(){this.duringCreationMarkup?this.duringCreationMarkup.creationHandler.onEscape(!1):this.actionManager.undo()}},{key:"redo",value:function(){this.actionManager.redo()}},{key:"isActionGroupOpen",value:function(){return this.actionManager.isGroupOpen}},{key:"openActionGroup",value:function(){this.actionManager.openActionGroup()}},{key:"closeActionGroup",value:function(){this.actionManager.closeActionGroup()}},{key:"copy",value:function(){this.markupsToCopy=this.getSelectedMarkups(),this.pasteOffset=1}},{key:"paste",value:function(){var e=this;this.deselectAllMarkups(),this.openActionGroup(),this.markupsToCopy.forEach((function(t){e.duplicateMarkup(t)})),this.closeActionGroup(),this.pasteOffset+=1}},{key:"cut",value:function(){this.copy(),this.deleteInEditMarkups()}},{key:"duplicateMarkup",value:function(e){var t=this,n=function(){var e=t.markupsExtension.renderer.getCameraRightVector(),n=t.markupsExtension.renderer.getCameraUpVector(),r=t.markupsExtension.renderer.multiplyByNormaStrokeWidth(Fe*t.pasteOffset);return e.sub(n).normalize().multiplyScalar(r)},r=function(e){e.completed=!0;var n=t.activeLayer?t.activeLayer:t.createLayer();new Et(t,e,n).execute()};if(e.translationHandler&&!e.belongsToGroup()){var i=lt.cloneDeep(e.getState()),a=n();i.translation.add(a);var A=this.createMarkup(e.type,i);r(A),A.select()}else if(e.isGroupMarkup()){var o=lt.cloneDeep(e.getState()),s=n();o.uuid=THREE.Math.generateUUID(),o.componentsState=e.markups.map((function(e){var t=lt.cloneDeep(e.getState());return t.translation.add(s),t}));var u=this.createMarkup(e.type,o);r(u),u.markups.forEach((function(e){return r(e)})),u.select()}}},{key:"loadMarkupsToLayer",value:function(e){var t=this,n=e.layerData&&e.layerData.getSvgResource();if(n&&e.isEmpty()){var r=function(n){n.completed=!0,t.addMarkupToLayer(n,e),n.setDirty()},i=gu(n,e.layerData,this.markupsExtension.viewer,this.markupsExtension.renderer);i.forEach((function(e){if(!e.state.groupId){e.state.uuid&&(e.state.componentsState=i.filter((function(t){return e.state.uuid===t.state.groupId})).map((function(e){return e.state})));var n=t.createMarkup(e.type,e.state);n&&(r(n),n.isGroupMarkup()&&n.markups.forEach((function(e){return r(e)})))}}))}}},{key:"createLinkMetadata",value:function(e){var t=e.metadata;t.markup_metadata=t.markup_metadata||{},t.markup_metadata.links=t.markup_metadata.links||[],e.attachments.forEach((function(e){t.markup_metadata.links.some((function(t){return t.id===e.attributes.issue_id&&t.type===e.attributes.attachment_type}))||t.markup_metadata.links.push({id:e.attributes.issue_id,type:e.attributes.attachment_type,position:null})}))}},{key:"loadLinksToLayer",value:function(e){var t=this;this.createLinkMetadata(e.layerData);var n=e.layerData.getLinksMetadata();n&&n.forEach((function(n){if(!e.getAllLinks().find((function(e){return e.guid===n.id}))&&e.layerData.attachments.some((function(e){return e.attributes.issue_id===n.id}))){var r=t.createLink(e,n);t.addLinkToLayer(r,e),r.setDirty(!0)}}))}},{key:"changeStyleProperty",value:function(e,t,n){"string"==typeof t&&(t=o[t.toUpperCase()]||t),e===c.THICKNESS&&(t*=this.markupsExtension.renderer.getNormaStrokeWidth()),this.creationStyleProperties[e]=t,e===c.COLOR&&t!==o.NO_COLOR&&(this.creationStyleProperties[c.LAST_COLOR]=t),this.isMarkupSessionOpen()&&(this.openActionGroup(),this.getSelectedMarkups().forEach((function(r){r.creationHandler.changeStyleProperty(e,t,n)})),this.closeActionGroup()),this.dispatchEvent({type:a.MARKUP_STYLE_PROPERTY_CHANGED,styleProperty:e,value:t})}},{key:"getStyleProperty",value:function(e){return this.creationStyleProperties[e]}},{key:"onCalibrationEnded",value:function(){this.markupsExtension.setToolEnabled(!0),this.startMarkupSession(U)}},{key:"onHistoryChanged",value:function(e){e.actionGroup.forEach((function(e){e.markup.setDirty()})),this.dispatchEvent(e),this.dispatchEvent({type:a.LAYER_READY_TO_SAVE,readyToSave:this.getReadyToSave()})}},{key:"getLayersAsList",value:function(){return It(this.layers)}},{key:"getAllMarkups",value:function(){var e=[];return Lt(this.layers,(function(t){e.push.apply(e,vu(It(t.markups)))})),e}},{key:"generateScreenCapture",value:function(e){var t=this;return new Promise((function(n){setTimeout((function(){!function(e,t,n){var r,i=e.getExtension("Autodesk.BIM360.Markups");n&&e.impl.is2d&&(r=n.getWorldBoundingBox(),Autodesk.Viewing.ScreenShot.makeBoundsSquare(r));var a={bounds:r,margin:n?De:0,overlayRenderer:Yt,overlayRendererExtraOptions:{markupLayer:n},getCropBounds:n&&function(e,t){r=n.getWorldBoundingBox(),Autodesk.Viewing.ScreenShot.makeBoundsSquare(r);var a=i.renderer.markupsCamera;e.impl.is2d&&(i.renderer.markupsCamera=t);var A=i.renderer.worldToClient(r.min),o=i.renderer.worldToClient(r.max);i.renderer.markupsCamera=a;var s=(new THREE.Box3).setFromPoints([A,o]);Autodesk.Viewing.ScreenShot.makeBoundsSquare(s,qe);var u=s.size().x;return s.expandByVector(new THREE.Vector3(u*De,u*De,0)),s}};Autodesk.Viewing.ScreenShot.getScreenShotAtScreenSize(e,t,a)}(t.markupsExtension.viewer,(function(e){n(e)}),e)}),100)}))}},{key:"changeCreationStatusType",value:function(e){this.creationStatusType=e}},{key:"getCreationStatusType",value:function(){return this.creationStatusType}},{key:"setDefaultCreationStyleProperties",value:function(){this.creationStyleProperties={},this.changeStyleProperty(c.LAST_COLOR,oe),this.changeStyleProperty(c.COLOR,oe),this.changeStyleProperty(c.FILL_COLOR,ue),this.changeStyleProperty(c.THICKNESS,ce),this.changeStyleProperty(c.OPACITY,le),this.changeStyleProperty(c.FILL_OPACITY,de),this.changeStyleProperty(c.FONT_SIZE,pe),this.changeStyleProperty(c.FONT_WEIGHT,ye),this.changeStyleProperty(c.FONT_FAMILY,ve),this.changeStyleProperty(c.FONT_STYLE,me),this.changeStyleProperty(c.FONT_COLOR,se)}},{key:"reset",value:function(){this.nextMarkupId=0,this.nextLinkId=0,this.nextLayerId=0,this.sessionOpen=!1,this.layers={},this.selectedLayers=[],this.duringCreationMarkup=null,this.activeLayer=null,this.markupCreationType=null,this.markupsToCopy=[],this.pasteOffset=1,this.toolEnabled=!0,this.contextMenu=null,this.actionManager.clear(),this.creationStyleProperties={}}},{key:"destroy",value:function(){this.removeAllLayers(),this.unlockNavigation(),this.unregisterEvents(),this.reset(),this.clearListeners(),this.markupsExtension=null,this.actionManager=null}}])&&Bu(t.prototype,n),r&&Bu(t,r),A}();n(436);function Tu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Mu=Autodesk.Viewing,Uu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.setGlobalManager(t.globalManager),this.viewer=this.markupsExtension.viewer,this.container=this.viewer.appendOrderedElementToViewer("markup-frames-container"),this.container.className="markup-frames-container",this.markupFrames={},this.layerFrames={},this.anchors={},this.segments={},this.rotationAxis=new THREE.Vector3(0,0,1),this.registerEventListeners()}var t,n,r;return t=e,(n=[{key:"registerEventListeners",value:function(){this.onMarkupDirtyBinded=this.onMarkupDirty.bind(this),this.onLayerDirtyBinded=this.onLayerDirty.bind(this),this.onLayerDeletedBinded=this.onLayerDeleted.bind(this),this.onMarkupRemovedBinded=this.onMarkupRemoved.bind(this),this.renderAllBinded=this.renderAll.bind(this),this.onRectSelectorUpdatedBinded=this.onRectSelectorUpdated.bind(this),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_DIRTY,this.onMarkupDirtyBinded),this.markupsExtension.markupsManager.addEventListener(a.LAYER_DIRTY,this.onLayerDirtyBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_REMOVED,this.onMarkupRemovedBinded),this.markupsExtension.markupsManager.addEventListener(a.LAYER_DELETED,this.onLayerDeletedBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_SESSION_START,this.renderAllBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_SESSION_END,this.renderAllBinded),this.markupsExtension.markupsManager.addEventListener(a.RECT_SELECTOR_UPDATED,this.onRectSelectorUpdatedBinded),this.viewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.renderAllBinded)}},{key:"unregisterEventListeners",value:function(){this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_DIRTY,this.onMarkupDirtyBinded),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_DIRTY,this.onLayerDirtyBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_REMOVED,this.onMarkupRemovedBinded),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_DELETED,this.onLayerDeletedBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_SESSION_START,this.renderAllBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_SESSION_END,this.renderAllBinded),this.markupsExtension.markupsManager.removeEventListener(a.RECT_SELECTOR_UPDATED,this.onRectSelectorUpdatedBinded),this.viewer.removeEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.renderAllBinded)}},{key:"renderAll",value:function(){var e=this.markupsExtension.markupsManager.getAllMarkups();this.renderMarkups(e);var t=this.markupsExtension.markupsManager.getLayersAsList();this.renderLayers(t)}},{key:"onMarkupDirty",value:function(e){var t=e.markup;this.renderMarkups([t])}},{key:"onLayerDirty",value:function(e){var t=e.layer;this.renderLayerSelectionFrame(t)}},{key:"renderLayers",value:function(e){var t=this;e.forEach((function(e){t.renderLayerSelectionFrame(e)}))}},{key:"renderMarkups",value:function(e){var t=this;e.forEach((function(e){e.belongsToGroup()||t.renderMarkupSelectionFrame(e),t.renderTransformAnchors(e),e.layer&&t.renderLayerSelectionFrame(e.layer)}))}},{key:"renderFrame",value:function(e,t,n){var r=this.getDocument();if(!e){(e=r.createElement("div")).className="markup-selection-frame-container",this.container.appendChild(e);var i=r.createElement("div");i.className="markup-selection-frame fill",i.style.width="".concat(Ne,"px"),i.style.height="".concat(Ne,"px"),Autodesk.Viewing.isIOSDevice()&&(i.className+=" ios"),e.appendChild(i),e.fillElement=i;for(var a=0;a<4;a++){var A=r.createElement("div");A.className="markup-selection-frame border",A.style.width="".concat(Ne,"px"),A.style.height="".concat(Ne,"px"),Autodesk.Viewing.isIOSDevice()&&(A.className+=" ios"),e.appendChild(A),e["border_".concat(a)]=A}}e.classList.contains("visible")||(e.classList.add("visible"),e.offsetHeight),n&&!e.fillElement.classList.contains("visible")?(e.fillElement.classList.add("visible"),e.fillElement.offsetHeight):!n&&e.fillElement.classList.contains("visible")&&(e.fillElement.classList.remove("visible"),e.fillElement.offsetHeight);var o=t.getClientBoundingBox(!0),s=o.center();s.x-=Ne/2,s.y-=Ne/2;var u=o.size(),c=st.radiansToDegrees(t.getRotation()+this.markupsExtension.renderer.getCameraRotation())||0;return n&&(e.fillElement.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px) rotate(").concat(c,"deg) scale(").concat(u.x/Ne,", ").concat(u.y/Ne,")")),e.border_0.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px) rotate(").concat(c,"deg) translate(0px, ").concat(u.y/2,"px) scale(").concat(u.x/Ne,", ").concat(1/Ne,")"),e.border_1.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px) rotate(").concat(c,"deg) translate(0px, ").concat(-u.y/2,"px) scale(").concat(u.x/Ne,", ").concat(1/Ne,")"),e.border_2.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px) rotate(").concat(c,"deg) translate(").concat(u.x/2,"px, 0px) scale(").concat(1/Ne,", ").concat(u.y/Ne,")"),e.border_3.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px) rotate(").concat(c,"deg) translate(").concat(-u.x/2,"px, 0px) scale(").concat(1/Ne,", ").concat(u.y/Ne,")"),e}},{key:"renderMarkupSelectionFrame",value:function(e){var t=this.markupFrames[e.id],n=e.isHovered(),r=e.isSelected();(r||n)&&e.layer?this.markupFrames[e.id]=this.renderFrame(t,e,r):t&&t.classList.contains("visible")&&(t.classList.remove("visible"),t.offsetHeight)}},{key:"renderLayerSelectionFrame",value:function(e){var t=this.layerFrames[e.id],n=e.isHovered(),r=e.isSelected(),i=e.isVisible();(r||n)&&i&&!this.markupsExtension.markupsManager.isMarkupSessionOpen()?this.layerFrames[e.id]=this.renderFrame(t,e,!1):t&&t.classList.contains("visible")&&(this.container.removeChild(t),delete this.layerFrames[e.id])}},{key:"_renderScaleAnchors",value:function(e){var t=this;if(e.scaleHandler)if(e.isInEdit()){var n=e.scaleHandler.getScaleAnchors(),r=e.getClientCenter();n.forEach((function(n,i){var a="".concat(e.id,"_scale_").concat(i),A=e.getRotation()+t.markupsExtension.renderer.getCameraRotation();st.applyRotation(n.pos,A,r,t.rotationAxis);var o=e.scaleHandler.isDragging()&&n.id===e.scaleHandler.scaleAnchor.id;t.createAnchorElement(a,n.pos,o,A,"rectangle")}))}else for(var i=0;i<8;i++){var a="".concat(e.id,"_scale_").concat(i);this.anchors[a]&&this.anchors[a].classList.contains("visible")&&this.anchors[a].classList.remove("visible")}}},{key:"_renderRotationAnchor",value:function(e){if(e.rotationHandler){var t="".concat(e.id,"_rotation_anchor");if(e.isInEdit()){var n=e.rotationHandler.getRotationAnchor(),r=e.rotationHandler.isDragging();this.createAnchorElement(t,n,r);var i=e.getClientBoundingBox(!0),a=i.center().add(new THREE.Vector3(0,i.size().y/2,0)),A=i.center(),o=e.getRotation()+this.markupsExtension.renderer.getCameraRotation();st.applyRotation(a,o,A,this.rotationAxis),this.createSegment(t,a,n)}else this.anchors[t]&&this.anchors[t].classList.contains("visible")&&(this.anchors[t].classList.remove("visible"),this.segments[t].classList.remove("visible"))}}},{key:"_renderAnchors",value:function(e){var t=this;if(e.anchorHandler){var n,r=function(e){var n=t.anchors[e];n&&n.classList.contains("visible")&&n.classList.remove("visible")},i=function(e){var n=t.segments[e];n&&n.classList.contains("visible")&&n.classList.remove("visible")},a="".concat(e.id,"_anchor"),A=e.anchorHandler.getAnchors();if(e.isInEdit()){for(var o=e.getClientCenter(),s=function(n){return e.applyScaleAndTranslation(n),n=t.markupsExtension.renderer.worldToClient(n),st.applyRotation(n,e.getRotation(),o,t.rotationAxis),n},u=null,c=null,l=0;l<A.length;l++){var h="".concat(a,"_").concat(l);c=s(A[l].clone());var d=A[l]===e.anchorHandler.activeAnchor;e.isAnchorHandlingAllowed(A[l])&&this.createAnchorElement(h,c,d),e.showPath()&&l>0&&this.createSegment(h,u,c),u=c}if(e.showPath()&&e.editState.closed){var f="".concat(a,"_").concat(A.length),p=s(A[0].clone());this.createSegment(f,c,p)}for(var g=(n=a,Object.keys(t.anchors).filter((function(e){return 0===e.indexOf(n)}))),y=function(e){return Object.keys(t.segments).filter((function(t){return 0===t.indexOf(e)}))}(a),v=A.length;v<g.length;v++)r("".concat(a,"_").concat(v));for(var m=e.editState.closed?y.length:y.length+1,E=A.length;E<m;E++)i("".concat(a,"_").concat(E))}else for(var B=0;B<=A.length;B++){var w="".concat(a,"_").concat(B);r(w),i(w)}}}},{key:"renderTransformAnchors",value:function(e){e.isCompleted()&&(this._renderScaleAnchors(e),this._renderRotationAnchor(e),this._renderAnchors(e))}},{key:"createAnchorElement",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=this.anchors[e],A=this.getDocument();if(!a){(a=A.createElement("div")).className="markup-anchor "+i;var o="".concat(2*be,"px");a.style.width=o,a.style.height=o,this.container.appendChild(a),this.anchors[e]=a;var s=A.createElement("div");s.className="markup-anchor-fill "+i,a.appendChild(s),a.anchorFill=s}a.classList.contains("visible")||a.classList.add("visible"),n&&!a.anchorFill.classList.contains("visible")?a.anchorFill.classList.add("visible"):!n&&a.anchorFill.classList.contains("visible")&&a.anchorFill.classList.remove("visible");var u=st.radiansToDegrees(r);a.style.transform="translate(".concat(t.x-be,"px, ").concat(t.y-be,"px) rotate(").concat(u,"deg)")}},{key:"createSegment",value:function(e,t,n){var r=this.segments[e],i=this.getDocument();r||((r=i.createElement("div")).className="markup-selection-frame segment border",r.style.width="".concat(Ne,"px"),r.style.height="".concat(Ne,"px"),this.container.appendChild(r),this.segments[e]=r),r.classList.contains("visible")||r.classList.add("visible");var a=t.clone().add(n).multiplyScalar(.5);a.x-=Ne/2,a.y-=Ne/2;var A=t.distanceTo(n),o=st.getSignedAngle(n.clone().sub(t),this.markupsExtension.renderer.getCameraUpVector(),this.markupsExtension.renderer.getCameraEyeVector());r.style.transform="translate(".concat(a.x,"px, ").concat(a.y,"px) rotate(").concat(st.radiansToDegrees(o+this.markupsExtension.renderer.getCameraRotation()),"deg) scale(").concat(1/Ne,", ").concat(A/Ne,")")}},{key:"onLayerDeleted",value:function(e){var t=e.layer.id,n=this.layerFrames[t];n&&this.container.removeChild(n),delete this.layerFrames[t]}},{key:"onMarkupRemoved",value:function(e){var t=e.markup,n=t.id,r=this.markupFrames[n];r&&this.container.removeChild(r),delete this.markupFrames[n],t.layer&&t.layer.isEmpty()&&this.onLayerDeleted(t)}},{key:"onRectSelectorUpdated",value:function(e){var t=e.bounds,n=this.getDocument();this.rectSelectorFrame||(this.rectSelectorFrame=n.createElement("div"),this.rectSelectorFrame.className="rect-selector-frame",this.container.appendChild(this.rectSelectorFrame));var r=!t.empty();r&&!this.rectSelectorFrame.classList.contains("visible")?(this.rectSelectorFrame.classList.add("visible"),this.rectSelectorFrame.offsetHeight):!r&&this.rectSelectorFrame.classList.contains("visible")&&(this.rectSelectorFrame.classList.remove("visible"),this.rectSelectorFrame.offsetHeight);var i=t.clone();i.min=this.markupsExtension.renderer.worldToClient(i.min),i.max=this.markupsExtension.renderer.worldToClient(i.max);var a=i.size();this.rectSelectorFrame.style.width="".concat(Math.abs(a.x),"px"),this.rectSelectorFrame.style.height="".concat(Math.abs(a.y),"px"),this.rectSelectorFrame.style.transformOrigin="top left",this.rectSelectorFrame.style.transform="translate(".concat(i.min.x,"px, ").concat(i.min.y,"px) scale(").concat(Math.sign(a.x),", ").concat(Math.sign(a.y),")")}},{key:"destroy",value:function(){var e=this;this.unregisterEventListeners(),Lt(this.markupFrames,(function(t){e.container.removeChild(t)})),this.markupFrames=null,Lt(this.layerFrames,(function(t){e.container.removeChild(t)})),this.layerFrames=null,Lt(this.anchors,(function(t){e.container.removeChild(t)})),this.anchors=null,Lt(this.segments,(function(t){e.container.removeChild(t)})),this.segments=null,this.markupsExtension=null,this.viewer=null}}])&&Tu(t.prototype,n),r&&Tu(t,r),e}();Mu.GlobalManagerMixin.call(Uu.prototype);n(438);function Qu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xu=Autodesk.Viewing,Fu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.setGlobalManager(t.globalManager),this.viewer=this.markupsExtension.viewer,this.container=this.viewer.appendOrderedElementToViewer("markup-links-container"),this.container.className="markup-links-container",this.links={},this.linksSizeCache={},this.registerEventListeners()}var t,n,r;return t=e,(n=[{key:"registerEventListeners",value:function(){this.onLinkDirtyBinded=this.onLinkDirty.bind(this),this.onMarkupDirtyBinded=this.onMarkupDirty.bind(this),this.renderAllLinksBinded=this.renderAllLinks.bind(this),this.onLinkDeletedBinded=this.onLinkDeleted.bind(this),this.markupsExtension.markupsManager.addEventListener(a.LINK_DIRTY,this.onLinkDirtyBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_DIRTY,this.onMarkupDirtyBinded),this.markupsExtension.markupsManager.addEventListener(a.LINK_SYNCED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.addEventListener(a.LINK_REMOVED,this.onLinkDeletedBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_SESSION_START,this.renderAllLinksBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_SESSION_END,this.renderAllLinksBinded),this.markupsExtension.markupsManager.addEventListener(a.LAYER_SELECTED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.addEventListener(a.LAYER_DESELECTED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_VIEW_EXITED,this.renderAllLinksBinded),this.viewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.renderAllLinksBinded)}},{key:"unregisterEventListeners",value:function(){this.markupsExtension.markupsManager.removeEventListener(a.LINK_DIRTY,this.onLinkDirtyBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_DIRTY,this.onMarkupDirtyBinded),this.markupsExtension.markupsManager.removeEventListener(a.LINK_SYNCED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.removeEventListener(a.LINK_REMOVED,this.onLinkDeletedBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_SESSION_START,this.renderAllLinksBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_SESSION_END,this.renderAllLinksBinded),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_SELECTED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_DESELECTED,this.renderAllLinksBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_VIEW_EXITED,this.renderAllLinksBinded),this.viewer.removeEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.renderAllLinksBinded)}},{key:"onMarkupDirty",value:function(e){var t=this,n=e.markup;n.layer&&Lt(n.layer.links,(function(e){t.renderLink(e)}))}},{key:"onLinkDirty",value:function(e){var t=e.link;this.renderLink(t)}},{key:"renderLink",value:function(e){if(!e.layer.isEmpty()){var t="".concat(e.layer.id,"_link_").concat(e.id);if(e.isVisible()){var n=e.isSelected(),r=e.isHovered(),i=this.markupsExtension.markupsManager.getActiveLayer()===e.layer,a=e.layer.layerData.attachments.length,A=this.markupsExtension.markupsManager.isMarkupSessionOpen()&&!i||this.markupsExtension.markupsManager.getSelectedLayers().length>0&&!e.layer.isSelected()||!this.markupsExtension.isToolEnabled();this.createLinkElement(t,e,n,i,r,a,A)}else this.links[t]&&this.links[t].classList.remove("visible");e.setDirty(!1)}}},{key:"renderAllLinks",value:function(){var e=this,t=this.markupsExtension.markupsManager.layers;Lt(t,(function(t){Lt(t.links,(function(t){e.renderLink(t)}))})),this.markupsExtension.markupsManager.dispatchEvent({type:a.LINK_RENDERED})}},{key:"createLinkElement",value:function(e,t,n,r,i,a,A){var o=this.links[e],s=this.getDocument();if(!o){(o=s.createElement("div")).className="link";var u=s.createElement("div");u.className="link-document-attachment",o.appendChild(u),this.container.appendChild(o),this.links[e]=o}o.classList.contains("visible")||o.classList.add("visible"),A&&!o.classList.contains("transparent")?o.classList.add("transparent"):!A&&o.classList.contains("transparent")&&o.classList.remove("transparent"),n&&!o.classList.contains("selected")?o.classList.add("selected"):!n&&o.classList.contains("selected")&&o.classList.remove("selected"),i&&!o.classList.contains("hover")?o.classList.add("hover"):!i&&o.classList.contains("hover")&&o.classList.remove("hover"),r&&!o.classList.contains("editable")?o.classList.add("editable"):!r&&o.classList.contains("editable")&&o.classList.remove("editable");var c=a>99?"99+":a;o.firstChild.innerText=c,this.linksSizeCache[c]||(this.linksSizeCache[c]=o.firstChild.getBoundingClientRect());var l=new THREE.Box3,h=new THREE.Vector3(this.linksSizeCache[c].width/2,this.linksSizeCache[c].height/2,0);l.expandByPoint(new THREE.Vector3),l.expandByVector(h),o.boundingBox=l;var d=t.getPosition(),f=this.markupsExtension.renderer.worldToClient(d);o.style.transform="translate(".concat(Math.round(f.x-this.linksSizeCache[c].width/2),"px, ").concat(Math.round(f.y-this.linksSizeCache[c].height/2),"px)"),l.makeEmpty(),l.expandByPoint(f),l.expandByVector(h)}},{key:"getLinkBoundingBox",value:function(e){var t="".concat(e.layer.id,"_link_").concat(e.id),n=this.links[t];return n?n.boundingBox:new THREE.Box3}},{key:"onLinkDeleted",value:function(e){var t=e.link,n="".concat(t.layer.id,"_link_").concat(t.id),r=this.links[n];r&&this.container.removeChild(r),delete this.links[n]}},{key:"destroy",value:function(){var e=this;this.unregisterEventListeners(),Lt(this.links,(function(t){e.container.removeChild(t)})),this.links=null,this.markupsExtension=null,this.viewer=null}}])&&Qu(t.prototype,n),r&&Qu(t,r),e}();function _u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}xu.GlobalManagerMixin.call(Fu.prototype);var Hu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.viewer=t.viewer,this.materials={}}var t,n,r;return t=e,(n=[{key:"_getHashName",value:function(e,t,n,r){var i=e;return n?(i+="|f",t[c.FILL_COLOR]&&(i+="|c"+t[c.FILL_COLOR]),void 0!==t[c.FILL_OPACITY]&&(i+="|o"+t[c.FILL_OPACITY]*(r?Ye:1))):(t[c.THICKNESS]&&(i+="|t"+t[c.THICKNESS]),t[c.COLOR]&&(i+="|c"+t[c.COLOR]),void 0!==t[c.OPACITY]&&(i+="|o"+t[c.OPACITY]*(r?Ye:1))),i}},{key:"_setResolution",value:function(e,t){e.uniforms&&e.uniforms.resolution&&e.uniforms.resolution.value.set(t.width,t.height)}},{key:"getMaterial",value:function(e,t,n){var r=this._getHashName(e,t,n);return this.materials[r]?this.materials[r]:null}},{key:"_setFillBlending",value:function(e){e.blending=e.opacity<1?THREE.NoBlending:THREE.NormalBlending}},{key:"_setStrokeBlending",value:function(e){e.uniforms.opacity.value<1?(e.blending=THREE.CustomBlending,e.blendDst=THREE.ZeroFactor,e.blendSrc=THREE.OneFactor,e.blendEquation=THREE.AddEquation,Autodesk.Viewing.isIE11||(e.blendEquationAlpha=THREE.MaxEquation)):e.blending=THREE.NormalBlending}},{key:"_createStrokeMaterial",value:function(e,t,n){var r=this.markupsExtension.renderer.getResolution(),i=new fa({color:new THREE.Color(e[c.COLOR]),opacity:e[c.OPACITY]*(n?Ye:1),resolution:new THREE.Vector2(r.width,r.height),lineWidth:e[c.THICKNESS],side:THREE.FrontSide,miter:t});return this._setStrokeBlending(i),i}},{key:"_createFillMaterial",value:function(e,t){var n={color:new THREE.Color(e[c.FILL_COLOR]),transparent:!0,opacity:e[c.FILL_OPACITY]*(t?Ye:1),side:THREE.DoubleSide,wireframe:!1},r=new THREE.MeshBasicMaterial(n);return this._setFillBlending(r),r}},{key:"_editStrokeMaterial",value:function(e,t,n){e.uniforms.color.value.setStyle(t[c.COLOR]),e.uniforms.lineWidth.value=t[c.THICKNESS],e.uniforms.opacity.value=t[c.OPACITY]*(n?Ye:1),this._setStrokeBlending(e)}},{key:"_editFillMaterial",value:function(e,t,n){e.color.setStyle(t[c.FILL_COLOR]),e.opacity=t[c.FILL_OPACITY]*(n?Ye:1),e.needsUpdate=!0,this._setFillBlending(e)}},{key:"hasThicknessChanged",value:function(e,t){return e&&t&&e.uniforms&&t.uniforms&&e.uniforms.lineWidth.value!==t.uniforms.lineWidth.value}},{key:"addMaterial",value:function(e,t){var n=e.type,r=e.editState.style,i=e.isTransparent(),a=this._getHashName(n,r,t,i);if(this.materials[a])this.materials[a].refCount++;else{var A=t?this._createFillMaterial(r,i):this._createStrokeMaterial(r,e.needsMiter(),i);A.depthWrite=!1,A.depthTest=!1,A.transparent=!0,A.refCount=1,A.name=a,this.materials[a]=A}return this.materials[a]}},{key:"removeMaterial",value:function(e){this.materials[e.name]?(e.refCount--,0===e.refCount&&(e.dispose(),e.needsUpdate=!0,delete this.materials[e.name])):console.error("Trying to remove a non-existing material")}},{key:"editMaterial",value:function(e,t,n){if(this.materials[e.name]){var r=t.type,i=t.editState.style,a=t.isTransparent(),A=this._getHashName(r,i,n,a);if(A!==e.name)return 1!==e.refCount||this.materials[A]?(this.removeMaterial(e),this.addMaterial(t,n)):(n?this._editFillMaterial(e,i,a):this._editStrokeMaterial(e,i,a),delete this.materials[e.name],e.name=A,this.materials[A]=e,e.needsUpdate=!0,e)}else console.error("Trying to edit a non-existing material")}},{key:"destroy",value:function(){for(var e in this.materials)this.materials[e].dispose(),this.materials[e].needsUpdate=!0;this.materials={}}},{key:"updateScreenSize",value:function(e){for(var t in this.materials)this._setResolution(this.materials[t],e)}}])&&_u(t.prototype,n),r&&_u(t,r),e}(),Ru=n(280),Lu=n.n(Ru);n(440);function Du(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Iu=Autodesk.Viewing,Ou=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.setGlobalManager(t.globalManager),this.viewer=this.markupsExtension.viewer,this.container=this.viewer.appendOrderedElementToViewer("markup-text-container"),this.container.className="markup-text-container",this.labels={},this.textMarkups={},this.textSizeCache={},this.registerEventListeners()}var t,n,r;return t=e,(n=[{key:"registerEventListeners",value:function(){this.onMarkupRemovedBinded=this.onMarkupRemoved.bind(this),this.onCameraChangedBinded=this.onCameraChanged.bind(this),this.onMarkupVisibilityChangedBinded=this.onMarkupVisibilityChanged.bind(this),this.onResizeBinded=this.onResize.bind(this),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_VISIBILITY_CHANGED,this.onMarkupVisibilityChangedBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_REMOVED,this.onMarkupRemovedBinded),this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResizeBinded)}},{key:"unregisterEventListeners",value:function(){this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_VISIBILITY_CHANGED,this.onMarkupVisibilityChangedBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_REMOVED,this.onMarkupRemovedBinded),this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResizeBinded)}},{key:"onCameraChanged",value:function(){this.renderTextMarkups()}},{key:"onResize",value:function(){var e=this;this.viewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,(function(){e.onCameraChanged()}),{once:!0})}},{key:"renderTextMarkups",value:function(){var e=this;Lt(this.textMarkups,(function(t){e.renderMarkup(t)}))}},{key:"updateLabelPositionAndSize",value:function(e,t){function n(t,n){e.styleCache[t]!==n&&(e.style[t]=n,e.styleCache[t]=n)}var r=t.getEditState().text,i=t.getTextStyle(),a=this.markupsExtension.renderer.getFontToWorldScale(),A=this.markupsExtension.renderer.sizeFromWorldToClient(a),o=t.getClientBoundingBoxTextOnly(),s=o.center(),u=o.size(),c=st.radiansToDegrees(t.getRotation()+this.markupsExtension.renderer.getCameraRotation());if(Autodesk.Viewing.isSafari()||Autodesk.Viewing.isIOSDevice()){var l=parseFloat(i.fontSize)*A,h=Math.floor(l)||1,d=l/h,f=u.x/d;i.width="".concat(f,"px"),i.fontSize="".concat(h,"px"),Object.keys(i).forEach((function(e){n(e,i[e])})),e.style.transform="translate(".concat(s.x,"px, ").concat(s.y,"px)\n                                    translate(-50%, -50%)\n                                    rotate(").concat(c,"deg)\n                                    scale(").concat(d,")")}else{var p=t.getTextWidthInFontScale(),g=p.preciseWidth,y=p.width;i.width="".concat(y,"px"),Object.keys(i).forEach((function(e){n(e,i[e])}));var v=(g-y)*A;e.style.transform="translate(".concat(s.x-v/2,"px, ").concat(s.y,"px)\n                                    translate(-50%, -50%)\n                                    rotate(").concat(c,"deg)\n                                    scale(").concat(A,")")}t.textInputHandler.textboxActive||(e.innerText=r||"")}},{key:"renderMarkup",value:function(e){if(e.editState.anchors[0]){var t=this.labels[e.id],n=this.getDocument();if(!t){(t=n.createElement("div")).className="markup-text",t.id=e.id;var r=e.getEditState().text;t.innerText=r||"",t.styleCache={},this.container.appendChild(t),this.labels[e.id]=t,this.textMarkups[e.id]=e}e.isVisible()&&!t.classList.contains("visible")?t.classList.add("visible"):!e.isVisible()&&t.classList.contains("visible")&&t.classList.remove("visible"),e.editState.isSingleLine&&!t.classList.contains("single-line")&&t.classList.add("single-line"),e.isVisible()&&this.updateLabelPositionAndSize(t,e)}}},{key:"getLabel",value:function(e){return this.labels[e.id]}},{key:"onMarkupVisibilityChanged",value:function(e){var t=e.markup;e.visible,t.type===S&&this.renderMarkup(t)}},{key:"onMarkupRemoved",value:function(e){var t=e.markup.id,n=this.labels[t];n&&this.container.removeChild(n),delete this.labels[t],delete this.textMarkups[t]}},{key:"isEmpty",value:function(){return 0===Object.keys(this.labels).length}},{key:"renderTextToCanvas",value:function(e,t,n,r,i,a){var A=this;if(this.isEmpty())a(e);else{var o={};It(this.textMarkups).forEach((function(e){e.isVisible()&&(o[e.id]=!0)}));var s={backgroundColor:null,logging:!1,scale:n,onclone:function(e){r();var n=A.markupsExtension.renderer.documentCamera,a=A.markupsExtension.renderer.markupsCamera;A.markupsExtension.renderer.documentCamera=t,A.markupsExtension.renderer.markupsCamera=t;for(var s=e.getElementsByClassName("markup-text-container")[0].children,u=0;u<s.length;u++){var c=s[u];if(o[c.id]){var l=A.textMarkups[c.id];c.classList.contains("visible")||c.classList.add("visible"),c.styleCache={},A.updateLabelPositionAndSize(c,l)}else c.classList.contains("visible")&&c.classList.remove("visible")}A.markupsExtension.renderer.documentCamera=n,A.markupsExtension.renderer.markupsCamera=a,i()}};Lu()(this.container,s).then((function(t){var n=A.getDocument().createElement("canvas");n.width=t.width,n.height=t.height;var r=n.getContext("2d");r.translate(0,n.height),r.scale(1,-1),r.drawImage(t,0,0);var i=e.getContext("2d");i.globalCompositeOperation="source-over",i.drawImage(n,0,0),a(e)}))}}},{key:"destroy",value:function(){var e=this;this.unregisterEventListeners(),Lt(this.labels,(function(t){e.container.removeChild(t)})),this.labels=null,this.textMarkups=null,this.textSizeCache=null,this.markupsExtension=null,this.viewer=null}}])&&Du(t.prototype,n),r&&Du(t,r),e}();Iu.GlobalManagerMixin.call(Ou.prototype);var Nu={worldToClient:function(e,t,n){var r=new THREE.Vector4(t.x,t.y,t.z,1);return r.applyMatrix4(n.matrixWorldInverse),r.applyMatrix4(n.projectionMatrix),r.w>0&&(r.x/=r.w,r.y/=r.w,r.z/=r.w),e.impl.viewportToClient(r.x,r.y)},getCameraEyeVector:function(e){return e.target.clone().sub(e.position).normalize()},getCameraRightVector:function(e){var t=Nu.getCameraEyeVector(e);return(new THREE.Vector3).crossVectors(t,e.up).normalize()},getCameraUpVector:function(e){var t=Nu.getCameraRightVector(e),n=Nu.getCameraEyeVector(e);return(new THREE.Vector3).crossVectors(t,n).normalize()},getCameraRotation:function(e){return st.getSignedAngle(Nu.getCameraUpVector(e),new THREE.Vector3(0,1,0),Nu.getCameraEyeVector(e))}},Pu=Nu;function Ku(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Vu=Autodesk.Viewing.Private,ju=Vu.ShaderPass,Gu=Vu.CopyShader,zu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.viewer=this.markupsExtension.viewer,this.viewer.impl.updateCameraMatrices(),this.viewer.navigation.updateCamera(),this.documentCamera=this.viewer.navigation.getCamera(),this.documentCamera.updateMatrixWorld(),this.documentCamera.matrixWorldInverse.getInverse(this.documentCamera.matrixWorld),this.textRenderer=new Ou(this.markupsExtension),this.frameRenderer=new Uu(this.markupsExtension),this.linksRenderer=new Fu(this.markupsExtension),this.materialManager=new Hu(this.markupsExtension),this.geometryManager=new ka(this.markupsExtension),this.is3d=this.viewer.model.is3d(),this.raycaster=new THREE.Raycaster,this.size={width:this.viewer.canvas.clientWidth,height:this.viewer.canvas.clientHeight},this.is3d?(this.viewSize=Ze,this.markupsCamera=new THREE.OrthographicCamera(0,this.viewSize,this.viewSize,0,0,1),this.markupsCamera.position.set(0,0,1),this.markupsCamera.target=new THREE.Vector3(0,0,0)):this.markupsCamera=this.viewer.navigation.getCamera(),this.markups=[],this.renderer=this.viewer.impl.renderer(),this.glrenderer=this.viewer.impl.glrenderer(),this.copyPass=new ju(Gu),this.copyPass.material.depthWrite=!1,this.copyPass.material.depthTest=!1,this.copyPass.material.transparent=!0,this._tmpScene=new THREE.Scene,this._black=new THREE.Color(0,0,0),this.absoluteRightVec=new THREE.Vector3(1,0,0),this.absoluteUpVec=new THREE.Vector3(0,1,0),this.absoluteEyeVec=new THREE.Vector3(0,0,1),this.tmpMatrix=new THREE.Matrix4,this.frustum=new THREE.Frustum,this.setMMtoUnitConversion(),this.setNormaStrokeWidth(),this.setNormaTextSize(),this.registerEventListeners(),this.updateCameraAndMaterialParameters()}var t,n,r;return t=e,(n=[{key:"registerEventListeners",value:function(){this.onRenderBinded=this.onRender.bind(this),this.onResizeBinded=this.onResize.bind(this),this.invalidateBinded=this.invalidate.bind(this),this.onCameraChangedBinded=this.onCameraChanged.bind(this),this.viewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.onRenderBinded),this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResizeBinded),this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_REMOVED,this.invalidateBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_DRAWING_CANCEL,this.invalidateBinded)}},{key:"removeEventListeners",value:function(){this.viewer.removeEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.onRenderBinded),this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResizeBinded),this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangedBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_REMOVED,this.invalidateBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_DRAWING_CANCEL,this.invalidateBinded)}},{key:"onCameraChanged",value:function(){this.eyeVector=null,this.upVector=null,this.rightVector=null}},{key:"getResolution",value:function(){var e=this.glrenderer.getPixelRatio();return{width:this.size.width*e,height:this.size.height*e}}},{key:"supportsInt32Index",value:function(){return!!this.glrenderer.supportsElementIndexUint()}},{key:"disposeTmpTarget",value:function(){this._tmpTarget&&(this._tmpTarget.dispose(),this._tmpTarget=null)}},{key:"createTempRenderTarget",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getResolution();return this.disposeTmpTarget(),0!==e.width&&0!==e.height&&(this._tmpTarget=new THREE.WebGLRenderTarget(e.width,e.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1,depthBuffer:!1}),this._tmpTarget.generateMipmaps=!1,!0)}},{key:"onRender",value:function(){this.render()}},{key:"onResize",value:function(e){this.size.width=e.width,this.size.height=e.height,this.updateCameraAndMaterialParameters()}},{key:"updateCameraAndMaterialParameters",value:function(){if(this.is3d){var e=this.size.width/(this.size.height||1),t=this.viewSize*e,n=this.markupsCamera.right-t;this.markupsCamera.position.x+=n/2,this.markupsCamera.target.x+=n/2,this.markupsCamera.right=t,this.markupsCamera.updateProjectionMatrix(),this.markupsCamera.updateMatrixWorld(),this.markupsCamera.matrixWorldInverse.getInverse(this.markupsCamera.matrixWorld)}var r=this.getResolution();this._tmpTarget&&this.createTempRenderTarget(r),this.materialManager.updateScreenSize(r)}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.renderer.getFinalTarget(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.markupsCamera;this.tmpMatrix.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this.frustum.setFromMatrix(this.tmpMatrix);var r=function(t){var n=t.max,r=t.max.clone().setX(t.min.x),i=t.min,a=t.min.clone().setX(t.max.x);return e.frustum.containsPoint(n)||e.frustum.containsPoint(r)||e.frustum.containsPoint(i)||e.frustum.containsPoint(a)||e.frustum.intersectsBox(t)},i=function(e,t){return!(t.max.x<e.min.x||t.min.x>e.max.x||t.max.y<e.min.y||t.min.y>e.max.y)},a=[],A=[],o=[],s=function(){var r;0!==a.length&&((r=e._tmpScene).add.apply(r,a),e.glrenderer.render(e._tmpScene,n,t),e._tmpScene.children.length=0,a.length=0)},u=function(){var r;0!==A.length&&((r=e._tmpScene).add.apply(r,A),e.glrenderer.setClearColor(e._black,0),e.glrenderer.clearTarget(e._tmpTarget,!0,!1,!1),e.glrenderer.render(e._tmpScene,n,e._tmpTarget),e.copyPass.render(e.glrenderer,t,e._tmpTarget),e._tmpScene.children.length=0,A.length=0,o.length=0)};this.markups.forEach((function(c){var l=c.meshContainer;if(l.visible&&0!==l.children.length){if(!e.is3d){var h=c.getWorldBoundingBox(!0);if(!r(h))return}var d=c.fillMesh,f=c.strokeMesh,p=d&&d.material.opacity<1,g=f.material.uniforms.opacity.value<1;if(p||g){if(!e._tmpTarget&&!e.createTempRenderTarget())return;if(s(),!p&&d||!g)u(),e._tmpScene.add(l),l.remove(f),e.glrenderer.setClearColor(e._black,0),e.glrenderer.clearTarget(e._tmpTarget,!0,!1,!1),e.glrenderer.render(e._tmpScene,n,e._tmpTarget),e.copyPass.render(e.glrenderer,t,e._tmpTarget),l.remove(d),l.add(f),e.glrenderer.render(e._tmpScene,n,t),l.add(d),l.add(f),e._tmpScene.remove(l);else{var y=c.getWorldBoundingBox(!0);o.some((function(e){return(!c.isTransparent()||!e.isTransparent)&&i(y,e.bbox)}))&&u(),A.push(l),o.push({bbox:y,isTransparent:c.isTransparent()})}}else u(),a.push(l)}})),s(),u()}},{key:"getCameraEyeVector",value:function(){return this.eyeVector||(this.eyeVector=Pu.getCameraEyeVector(this.markupsCamera)),this.eyeVector.clone()}},{key:"getCameraRightVector",value:function(){return this.rightVector||(this.rightVector=Pu.getCameraRightVector(this.markupsCamera)),this.rightVector.clone()}},{key:"getCameraUpVector",value:function(){return this.upVector||(this.upVector=Pu.getCameraUpVector(this.markupsCamera)),this.upVector.clone()}},{key:"getCameraRotation",value:function(){return Pu.getCameraRotation(this.markupsCamera)}},{key:"worldToClient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.markupsCamera,n=this.viewer.navigation.getScreenViewport(),r=e.clone().project(t);return new THREE.Vector3((r.x+1)/2*n.width,(1-r.y)/2*n.height,0)}},{key:"clientToWorld",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.markupsCamera,n=this.viewer.navigation.getScreenViewport(),r=new THREE.Vector3;r.x=e.x/n.width*2-1,r.y=-(e.y/n.height*2-1);var i=r.unproject(t);return i.z=0,i}},{key:"sizeFromWorldToClient",value:function(e){var t=this.worldToClient(new THREE.Vector3),n=this.worldToClient(new THREE.Vector3(e,0,0));return t.distanceTo(n)}},{key:"sizeFromClientToWorld",value:function(e){var t=this.clientToWorld(new THREE.Vector3),n=this.clientToWorld(new THREE.Vector3(e,0,0));return t.distanceTo(n)}},{key:"multiplyByNormaStrokeWidth",value:function(e){return this.normaStrokeWidth*e}},{key:"documentCameraToMarkupsCamera",value:function(e){if(!this.is3d)return e.z=0,e;var t=this.worldToClient(e,this.documentCamera);return this.clientToWorld(t)}},{key:"_fromMMtoWorldUnits",value:function(e){if(this.is3d)return 1;var t=this.viewer.model,n=t.getMetadata("page_dimensions","page_units",null)||t.getMetadata("page_dimensions","model_units","mm");n=t.getUnitData(n.toLowerCase()).unitString;var r=Autodesk.Viewing.Private.convertUnits("mm",n,1,e);return t.isLeaflet()&&(r*=this.viewer.impl.getFitBounds(!0).size().x/t.getMetadata("page_dimensions","page_width")),r}},{key:"_calcNormaSize",value:function(e,t){var n=this.mmToWorldUnitFactor*e,r=this.viewer.impl.getFitBounds(!0),i=r.size().x,a=r.size().y,A=Math.sqrt(i*i+a*a);return n=Math.min(n,A*t)}},{key:"setMMtoUnitConversion",value:function(){this.mmToWorldUnitFactor=this._fromMMtoWorldUnits(1)}},{key:"setNormaStrokeWidth",value:function(){this.is3d?this.normaStrokeWidth=tt:this.normaStrokeWidth=this._calcNormaSize(fe,$e)}},{key:"setNormaTextSize",value:function(){this.is3d?this.normaTextSize=nt:this.normaTextSize=this._calcNormaSize(ge,et)}},{key:"getNormaStrokeWidth",value:function(){return this.normaStrokeWidth}},{key:"getFontToWorldScale",value:function(){return this.normaTextSize/pe}},{key:"addToScene",value:function(e){var t=function(e){return e.layer&&e.layer.layerData&&e.layer.layerData.metadata&&e.layer.layerData.metadata.created_at};t(e)?Gt(e,this.markups,(function(e,n){if(!t(e))return 1;var r=Date.parse(e.layer.layerData.metadata.created_at),i=Date.parse(n.layer.layerData.metadata.created_at);return r>i?1:r<i?-1:e.id>n.id?1:e.id<n.id?-1:0})):this.markups.push(e)}},{key:"removeFromScene",value:function(e){lt.remove(this.markups,(function(t){return t===e}))}},{key:"invalidate",value:function(){this.markupsExtension.viewer.impl.invalidate(!1,!1,!0)}},{key:"updateRaycaster",value:function(e){var t=this.viewer.navigation.getScreenViewport(),n=e.x/t.width*2-1,r=-e.y/t.height*2+1;this.raycaster.ray.origin.set(n,r,(this.markupsCamera.near+this.markupsCamera.far)/(this.markupsCamera.near-this.markupsCamera.far)).unproject(this.markupsCamera),this.raycaster.ray.direction.set(0,0,-1)}},{key:"destroy",value:function(){this.removeEventListeners(),this.frameRenderer&&(this.frameRenderer.destroy(),this.frameRenderer=null),this.linksRenderer&&(this.linksRenderer.destroy(),this.linksRenderer=null),this.textRenderer&&(this.textRenderer.destroy(),this.textRenderer=null),this.materialManager&&(this.materialManager.destroy(),this.materialManager=null),this.geometryManager&&(this.geometryManager.destroy(),this.geometryManager=null),this.disposeTmpTarget(),this.invalidate(),this.markupsExtension=null,this.viewer=null}}])&&Ku(t.prototype,n),r&&Ku(t,r),e}(),Yu=n(51),Wu={getModelExtension:function(e){var t=e&&e.toLowerCase().match(/\.([a-z0-9]+)(\?|$)/);return t?t[1]:null}},Xu=Wu;function Ju(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qu=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.options=n,this.filters=this.markupsExtension.cache.filters||this.getInitialFilters(),this.filterWithGUID=this.fileTypeSupportGUID(this.options.fileName)}var t,n,r;return t=e,(n=[{key:"getInitialFilters",value:function(){return{createdByFilter:[],createdAtStartFilter:null,createdAtEndFilter:null,showPrivateFilter:!0,showPublishedFilter:!0,showArchivedFilter:!1,toggleMarkupViewFilter:!0}}},{key:"updateFilters",value:function(e){this.markupsExtension.cache.filters=this.filters=Object.assign({},this.filters,e),this.markupsExtension.loadLayers(),this.markupsExtension.markupsManager.dispatchEvent({type:a.FILTER_CHANGED,filters:this.filters})}},{key:"filterLayers",value:function(e,t){var n=this;return!t&&this.filters.hideAllMarkups?[]:e.filter((function(e){return n.filterByVersion(e)&&n.filterBySheet(e,t&&n.filters.toggleMarkupViewFilter)&&n.filterByDate(e)&&n.filterPrivate(e)&&n.filterPublished(e)&&n.filterArchived(e)&&n.filterCreator(e)&&n.filterDeleted(e)}))}},{key:"fileTypeSupportGUID",value:function(e){var t=Xu.getModelExtension(e);return!!t&&(t=t.toLowerCase(),re.includes(t))}},{key:"isDateInRange",value:function(e,t,n){var r=Object(Yu.format)(e,"MM/DD/YYYY"),i=Object(Yu.format)(t,"MM/DD/YYYY"),a=Object(Yu.format)(n,"MM/DD/YYYY");return Object(Yu.isWithinRange)(r,i,a)}},{key:"filterByDate",value:function(e){return!this.filters.createdAtStartFilter||!this.filters.createdAtEndFilter||this.isDateInRange(e.metadata.created_at,this.filters.createdAtStartFilter,this.filters.createdAtEndFilter)}},{key:"filterBySheet",value:function(e,t){if(t||!this.options.hasMultiSheet)return!0;var n=e.metadata.markup_metadata&&e.metadata.markup_metadata.sheetGUID,r=e.metadata.markup_metadata&&e.metadata.markup_metadata.sheetName;return this.filterWithGUID&&!e.loadedByName&&this.options.sheetGUID&&n?this.options.sheetGUID===n:!this.options.sheetName||!r||this.options.sheetName===r}},{key:"filterDeleted",value:function(e){return e.status!==L}},{key:"filterPrivate",value:function(e){return this.filters.showPrivateFilter||e.metadata.status!==N}},{key:"filterPublished",value:function(e){return this.filters.showPublishedFilter||e.metadata.status!==P}},{key:"filterArchived",value:function(e){return this.filters.showArchivedFilter||e.metadata.status!==j}},{key:"filterCreator",value:function(e){return!this.filters.createdByFilter||0===this.filters.createdByFilter.length||this.filters.createdByFilter.some((function(t){return e.metadata.created_by===t.value}))}},{key:"filterByVersion",value:function(e){var t=e.metadata.starting_version;return this.options.documentVersion>=t}},{key:"destroy",value:function(){this.filters=null,this.options=null}}])&&Ju(t.prototype,n),r&&Ju(t,r),e}();function Zu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ec=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Zu(this,e),this.options=t}var t,n,r;return t=e,(n=[{key:"canPublishMarkup",value:function(e){return!!(e&&e.guid&&!e.metadata.status!==P&&this.options.userId&&e.metadata.permitted_statuses&&-1!==e.metadata.permitted_statuses.indexOf(P))}},{key:"canArchiveMarkup",value:function(e){return!!(e&&e.guid&&!e.metadata.status!==j&&this.options.userId&&e.metadata.permitted_statuses&&-1!==e.metadata.permitted_statuses.indexOf(j))}},{key:"canEditMarkup",value:function(e){if(!e)return!0;if(!e.guid)return!1;var t=[N,P];return!(!this.options.userId||-1===t.indexOf(e.metadata.status))&&!(this.options.documentVersion<this.options.currentRawDocumentVersion)&&(this.options.isAdmin||this.options.userId===e.metadata.created_by)}},{key:"canDeleteMarkup",value:function(e){if(!e||!e.guid)return!1;var t=[O,N];return!(!this.options.userId||-1===t.indexOf(e.metadata.status))&&(this.options.isAdmin||this.options.userId===e.metadata.created_by)}},{key:"canEditMarkupAttachment",value:function(e,t){return!(!e||!e.guid)&&e.metadata.status!==V&&e.metadata.status!==j&&this.options.documentVersion===this.options.currentRawDocumentVersion&&!!this.options.userId&&(!!this.options.isAdmin||!t||t&&this.options.userId===t.attributes.created_by)}},{key:"canCreateMarkup",value:function(){return this.options.documentVersion===this.options.currentRawDocumentVersion}},{key:"destroy",value:function(){this.options=null}}])&&$u(t.prototype,n),r&&$u(t,r),e}();function tc(e){return(tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ic=Autodesk.Viewing.getGlobal(),ac=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.registerEventListeners()}var t,n,r;return t=e,r=[{key:"send",value:function(e,t){var n=ic.webkit&&ic.webkit.messageHandlers.callbackHandler,r=n?function(e,t){n.postMessage({command:e,data:t})}:null,i=ic.JSINTERFACE,a="object"===tc(t)?JSON.stringify(t):t;r?void 0!==a?r(e,a):r(e):i&&i[e]&&(void 0!==a?i[e](a):i[e]())}},{key:"correctPixelRatio",value:function(e){return Autodesk.Viewing.isAndroidDevice()&&(e.min.multiplyScalar(window.devicePixelRatio),e.max.multiplyScalar(window.devicePixelRatio)),e}}],(n=[{key:"registerEventListeners",value:function(){this.markupsExtension.markupsManager.addEventListener(a.LAYER_DESELECTED,this.onLayerDeselected),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_DESELECTED,this.onMarkupDeselected),this.markupsExtension.markupsManager.addEventListener(a.LAYER_SELECTED_FROM_DIFFERENT_SHEET,this.onLayerSelectedDifferentSheet),this.markupsExtension.markupsManager.addEventListener(a.LAYER_EDITED_FROM_DIFFERENT_SHEET,this.onLayerEditDifferentSheet),this.markupsExtension.markupsManager.addEventListener(rr.HISTORY_CHANGED_EVENT,this.onHistoryChanged),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_SESSION_START,this.onMarkupSessionStart),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_SESSION_END,this.onMarkupSessionEnd),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_DRAWING_START,this.onMarkupDrawingStart),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_DRAWING_END,this.onMarkupDrawingEnd),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_DRAWING_CANCEL,this.onMarkupDrawingCancel),this.markupsExtension.markupsManager.addEventListener(a.LINK_SELECTED,this.onLinkSelected),this.markupsExtension.markupsManager.addEventListener(a.LINK_DESELECTED,this.onLinkDeselected),this.onLayerReadyToSaveChangedBinded=this.onLayerReadyToSaveChanged.bind(this),this.markupsExtension.markupsManager.addEventListener(a.LAYER_READY_TO_SAVE,this.onLayerReadyToSaveChangedBinded),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_VIEW_ENTERED,this.onMarkupViewEntered),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_VIEW_EXITED,this.onMarkupViewExited),this.markupsExtension.markupsManager.addEventListener(a.TEXT_EDITING_STARTED,this.onTextEditingStarted),this.markupsExtension.markupsManager.addEventListener(a.TEXT_EDITING_ENDED,this.onTextEditingEnded),this.updateContextualMenuBinded=this.updateContextualMenu.bind(this),this.hideContextualMenuBinded=this.hideContextualMenu.bind(this),this.updateContextualMenuDebouncedShort=lt.debounce(this.updateContextualMenuBinded,10),this.updateContextualMenuDebouncedLong=lt.debounce(this.updateContextualMenuBinded,200),this.markupsExtension.markupsManager.addEventListener(rr.HISTORY_CHANGED_EVENT,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_SELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(a.LAYER_DIRTY,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(a.LAYER_SYNCED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(a.LAYER_SELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_EDIT_END,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_TOOL_ENABLED_CHANGED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(a.LAYER_DESELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_DESELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.addEventListener(a.MARKUP_EDIT_START,this.hideContextualMenuBinded),this.markupsExtension.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.updateContextualMenuDebouncedLong)}},{key:"unregisterEventListeners",value:function(){this.markupsExtension.markupsManager.removeEventListener(a.LAYER_DESELECTED,this.onLayerDeselected),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_DESELECTED,this.onMarkupDeselected),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_SELECTED_FROM_DIFFERENT_SHEET,this.onLayerSelectedDifferentSheet),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_EDITED_FROM_DIFFERENT_SHEET,this.onLayerEditDifferentSheet),this.markupsExtension.markupsManager.removeEventListener(rr.HISTORY_CHANGED_EVENT,this.onHistoryChanged),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_SESSION_START,this.onMarkupSessionStart),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_SESSION_END,this.onMarkupSessionEnd),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_DRAWING_START,this.onMarkupDrawingStart),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_DRAWING_END,this.onMarkupDrawingEnd),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_DRAWING_CANCEL,this.onMarkupDrawingCancel),this.markupsExtension.markupsManager.removeEventListener(a.LINK_SELECTED,this.onLinkSelected),this.markupsExtension.markupsManager.removeEventListener(a.LINK_DESELECTED,this.onLinkDeselected),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_READY_TO_SAVE,this.onLayerReadyToSaveChangedBinded),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_VIEW_ENTERED,this.onMarkupViewEntered),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_VIEW_EXITED,this.onMarkupViewExited),this.markupsExtension.markupsManager.removeEventListener(a.TEXT_EDITING_STARTED,this.onTextEditingStarted),this.markupsExtension.markupsManager.removeEventListener(a.TEXT_EDITING_ENDED,this.onTextEditingEnded),this.markupsExtension.markupsManager.removeEventListener(rr.HISTORY_CHANGED_EVENT,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_SELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_DIRTY,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_SYNCED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_SELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_EDIT_END,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_TOOL_ENABLED_CHANGED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(a.LAYER_DESELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_DESELECTED,this.updateContextualMenuDebouncedShort),this.markupsExtension.markupsManager.removeEventListener(a.MARKUP_EDIT_START,this.hideContextualMenuBinded),this.markupsExtension.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.updateContextualMenuDebouncedLong),this.updateContextualMenuDebouncedShort.cancel(),this.updateContextualMenuDebouncedLong.cancel()}},{key:"markupToolLoaded",value:function(){e.send("onMarkupToolLoaded")}},{key:"onMarkupSessionStart",value:function(){e.send("onMarkupSessionStart")}},{key:"onMarkupSessionEnd",value:function(){e.send("onMarkupSessionEnd")}},{key:"onMarkupDrawingStart",value:function(t){var n=t.markup;e.send("onMarkupDrawingStart",n.type)}},{key:"onMarkupDrawingEnd",value:function(t){var n=t.markup;e.send("onMarkupDrawingEnd",n.type)}},{key:"onMarkupDrawingCancel",value:function(t){var n=t.markup;e.send("onMarkupDrawingCancel",n.type)}},{key:"onLayerSelectedDifferentSheet",value:function(t){var n=t.layerGuid;e.send("onLayerSelectedDifferentSheet",n)}},{key:"onLayerEditDifferentSheet",value:function(t){var n=t.layerGuid;e.send("onLayerEditDifferentSheet",n)}},{key:"onLayerSelected",value:function(t){var n=t.layer,r=n.getGuid();if(r){var i={guid:r,boundingBox:e.correctPixelRatio(n.getClientBoundingBox(!0))};e.send("onLayerSelected",i)}}},{key:"onLayerDeselected",value:function(t){var n=t.layer.getGuid();n&&e.send("onLayerDeselected",n)}},{key:"onMarkupSelected",value:function(t){var n=t.markup,r={id:n.id,layerGuid:n.layer&&n.layer.getGuid()||"",type:n.type,style:n.editState.style,boundingBox:e.correctPixelRatio(n.getClientBoundingBox(!0,!0))};e.send("onMarkupSelected",r)}},{key:"onMarkupDeselected",value:function(t){var n=t.markup;e.send("onMarkupDeselected",n.id)}},{key:"onHistoryChanged",value:function(t){var n={enableUndo:t.hasUndo,enableRedo:t.hasRedo};e.send("onMarkupHistoryChanged",n)}},{key:"onLayerReadyToSaveChanged",value:function(t){var n=t.readyToSave;e.send("onLayerReadyToSaveChanged",n)}},{key:"postLayer",value:function(t,n,r){var i,a={metadata:t,resources:(i={},nc(i,ee,n[0]),nc(i,te,n[1]),i),requestId:r};e.send("onPostLayer",a)}},{key:"updateLayer",value:function(t,n,r,i){var a,A={originalGuid:t,metadata:n,resources:(a={},nc(a,ee,r[0]),nc(a,te,r[1]),a),requestId:i};e.send("onUpdateLayer",A)}},{key:"deleteLayer",value:function(t,n){var r={guid:t,requestId:n};e.send("onDeleteLayer",r)}},{key:"publishLayer",value:function(t,n){var r={guid:t,requestId:n};e.send("onPublishLayer",r)}},{key:"archiveLayer",value:function(t,n,r){var i={guid:t,closeVersion:n,requestId:r};e.send("onArchiveLayer",i)}},{key:"onLinkSelected",value:function(t){var n=t.link,r={type:n.type,layerGuid:n.layer.layerData.guid,boundingBox:n.getClientBoundingBox()};e.send("onLinkSelected",r)}},{key:"onLinkDeselected",value:function(t){var n=t.link,r={type:n.type,layerGuid:n.layer.layerData.guid};e.send("onLinkDeselected",r)}},{key:"updateContextualMenu",value:function(){if(!this.markupsExtension.markupsManager.getDuringCreationMarkup()){var e=this.markupsExtension.markupsManager.getSelectedMarkups()[0];if(e)return void this.onMarkupSelected({markup:e});if(!this.markupsExtension.markupsManager.isMarkupSessionOpen()){var t=this.markupsExtension.markupsManager.getSelectedLayer();if(t)return void this.onLayerSelected({layer:t})}}this.hideContextualMenu()}},{key:"hideContextualMenu",value:function(){e.send("onHideContextualMenu")}},{key:"onMarkupViewExited",value:function(){e.send("onMarkupViewExited")}},{key:"onMarkupViewEntered",value:function(){e.send("onMarkupViewEntered")}},{key:"onTextEditingStarted",value:function(){e.send("onTextEditingStarted")}},{key:"onTextEditingEnded",value:function(){e.send("onTextEditingEnded")}},{key:"destroy",value:function(){this.unregisterEventListeners(),this.iosSend=null,this.androidSend=null,this.send=null}}])&&rc(t.prototype,n),r&&rc(t,r),e}();function Ac(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache={},this.currentUrn="default"}var t,n,r;return t=e,(n=[{key:"setCurrentUrn",value:function(e){this.currentUrn=e,this.cache[e]=this.cache[e]||{}}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.currentUrn;this.cache[n][e]=t}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentUrn;delete this.cache[t][e]}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentUrn;return this.cache[t][e]}},{key:"getAsList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentUrn,n=[];return Object.keys(this.cache[t]).forEach((function(r){n.push(e.cache[t][r])})),n}},{key:"getCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentUrn;return this.cache[e]}},{key:"cleanCache",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentUrn;Object.keys(this.cache[t]).forEach((function(t){e.remove(t)}))}},{key:"length",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentUrn;return Object.keys(this.cache[e]).length}},{key:"isEmpty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentUrn;return 0===this.length(e)}}])&&Ac(t.prototype,n),r&&Ac(t,r),e}();function sc(e,t,n,r,i,a,A){try{var o=e[a](A),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,i)}function uc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var cc=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.markupsExtension=t,this.options=n||{}}var t,n,r,i,a;return t=e,(n=[{key:"postLayer",value:(i=regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("postLayer"),e.abrupt("return",new Promise((function(e,t){})));case 2:case"end":return e.stop()}}),e)})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var a=i.apply(e,t);function A(e){sc(a,n,r,A,o,"next",e)}function o(e){sc(a,n,r,A,o,"throw",e)}A(void 0)}))},function(e,t){return a.apply(this,arguments)})},{key:"publishLayer",value:function(e){return console.log("publishLayer"),new Promise((function(e,t){}))}},{key:"archiveLayer",value:function(e,t){return console.log("archiveLayer"),new Promise((function(e,t){}))}},{key:"updateLayer",value:function(e,t){return console.log("updateLayer"),new Promise((function(e,t){}))}},{key:"deleteLayer",value:function(e){return console.log("deleteLayer"),new Promise((function(e,t){}))}},{key:"postDocumentAttachment",value:function(e,t){return console.log("postDocumentAttachment"),new Promise((function(e,t){}))}},{key:"deleteDocumentAttachment",value:function(e){return console.log("deleteDocumentAttachment"),new Promise((function(e,t){}))}},{key:"renameDocumentAttachment",value:function(e,t){return console.log("renameDocumentAttachment"),new Promise((function(e,t){}))}},{key:"requestMarkups",value:function(e,t,n,r){return console.log("requestMarkups"),new Promise((function(e,t){}))}},{key:"getAttachment",value:function(e,t,n){return console.log("getAttachment"),new Promise((function(e,t){}))}},{key:"cancelAllGet",value:function(){console.log("cancelAllGet")}}])&&uc(t.prototype,n),r&&uc(t,r),e}();function lc(e){return(lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hc(e,t,n,r,i,a,A){try{var o=e[a](A),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,i)}function dc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fc(e,t){return(fc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yc(e);if(t){var i=yc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return gc(this,n)}}function gc(e,t){return!t||"object"!==lc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yc(e){return(yc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fc(e,t)}(o,e);var t,n,r,i,a,A=pc(o);function o(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);(n=A.call(this,e,t)).issueType=n.ISSUES_TYPE.markup;var r=n.ENV_TABLE[t.env]||n.ENV_TABLE.Development;return n.ISSUE_SERVICE_URL=r.ISSUE_SERVICE,n.OBJECT_STORAGE_SERVICE_URL=r.OBJECT_STORAGE,n.maxPageLimit=200,n.xhrGetReq=[],n.headers=[{name:"x-ads-acm-namespace",value:n.options.acmNamespace},{name:"x-ads-acm-check-groups",value:"true"}],n.options.acmScopes&&n.headers.push({name:"x-ads-acm-scopes",value:n.options.acmScopes}),n}return t=o,(n=[{key:"checkValidation",value:function(){var e=this.getAccessToken();return this.valid=!!e&&!!this.options.issueProject&&!!this.issueType,this.valid}},{key:"requestMarkups",value:function(e,t,n,r){if(!this.checkValidation())return Promise.reject("Service is unavailable.");e||(e=this.maxPageLimit),t||(t=0);var i=this;return new Promise((function(a,A){if(!i.options.documentUrn)return A();var o=[i.ISSUE_SERVICE_URL,"containers/",i.options.issueProject,i.issueType.endpoint].join("");o=[o,"?page[limit]="+e+"&page[offset]="+t].join(""),i.options.documentUrn&&(o=[o,"&filter[target_urn]=",encodeURIComponent(i.options.documentUrn)].join("")),o=[o,"&include=attachments"].join(""),r&&(o=[o,"&filter[status]=",r].join("")),o=[o,"&sort=-created_at"].join("");var s=i.getAjaxCallback((function(){i.removeXhr(u),a.apply(null,arguments)}),(function(){i.removeXhr(u),A.apply(null,arguments)})),u=i.createRequest(i,"GET",o,"application/vnd.api+json",s);i.injectHeaders(u,n),u.send(),i.addXhr(u)}))}},{key:"postMarkups",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var n=this;return new Promise((function(r,i){var a=[n.ISSUE_SERVICE_URL,"containers/",n.options.issueProject,n.issueType.endpoint].join(""),A=n.getAjaxCallback(r,i),o=n.createRequest(n,"POST",a,"application/vnd.api+json",A);n.injectHeaders(o,t);var s={data:{type:n.issueType.value,attributes:e}};o.send(JSON.stringify(s))})).then(n.parseResponse)}},{key:"fetchOSSBucketForAttachment",value:function(e){var t=this;return new Promise((function(n,r){t.fetchLocationForNewOssAttachment([],{onLoad:function(t){var i=t.currentTarget;if(201===i.status||200===i.status){var a=JSON.parse(i.responseText);e.ossPath=a.data.attributes.urn,n()}else r("Failed fetching OSS Bucket")},onError:r,onTimeout:r,onAbort:r})}))}},{key:"uploadAttachment",value:function(e){var t=this;return new Promise((function(n,r){var i=t.extractOssBucketAndId(e.ossPath),a=i[0],A=i[1];t.postAttachment(A,e.data,a,{onLoad:function(e){var t=e.currentTarget;200===t.status||201===t.status?n():r("Failed uploading attachment")},onError:r,onTimeout:r,onAbort:r})}))}},{key:"postLayer",value:(i=regeneratorRuntime.mark((function e(t,n,r){var i,a,A,o,s,u,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=function(){if(0===n.length)return Promise.resolve();var e=n.map((function(e){return c.fetchOSSBucketForAttachment(e)}));return Promise.all(e)},a=function(){if(0===n.length)return Promise.resolve();var e=n.map((function(e){return c.uploadAttachment(e)}));return Promise.all(e)},A=function(){return n.forEach((function(e){t.resource_urns[e.type]=e.ossPath})),r?c.updateLayer(r,t):c.postMarkups(t,[])},o=3,s=0;case 5:if(!(s<o)){e.next=28;break}return e.prev=6,e.next=9,i();case 9:return e.next=11,a();case 11:return e.next=13,A();case 13:return u=e.sent,e.abrupt("return",u);case 17:if(e.prev=17,e.t0=e.catch(6),console.error(e.t0),o!==s+1){e.next=24;break}throw e.t0;case 24:console.warn("Retry saving layer.");case 25:s++,e.next=5;break;case 28:case"end":return e.stop()}}),e,null,[[6,17]])})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var a=i.apply(e,t);function A(e){hc(a,n,r,A,o,"next",e)}function o(e){hc(a,n,r,A,o,"throw",e)}A(void 0)}))},function(e,t,n){return a.apply(this,arguments)})},{key:"parseResponse",value:function(e){try{var t=JSON.parse(e).data;return Promise.resolve(t)}catch(e){return Promise.reject(e)}}},{key:"publishLayer",value:function(e){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var t=this;return new Promise((function(n,r){var i=[t.ISSUE_SERVICE_URL,"containers/",t.options.issueProject,t.issueType.endpoint,"/",e].join(""),a=t.getAjaxCallback(n,r),A=t.createRequest(t,"PATCH",i,"application/vnd.api+json",a),o={data:{type:t.issueType.value,id:e,attributes:{status:P}}};A.send(JSON.stringify(o))})).then(t.parseResponse)}},{key:"archiveLayer",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var n=this;return new Promise((function(r,i){var a=[n.ISSUE_SERVICE_URL,"containers/",n.options.issueProject,n.issueType.endpoint,"/",e].join(""),A=n.getAjaxCallback(r,i),o=n.createRequest(n,"PATCH",a,"application/vnd.api+json",A),s={data:{type:n.issueType.value,id:e,attributes:{close_version:t,status:j}}};o.send(JSON.stringify(s))})).then(n.parseResponse)}},{key:"fetchLocationForNewOssAttachment",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var n=[this.ISSUE_SERVICE_URL,"containers/",this.options.issueProject,"/oss_objects"].join(""),r=this.createRequest(this,"POST",n,"application/vnd.api+json",t);return this.injectHeaders(r,e),r.send(JSON.stringify({data:{type:"oss_objects"}})),null}},{key:"getAttachment",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var n=this;return new Promise((function(r,i){var a=n.extractOssBucketAndId(e),A=[n.OBJECT_STORAGE_SERVICE_URL,"buckets/",a[0],"/objects/",a[1]].join(""),o=n.getAjaxCallback((function(){n.removeXhr(s),r.apply(null,arguments)}),(function(){n.removeXhr(s),i.apply(null,arguments)}),t),s=n.createRequest(n,"GET",A,null,o);n.injectHeaders(s,n.headers),t&&(s.responseType="arraybuffer"),s.send(),n.addXhr(s)}))}},{key:"postAttachment",value:function(e,t,n,r){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var i=[this.OBJECT_STORAGE_SERVICE_URL,"buckets/",n,"/objects/",e].join(""),a=this.createRequest(this,"PUT",i,"text/plain",r);return this.injectHeaders(a,this.headers),a.send(t),null}},{key:"updateLayer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!this.checkValidation())return Promise.reject("Service is unavailable.");var r=this;return new Promise((function(i,a){var A=[r.ISSUE_SERVICE_URL,"containers/",r.options.issueProject,r.issueType.endpoint,"/",e].join(""),o=r.getAjaxCallback(i,a),s=r.createRequest(r,"PATCH",A,"application/vnd.api+json",o);r.injectHeaders(s,n);var u={data:{type:r.issueType.value,id:e,attributes:t||{}}};s.send(JSON.stringify(u)),r.addXhr(s)})).then(r.parseResponse)}},{key:"deleteLayer",value:function(e){if(!this.checkValidation())return Promise.reject("Service is unavailable");var t=this;return new Promise((function(n,r){var i=[t.ISSUE_SERVICE_URL,"containers/",t.options.issueProject,t.ISSUES_TYPE.markup.endpoint+"/",e].join(""),a=t.getAjaxCallback(n,r);t.createRequest(t,"DELETE",i,"application/vnd.api+json",a).send()}))}},{key:"postDocumentAttachment",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable.");var n=this;return new Promise((function(r,i){var a=[n.ISSUE_SERVICE_URL,"containers/",n.options.issueProject,n.ATTACHMENT.endpoint].join(""),A=n.getAjaxCallback(r,i),o=n.createRequest(n,"POST",a,"application/vnd.api+json",A);n.injectHeaders(o,t);var s={data:{type:n.ATTACHMENT.value,attributes:e.attributes}};o.send(JSON.stringify(s))})).then(n.parseResponse)}},{key:"deleteDocumentAttachment",value:function(e){if(!this.checkValidation())return Promise.reject("Service is unavailable");var t=this;return new Promise((function(n,r){var i=[t.ISSUE_SERVICE_URL,"containers/",t.options.issueProject,t.ATTACHMENT.endpoint+"/",e].join(""),a=t.getAjaxCallback(n,r);t.createRequest(t,"DELETE",i,"application/vnd.api+json",a).send()}))}},{key:"renameDocumentAttachment",value:function(e,t){if(!this.checkValidation())return Promise.reject("Service is unavailable");var n=this;return new Promise((function(r,i){var a=[n.ISSUE_SERVICE_URL,"containers/",n.options.issueProject,n.ATTACHMENT.endpoint+"/",e].join(""),A=n.getAjaxCallback(r,i),o=n.createRequest(n,"PATCH",a,"application/vnd.api+json",A),s={data:{type:n.ATTACHMENT.value,id:e,attributes:{name:t}}};o.send(JSON.stringify(s))})).then(n.parseResponse)}},{key:"extractOssBucketAndId",value:function(e){var t=e.split("/"),n=t[0].split(":");return t[0]=n[n.length-1],t}},{key:"cancelAllGet",value:function(){for(var e=this.xhrGetReq.length-1;e>=0;e--)this.xhrGetReq[e]&&this.xhrGetReq[e].abort();this.xhrGetReq=[]}},{key:"removeXhr",value:function(e){var t=this.xhrGetReq.indexOf(e);t>-1&&this.xhrGetReq.splice(t,1)}},{key:"addXhr",value:function(e){this.xhrGetReq.push(e)}},{key:"getAccessToken",value:function(){var e;if(this.markupsExtension.options.getAccessToken)return this.markupsExtension.options.getAccessToken((function(t,n){e=t})),e}},{key:"getAjaxCallback",value:function(e,t,n){return{onLoad:function(r){201===r.currentTarget.status||200===r.currentTarget.status||204===r.currentTarget.status?e(n?r.currentTarget.response:r.currentTarget.responseText):t()},onError:t,onTimeout:t,onAbort:t}}},{key:"createRequest",value:function(e,t,n,r,i){var a=new XMLHttpRequest;a.open(t,n,!0),r&&a.setRequestHeader("Content-Type",r);var A=this.getAccessToken();return a.setRequestHeader("Access-Control-Allow-Origin","*"),a.setRequestHeader("Authorization","Bearer "+A),a.onload=i.onLoad,a.onerror=i.onError,a.ontimeout=i.onTimeout,a.onabort=i.onAbort,a}},{key:"injectHeaders",value:function(e,t){t&&t.forEach((function(t){e.setRequestHeader(t.name,t.value)}))}},{key:"ENV_TABLE",get:function(){return{Local:{ISSUE_SERVICE:"https://developer-dev.api.autodesk.com/issues-dev/v1/",OBJECT_STORAGE:"https://developer-dev.api.autodesk.com/oss/v2/"},Development:{ISSUE_SERVICE:"https://developer-stg.api.autodesk.com/issues-dev/v1/",OBJECT_STORAGE:"https://developer-stg.api.autodesk.com/oss/v2/"},Qa:{ISSUE_SERVICE:"https://developer-stg.api.autodesk.com/issues-qa/v1/",OBJECT_STORAGE:"https://developer-stg.api.autodesk.com/oss/v2/"},Staging:{ISSUE_SERVICE:"https://developer-stg.api.autodesk.com/issues-stg/v1/",OBJECT_STORAGE:"https://developer-stg.api.autodesk.com/oss/v2/"},Production:{ISSUE_SERVICE:"https://developer.api.autodesk.com/issues/v1/",OBJECT_STORAGE:"https://developer.api.autodesk.com/oss/v2/"}}}},{key:"ISSUES_TYPE",get:function(){return{issue:{value:"issues",endpoint:"/issues"},markup:{value:"markups",endpoint:"/markups"},area_markup:{value:"areas",endpoint:"/areas"},area_status:{value:"area_statuses",endpoint:"/area-statuses"}}}},{key:"ATTACHMENT",get:function(){return{value:"attachments",endpoint:"/attachments"}}}])&&dc(t.prototype,n),r&&dc(t,r),o}(cc),mc=n(12);function Ec(e){return(Ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wc(e,t){return(wc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bc(e);if(t){var i=bc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Cc(this,n)}}function Cc(e,t){return!t||"object"!==Ec(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bc(e){return(bc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wc(e,t)}(a,e);var t,n,r,i=kc(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).pendingRequests={},n}return t=a,(n=[{key:"requestMarkups",value:function(){return this.markupsExtension.mobileCallbacks.markupToolLoaded(),new Promise((function(e,t){}))}},{key:"postLayer",value:function(e,t,n){var r=Object(mc.v4)();return n?this.markupsExtension.mobileCallbacks.updateLayer(n,e,t,r):this.markupsExtension.mobileCallbacks.postLayer(e,t,r),this.returnDelayedPromise(r)}},{key:"updateLayer",value:function(e,t){var n=Object(mc.v4)();return this.markupsExtension.mobileCallbacks.updateLayer(e,t),this.returnDelayedPromise(n)}},{key:"deleteLayer",value:function(e){var t=Object(mc.v4)();return this.markupsExtension.mobileCallbacks.deleteLayer(e,t),this.returnDelayedPromise(t)}},{key:"publishLayer",value:function(e){var t=Object(mc.v4)();return this.markupsExtension.mobileCallbacks.publishLayer(e,t),this.returnDelayedPromise(t)}},{key:"archiveLayer",value:function(e,t){var n=Object(mc.v4)();return this.markupsExtension.mobileCallbacks.archiveLayer(e,t,n),this.returnDelayedPromise(n)}},{key:"postDocumentAttachment",value:function(e,t){var n=Object(mc.v4)();return this.returnDelayedPromise(n)}},{key:"deleteDocumentAttachment",value:function(e){var t=Object(mc.v4)();return this.returnDelayedPromise(t)}},{key:"renameDocumentAttachment",value:function(e,t){var n=Object(mc.v4)();return this.returnDelayedPromise(n)}},{key:"cancelAllGet",value:function(){var e=this;Object.keys(this.pendingRequests).forEach((function(t){e.pendingRequests[t].reject(),delete e.pendingRequests[t]}))}},{key:"returnDelayedPromise",value:function(e){var t={},n=new Promise((function(e,n){t.resolve=e,t.reject=n}));return this.pendingRequests[e]=t,n}},{key:"onRequestCompleted",value:function(e,t,n){this.pendingRequests[n]&&(t?this.pendingRequests[n].resolve(e):this.pendingRequests[n].reject(),delete this.pendingRequests[n])}}])&&Bc(t.prototype,n),r&&Bc(t,r),a}(cc);function Tc(e){return(Tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Mc=function(e,t){delete e.scale,delete e.translation,t&&(delete e.style,delete e.position,delete e.size,delete e.rotation)},Uc=function(e,t){var n,r;if(t.model.isPdf(!0))Autodesk.Viewing.PDFUtils.pdfToLeafletWorld(t,e),n=Autodesk.Viewing.PDFUtils.getLeafletLoadOptions(t),r=Autodesk.Viewing.PDFUtils.getLeafletBoundingBox(t);else{var i=t.model.getData();n=i.loadOptions.loadOptions,r=i.bbox}var a=n,A=a.texWidth,o=a.texHeight,s=e,u=new THREE.Vector3(r.min.x,r.max.y,0);return s.sub(u),e.x=s.x*A/r.size().x,e.y=s.y*o/r.size().y,e},Qc=function(e,t){var n=Uc(new THREE.Vector3,t),r=Uc(new THREE.Vector3(e,0,0),t);return n.distanceTo(r)},xc=function(e,t){return t.createElementNS("http://www.w3.org/2000/svg",e)},Fc=function(e,t,n){var r=t.getDocument(),i=xc("svg",r);!function(e,t,n){var r=n.createElementNS("http://www.w3.org/2000/svg","metadata"),i=n.createElement("markup_document");r.appendChild(i),i.setAttribute("data-model-version",t["data-model-version"]),e.insertBefore(r,e.firstChild)}(i,{"data-model-version":"5"},r);var a=It(e.markups),A=t.impl.is2d?null:t.getState(),s=t.model.isLeaflet(),u=t.model.isPdf(!0);return a.forEach((function(a){var A=lt.cloneDeep(a.getState());if(t.impl.is2d||hu(t,e.layerData,!0),A.anchors.forEach((function(e){a.applyScaleAndTranslation(e),(s||u)&&e.copy(Uc(e,t))})),a.type!==y&&a.type!==U&&!a.isGroupMarkup()){var l;a.type===S?(A.isFrameUsed=A.isFrameUsed?1:0,l=a.getWorldBoundingBoxTextOnly()):l=a.getWorldBoundingBox();var h=l.size(),d=l.center();(s||u)&&(d.copy(Uc(d,t)),h.x=Qc(h.x,t),h.y=Qc(h.y,t)),A.size="".concat(h.x," ").concat(h.y),A.position="".concat(d.x," ").concat(d.y),Nt(A.anchors,d.clone().negate())}a.type===U&&((s||u)&&A.translation.copy(Uc(A.translation,t).sub(Uc(new THREE.Vector3,t))),A.offset="".concat(A.translation.x," ").concat(A.translation.y," ").concat(A.translation.z),A.style[c.FONT_SIZE]*=ze,A.style[c.THICKNESS]*=Ge),(s||u)&&(A.style[c.THICKNESS]=Qc(A.style[c.THICKNESS],t),A.style[c.FONT_SIZE]=Qc(A.style[c.FONT_SIZE],t),A.style[c.FONT_SIZE]*=n.getFontToWorldScale()),A.type=a.type,(A.style[c.FILL_COLOR]===o.NO_COLOR||a.options.fillNotAllowed)&&(A.style[c.FILL_OPACITY]=0,A.style[c.FILL_COLOR]=o.NO_COLOR),Mc(A,a.isGroupMarkup()),function(e){var t={};switch(e.type){case v:case E:case m:break;case y:case Q:t.tail=e.anchors[0],t.head=e.anchors[1];break;case U:t.firstAnchor=e.anchors[0],t.secondAnchor=e.anchors[1];break;case w:case B:case C:case k:t.locations=e.anchors}e.anchors=t}(A);var f=function(e){var t={};return Object.keys(e).forEach((function(n){"object"!==Tc(e[n])||Array.isArray(e[n])?t[n]=e[n]:Object.keys(e[n]).forEach((function(r){t[r]=e[n][r]}))})),t}(A);!function(e){Object.keys(e).forEach((function(t){if(Array.isArray(e[t])){var n=e[t],r=[];n.forEach((function(e){r.push(e.x),r.push(e.y)})),e[t]=r.join(" ")}else if("object"===Tc(e[t])){var i=e[t],a=[];a.push(i.x),a.push(i.y),e[t]=a.join(" ")}}))}(f);var p=function(e,t){var n=xc("g",t);n.setAttribute("cursor","inherit"),n.setAttribute("pointer-events","none");var r=xc("path",t);return r.setAttribute("id","markup"),e?r.setAttribute("d","M 0 0 z"):r.setAttribute("d","M 0 0"),n.appendChild(r),n}(f.closed,r);!function(e,t,n){var r=n.createElementNS("http://www.w3.org/2000/svg","metadata"),i=n.createElement("markup_element");r.appendChild(i),Object.keys(t).forEach((function(e){i.setAttribute(e,t[e])})),e.insertBefore(r,e.firstChild)}(p,f,r),i.appendChild(p)})),A&&t.restoreState(A,null,!0),function(e){var t="";try{t=(new XMLSerializer).serializeToString(e)}catch(e){console.error("svgNodeToString failed to generate string representation of domNode.")}return t}(i)};function _c(e){return function(e){if(Array.isArray(e))return Hc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Hc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hc(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Lc=At,Dc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"reset",value:function(e){this.markupsExtension=e,this.markupsManager=e.markupsManager,this.markupsCache=e.markupsCache,this.viewer=e.viewer,this.options=this.markupsExtension.options,this.savingCounter=0;var t=e.options.isMobileApp,n=this.options.serviceClass||vc;this.service=t?new Sc(this.markupsExtension,this.options):new n(this.markupsExtension,this.options),this.errorHandler=this.options.errorHandler||function(){},this.onSessionEndedBinded=this.onSessionEnded.bind(this),this.markupsManager.addEventListener(a.MARKUP_SESSION_END,this.onSessionEndedBinded),this.onLayerDeletedBinded=this.onLayerDeleted.bind(this),this.markupsManager.addEventListener(a.LAYER_DELETE,this.onLayerDeletedBinded),this.onDocumentAttachmentCreationStartBinded=this.onDocumentAttachmentCreationStart.bind(this),this.markupsManager.addEventListener(a.DOCUMENT_ATTACHMENT_CREATION_START,this.onDocumentAttachmentCreationStartBinded),this.renameDocumentAttachmentBinded=this.renameDocumentAttachment.bind(this),this.markupsManager.addEventListener(a.DOCUMENT_ATTACHMENT_RENAME,this.renameDocumentAttachmentBinded),this.deleteDocumentAttachmentBinded=this.deleteDocumentAttachment.bind(this),this.markupsManager.addEventListener(a.DOCUMENT_ATTACHMENT_DELETE,this.deleteDocumentAttachmentBinded),this.onPublishLayerBinded=this.onPublishLayer.bind(this),this.markupsManager.addEventListener(a.LAYER_PUBLISH,this.onPublishLayerBinded),this.onArchiveLayerBinded=this.onArchiveLayer.bind(this),this.markupsManager.addEventListener(a.LAYER_ARCHIVE,this.onArchiveLayerBinded)}},{key:"onSessionEnded",value:function(e){var t=e.layer;e.save&&!t.isEmpty()&&this.saveLayer(t)}},{key:"onLayerDeleted",value:function(e){var t=e.layerData;t&&this.deleteLayer(t)}},{key:"onPublishLayer",value:function(e){var t=e.layerData;t&&this.publishLayer(t)}},{key:"onArchiveLayer",value:function(e){var t=e.layerData;t&&this.archiveLayer(t)}},{key:"fetchMarkups",value:function(){var e=this,t=this.options.documentUrn;this.numOfMarkupsLoaded=0;var n=this.getMaxPageLimit(),r=0,i={layersData:[],relatedResources:[]},a=ne;(function t(){return e.requestMarkups(i,n,r,a).then((function(e){if(e&&e.nextReq)return r+=n,t()})).catch((function(e){console.warn("requestMarkups failed or canceled.")}))})().then((function(){return e.getMetadata(i,t)})).catch((function(e){return e}))}},{key:"requestMarkups",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ne;return this.service.requestMarkups(t,n,null,r).then((function(t){try{var n,r=JSON.parse(t);(n=e.layersData).push.apply(n,_c(r.data));var i,a=r.included;return a&&Array.isArray(a)&&(i=e.relatedResources).push.apply(i,_c(a)),Promise.resolve({nextReq:r.links.next})}catch(e){return Promise.reject(e)}}),(function(){return Promise.reject()}))}},{key:"getMetadata",value:function(e,t){var n=this,r=e.relatedResources,i=e.layersData,A=this.markupsExtension.filterManager.filterWithGUID?function(e){return e.attributes.markup_metadata.sheetGUID===n.options.sheetGUID}:function(e){return e.attributes.markup_metadata.sheetName===n.options.sheetName};return(i=lt.remove(i,A).concat(i)).forEach((function(e){var r=e.attributes;if(r.markup_metadata){var i=r.starting_version;if(!(n.options.documentVersion<i)){r.tags=r.tags||{};var A=function(e){return"true"===e||!0===e||1===e}(r.tags.resourceEmbed),o=n.markupsCache.get(e.id),s=o||new Qs;if(!o){s.guid=e.id,s.status=O,s.metadata=r,r.close_version>0&&(s.status=V);var u=r.resource_urns;if(u){var c=n.createEmptyResourceObject(ee,A,u);c&&s.resources.push(c);var l=n.createEmptyResourceObject(te,A,u);l&&s.resources.push(l)}n.markupsCache.add(s.guid,s,t)}n.notify({type:a.LAYER_FETCHED,layerData:s}),n.getAttachment(s)}}})),this.fetchedAllMarkups||this.numOfMarkupsLoaded!==this.markupsCache.length()||(this.fetchedAllMarkups=!0,this.notify({type:a.ALL_MARKUPS_LOADED,amount:this.numOfMarkupsLoaded})),this.getUserProfiles(),this.getProjectUsers(),this.getRevisions(),this.getAttachedDocumentData(r),this.notify({type:a.LAYER_METADATA_FETCHED}),Promise.resolve()}},{key:"notify",value:function(e){if(this.markupsManager)try{this.markupsManager.dispatchEvent(e)}catch(e){console.warn(e)}}},{key:"getAttachment",value:function(e){var t=this,n=e.resources.map((function(n){var r=null;if(n.data)return r={layerData:e,resourceType:n.type},t.onGetAttachment(r),Promise.resolve(r);var i=$===Z;return t.service.getAttachment(n.ossPath,i).then((function(i){return i?(n.data=i,r={layerData:e,resourceType:n.type},t.onGetAttachment(r),Promise.resolve(r)):Promise.resolve(null)})).catch((function(e){}))}));return Promise.all(n)}},{key:"onGetAttachment",value:function(e){var t=e.layerData,n=e.resourceType;n===ee&&(this.numOfMarkupsLoaded+=1,this.notify({type:a.LAYER_RESOURCE_FETCHED,layerData:t}),this.fetchedAllMarkups||this.numOfMarkupsLoaded!==this.markupsCache.length()||(this.fetchedAllMarkups=!0,this.notify({type:a.ALL_MARKUPS_LOADED,amount:this.numOfMarkupsLoaded}))),n===te&&this.notify({type:a.LAYER_THUMBNAIL_FETCHED,layerData:t})}},{key:"createEmptyResourceObject",value:function(e,t,n){if(n[e]){var r={type:e,data:null,id:null,ossPath:null};return t?r.data=n[e]:r.ossPath=n[e],r}return null}},{key:"getAttachedDocumentData",value:function(e){var t=this;if(e&&Array.isArray(e)&&0!==e.length&&this.options.getAttachedDocumentCallback){var n=this.markupsCache.getAsList(),r=e.filter((function(e){return n.some((function(t){return e.attributes&&e.type===ie&&t.guid===e.attributes.issue_id}))}));r.length>0&&this.options.getAttachedDocumentCallback(r,(function(e){n.forEach((function(n){var r;e&&((r=n.attachments).push.apply(r,_c(e.filter((function(e){return e.attributes.issue_id===n.guid&&-1===n.attachments.findIndex((function(t){return t.id===e.id}))})))),n.attachments.forEach((function(e){t.notify({type:a.LINK_SYNCED,layerData:n,documentAttachment:e})})))}))}))}}},{key:"getUserProfiles",value:function(){var e=this;this.options.getUserProfileCallback&&Lt(this.markupsCache.getCache(),(function(t){var n=t.metadata.created_by;n&&!t.userName&&e.options.getUserProfileCallback(n,(function(n){n&&n.name&&(t.userName=n.name,e.notify({type:a.LAYER_METADATA_FETCHED}))}))}))}},{key:"getProjectUsers",value:function(){var e=this;this.options.getProjectUsersCallback&&(0,this.options.getProjectUsersCallback)((function(t){e.notify({type:a.PROJECT_USERS_FETCHED,users:t})}))}},{key:"getRevisions",value:function(){var e=this;this.options.getRevisionCallback&&this.options.getRevisionCallback(this.options.documentUrn,(function(t){Lt(e.markupsCache.getCache(),(function(e){if(e&&e.metadata){var n=e.metadata.starting_version;e.metadata.tags.starting_revision=t[n]}})),e.notify({type:a.LAYER_METADATA_FETCHED})}))}},{key:"generateMarkupDescription",value:function(e){var t=[];return e.getAllMarkups().forEach((function(e){e.type!==b&&e.type!==S||t.push(e.state.text)})),t.join(".\n")}},{key:"generateMetadata",value:function(e,t){var n=this,r={};r.target_urn=this.options.documentUrn,r.starting_version=this.options.documentVersion,r.resource_urns={};var i=this.viewer.getState(),a=this.viewer.model?this.viewer.model.getData().globalOffset:null;if(r.markup_metadata=function(e,t,n){var r=JSON.parse(JSON.stringify(e));return t&&cu(r.viewport,t),r.sheetGUID=n.sheetGUID,r.sheetName=n.sheetName,r}(i,a,this.options),r.markup_metadata.links=It(t.links).map((function(e){var t=e.state.position&&e.state.position.clone();return t&&n.markupsExtension.viewer.model.isPdf(!0)&&Autodesk.Viewing.PDFUtils.pdfToLeafletWorld(n.markupsExtension.viewer,t),{id:e.guid,type:e.type,position:t}})),r.description=this.generateMarkupDescription(t),r.tags={starting_revision:this.options.documentRevision||this.options.documentVersion},this.options.collectionUrn&&(r.collection_urn=this.options.collectionUrn),this.options.userName&&(r.tags.userName=this.options.userName),r.status=e,this.viewer.model.isLeaflet()){var A=this.viewer.model.getData().loadOptions.loadOptions;r.markup_metadata.originalDocumentResolution=[A.texWidth,A.texHeight]}return r}},{key:"saveLayer",value:function(e){var t,n=this,r=this.options.documentUrn,i=!e.layerData,A="".concat(e.id,"_tmp"),o=i?new Qs:e.layerData,s=this.generateMetadata(i?this.markupsExtension.getCreationStatusType():o.metadata.status,e),u=[{type:ee,data:Fc(e,this.markupsExtension.viewer,this.markupsExtension.renderer),id:null,ossPath:null},{type:te,data:null,id:null,ossPath:null}];o.status=H,o.originalCreationTime=i?(new Date).toISOString():s.created_at,e.layerData=o,i&&((t=lt.cloneDeep(o)).metadata=s,t.resources=u,this.markupsCache.add(A,t,r)),this.notify({type:a.LAYER_SYNCING,layerData:o,layer:e}),this.savingCounter++,this.markupsManager.generateScreenCapture(e).then((function(t){u[1].data=t,i||(o.resources=u),n.notify({type:a.LAYER_SYNCING,layerData:o,layer:e}),n.service.postLayer(s,u,i?void 0:e.getGuid()).then((function(e){var t=e.id;o.guid=t,o.metadata=e.attributes,o.resources=u,o.attachments=o.attachments||[],o.status=_,n.markupsCache.add(t,o,r),o.userName=o.metadata.tags.userName})).catch((function(t){i?e.layerData=null:o.status=F,n.errorHandler(Autodesk.Viewing.i18n.translate("Failed to save markup"),Lc.MARKUP_SAVE_FAILED,t),console.error("Failed to save markup",o,t)})).finally((function(){n.markupsCache.remove(A,r),n.notify({type:a.LAYER_SYNCED,layerData:o,layer:e}),n.savingCounter--}))})).catch((function(){n.savingCounter--}))}},{key:"onDocumentAttachmentCreationStart",value:function(e){var t=this,n=e.documentAttachments,r=e.layerData;if(0!==n.length)if(n.length>1)console.error("Dont save multiple attachments at a time.");else{n.forEach((function(e){e.attributes.issue_id=r.guid,e.attributes.attachment_type=ae}));var i=n[0];this.notify({type:a.LINK_SYNCING,documentAttachment:i,layerData:r}),this.service.postDocumentAttachment(i).then((function(e){e&&e.attributes&&e.attributes.issue_id&&(i.attributes=e.attributes,i.id=e.id,r.attachments.splice(0,0,i),t.markupsManager.createLinkMetadata(r)),t.notify({type:a.LINK_SYNCED,documentAttachment:i,layerData:r})})).catch((function(e){t.notify({type:a.LINK_SYNCED,documentAttachment:i,layerData:r}),t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to create markup attachment"),Lc.MARKUP_ATTACHMENT_CREATE_FAILED,e),console.error("Failed to create markup attachment",e)}))}}},{key:"deleteDocumentAttachment",value:function(e){var t=this,n=e.documentAttachment,r=e.layerData;n.status=q,this.notify({type:a.LINK_SYNCING,documentAttachment:n,layerData:r}),this.service.deleteDocumentAttachment(n.id).then((function(){var e=r.attachments,i=e.indexOf(n);i>-1&&e.splice(i,1),t.notify({type:a.LINK_SYNCED,documentAttachment:n,layerData:r})})).catch((function(e){t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to delete markup attachment"),Lc.MARKUP_ATTACHMENT_DELETE_FAILED,e),t.notify({type:a.LINK_SYNCED,documentAttachment:n,layerData:r})}))}},{key:"renameDocumentAttachment",value:function(e){var t=this,n=e.documentAttachment,r=e.newName,i=e.layerData;n.status=J,n.tmpName=r,this.notify({type:a.LINK_SYNCING,documentAttachment:n,layerData:i}),this.service.renameDocumentAttachment(n.id,r).then((function(e){n.attributes=e.attributes,n.status=void 0,n.tmpName=void 0,t.notify({type:a.LINK_SYNCED,documentAttachment:n,layerData:i})})).catch((function(e){n.status=void 0,n.tmpName=void 0,t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to rename markup attachment"),Lc.MARKUP_ATTACHMENT_RENAME_FAILED,e),t.notify({type:a.LINK_SYNCED,documentAttachment:n,layerData:i})}))}},{key:"updateLinkPosition",value:function(e,t,n){var r=this,i=n.clone();this.markupsExtension.viewer.model.isPdf(!0)&&Autodesk.Viewing.PDFUtils.pdfToLeafletWorld(this.markupsExtension.viewer,i);var a={markup_metadata:{links:[{id:t,position:i}]}};return this.service.updateLayer(e,a).then((function(e){return Promise.resolve(e)}),(function(e){return r.errorHandler(Autodesk.Viewing.i18n.translate("Failed to update markup attachment"),Lc.MARKUP_ATTACHMENT_UPDATE_FAILED,e),Promise.reject("Failed to change the link position: "+t)}))}},{key:"deleteLayer",value:function(e){var t=this;e.guid||(e=this.markupsCache.get(e)),e.status=R,this.notify({type:a.LAYER_SYNCING,layerData:e});var n=this.options.documentUrn;return this.service.deleteLayer(e.guid).then((function(r){return t.markupsCache.remove(e.guid,n),e.status=L,t.notify({type:a.LAYER_SYNCED,layerData:e}),Promise.resolve(!0)}),(function(n){return e.status=D,t.notify({type:a.LAYER_SYNCED,layerData:e}),t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to delete markup"),Lc.MARKUP_DELETE_FAILED,n),Promise.reject("Failed to delete markup: "+e.guid)}))}},{key:"deleteAllLayers",value:function(){var e=this;this.markupsCache.getAsList().forEach((function(t){e.deleteLayer(t)}))}},{key:"publishLayer",value:function(e){var t=this;e.guid||(e=this.markupsCache.get(e));var n=e.status;e.status=K,this.notify({type:a.LAYER_SYNCING,layerData:e}),this.service.publishLayer(e.guid).then((function(r){return e.status=n,e.metadata=r.attributes,t.notify({type:a.LAYER_SYNCED,layerData:e}),Promise.resolve()})).catch((function(r){e.status=n,t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to publish markup"),Lc.MARKUP_PUBLISH_FAILED,r),t.notify({type:a.LAYER_SYNCED,layerData:e})}))}},{key:"archiveLayer",value:function(e){var t=this;e.guid||(e=this.markupsCache.get(e));var n=e.status;e.status=G,this.notify({type:a.LAYER_SYNCING,layerData:e}),this.service.archiveLayer(e.guid,this.options.currentRawDocumentVersion).then((function(r){return e.status=n,e.metadata=r.attributes,t.notify({type:a.LAYER_SYNCED,layerData:e}),Promise.resolve()})).catch((function(r){e.status=n,t.errorHandler(Autodesk.Viewing.i18n.translate("Failed to archive markup"),Lc.MARKUP_ARCHIVE_FAILED,r),t.notify({type:a.LAYER_SYNCED,layerData:e})}))}},{key:"cancelRequests",value:function(){this.service.cancelAllGet()}},{key:"terminate",value:function(){this.cancelRequests(),this.markupsExtension=null,this.markupsManager=null,this.service=null}},{key:"getMaxPageLimit",value:function(){return this.service.maxPageLimit}}])&&Rc(t.prototype,n),r&&Rc(t,r),e}();function Ic(e){return(Ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oc(e,t,n,r,i,a,A){try{var o=e[a](A),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,i)}function Nc(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function A(e){Oc(a,r,i,A,o,"next",e)}function o(e){Oc(a,r,i,A,o,"throw",e)}A(void 0)}))}}function Pc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vc(e,t){return(Vc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Yc(e);if(t){var i=Yc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Gc(this,n)}}function Gc(e,t){return!t||"object"!==Ic(t)&&"function"!=typeof t?zc(e):t}function zc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yc(e){return(Yc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wc=AutodeskNamespace("Autodesk.BIM360.Markups"),Xc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vc(e,t)}(A,Autodesk.Viewing.Extension);var t,n,r,i,a=jc(A);function A(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Pc(this,A),(t=a.call(this,e,n)).viewer=e,t.options=n,t.cache=t.getCache(),t.onModelLoadedBinded=t.onModelLoaded.bind(zc(t)),t}return t=A,(n=[{key:"onModelLoaded",value:function(e){if(this.viewer.model&&!this.initialized){this.initCache();var t=e.model.getDocumentNode();t?(this.sheetList=t.getRootNode().search({type:"geometry"}),this.options.sheetGUID=t.guid(),this.options.sheetName=t.name(),this.options.fileName=t.findViewableParent().name()):this.sheetList=[],this.markupsManager=new Su(this),this.filterManager=new qu(this,this.options),this.permissionManager=new ec(this.options),this.markupsTool=new bs(this),this.viewer.toolController.registerTool(this.markupsTool);var n=this.viewer.toolController.setIsLocked(!1);this.viewer.toolController.activateTool(this.markupsTool.getName()),this.viewer.toolController.setIsLocked(n),this.renderer=new zu(this),this.markupsManager.setDefaultCreationStyleProperties(),this.options.isMobileApp?this.mobileCallbacks=new ac(this):(this.markupsUI=new Ms(this),this.initMarkupsPanel()),this.initServiceOperator(),this.selectInitialLayer(),this.initialized=!0}}},{key:"initCache",value:function(){this.cache.hasOwnProperty("markupsCache")||(this.cache.markupsCache=new oc),this.markupsCache=this.cache.markupsCache,this.markupsCache.currentUrn!==this.options.documentUrn&&(this.cache.layerToSelect=null,this.cache.layerToEdit=null,this.cache.filters=null),this.cache.markupsCache.setCurrentUrn(this.options.documentUrn)}},{key:"initServiceOperator",value:function(){this.serviceOperator||(this.serviceOperator=new Dc),this.serviceOperator.reset(this),this.serviceOperator.fetchMarkups()}},{key:"initMarkupsPanel",value:function(){this.options.panelContainer&&this.options.uiClasses&&this.options.uiClasses.MarkupPanelClass&&(this.cache.markupsPanel||(this.cache.markupsPanel=new this.options.uiClasses.MarkupPanelClass),this.cache.markupsPanel.reset(this))}},{key:"selectInitialLayer",value:function(){var e=this;setTimeout(Nc(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Autodesk.Viewing.EventUtils.waitUntilTransitionEnded(e.viewer);case 2:e.cache.layerToSelect&&(e.selectLayer(e.cache.layerToSelect,!0,!0),e.cache.layerToSelect=null),e.cache.layerToEdit&&(e.editLayer(e.cache.layerToEdit,!0,!0,!0),e.cache.layerToEdit=null);case 4:case"end":return t.stop()}}),t)}))))}},{key:"load",value:(i=Nc(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.viewer.loadExtension("Autodesk.Snapping");case 2:return this.viewer.model?this.onModelLoaded({model:this.viewer.model}):this.viewer.addEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,this.onModelLoadedBinded),e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"unload",value:function(){return this.viewer.removeEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,this.onModelLoadedBinded),this.mobileCallbacks&&(this.mobileCallbacks.destroy(),this.mobileCallbacks=null),this.markupsUI&&(this.markupsUI.destroy(),this.markupsUI=null),this.renderer&&(this.renderer.destroy(),this.renderer=null),this.markupsTool&&(this.viewer.toolController.deregisterTool(this.markupsTool),this.markupsTool=null),this.markupsManager&&(this.markupsManager.destroy(),this.markupsManager=null),this.filterManager&&(this.filterManager.destroy(),this.filterManager=null),this.permissionManager&&(this.permissionManager.destroy(),this.permissionManager=null),this.serviceOperator&&(this.serviceOperator.terminate(),this.serviceOperator=null),this.markupsCache=null,this.initialized=!1,!0}},{key:"startMarkupSession",value:function(e,t){this.markupsManager.startMarkupSession(e,t)}},{key:"endMarkupSession",value:function(e){this.markupsManager.endMarkupSession(e)}},{key:"setToolEnabled",value:function(e){this.markupsManager.setToolEnabled(e)}},{key:"isToolEnabled",value:function(){return this.markupsManager.isToolEnabled()}},{key:"editLayer",value:function(e,t,n,r){this.markupsManager.editLayer(e,t,n,r)}},{key:"changeMarkupCreationType",value:function(e,t){(this.markupsManager.isMarkupSessionOpen()||t)&&this.markupsManager.changeMarkupCreationType(e)}},{key:"deleteMarkup",value:function(e){this.markupsManager.deleteMarkup(e)}},{key:"deleteInEditMarkups",value:function(){this.markupsManager.deleteInEditMarkups()}},{key:"undo",value:function(){this.markupsManager.undo()}},{key:"redo",value:function(){this.markupsManager.redo()}},{key:"copy",value:function(){this.markupsManager.copy()}},{key:"paste",value:function(){this.markupsManager.paste()}},{key:"cut",value:function(){this.markupsManager.cut()}},{key:"selectMarkup",value:function(e){this.markupsManager.selectMarkup(e)}},{key:"deselectMarkup",value:function(e){this.markupsManager.deselectMarkup(e)}},{key:"deselectAllMarkups",value:function(e){this.markupsManager.deselectAllMarkups(e)}},{key:"deselectAllLayers",value:function(e){this.markupsManager.deselectAllLayers(e)}},{key:"exitMarkupView",value:function(){this.markupsManager.exitMarkupView()}},{key:"getSelectedMarkups",value:function(){return this.markupsManager.getSelectedMarkups()}},{key:"getSelectedLayer",value:function(){return this.markupsManager.getSelectedLayer()}},{key:"getVisibleMarkups",value:function(){return this.markupsManager.getVisibleMarkups()}},{key:"selectLayer",value:function(e,t,n){this.markupsManager.selectLayer(e,t,n)}},{key:"deselectLayer",value:function(e){this.markupsManager.deselectLayer(e)}},{key:"getStyleProperty",value:function(e){return this.markupsManager.getStyleProperty(e)}},{key:"changeStyleProperty",value:function(e,t,n){this.markupsManager.changeStyleProperty(e,t,n)}},{key:"loadLayers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.markupsCache&&this.markupsCache.getAsList(),t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.markupsManager.loadLayers(e,t,n)}},{key:"removeLayer",value:function(e){this.markupsManager.removeLayer(e)}},{key:"changeCreationStatusType",value:function(e){this.markupsManager.changeCreationStatusType(e)}},{key:"getCreationStatusType",value:function(){return this.markupsManager.getCreationStatusType()}},{key:"updateFilters",value:function(e){this.filterManager.updateFilters(e)}}])&&Kc(t.prototype,n),r&&Kc(t,r),A}();Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.BIM360.Markups",Xc),Wc.Constants=Object.assign({},r),Wc.Events=Object.assign({},a),Wc.markupsOverlayRenderer=Yt}]);
//# sourceMappingURL=BimMarkups.min.js.map
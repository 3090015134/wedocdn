/*!
 * LMV v7.32.0
 * 
 * Copyright 2020 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.Pushpins=function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=607)}({153:function(e){e.exports=JSON.parse('{"@@locale":"en","@@context":"Pushpins Extension","No issue in current doc":"No issue in current doc","Show all issues":"Show all issues","Hide all issues":"Hide all issues","No RFI in current doc":"No RFI in current doc","Show all RFIs":"Show all RFIs","Hide all RFIs":"Hide all RFIs","No field issue in current doc":"No field issue in current doc","Show all field issues":"Show all field issues","Hide all field issues":"Hide all field issues"}')},154:function(e){e.exports=JSON.parse('{"@@locale":"cs","@@context":"Rozšíření Pushpins","No issue in current doc":"V aktuálním dokumentu není problém.","Show all issues":"Zobrazit všechny problémy","Hide all issues":"Skrýt všechny problémy","No RFI in current doc":"V aktuálním dokumentu neexistuje soubor RFI.","Show all RFIs":"Zobrazit všechny soubory RFI","Hide all RFIs":"Skrýt všechny soubory RFI","No field issue in current doc":"V aktuálním dokumentu není problém s polem.","Show all field issues":"Zobrazit všechny problémy s poli","Hide all field issues":"Skrýt všechny problémy s poli"}')},155:function(e){e.exports=JSON.parse('{"@@locale":"de","@@context":"Pin-Erweiterung","No issue in current doc":"Kein Mangel im aktuellen Dokument","Show all issues":"Alle Mängel anzeigen","Hide all issues":"Alle Mängel ausblenden","No RFI in current doc":"Kein RFI im aktuellen Dokument","Show all RFIs":"Alle RFIs anzeigen","Hide all RFIs":"Alle RFIs ausblenden","No field issue in current doc":"Kein Mangel vor Ort im aktuellem Dokument","Show all field issues":"Alle Mängel vor Ort anzeigen","Hide all field issues":"Alle Mängel vor Ort ausblenden"}')},156:function(e){e.exports=JSON.parse('{"@@locale":"es","@@context":"Extensión de chinchetas","No issue in current doc":"No hay ninguna incidencia en el documento actual.","Show all issues":"Mostrar todas las incidencias","Hide all issues":"Ocultar todas las incidencias","No RFI in current doc":"No hay ninguna SDI en el documento actual.","Show all RFIs":"Mostrar todas las SDI","Hide all RFIs":"Ocultar todas las SDI","No field issue in current doc":"No hay ninguna incidencia de obra en el documento actual.","Show all field issues":"Mostrar todas las incidencias de obra","Hide all field issues":"Ocultar todas las incidencias de obra"}')},157:function(e){e.exports=JSON.parse('{"@@locale":"fr","@@context":"Extension des punaises","No issue in current doc":"Aucun problème dans le document actif","Show all issues":"Afficher tous les problèmes","Hide all issues":"Masquer tous les problèmes","No RFI in current doc":"Aucune DI dans le document actif","Show all RFIs":"Afficher toutes les DI","Hide all RFIs":"Masquer toutes les DI","No field issue in current doc":"Aucun problème de champ dans le document actif","Show all field issues":"Afficher tous les problèmes de champ","Hide all field issues":"Masquer tous les problèmes de champ"}')},158:function(e){e.exports=JSON.parse('{"@@locale":"fr-CA","@@context":"Extension des punaises","No issue in current doc":"Aucun problème dans le document actif","Show all issues":"Afficher tous les problèmes","Hide all issues":"Masquer tous les problèmes","No RFI in current doc":"Aucune QT dans le document actif","Show all RFIs":"Afficher toutes les QT","Hide all RFIs":"Masquer toutes les QT","No field issue in current doc":"Aucun problème de champ dans le document actif","Show all field issues":"Afficher tous les problèmes de champ","Hide all field issues":"Masquer tous les problèmes de champ"}')},159:function(e){e.exports=JSON.parse('{"@@locale":"it","@@context":"Estensione Pushpin","No issue in current doc":"Nessun problema nel documento corrente","Show all issues":"Mostra tutti i problemi","Hide all issues":"Nascondi tutti i problemi","No RFI in current doc":"Nessun file RFI nel documento corrente","Show all RFIs":"Mostra tutti i file RFI","Hide all RFIs":"Nascondi tutti i file RFI","No field issue in current doc":"Nessun problema del campo nel documento corrente","Show all field issues":"Mostra tutti i problemi dei campi","Hide all field issues":"Nascondi tutti i problemi dei campi"}')},160:function(e){e.exports=JSON.parse('{"@@locale":"ja","@@context":"押しピン エクステンション","No issue in current doc":"現在のドキュメントに指摘事項はありません","Show all issues":"すべての指摘事項を表示","Hide all issues":"すべての指摘事項を非表示","No RFI in current doc":"現在のドキュメントに情報提供依頼はありません","Show all RFIs":"すべての情報提供依頼を表示","Hide all RFIs":"すべての情報提供依頼を非表示","No field issue in current doc":"現在のドキュメントに現場指摘事項はありません","Show all field issues":"すべての現場指摘事項を表示","Hide all field issues":"すべての現場指摘事項を非表示"}')},161:function(e){e.exports=JSON.parse('{"@@locale":"ko","@@context":"압정 확장","No issue in current doc":"현재 문서에 문제 없음","Show all issues":"모든 문제 표시","Hide all issues":"모든 문제 숨기기","No RFI in current doc":"현재 문서에 RFI 없음","Show all RFIs":"모든 RFI 표시","Hide all RFIs":"모든 RFI 숨기기","No field issue in current doc":"현재 문서에 필드 문제 없음","Show all field issues":"모든 필드 문제 표시","Hide all field issues":"모든 필드 문제 숨기기"}')},162:function(e){e.exports=JSON.parse('{"@@locale":"pl","@@context":"Rozszerzenie blokad","No issue in current doc":"Brak problemu w bieżącym dokumencie","Show all issues":"Pokaż wszystkie problemy","Hide all issues":"Ukryj wszystkie problemy","No RFI in current doc":"Brak RFI w bieżącym dokumencie","Show all RFIs":"Pokaż wszystkie RFI","Hide all RFIs":"Ukryj wszystkie RFI","No field issue in current doc":"Brak problemu z polem w bieżącym dokumencie","Show all field issues":"Pokaż wszystkie problemy z polami","Hide all field issues":"Ukryj wszystkie problemy z polami"}')},163:function(e){e.exports=JSON.parse('{"@@locale":"pt","@@context":"Extensão de pinos","No issue in current doc":"Nenhum problema no documento atual","Show all issues":"Mostrar todos os problemas","Hide all issues":"Ocultar todos os problemas","No RFI in current doc":"Nenhuma RFI no documento atual","Show all RFIs":"Mostrar todas as RFIs","Hide all RFIs":"Ocultar todas as RFIs","No field issue in current doc":"Nenhum problema de campo no documento atual","Show all field issues":"Mostrar todos os problemas de campo","Hide all field issues":"Ocultar todos os problemas de campo"}')},164:function(e){e.exports=JSON.parse('{"@@locale":"ru","@@context":"Расширение Pushpins","No issue in current doc":"В текущем документе проблем нет","Show all issues":"Показать все проблемы","Hide all issues":"Скрыть все проблемы","No RFI in current doc":"В текущем документе нет запроса информации (RFI)","Show all RFIs":"Показать все запросы информации","Hide all RFIs":"Скрыть все запросы информации","No field issue in current doc":"В текущем документе нет проблем с полями","Show all field issues":"Показать все проблемы с полями","Hide all field issues":"Скрыть все проблемы с полями"}')},165:function(e){e.exports=JSON.parse('{"@@locale":"tr","@@context":"Pushpins Uzantısı","No issue in current doc":"Mevcut belgede sorun yok","Show all issues":"Tüm sorunları göster","Hide all issues":"Tüm sorunları gizle","No RFI in current doc":"Mevcut belgede RFI yok","Show all RFIs":"Tüm RFIleri göster","Hide all RFIs":"Tüm RFIleri gizle","No field issue in current doc":"Mevcut belgede alan sorunu yok","Show all field issues":"Tüm alan sorunlarını göster","Hide all field issues":"Tüm alan sorunlarını gizle"}')},166:function(e){e.exports=JSON.parse('{"@@locale":"zh-Hans","@@context":"图钉扩展","No issue in current doc":"当前文档中没有问题","Show all issues":"显示所有问题","Hide all issues":"隐藏所有问题","No RFI in current doc":"当前文档中无 RFI","Show all RFIs":"显示所有 RFI","Hide all RFIs":"隐藏所有 RFI","No field issue in current doc":"当前文档中没有字段问题","Show all field issues":"显示所有字段问题","Hide all field issues":"隐藏所有字段问题"}')},167:function(e){e.exports=JSON.parse('{"@@locale":"zh-Hant","@@context":"圖釘延伸","No issue in current doc":"目前文件中沒有問題","Show all issues":"展示所有問題","Hide all issues":"隱藏所有問題","No RFI in current doc":"目前文件中沒有 RFI","Show all RFIs":"展示所有 RFI","Hide all RFIs":"隱藏所有 RFI","No field issue in current doc":"目前文件中沒有欄位問題","Show all field issues":"展示所有欄位問題","Hide all field issues":"隱藏所有欄位問題"}')},168:function(e){e.exports=JSON.parse('{"@@locale":"nl","@@context":"Pushpins-extensie","No issue in current doc":"Geen probleem in huidig document","Show all issues":"Alle problemen weergeven","Hide all issues":"Alle problemen verbergen","No RFI in current doc":"Geen RFI in huidig document","Show all RFIs":"Alle RFI\'s weergeven","Hide all RFIs":"Alle RFI\'s verbergen","No field issue in current doc":"Geen veldproblemen in huidig document","Show all field issues":"Alle veldproblemen weergeven","Hide all field issues":"Alle veldproblemen verbergen"}')},169:function(e){e.exports=JSON.parse('{"@@locale":"sv","@@context":"Häftstift-tillägg","No issue in current doc":"Inga problem i aktuellt dokument","Show all issues":"Visa alla problem","Hide all issues":"Dölj alla problem","No RFI in current doc":"Ingen begäran om information i aktuellt dokument","Show all RFIs":"Visa alla begäranden","Hide all RFIs":"Dölj alla begäranden","No field issue in current doc":"Inga fältproblem i aktuellt dokument","Show all field issues":"Visa alla fältproblem","Hide all field issues":"Dölj alla fältproblem"}')},170:function(e){e.exports=JSON.parse('{"@@locale":"da","@@context":"Pushpins-filtypebetegnelse","No issue in current doc":"Ingen problemer i det aktuelle dokument","Show all issues":"Vis alle problemer","Hide all issues":"Skjul alle problemer","No RFI in current doc":"Ingen RFI i det aktuelle dokument","Show all RFIs":"Vis alle RFI\'er","Hide all RFIs":"Skjul alle RFI\'er","No field issue in current doc":"Intet feltproblem i det aktuelle dokument","Show all field issues":"Vis alle feltproblemer","Hide all field issues":"Skjul alle feltproblemer"}')},171:function(e){e.exports=JSON.parse('{"@@locale":"no","@@context":"Pushpins-utvidelse","No issue in current doc":"Ingen problemer i gjeldende dok","Show all issues":"Vis alle problemer","Hide all issues":"Skjul alle problemer","No RFI in current doc":"Ingen RFI i gjeldende dok","Show all RFIs":"Vis alle RFI-er","Hide all RFIs":"Skjul alle RFI-er","No field issue in current doc":"Ingen feltproblemer i gjeldende dok","Show all field issues":"Vis alle feltproblemer","Hide all field issues":"Skjul alle feltproblemer"}')},346:function(e,t,i){var n=i(347);"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i(5)(n,s);n.locals&&(e.exports=n.locals)},347:function(e,t,i){(e.exports=i(4)(!1)).push([e.i,'@font-face{font-family:\'issueicon\';src:url(data:application/font-woff;charset=utf-8;base64,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);font-weight:normal;font-style:normal}[class^="issueicon-"],[class*=" issueicon-"]{font-family:\'issueicon\';font-style:normal;font-weight:normal;font-variant:normal;line-height:1;padding-top:2px;speak:none;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}@font-face{font-family:\'rfiicon\';src:url(data:application/font-woff;charset=utf-8;base64,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);font-weight:normal;font-style:normal}[class^="rfiicon-"],[class*=" rfiicon-"]{font-family:\'rfiicon\';font-style:normal;font-weight:normal;font-variant:normal;line-height:1;padding-top:2px;speak:none;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}@font-face{font-family:\'fieldissueicon\';src:url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUAAA0AAAAAByQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAE5AAAABwAAAAcfzoDmUdERUYAAATIAAAAGwAAAB4AJwALT1MvMgAAAZwAAABKAAAAYC+xTDxjbWFwAAAB+AAAAEQAAAFKwBQjvWdhc3AAAATAAAAACAAAAAj//wADZ2x5ZgAAAkgAAAFeAAABhPocpV5oZWFkAAABMAAAADAAAAA2DEAuiWhoZWEAAAFgAAAAHAAAACQEIwIFaG10eAAAAegAAAAQAAAAEgYAAABsb2NhAAACPAAAAAwAAAAMAFgAwm1heHAAAAF8AAAAHgAAACAATgBKbmFtZQAAA6gAAADjAAAB47FU88Bwb3N0AAAEjAAAADIAAABR2shGr3icY2BkYGAA4uk3ErPi+W2+MnAzMYDAVZ+8TjB9te4fkGJnYmAE0RwMYGkALxEKOXicY2BkYGD8wsDAoMfEAAJAkpEBFbAAACM+AS54nGNgZGBgYGVwZ2BnAAEmIGZkAIk5gPkMAApQAJkAAHicY2BmYmCcwMDKwMHow5jGwMDgDqW/MkgytDAwMDGwcjLAgQCCyRCQ5prC4PCA8QET44P/Dxj0GL/8/wIUZkRSosDACAAr1Q1fAAB4nGNigAAmKGZgAAAAVgAHeJzdisEJwDAQw+RLyRR59NlBuv8M2STxpaWQFSowRiCg8Kwhktum5QeXv/pFQI8xMujKP+PtjSqfyGXWG+L3TGW0BrEAAAAAAAAAAABYAMJ4nG2PvU7CUBiGv4+fcyhwSiH0HAg/ASptKLQ1LaVoDTHGOOjohAnizwW46AU4GBNnZx2dZfQKSJzYvQYHE1fi0dnhXZ68w/NAGgBoAvAWmmDDCLZhAhC5SSua0MAXhtlHF40O0ctchC6Gw5GkhBrC53qgG2EggdCDkMp9j+db7RSheV20Nmy/9nRRV6unuaDdiwOz0rLqdkml/kJhfCGYwh3HOUuYoVvMKKxS4kU1c8eb3bhnjdOdVLdas7okL3/LpcIG0+mV48Cvq1wev3ANJWhDD3zpuwcHAGgW0JSilAtKBPcjHKX/ZKmEDaRDUxgdK+IxRjIj4sI06D8N+K5q56PK8UO7GR8WCqRI8Flbv04GZdYgzX4jcY2e45WrOMfkbtTKcZFllTfBssLzPPzUtEt2sh8PjrQCIfiifvR3aN1ukDqtPmpu7h4JToxN5rHsapVl7mx247o/vPQ77AAAeJyVj8FKw0AURc+0aUAUiht3ltnLhGQgCAXd2U/IFzQtgZJAmv6KOz/IT/ET3HmnPhe6EDrwmDN37rvzBrjhFUdajiXeeEbOs/GcB96MM3k+jBdcu1vjnKV7ktNlV1JW567EM+WXxnMaXowzed6NF9zxaZyzcvec6JnoVAdatgR2DGctUMGpn7rp0G7DbuinIOHX7Y+4MTHtI3sFeSKFxvGsVf8/8u2J1DqliuqreFSs4jfDuG99LEq/9n+GkRLrUIdYVjJf+pFGrpGjOpLLy5PmpWnHYzf0virKizO/AEzyTYUAeJxjYGJABowM6IAVLMrEyMTIzJ+WmZqToptZXFyaqpuZnCeCzM9PSwOK5ecBAP6rDY8AAAAAAAH//wACeJxjYGRgYOABYjEgZmJgBEIWMAbxGAADygAzAAAAAAEAAAAA1BgWEQAAAADVTG6JAAAAANXVfv4=);font-weight:normal;font-style:normal}[class^="fieldissueicon-"],[class*=" fieldissueicon-"]{font-family:\'fieldissueicon\';font-style:normal;font-weight:normal;font-variant:normal;line-height:1;padding-top:2px;speak:none;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.issueicon-issue_hide:before{content:"\\E915"}.issueicon-issue_normal:before{content:"\\E916"}.rfiicon-rfi_hide:before{content:"\\E003"}.rfiicon-rfi_normal:before{content:"\\E002"}.fieldissueicon-issue_hide:before{content:"\\E002"}.fieldissueicon-issue_normal:before{content:"\\E001"}.leaflet-text-label{display:inherit;font-family:\'HelveticaNeue-bold\';font-style:normal;font-weight:normal;font-variant:normal;line-height:0;pointer-events:none;text-align:center;font-size:16px;border-radius:.5em;max-width:auto;min-width:60px;height:32px;position:absolute;background-color:rgba(0,0,0,0.7);color:#FFF;border:2px solid white}.leaflet-marker-icon.leaflet-pin-icon{width:40px}.leaflet-text-label span{display:inline-block;vertical-align:middle;line-height:32px;white-space:pre}.leaflet-pushpin-hidden{visibility:hidden}#toolbar-pushpinVis,#toolbar-pushpinRfisVis,#toolbar-pushpinFieldIssuesVis{border:none}.pushpin-billboard-marker{position:absolute;font-size:10px;font-weight:bold;width:22px;height:22px;left:0;top:0;line-height:16px;text-align:center;cursor:pointer;pointer-events:none;color:#1757a8;border:4px solid rgba(255,255,255,0.95);background:#4675A8 no-repeat center;background-size:16px;border-radius:15px;opacity:1;transition:opacity 0.4s;-webkit-transition:opacity 0.4s;will-change:transform}.rfi-billboard-marker{position:absolute;font-size:10px;font-weight:bold;width:22px;height:22px;line-height:16px;text-align:center;cursor:pointer;pointer-events:none;left:0;top:0;color:#1757a8;border:4px solid rgba(255,255,255,0.95);background:#4675A8 no-repeat center;background-size:16px;border-radius:3px;opacity:1;transition:opacity 0.4s;-webkit-transition:opacity 0.4s;will-change:transform}.pushpin-billboard-marker.selected{border:5px solid rgba(255,255,255,0.95);border-radius:20px;background-size:20px;z-index:1;top:-3px;width:28px;height:28px;left:-3px}.rfi-billboard-marker.selected{border:5px solid rgba(255,255,255,0.95);border-radius:4px;background-size:20px;z-index:1;top:-3px;width:28px;height:28px;left:-3px}.pushpin-billboard-marker.grey-out{background-color:#919191 !important;opacity:0.5 !important;cursor:not-allowed}.rfi-billboard-marker.grey-out{background-color:#919191 !important;opacity:0.5 !important;cursor:not-allowed}.pushpin-container{will-change:transform;transform:translateZ(0);left:0;top:0;position:absolute}\n',""])},4:function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var s=(r=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),o=n.sources.map((function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"}));return[i].concat(o).concat([s]).join("\n")}var r;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},s=0;s<this.length;s++){var o=this[s][0];"number"==typeof o&&(n[o]=!0)}for(s=0;s<e.length;s++){var r=e[s];"number"==typeof r[0]&&n[r[0]]||(i&&!r[2]?r[2]=i:i&&(r[2]="("+r[2]+") and ("+i+")"),t.push(r))}},t}},5:function(e,t,i){var n,s,o={},r=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===s&&(s=n.apply(this,arguments)),s}),a=function(e,t){return t?t.querySelector(e):document.querySelector(e)},l=function(e){var t={};return function(e,i){if("function"==typeof e)return e();if(void 0===t[e]){var n=a.call(this,e,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),u=null,h=0,c=[],d=i(6);function p(e,t){for(var i=0;i<e.length;i++){var n=e[i],s=o[n.id];if(s){s.refs++;for(var r=0;r<s.parts.length;r++)s.parts[r](n.parts[r]);for(;r<n.parts.length;r++)s.parts.push(g(n.parts[r],t))}else{var a=[];for(r=0;r<n.parts.length;r++)a.push(g(n.parts[r],t));o[n.id]={id:n.id,refs:1,parts:a}}}}function A(e,t){for(var i=[],n={},s=0;s<e.length;s++){var o=e[s],r=t.base?o[0]+t.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};n[r]?n[r].parts.push(a):i.push(n[r]={id:r,parts:[a]})}return i}function f(e,t){var i=l(e.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===e.insertAt)n?n.nextSibling?i.insertBefore(t,n.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),c.push(t);else if("bottom"===e.insertAt)i.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var s=l(e.insertAt.before,i);i.insertBefore(t,s)}}function v(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function m(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=function(){0;return i.nc}();n&&(e.attrs.nonce=n)}return y(t,e.attrs),f(e,t),t}function y(e,t){Object.keys(t).forEach((function(i){e.setAttribute(i,t[i])}))}function g(e,t){var i,n,s,o;if(t.transform&&e.css){if(!(o="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=o}if(t.singleton){var r=h++;i=u||(u=m(t)),n=P.bind(null,i,r,!1),s=P.bind(null,i,r,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",y(t,e.attrs),f(e,t),t}(t),n=I.bind(null,i,t),s=function(){v(i),i.href&&URL.revokeObjectURL(i.href)}):(i=m(t),n=w.bind(null,i),s=function(){v(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else s()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=r()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var i=A(e,t);return p(i,t),function(e){for(var n=[],s=0;s<i.length;s++){var r=i[s];(a=o[r.id]).refs--,n.push(a)}e&&p(A(e,t),t);for(s=0;s<n.length;s++){var a;if(0===(a=n[s]).refs){for(var l=0;l<a.parts.length;l++)a.parts[l]();delete o[a.id]}}}};var b,E=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function P(e,t,i,n){var s=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=E(t,s);else{var o=document.createTextNode(s),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(o,r[t]):e.appendChild(o)}}function w(e,t){var i=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function I(e,t,i){var n=i.css,s=i.sourceMap,o=void 0===t.convertToAbsoluteUrls&&s;(t.convertToAbsoluteUrls||o)&&(n=d(n)),s&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var r=new Blob([n],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(r),a&&URL.revokeObjectURL(a)}},6:function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var i=t.protocol+"//"+t.host,n=i+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var s,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(s=0===o.indexOf("//")?o:0===o.indexOf("/")?i+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(s)+")")}))}},607:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return st}));var n,s,o,r,a={PUSH_PIN_EDIT_START_EVENT:"pushpin.edit.start",PUSH_PIN_EDIT_END_EVENT:"pushpin.edit.end",PUSH_PIN_PREPARING_THUMBNAIL:"pushpin.preparing.thumbnail",PUSH_PIN_CREATED_EVENT:"pushpin.created",PUSH_PIN_SELECTED_EVENT:"pushpin.selected",PUSH_PIN_REMOVED_EVENT:"pushpin.removed",PUSH_PIN_REMOVE_ALL_EVENT:"pushpin.remove.all",PUSH_PIN_MODIFY_EVENT:"pushpin.modified",PUSH_PIN_UPDATE_EVENT:"pushpin.update",PUSH_PIN_VISIBILITY_EVENT:"pushpin.visibility.changed",PUSH_PIN_ITEMS_LOADED:"pushpin.tool.items.loaded",PUSH_PIN_CLICKED_EVENT:"pushpin.clicked",PUSH_PIN_SELECT_NONE:"pushpin.select.none"},l=function(e,t){e&&t&&("eye"in e&&(e.eye[0]=(Number(e.eye[0])+t.x).toString(),e.eye[1]=(Number(e.eye[1])+t.y).toString(),e.eye[2]=(Number(e.eye[2])+t.z).toString()),"target"in e&&(e.target[0]=(Number(e.target[0])+t.x).toString(),e.target[1]=(Number(e.target[1])+t.y).toString(),e.target[2]=(Number(e.target[2])+t.z).toString()),"pivotPoint"in e&&(e.pivotPoint[0]=(Number(e.pivotPoint[0])+t.x).toString(),e.pivotPoint[1]=(Number(e.pivotPoint[1])+t.y).toString(),e.pivotPoint[2]=(Number(e.pivotPoint[2])+t.z).toString()))},u=function(e,t){if(e&&t)for(var i=new THREE.Vector3,n=0;n<e.length;n++){var s=e[n];c(s,i),s[3]=Number(s[3])-i.dot(t)}},h=function(e,t){t.data&&t.data.viewerState&&function(){for(var i=function(e,t){var i=e.model?e.model.getData().globalOffset:null,n=JSON.parse(JSON.stringify(t.data.viewerState));if(i){var s={x:-i.x,y:-i.y,z:-i.z};l(n.viewport,s),t.getAttributesVersion()>=2&&u(n.cutplanes,s)}var o=t.findModel(e),r=null==o?void 0:o.getModelTransform();return r&&f(n,r),n.objectSet||(n.objectSet=[]),n}(e,t),n=e.getVisibleModels(),s=function(e){for(var t=n[e].getSeedUrn(),s=1===n.length,o=0;o<i.objectSet.length;o++){if(!i.objectSet[o].seedUrn&&s||i.objectSet[o].seedUrn===t||i.seedURN===t)for(var r=i.objectSet[o].isolated,a=0;a<r.length;a++)n[e].isNodeExists(r[a])||(i.objectSet[o].isolated.splice(a,1),a--)}},o=0;o<n.length;o++)s(o);e.restoreState(i,null,!1);var r=e.navigation;if(r){r.updateCamera();var a=r.getCamera();a.updateMatrixWorld(),a.matrixWorldInverse.getInverse(a.matrixWorld)}}()},c=function(e,t){t.x=Number(e[0]),t.y=Number(e[1]),t.z=Number(e[2])},d=(n=new THREE.Vector3,function(e,t){c(e,n),n.applyMatrix4(t),n.toArray(e)}),p=function(){var e=new THREE.Vector3,t=new THREE.Matrix3;return function(i,n){c(i,e),t.getNormalMatrix(n),e.applyMatrix3(t),e.normalize(),e.toArray(i)}}(),A=(s=new THREE.Vector3,o=new THREE.Vector3,r=new THREE.Vector3,function(e,t){c(e.eye,s),c(e.target,o),r.subVectors(s,o).normalize().multiplyScalar(e.orthographicHeight),s.copy(o).add(r),s.applyMatrix4(t),o.applyMatrix4(t),e.orthographicHeight=s.distanceTo(o)}),f=function(e,t){if(e&&t&&(e.viewport.isOrthographic&&e.viewport.orthographicHeight>0&&A(e.viewport,t),d(e.viewport.eye,t),d(e.viewport.target,t),d(e.viewport.pivotPoint,t),p(e.viewport.up,t),p(e.viewport.worldUpVector,t),e.cutplanes))for(var i=new THREE.Plane,n=new THREE.Vector3,s=0;s<e.cutplanes.length;s++){var o=e.cutplanes[s];c(o,n);var r=Number(o[3]);i.set(n,r),i.applyMatrix4(t),i.normal.toArray(o),o[3]=i.constant}},v={"issues-draft":"#819099","issues-draft-selected":"#819099","issues-draft-movable":"#819099","issues-open":"#ffba0c","issues-open-selected":"#ffba0c","issues-open-movable":"#ffba0c","issues-answered":"#087cd9","issues-answered-selected":"#087cd9","issues-answered-movable":"#087cd9","issues-closed":"#bcc9d1","issues-closed-selected":"#bcc9d1","issues-closed-movable":"#bcc9d1","rfis-draft":"#819099","rfis-draft-selected":"#819099","rfis-draft-movable":"#819099","rfis-submitted":"#7a77d9","rfis-submitted-selected":"#7a77d9","rfis-submitted-movable":"#7a77d9","rfis-open":"#ffba0c","rfis-open-selected":"#ffba0c","rfis-open-movable":"#ffba0c","rfis-answered":"#087cd9","rfis-answered-selected":"#087cd9","rfis-answered-movable":"#087cd9","rfis-rejected":"#ff495c","rfis-rejected-selected":"#ff495c","rfis-rejected-movable":"#ff495c","rfis-closed":"#bcc9d1","rfis-closed-selected":"#bcc9d1","rfis-closed-movable":"#bcc9d1","rfis-void":"#bcc9d1","rfis-void-selected":"#bcc9d1","rfis-void-movable":"#bcc9d1","quality_issues-draft":"#819099","quality_issues-draft-selected":"#819099","quality_issues-draft-movable":"#819099","quality_issues-not_approved":"#ff495c","quality_issues-not_approved-selected":"#ff495c","quality_issues-not_approved-movable":"#ff495c","quality_issues-open":"#ffba0c","quality_issues-open-selected":"#ffba0c","quality_issues-open-movable":"#ffba0c","quality_issues-ready_to_inspect":"#7a77d9","quality_issues-ready_to_inspect-selected":"#7a77d9","quality_issues-ready_to_inspect-movable":"#7a77d9","quality_issues-void":"#bcc9d1","quality_issues-void-selected":"#bcc9d1","quality_issues-void-movable":"#bcc9d1","quality_issues-work_completed":"#087cd9","quality_issues-work_completed-selected":"#087cd9","quality_issues-work_completed-movable":"#087cd9","quality_issues-in_dispute":"#ff495c","quality_issues-in_dispute-selected":"#ff495c","quality_issues-in_dispute-movable":"#ff495c","quality_issues-closed":"#bcc9d1","quality_issues-closed-selected":"#bcc9d1","quality_issues-closed-movable":"#bcc9d1","quality_issues-answered":"#087cd9","quality_issues-answered-selected":"#087cd9","quality_issues-answered-movable":"#087cd9"},m="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAABMCAYAAAAlS0pSAAAA4UlEQVR42u3bSw7DIAwFwNz/zhXddNVuoPWHlHkHCGKUgG0p1yVyTMYrJGDFQwFbhAIGKw8KGKw8KGCLUMBg5UEdDQYrGeo4sBEUWLC0O7BgwYIFCxYsWLBgwYL1r1jRm8nGasPP3Ew2VhlY1Waqnl96ntwdKxytagjXifXzOtUTy26sr9YbMoeGaAIMywIaDm+Yc2sbKKVDcr2lKP1c6KHd0Ugb0WwxojH8M1aGBUtgwYIFCxYsgQUL1iYofkeB1Q/mcwQFqw3MzQgrHkwlOglGCJZ2B9YdwIhMgpGAJfKWJ1qioD8mrIWXAAAAAElFTkSuQmCC)",y="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIxJREFUeNpi/P//PwMlgJGR0QBIfQCa84ASc5gYKAcTgDiBUkOo4RCqgFGHjDpk1CGjDhl1yKhDRoxDGIFYgcJqPAVK3yHXAGBbxoEF1KgBYgcKHPIHiEHmHKCgcaXASIUWWgPIIyBfjSbWUYeMOmTUIaMOGXXIqEOGVMOICs0AUMNKAGjOBUrMAQgwAFWiHzqojsmJAAAAAElFTkSuQmCC)16 16, auto",g=30,b=38;function E(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var P=AutodeskNamespace("Autodesk.BIM360.Extension.PushPin"),w=function(e){for(e=(e=e.replace(/-/g,"+")).replace(/_/g,"/");e.length%4;)e+="=";try{return atob(e)}catch(e){return null}},I=function(e){for(var t=e.split("/"),i=null,n=t.length-1;n>=0&&(!(i=w(t[n]))||-1==i.indexOf("file:"));n--)i=null;if(!i)return console.error("urn is not encoded correctly."),null;var s=i.indexOf("file:")+"file:".length,o=i.indexOf("?");return i.substring(s,o)},k=function(e,t){var i=e.getVisibleModels();if(!t)return 1===i.length?(console.error("Issue seedUrn does not exist. Assume pushpin belongs to viewer current main model"),i[0]):(console.error("Issue seedUrn does not exist."),null);for(var n=I(t),s=0;s<i.length;s++){var o=i[s],r=o.myData.urn;if(I(r)===n)return o}if(1===i.length)return console.error("Issue seedUrn does not match with any visible model urn. Assume pushpin belongs to viewer current main model"),i[0];console.error("Issue seedUrn does not match with any visible model urn.")},B=1,M=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.itemData={id:(B++).toString(),label:"New",status:"issues-open",position:{x:0,y:0,z:0},type:"issues",objectId:null,externalId:null,viewerState:null,objectData:null,locationIds:[],seedURN:null},this.selected=!1,this.isVisible=!0,this.draggable=!1,this.selectable=!0}var t,i,n;return t=e,(i=[{key:"defaultAppearance",value:function(){return{normalSize:40,selectedSize:60,draggableStatus:"-movable",selectedStatus:"-selected"}}},{key:"set",value:function(e){return this.itemData=Object.assign({},this.itemData,e),this.correctDataFormat(),this}},{key:"setLocal",value:function(e,t){this.set(e);var i=this.findModel(t);if(i){this.itemData.position=(new THREE.Vector3).copy(this.itemData.position);var n=i.myData.placementWithOffset;n&&this.itemData.position.applyMatrix4(n);var s=i.myData.placementTransform;this.itemData.viewerState=JSON.parse(JSON.stringify(this.itemData.viewerState)),s&&f(this.itemData.viewerState,s)}else console.error("PushPin coordinate conversion failed: PushPin must belong to a visible model.")}},{key:"getLocal",value:function(e){var t=this.findModel(e);if(t){var i=Object.assign({},this.itemData);i.position=(new THREE.Vector3).copy(this.itemData.position),i.viewerState=JSON.parse(JSON.stringify(this.itemData.viewerState));var n=t.myData.placementWithOffset,s=t.myData.placementTransform;if(n){var o=(new THREE.Matrix4).getInverse(n);i.position.applyMatrix4(o)}if(s){var r=(new THREE.Matrix4).getInverse(s);f(i.viewerState,r)}return i}console.error("PushPin coordinate conversion failed: PushPin must belong to a visible model.")}},{key:"setObjectId",value:function(e){this.itemData.objectId=e}},{key:"setObjectData",value:function(e){var t=e.model;if(t){var i=t.getData();if(i){var n=t.getDocumentNode();if(n){var s=n.data;s&&(this.itemData.objectData={guid:s.guid,urn:i.urn,viewableId:s.viewableID,viewName:s.name})}}}}},{key:"setExternalId",value:function(e){this.itemData.externalId=e}},{key:"setPosition",value:function(e){this.itemData.position=Object.assign({},e)}},{key:"hasPosition",value:function(){return null!==this.itemData.position.x&&null!==this.itemData.position.y&&null!==this.itemData.position.z}},{key:"findModel",value:function(e){var t=e.getVisibleModels();if(!this.itemData.viewerState&&1===t.length)return t[0];var i=this.getSeedUrn();return k(e,i)}},{key:"setViewerState",value:function(e){this.itemData.viewerState=Object.assign({},e),this.itemData.viewerState.attributesVersion=2}},{key:"setOriginalDocumentResolution",value:function(e){this.setViewerState({originalDocumentResolution:e})}},{key:"correctDataFormat",value:function(){var e=this;["draft","draft-selected","draft-movable","open","open-selected","open-movable","answered","answered-selected","answered-movable","closed","closed-selected","closed-movable"].forEach((function(t){e.itemData.status===t&&(e.itemData.status="".concat(e.itemData.type||"issues","-").concat(e.itemData.status))}))}},{key:"getAttributesVersion",value:function(){return this.itemData.attributesVersion||this.itemData.viewerState&&this.itemData.viewerState.attributesVersion}},{key:"setLocationIds",value:function(e){this.itemData.locationIds=e}},{key:"getSeedUrn",value:function(){var e,t;return this.itemData.seedURN||(null===(e=this.itemData.viewerState)||void 0===e?void 0:e.seedUrn)||(null===(t=this.itemData.viewerState)||void 0===t?void 0:t.seedURN)}},{key:"setSeedUrn",value:function(e){this.itemData.seedURN=e}},{key:"data",get:function(){return this.itemData}},{key:"visible",get:function(){return this.isVisible},set:function(e){this.hasPosition()?this.isVisible=e:this.isVisible=!1}}])&&E(t.prototype,i),n&&E(t,n),e}();function S(e,t){var i=Math.ceil(Math.log2(e)),n=Math.ceil(Math.log2(t));return Math.max(i,n)}function T(e,t,i){return e.model.isLeaflet()?function(e,t,i){var n,s;if(e.model.isPdf(!0))n=Autodesk.Viewing.PDFUtils.getLeafletLoadOptions(e),s=Autodesk.Viewing.PDFUtils.getLeafletBoundingBox(e);else{var o=e.model.getData();n=o.loadOptions.loadOptions,s=o.bbox}var r=n,a=r.texWidth,l=r.texHeight,u=e.clientToWorld(t,i,void 0,!0).point,h=new THREE.Vector3(s.min.x,s.max.y,0);u.sub(h);var c=u.x*a/s.size().x,d=u.y*l/s.size().y,p=new THREE.Vector3(c,d,0),A=S(a,l),f=Math.pow(2,A),v=p.x/f,m=p.y/f;return new THREE.Vector3(m,v,0)}(e,t,i):e.clientToWorld(t,i,void 0,!0).point}function x(e,t){if(e.model.isLeaflet()||e.model.isPdf(!0)){var i=t.viewerState&&t.viewerState.originalDocumentResolution,n=function(e,t,i){if(!e.model.isLeaflet()&&!e.model.isPdf(!0))return e.worldToClient(t);var n,s,o=t.y,r=t.x;if(e.model.isPdf(!0))n=Autodesk.Viewing.PDFUtils.getLeafletLoadOptions(e),s=Autodesk.Viewing.PDFUtils.getLeafletBoundingBox(e);else{var a=e.model.getData();n=a.loadOptions.loadOptions,s=a.bbox}var l=n,u=l.texWidth,h=l.texHeight,c=S(u,h),d=Math.pow(2,c);o*=d,r*=d;var p=i&&i[0]||u,A=u/p,f=o/(u/A)*s.size().x,v=r/(h/A)*s.size().y,m=new THREE.Vector3(s.min.x+f,s.max.y+v,0);e.model.isPdf(!0)&&Autodesk.Viewing.PDFUtils.leafletToPdfWorld(e,m);return e.impl.worldToClient(m)}(e,t.position,i);return e.clientToWorld(n.x,n.y,void 0,!0).point}return t.position}function N(e,t){var i=Autodesk.Viewing.PDFUtils.pdfToLeafletWorld(e,(new THREE.Vector3).copy(t.position));t.position={x:i.y-1,y:i.x,z:0}}function D(e,t){var i=null==t?void 0:t.getModelTransform();i&&e.applyMatrix4((new THREE.Matrix4).getInverse(i))}function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t,i){return(_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=F(e)););return e}(e,t);if(n){var s=Object.getOwnPropertyDescriptor(n,t);return s.get?s.get.call(i):s.value}})(e,t,i||e)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=F(e);if(t){var s=F(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return L(this,i)}}function L(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?U(e):t}function U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}P.PushPinItem=M;var j=AutodeskNamespace("Autodesk.BIM360.Extension.PushPin"),G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(o,Autodesk.Viewing.EventDispatcher);var t,i,n,s=O(o);function o(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(V(this,o),(t=s.call(this)).viewer=e,t.options=i,t.pushPinList=[],t.selectedItem=null,t.PushPinTypes={ISSUES:"issues",RFIS:"rfis",QUALITY_ISSUES:"quality_issues"},t.is2D=!!t.viewer.impl.is2d,!t.is2D){var n=t.viewer.model.getBoundingBox(),r=t.viewer.impl.worldUpName();t.isPseudo2D=n.max[r]-n.min[r]==0,t.options.disableOcclusionTest=t.options.disableOcclusionTest||t.isPseudo2D}return t.pushPinsVisibilityByType=t.getInitialPushpinVisibilityByType(),t.pushpinsByType=t.getInitialPushpinsByType(),t.create=Promise.resolve(),t.onPushpinEditStartBinded=t.onPushpinEditStart.bind(U(t)),t.onPushpinEditEndBinded=t.onPushpinEditEnd.bind(U(t)),t.addEventListener(a.PUSH_PIN_EDIT_START_EVENT,t.onPushpinEditStartBinded),t.addEventListener(a.PUSH_PIN_EDIT_END_EVENT,t.onPushpinEditEndBinded),t.addEventListener(a.PUSH_PIN_REMOVED_EVENT,t.onPushpinEditEndBinded),t}return t=o,(i=[{key:"items",value:function(){return this.pushPinList}},{key:"getInitialPushpinsByType",value:function(){var e=this,t={};return Object.keys(this.PushPinTypes).forEach((function(i){t[e.PushPinTypes[i]]={}})),t}},{key:"getInitialPushpinVisibilityByType",value:function(){var e=this,t={};return Object.keys(this.PushPinTypes).forEach((function(i){t[e.PushPinTypes[i]]=!0})),t}},{key:"shouldGenerateThumbnail",value:function(e){return this.options.generateIssueThumbnail&&(e.data.type===this.PushPinTypes.ISSUES||e.data.type===this.PushPinTypes.QUALITY_ISSUES)||this.options.generateRFIThumbnail&&e.data.type===this.PushPinTypes.RFIS}},{key:"generateThumbnail",value:function(e){var t=this;return this.shouldGenerateThumbnail(e)?new Promise((function(i,n){var s,o,r,l,u,h,c=e.data.position,d=c.x,p=c.y,A=c.z;t.viewer.model.isPdf(!0)&&N(t.viewer,e.data),t.fireEvent({type:a.PUSH_PIN_PREPARING_THUMBNAIL,value:e}),e.data.position={x:d,y:p,z:A},l=t.viewer.model.isLeaflet()?x(t.viewer,e.data):e.data.position;var f=t.viewer.impl.getCanvasBoundingClientRect();if(f.width/f.height>1?(o=Math.floor(Math.max(f.height,800)),r=o/f.height,s=Math.floor(f.width*r)):(s=Math.floor(Math.max(f.width,800)),r=s/f.width,o=Math.floor(f.height*r)),t.viewer.model.is2d()){var v=T(t.viewer,200,0),m=T(t.viewer,0,0),y=v.distanceTo(m);(h=(new THREE.Box3).expandByPoint(l)).expandByVector(new THREE.Vector3(y/2,y/2,0)),h.min.z=0,h.max.z=0}var g={bounds:h,getCropBounds:function(e,t){var i=u;i.x+400>s&&(i.x-=i.x+400-s),i.y+400>o&&(i.y-=i.y+400-o);var n=(new THREE.Box3).expandByPoint(i);return n.expandByVector(new THREE.Vector3(400,400,0)),n},overlayRenderer:function(e,t){var i=t.width,n=t.height,s=t.ctx,o=t.target,a=t.screenshotCamera,c=t.onRenderDone,d=s.targetToCanvas(o).canvas;u=h?{x:i/2,y:n/2}:e.worldToClient(l,a).multiplyScalar(r);var p=d.getContext("2d");p.fillStyle="#FF0000",p.beginPath(),p.arc(u.x,n-u.y,40,0,2*Math.PI),p.closePath(),p.fill(),c(d)}};Autodesk.Viewing.ScreenShot.getScreenShotWithBounds(t.viewer,s,o,(function(e,t,s){if(!e)return n("Error while preparing pushpin thumbnail.");Autodesk.Viewing.ScreenShot.blobToImage(e,t,s,(function(e){return i(e)}))}),g)})).catch((function(e){return console.error(e),null})):Promise.resolve(null)}},{key:"setItemLocationIds",value:function(e){var t;if(this.viewer.model.isLeaflet()){var i=x(this.viewer,e.data);t=this.viewer.model.isPageCoordinates()?i:Autodesk.Viewing.PDFUtils.leafletToPdfWorld(this.viewer,i)}else t=e.data.position;var n=this.getLocationIdsAtPoint(t);e.setLocationIds(n)}},{key:"createItem",value:function(e){var t=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if(this.getItemById(e.id))return null;var o=new M;return n?o.setLocal(e,s):o.set(e),this.addItem(o),i&&this.create(o).then((function(){return t.setItemLocationIds(o),t.generateThumbnail(o)})).then((function(e){var i=o.data.position,n=i.x,s=i.y,r=i.z;t.viewer.model.isPdf(!0)&&N(t.viewer,o.data),t.fireEvent({type:a.PUSH_PIN_CREATED_EVENT,value:o,thumbnail:e}),o.data.position={x:n,y:s,z:r}})),o}},{key:"addItems",value:function(e,t,i){var n=this;e.forEach((function(e){if(n.viewer.model.isPdf(!0)){var s=x(n.viewer,e),o=s.x,r=s.y,a=s.z;e.position={x:o,y:r,z:a}}n.createItem(e,!1,t,i)})),this.fireEvent({type:a.PUSH_PIN_ITEMS_LOADED,value:null})}},{key:"removeAllItems",value:function(){this.selectedItem=null,this.pushPinList=[],this.pushpinsByType=this.getInitialPushpinsByType(),this.fireEvent({type:a.PUSH_PIN_REMOVE_ALL_EVENT})}},{key:"addItem",value:function(e){if(e.data&&e.data.id){if(this.getItemIndexById(e.data.id)>-1)return!1;var t=e.data.type;return t&&this.pushPinsVisibilityByType&&(e.visible=this.pushPinsVisibilityByType[t]),t=t||this.PushPinTypes.ISSUES,this.pushpinsByType[t]&&(this.pushpinsByType[t][e.data.id]=e.data),this.pushPinList.unshift(e),!0}return!1}},{key:"removeItemById",value:function(e){this.selectedItem&&this.selectedItem.data.id===e&&(this.selectedItem=null);var t=this.getItemIndexById(e);if(t>-1){var i=this.pushPinList.splice(t,1)[0],n=i.data.type;return n&&this.pushpinsByType[n]&&delete this.pushpinsByType[n][e],this.fireEvent({type:a.PUSH_PIN_REMOVED_EVENT,value:i}),i}return null}},{key:"removeItemsByType",value:function(e){var t=this,i=this.pushpinsByType[e]||{};Object.keys(i).forEach((function(e){t.removeItemById(e)}))}},{key:"updateItemById",value:function(e,t){var i=this.getItemById(e);if(!i)return null;var n=this.getItemIndexById(i.data.id);if(!t||!t.id||t.type!==i.data.type)return null;if(this.viewer.model.isPdf(!0)){var s=x(this.viewer,t),o=s.x,r=s.y,l=s.z;t.position={x:o,y:r,z:l}}i.set(t);var u=i.data.type;return u&&this.pushpinsByType[u]&&(delete this.pushpinsByType[u][e],this.pushpinsByType[u][i.data.id]=i.data),this.pushPinList[n]=i,this.fireEvent({type:a.PUSH_PIN_UPDATE_EVENT,value:i}),i}},{key:"getItemById",value:function(e){var t=this.getItemIndexById(e);return t>-1?this.pushPinList[t]:null}},{key:"getItemIndexById",value:function(e){var t=-1;return this.pushPinList.every((function(i,n){return i.data.id!==e||(t=n,!1)})),t}},{key:"getItemCountByType",value:function(e){var t=this.pushpinsByType[e]||{};return Object.keys(t).length}},{key:"getSelectedItem",value:function(){return this.selectedItem}},{key:"selectOne",value:function(e){if(!this.selectedItem||this.selectedItem.data.id!==e){var t=this.selectedItem;this.selectedItem=this.getItemById(e),t!==this.selectedItem&&(t&&(t.selected=!1),this.selectedItem&&(this.selectedItem.selected=!0),this.fireEvent({type:a.PUSH_PIN_SELECTED_EVENT,value:this.selectedItem}))}return this.selectedItem}},{key:"selectNone",value:function(){this.selectOne(null)}},{key:"getVisibleByType",value:function(e){return this.pushPinsVisibilityByType[e]}},{key:"setVisibleByType",value:function(e,t){var i=this;this.pushPinsVisibilityByType[e]=t;var n=this.pushpinsByType[e]||{};Object.keys(n).forEach((function(e){var n=i.getItemById(e);n&&(n.visible=t)})),this.fireEvent({type:a.PUSH_PIN_VISIBILITY_EVENT,value:{type:e,isVisible:t}})}},{key:"addEventListener",value:function(e,t){this.hasEventListener(e,t)||_(F(o.prototype),"addEventListener",this).call(this,e,t)}},{key:"setCreateFunction",value:function(e){this.create=e}},{key:"removeCreateFunction",value:function(e){e===this.create&&(this.create=Promise.resolve())}},{key:"getLocationsExtension",value:function(){return this.viewer.getExtension("Autodesk.AEC.LocationsExtension")}},{key:"onPushpinEditStart",value:function(){var e=this.viewer.getExtension("Autodesk.Explode");e&&e.setUIEnabled(!1);var t=this.getLocationsExtension();t&&(this.options.showLocations&&t.showAllLocations(),this.selectedItem&&t.hoverLocationsByIds(this.selectedItem.data.locationIds),this.highlightPausedBackup=this.viewer.isHighlightPaused(),this.viewer.impl.pauseHighlight(!0))}},{key:"onPushpinEditEnd",value:function(){if(!this.selectedItem||!this.selectedItem.draggable){var e=this.viewer.getExtension("Autodesk.Explode");e&&e.setUIEnabled(!0);var t=this.getLocationsExtension();t&&(t.hideAllLocations(),this.viewer.impl.pauseHighlight(this.highlightPausedBackup))}}},{key:"getLocationIdsAtPoint",value:function(e){var t=this.getLocationsExtension();return t?t.getLocationIdsAtPoint(e):[]}},{key:"hoverLocations",value:function(e){var t=this.getLocationsExtension();t&&t.onMouseMove(e)}}])&&C(t.prototype,i),n&&C(t,n),o}();function z(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}j.PushPinManager=G;var Y=Autodesk.Viewing.getGlobal().document,Q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=Y.createElement("div"),this.container.className="leaflet-text-label",this.text="",this.dirty=!1}var t,i,n;return t=e,(i=[{key:"setParent",value:function(e){this.container.parentNode&&this.container.parentNode.removeChild(this.container),e&&e.appendChild(this.container)}},{key:"set",value:function(e){if(this.text!==e){this.container.innerHTML="<span>"+e+"</span>",this.text=e;var t=this.container.firstChild.clientWidth+20;t<60&&(t=60),this.container.style.width=t.toString()+"px";var i=10,n=0;0!==this.container.clientWidth&&(i+=this.container.parentNode.clientHeight,n=.5*(this.container.parentNode.clientWidth-this.container.clientWidth),i=i.toString()+"px",n=n.toString()+"px",this.container.style.top!==i&&(this.container.style.top=i),this.container.style.left!==n&&(this.container.style.left=n),this.dirty=!1)}}}])&&z(t.prototype,i),n&&z(t,n),e}();function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function X(e,t,i){return(X="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$(e)););return e}(e,t);if(n){var s=Object.getOwnPropertyDescriptor(n,t);return s.get?s.get.call(i):s.value}})(e,t,i||e)}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=$(e);if(t){var s=$(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return q(this,i)}}function q(e,t){return!t||"object"!==W(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}AutodeskNamespace("Autodesk.BIM360.Extension.PushPin").HTMLPushPinLabel=Q;var ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(o,e);var t,i,n,s=K(o);function o(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(i=s.call(this)).createLabel(e,t),i.visible=!0,i}return t=o,(i=[{key:"createLabel",value:function(e,t){X($(o.prototype),"setParent",this).call(this,e),this.update(t)}},{key:"update",value:function(e){X($(o.prototype),"set",this).call(this,e),this.container.style.top=o.TOP_PADDING,this.container.style.left=this.container.style.width/3+"px"}},{key:"show",value:function(){this.visible=!0,this.container.style.display="block"}},{key:"hide",value:function(){this.visible=!1,this.container.style.display="none"}},{key:"isVisible",get:function(){return this.visible},set:function(e){this.visible=e}}])&&J(t.prototype,i),n&&J(t,n),o}(Q);function te(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}ee.TOP_PADDING="50px",AutodeskNamespace("Autodesk.BIM360.Extension.PushPin").PushPinBillboardLabel=ee;var ie=Autodesk.Viewing,ne=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.names=["pushpinBillboard2D"],this.viewer=t,this.setGlobalManager(t.globalManager),this.active=!1,this.pushpins=[],this.selectedPushpin=null,this.dirty=!1,this.camera=this.viewer.navigation.getCamera(),this.curCameraZ=0,this.curCameraRotationZ=0,this.tmpVec=new THREE.Vector3,this.tmpMatrix=new THREE.Matrix4}var t,i,n;return t=e,(i=[{key:"getNames",value:function(){return this.names}},{key:"getName",value:function(){return this.names[0]}},{key:"isActive",value:function(){return this.active}},{key:"activate",value:function(e){var t=this;e===this.getName()&&(this.active=!0,this.onCameraChangeBinded=function(e){return t.onCameraChange(e)},this.handleResizeBinded=function(e){return t.handleResize(e)},this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.handleResizeBinded),this.createMarkerContainer())}},{key:"deactivate",value:function(e){e===this.getName()&&(this.active=!1,this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.handleResizeBinded))}},{key:"onCameraChange",value:function(e){e.camera.position.z.toPrecision(5)!==this.curCameraZ.toPrecision(5)||e.camera.rotation.z.toPrecision(5)!==this.curCameraRotationZ.toPrecision(5)?(this.updatePushpinsProjection(),this.curCameraZ=e.camera.position.z,this.curCameraRotationZ=e.camera.rotation.z):this.updateContainerProjection()}},{key:"createMarkerContainer",value:function(){this.pushpinContainer||(this.pushpinContainer=this.viewer.appendOrderedElementToViewer("pushpin-container"),this.pushpinContainer.className="pushpin-container",this.pushpinContainer.position=new THREE.Vector3)}},{key:"project",value:function(e){var t=e.marker.intersectPoint,i=this.viewer.navigation.getScreenViewport(),n=this.tmpVec.copy(t);return this.tmpMatrix.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),n.applyProjection(this.tmpMatrix),new THREE.Vector3(Math.round((n.x+1)/2*i.width),Math.round((1-n.y)/2*i.height),n.z)}},{key:"unproject",value:function(e){var t=this.viewer.navigation.getScreenViewport(),i=new THREE.Vector3;return i.x=e.x/t.width*2-1,i.y=-(e.y/t.height*2-1),i.z=e.z,i.unproject(this.camera),i}},{key:"initNewPushpin",value:function(e){if(this.viewer.model.isLeaflet()){this.convertLeafletPosition(e);var t=this.viewer.model.getData().loadOptions.loadOptions;e.setOriginalDocumentResolution([t.texWidth,t.texHeight])}else e.intersectPoint=e.data.position;this.pushpins.push(e),this.createMarker(e),e.draggable?this.enableDragging(e):this.disableDragging(e),e.visible?this.showMarker(e.marker):this.hideMarker(e.marker)}},{key:"createPushpin",value:function(e){return e.data.attributesVersion=2,this.initNewPushpin(e),this.selectPushpin(e),Promise.resolve()}},{key:"convertLeafletPosition",value:function(e){var t=x(this.viewer,e.data);e.intersectPoint={x:t.x,y:t.y,z:t.z}}},{key:"loadPushpin",value:function(e){return this.initNewPushpin(e),Promise.resolve()}},{key:"createMarker",value:function(e){var t=this.getDocument().createElement("div"),i="rfis"===e.data.type?"rfi-billboard-marker":"pushpin-billboard-marker";if(t.classList.add(i),t.style.backgroundColor=v[e.data.status],t.style.boxShadow="0px 1px 6px rgba(0, 0, 0, 0.6)",this.pushpinContainer.appendChild(t),t.id=e.data.id,t.intersectPoint=e.intersectPoint,e.marker=t,this.setMarkerPosition(e),1===this.pushpins.length)this.setPushpinContainerPosition(e);else{var n=e.marker.position.x-this.pushpinContainer.position.x,s=e.marker.position.y-this.pushpinContainer.position.y;e.marker.style.transform="translate(".concat(n,"px, ").concat(s,"px)")}}},{key:"removePushpin",value:function(e){var t=this;this.pushpins=this.pushpins.filter((function(i){return t.selectedPushpin&&t.selectedPushpin.data.id===e.data.id&&(t.selectedPushpin=null),i.data.id!==e.data.id})),this.destroyMarker(e)}},{key:"removeAll",value:function(){var e=this;this.pushpins.forEach((function(t){e.removePushpin(t)}))}},{key:"destroyMarker",value:function(e){this.destroyLabel(e),this.pushpinContainer.removeChild(e.marker),e.marker=void 0}},{key:"destroyLabel",value:function(e){e.label&&(e.marker.removeChild(e.label.container),e.label=void 0)}},{key:"setPushpinContainerPosition",value:function(e){var t=e.marker.position.x-g/2,i=e.marker.position.y-g/2;this.pushpinContainer.initPos=e.intersectPoint,this.pushpinContainer.position.x=e.marker.position.x,this.pushpinContainer.position.y=e.marker.position.y,this.pushpinContainer.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}},{key:"setMarkerPosition",value:function(e){e.marker.position=this.project(e)}},{key:"updateStyle",value:function(e,t,i){v[e]=i,this.dirty=!0}},{key:"updateContainerProjection",value:function(){var e=this;if(this.pushpins.length>0){var t={marker:{intersectPoint:this.pushpinContainer.initPos}},i=this.pushpinContainer.position=this.project(t),n=g,s=i.x-n/2,o=i.y-n/2;this.pushpinContainer.style.transform="translate(".concat(s,"px, ").concat(o,"px)")}this.pushpins.forEach((function(t){e.updatePushpin(t)})),this.dirty=!1}},{key:"updatePushpinsProjection",value:function(){var e=this;this.redraw=!0,this.pushpins.forEach((function(t){e.setMarkerPosition(t)})),this.pushpins.forEach((function(t){e.redraw&&(e.setPushpinContainerPosition(t),e.redraw=!1);var i=t.marker.position.x-e.pushpinContainer.position.x,n=t.marker.position.y-e.pushpinContainer.position.y;t.marker.style.transform="translate(".concat(i,"px, ").concat(n,"px)"),e.updatePushpin(t)})),this.dirty=!1}},{key:"updatePushpin",value:function(e){this.dirty&&(e.label&&e.label.update(e.data.label),e.draggable?this.enableDragging(e):this.disableDragging(e),e.marker.style.backgroundColor=v[e.data.status],e.visible?this.showMarker(e.marker):this.hideMarker(e.marker))}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"selectPushpin",value:function(e){this.deselect(),this.viewer.clearSelection(),e.label=new ee(e.marker,e.data.label),e.marker.classList.add("selected"),this.selectedPushpin=e,e.draggable?this.enableDragging(e):this.disableDragging(e)}},{key:"deselect",value:function(){this.selectedPushpin&&(this.destroyLabel(this.selectedPushpin),this.selectedPushpin.marker.style.pointerEvents="none",this.selectedPushpin.marker.classList.remove("selected"),this.selectedPushpin=null)}},{key:"enableDragging",value:function(e){this.selectedPushpin&&this.selectedPushpin.data.id===e.data.id&&(e.marker.style.pointerEvents="auto"),e.marker.style.backgroundImage=m}},{key:"disableDragging",value:function(e){var t=e||this.selectedPushpin;t.marker.style.pointerEvents="none",t.marker.style.backgroundImage="none",t.draggable=!1}},{key:"showMarker",value:function(e){e.style.display=""}},{key:"hideMarker",value:function(e){e.style.display="none"}},{key:"showMarkers",value:function(){var e=this;this.pushpins.forEach((function(t){t.visible?e.showMarker(t.marker):e.hideMarker(t.marker)}))}},{key:"hideMarkers",value:function(){var e=this;this.pushpins.forEach((function(t){e.hideMarker(t.marker)})),this.selectedPushpin&&this.destroyLabel(this.selectedPushpin)}},{key:"handleButtonDown",value:function(e,t){return!1}},{key:"handleButtonUp",value:function(e,t){return!1}},{key:"handleResize",value:function(){var e=this;setTimeout((function(){e.updatePushpinsProjection()}),1)}}])&&te(t.prototype,i),n&&te(t,n),e}();function se(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}ie.GlobalManagerMixin.call(ne.prototype),AutodeskNamespace("Autodesk.BIM360.Extension.PushPin").PushPinBillboardTool2D=ne;var oe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pushpin=null,this.pushpinRenderer=t,this.mousePosition={x:0,y:0},this.onTouchDragBinded=this.onTouchDrag.bind(this),this.onMouseMoveBinded=this.onMouseMove.bind(this),this.onMouseUpBinded=this.onMouseUp.bind(this),this.onMouseDownBinded=this.onMouseDown.bind(this),this.onHammerInputBinded=this.onHammerInput.bind(this),this.mouseEnabled=!1,this.mousePrevValue=!1,this.lock=!1}var t,i,n;return t=e,n=[{key:"convertEventHammerToMouse",value:function(e){e.shiftKey=!1,e.clientX=e.pointers[0].clientX,e.clientY=e.pointers[0].clientY}}],(i=[{key:"processMouseEvent",value:function(e){this.mousePosition.x=e.clientX,this.mousePosition.y=e.clientY}},{key:"attachTo",value:function(e){this.pushpin&&this.detach(),this.pushpin=e,Autodesk.Viewing.isTouchDevice()&&(this.hammer=new Autodesk.Viewing.Hammer.Manager(e,{recognizers:[Autodesk.Viewing.GestureRecognizers.drag],inputClass:Autodesk.Viewing.isIE11?Hammer.PointerEventInput:Hammer.TouchInput}),this.hammer.on("dragstart dragmove dragend",this.onTouchDragBinded),this.hammer.on("hammer.input",this.onHammerInputBinded)),Autodesk.Viewing.isMobileDevice()||this.enableMouseButtons(!0)}},{key:"onHammerInput",value:function(e){this.setMouseDisabledWhenTouching(e)}},{key:"setMouseDisabledWhenTouching",value:function(e){var t=this;e.isFirst&&!this.lock?(this.enableMouseButtons(!1),this.lock=!0):e.isFinal&&setTimeout((function(){t.enableMouseButtons(t.mousePrevValue),t.lock=!1}),10)}},{key:"enableMouseButtons",value:function(e){e&&!this.mouseEnabled?(this.pushpin.addEventListener("mousedown",this.onMouseDownBinded),this.pushpinRenderer.viewer.container.addEventListener("mousemove",this.onMouseMoveBinded),this.pushpinRenderer.viewer.container.addEventListener("mouseup",this.onMouseUpBinded)):!e&&this.mouseEnabled&&(this.pushpin.removeEventListener("mousedown",this.onMouseDownBinded),this.pushpinRenderer.viewer.container.removeEventListener("mousemove",this.onMouseMoveBinded),this.pushpinRenderer.viewer.container.removeEventListener("mouseup",this.onMouseUpBinded)),this.mousePrevValue=this.mouseEnabled,this.mouseEnabled=e}},{key:"detach",value:function(){this.hammer&&this.hammer.destroy(),this.pushpinRenderer.viewer.container.removeEventListener("mousemove",this.onMouseMoveBinded),this.pushpinRenderer.viewer.container.removeEventListener("mouseup",this.onMouseUpBinded),this.pushpin&&(this.pushpin.removeEventListener("mousedown",this.onMouseDownBinded),this.pushpin=null),this.mouseEnabled=!1}},{key:"onMouseMove",value:function(e){this.processMouseEvent(e),this.pushpinRenderer.handleMouseMove(e),e.preventDefault()}},{key:"onMouseDown",value:function(e){this.processMouseEvent(e),this.pushpinRenderer.handleMouseDown(e),e.preventDefault()}},{key:"onMouseUp",value:function(e){this.processMouseEvent(e),this.pushpinRenderer.handleMouseUp(e),e.preventDefault()}},{key:"onTouchDrag",value:function(t){switch(e.convertEventHammerToMouse(t),t.type){case"dragstart":this.onMouseDown(t);break;case"dragmove":this.onMouseMove(t);break;case"dragend":this.onMouseUp(t)}t.preventDefault()}}])&&se(t.prototype,i),n&&se(t,n),e}();function re(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}AutodeskNamespace("Autodesk.BIM360.Extension.PushPin").PushPinInputHandler=oe;var ae=Autodesk.Viewing,le=function(){function e(t,i){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t,this.setGlobalManager(this.viewer.globalManager),this.pushPinManager=i,this.pushpinDirty=!1,this.selectedItem=null,this.onSelectedChangedBind=function(e){return n.onSelectedChanged(e)},this.onRemoveBind=function(e){return n.onRemove(e)},this.onRemoveAllBind=function(e){return n.onRemoveAll(e)},this.onModifyBind=function(e){return n.onModify(e)},this.onUpdateBind=function(e){return n.onUpdate(e)},this.createBind=function(e){return n.create(e)},this.onVisibilityChangedBind=function(e){return n.onVisibilityChanged(e)}}var t,i,n;return t=e,(i=[{key:"register",value:function(){this.pushpinBillboardTool=new ne(this.viewer),this.viewer.toolController.registerTool(this.pushpinBillboardTool)}},{key:"deregister",value:function(){this.pushpinBillboardTool&&(this.viewer.toolController.deregisterTool(this.pushpinBillboardTool),this.pushpinBillboardTool=null)}},{key:"activate",value:function(){return this.pushpinBillboardTool.isActive()||this.viewer.toolController.activateTool("pushpinBillboard2D"),this.inputHandler=new oe(this),this.pushPinManager.addEventListener(a.PUSH_PIN_SELECTED_EVENT,this.onSelectedChangedBind),this.pushPinManager.addEventListener(a.PUSH_PIN_REMOVED_EVENT,this.onRemoveBind),this.pushPinManager.addEventListener(a.PUSH_PIN_REMOVE_ALL_EVENT,this.onRemoveAllBind),this.pushPinManager.addEventListener(a.PUSH_PIN_MODIFY_EVENT,this.onModifyBind),this.pushPinManager.addEventListener(a.PUSH_PIN_UPDATE_EVENT,this.onUpdateBind),this.pushPinManager.addEventListener(a.PUSH_PIN_VISIBILITY_EVENT,this.onVisibilityChangedBind),this.pushPinManager.setCreateFunction(this.createBind),!0}},{key:"deactivate",value:function(){this.pushpinBillboardTool.isActive()&&this.viewer.toolController.deactivateTool("pushpinBillboard2D"),this.inputHandler.detach(),this.pushPinManager.removeEventListener(a.PUSH_PIN_SELECTED_EVENT,this.onSelectedChangedBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_REMOVED_EVENT,this.onRemoveBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_REMOVE_ALL_EVENT,this.onRemoveAllBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_MODIFY_EVENT,this.onModifyBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_UPDATE_EVENT,this.onUpdateBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_VISIBILITY_EVENT,this.onVisibilityChangedBind),this.pushPinManager.removeCreateFunction(this.createBind)}},{key:"setPushpinDirty",value:function(){this.pushpinDirty=!0}},{key:"onSelectedChanged",value:function(e){e.value?(this.selectedItem=e.value,this.selectedItem.marker||this.create(this.selectedItem),this.pushpinBillboardTool.selectPushpin(this.selectedItem),this.focusCameraOnSelectedItem(this.selectedItem),this.selectedItem.draggable&&this.enableItemDragging(this.selectedItem),this.viewer.dispatchEvent({type:a.PUSH_PIN_SELECTED_EVENT})):(this.deselectItem(),this.pushpinBillboardTool.deselect()),this.setPushpinDirty()}},{key:"deselectItem",value:function(){this.selectedItem=null,this.inputHandler.detach()}},{key:"onRemove",value:function(e){this.selectedItem&&e.value.data.id===this.selectedItem.data.id&&this.deselectItem(),e.value&&e.value.marker&&this.pushpinBillboardTool.removePushpin(e.value)}},{key:"onRemoveAll",value:function(){this.deselectItem(),this.pushpinBillboardTool.removeAll()}},{key:"onModify",value:function(){this.pushpinDirty=!0}},{key:"onVisibilityChanged",value:function(){this.pushpinBillboardTool.showMarkers()}},{key:"onUpdate",value:function(){var e=this;setTimeout((function(){e.setPushpinDirty(),e.pushpinBillboardTool&&e.pushpinBillboardTool.setDirty();var t=e.pushPinManager?e.pushPinManager.getSelectedItem():null;t&&(t.draggable&&t.marker?e.enableItemDragging(t):e.disableItemDragging(t))}),1)}},{key:"enableItemDragging",value:function(e){this.pushpinBillboardTool.enableDragging(e),this.inputHandler.attachTo(e.marker)}},{key:"disableItemDragging",value:function(e){this.pushpinBillboardTool.disableDragging(e),this.inputHandler.detach()}},{key:"create",value:function(e){return this.createRenderItem(e,Autodesk.Viewing.isIOSDevice())}},{key:"createRenderItem",value:function(e,t){var i,n=e.data.id.length>20;return n||this.pushpinBillboardTool.deselect(),n&&!t?i=this.pushpinBillboardTool.loadPushpin(e):(i=this.pushpinBillboardTool.createPushpin(e),this.pushPinManager.selectOne(e.data.id)),i}},{key:"updatePattern",value:function(e,t,i){this.pushpinBillboardTool.updateStyle(e,t,i),this.setPushpinDirty()}},{key:"focusCameraOnSelectedItem",value:function(e){if(e.marker){var t=this.viewer.utilities.getBoundingBox(!0),i=.2*(t.max.x-t.min.x),n=.2*(t.max.y-t.min.y),s=new THREE.Vector3(e.marker.intersectPoint.x-i,e.marker.intersectPoint.y-n,0),o=new THREE.Vector3(e.marker.intersectPoint.x+i,e.marker.intersectPoint.y+n,0),r=new THREE.Box3(s,o);this.viewer.navigation.fitBounds(!1,r,!1)}}},{key:"render",value:function(){var e=this;this.pushPinManager&&this.viewer.model&&(this.pushPinManager.items().reverse().forEach((function(t){t.marker||e.createRenderItem(t,!1)})),this.pushpinDirty&&(this.pushpinBillboardTool.updateContainerProjection(),this.pushpinDirty=!1))}},{key:"findIntersections",value:function(e){var t=e.clientX,i=e.clientY,n=null;return this.pushPinManager.items().some((function(e){if(e.selectable&&e.marker){var s=e.marker.getBoundingClientRect();if(t>s.left&&t<s.left+s.width&&i>s.top&&i<s.top+s.height)return n=e,!0}return!1})),n}},{key:"handleMouseMove",value:function(e){var t=this;if(this.selectedItem.marker&&this.selectedItem.marker.startDragging){this.newX||(this.selectedItem.marker.style.transform="translate(0px, 0px)");var i=function(e){if(e.pageX||e.pageY)return{x:e.pageX,y:e.pageY};var i=t.getDocument();return{x:e.clientX+i.body.scrollLeft-i.body.clientLeft,y:e.clientY+i.body.scrollTop-i.body.clientTop}}(e);this.newX=i.x-this.mouseOffset.x,this.newY=i.y-this.mouseOffset.y;var n=this.viewer.navigation.getScreenViewport(),s=this.selectedItem.marker.clientWidth,o=this.selectedItem.marker.clientHeight;this.newX<5&&(this.newX=0),this.newY<5&&(this.newY=0),n.width-5<this.newX+s&&(this.newX=n.width-s),n.height-5<this.newY+o&&(this.newY=n.height-o);var r=this.pushpinBillboardTool.pushpinContainer.position.x,a=this.pushpinBillboardTool.pushpinContainer.position.y;this.selectedItem.marker.style.left="".concat(this.newX-r,"px"),this.selectedItem.marker.style.top="".concat(this.newY-a,"px"),this.selectedItem.marker.dragging=!0,this.pushPinManager.hoverLocations(event)}}},{key:"handleMouseUp",value:function(e){var t=this;if(this.selectedItem.marker)if(this.selectedItem.marker.dragging){var i=this.pushpinBillboardTool.pushpinContainer.position.x,n=this.pushpinBillboardTool.pushpinContainer.position.y;this.selectedItem.marker.style.transform="translate(".concat(this.newX-i,"px, ").concat(this.newY-n,"px)");var s=T(this.viewer,this.newX,this.newY);this.selectedItem.data.position={x:s.x,y:s.y,z:s.z},this.pushPinManager.setItemLocationIds(this.selectedItem),this.pushPinManager.generateThumbnail(this.selectedItem).then((function(e){var i=t.selectedItem.data.position,n=i.x,s=i.y,o=i.z;t.viewer.model.isPdf(!0)&&N(t.viewer,t.selectedItem.data),t.pushPinManager.fireEvent({type:a.PUSH_PIN_MODIFY_EVENT,value:t.selectedItem,thumbnail:e}),t.selectedItem.data.position={x:n,y:s,z:o}})),this.pushpinBillboardTool.removeAll(),this.render(),this.pushpinBillboardTool.selectPushpin(this.pushPinManager.selectedItem),this.selectedItem.draggable&&this.enableItemDragging(this.selectedItem)}else this.selectedItem.marker.startDragging=!1}},{key:"handleMouseDown",value:function(e){if(this.selectedItem.marker){if("textarea"===e.target.tagName.toLowerCase())return;this.mouseOffset=function(e){for(var t=0,i=0;e.offsetParent;)t+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;return{x:t+=e.offsetLeft,y:i+=e.offsetTop}}(this.viewer.container),this.newX=null,this.newY=null,this.selectedItem.marker.startDragging=!0}}}])&&re(t.prototype,i),n&&re(t,n),e}();function ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function he(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}ae.GlobalManagerMixin.call(le.prototype);var ce=Autodesk.Viewing,de=function(){function e(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ue(this,e),this.names=["pushpinBillboard3D"],this.viewer=t,this.setGlobalManager(t.globalManager),this.active=!1,this.pushpins=[],this.selectedPushpin=null,this.dirty=!1,this.camera=this.viewer.navigation.getCamera();var s=200;this.maxMsPerRayCastCycle=20,this.updateTimestamp=0,this.tmpVec=new THREE.Vector3,this.tmpMatrix=new THREE.Matrix4,this.tmpFrustum=new THREE.Frustum,n.disableOcclusionTest?this.raycastThrottle=function(){}:this.raycastThrottle=this.throttle((function(){i.continueRayCasts()}),s)}var t,i,n;return t=e,(i=[{key:"continueRayCasts",value:function(){for(var e=performance.now(),t=0;t<this.pushpins.length;t++){var i=this.pushpins[t];if(i.visible&&i.updateTimestamp!==this.updateTimestamp&&(i.updateTimestamp=this.updateTimestamp,this.castRay(i),performance.now()>e+this.maxMsPerRayCastCycle))break}t<this.pushpins.length&&this.raycastThrottle()}},{key:"getNames",value:function(){return this.names}},{key:"getName",value:function(){return this.names[0]}},{key:"isActive",value:function(){return this.active}},{key:"activate",value:function(e){var t=this;e===this.getName()&&(this.active=!0,this.onCameraChangeBinded=function(e){return t.onCameraChange(e)},this.handleResizeBinded=function(e){return t.handleResize(e)},this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),this.viewer.addEventListener(Autodesk.Viewing.MODEL_TRANSFORM_CHANGED_EVENT,this.onCameraChangeBinded),this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.handleResizeBinded))}},{key:"throttle",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,n=null,s=null,o=function(){n=null,e.apply(i,s)};return function(){n||(s=arguments,n=setTimeout(o,t))}}},{key:"deactivate",value:function(e){e===this.getName()&&(this.active=!1,this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),this.viewer.removeEventListener(Autodesk.Viewing.MODEL_TRANSFORM_CHANGED_EVENT,this.onCameraChangeBinded),this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.handleResizeBinded))}},{key:"onCameraChange",value:function(){this.updatePushpins()}},{key:"project",value:function(e){var t=e.marker.intersectPoint,i=this.viewer.navigation.getScreenViewport(),n=this.tmpVec.copy(t);return function(e,t){var i=null==t?void 0:t.getModelTransform();i&&e.applyMatrix4(i)}(n,e.findModel(this.viewer)),this.tmpMatrix.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),e.visible&&(this.tmpFrustum.setFromMatrix(this.tmpMatrix),this.tmpFrustum.containsPoint(n)?this.showMarker(e.marker):this.hideMarker(e.marker)),n.applyProjection(this.tmpMatrix),new THREE.Vector3(Math.round((n.x+1)/2*i.width),Math.round((1-n.y)/2*i.height),n.z)}},{key:"unproject",value:function(e){var t=this.viewer.navigation.getScreenViewport(),i=new THREE.Vector3;return i.x=e.x/t.width*2-1,i.y=-(e.y/t.height*2-1),i.z=e.z,i.unproject(this.camera),i}},{key:"initNewPushpin",value:function(e){e.intersectPoint=e.data.position,this.pushpins.push(e),this.createMarker(e),e.draggable?this.enableDragging(e):this.disableDragging(e),e.visible?this.showMarker(e.marker):this.hideMarker(e.marker)}},{key:"fetchExternalId",value:function(e,t,i){var n=this;return new Promise((function(s,o){e.getProperties2(t,(function(t){var o=t.externalId;if(o.startsWith("[")&&o.endsWith("]"))try{var r=JSON.parse(o);Array.isArray(r)&&(o=r[r.length-1])}catch(e){console.error("Error "+e+" parsing externalId ",o)}if("ifc"===e.getData().loadOptions.fileExt){var a=t.properties.find((function(e){return"IfcGUID"===e.displayName||"GLOBALID"===e.displayName&&"IFC"===e.displayCategory}));if(a)o=a.displayValue;else{var l=t.properties.find((function(e){return"parent"===e.displayName&&e.displayValue>-1}));if(l)return void s(n.fetchExternalId(e,l.displayValue,i))}}i(o),s()}),(function(e,t,i){Autodesk.Viewing.Private.logger.warn(t),s()}),{needsExternalId:!0})}))}},{key:"createPushpin",value:function(e){e.data.attributesVersion=2,this.initNewPushpin(e),e.setViewerState(function(e,t){var i=e.model?e.model.getData().globalOffset:null,n=e.getState(),s=JSON.parse(JSON.stringify(n));s.seedURN=t.getSeedUrn()||n.seedURN,i&&(l(s.viewport,i),u(s.cutplanes,i),s.globalOffset=i);var o=t.findModel(e),r=null==o?void 0:o.getModelTransform();return r&&f(s,(new THREE.Matrix4).getInverse(r)),s}(this.viewer,e)),this.selectPushpin(e);var t=this.viewer.impl.clientToViewport(e.marker.position.x,e.marker.position.y),i=this.viewer.impl.castRayViewport(t,!1);if(i){e.setObjectId(i.dbId),e.setObjectData(i);var n=e.findModel(this.viewer);return n?this.fetchExternalId(n,i.dbId,(function(t){return e.setExternalId(t)})):(console.error("Failed to assign externalId: The model for this PushPin is not loaded."),Promise.resolve())}return Promise.resolve()}},{key:"loadPushpin",value:function(e){return this.initNewPushpin(e),Promise.resolve()}},{key:"createMarker",value:function(e){var t=this.getDocument().createElement("div");if(e.marker=t,t.id=e.data.id,t.intersectPoint=e.intersectPoint,e.hasPosition()){var i="rfis"===e.data.type?"rfi-billboard-marker":"pushpin-billboard-marker";t.classList.add(i),t.style.backgroundColor=v[e.data.status],this.viewer.container.appendChild(t),this.setMarkerPosition(e);var n=e.marker.position.x-g/2,s=e.marker.position.y-g/2;e.marker.style.transform="translate(".concat(n,"px, ").concat(s,"px)")}else this.hideMarker(t),e.visible=!1}},{key:"removePushpin",value:function(e){var t=this;this.pushpins=this.pushpins.filter((function(i){return t.selectedPushpin&&t.selectedPushpin.data.id===e.data.id&&(t.selectedPushpin=null),i.data.id!==e.data.id})),this.destroyMarker(e)}},{key:"removeAll",value:function(){var e=this;this.pushpins.forEach((function(t){e.removePushpin(t)}))}},{key:"destroyMarker",value:function(e){this.destroyLabel(e),this.viewer.container.removeChild(e.marker),e.marker=void 0}},{key:"destroyLabel",value:function(e){e.label&&(e.marker.removeChild(e.label.container),e.label=void 0)}},{key:"setMarkerPosition",value:function(e){e.marker.position=this.project(e)}},{key:"updateStyle",value:function(e,t,i){v[e]=i,this.dirty=!0}},{key:"castRay",value:function(e){var t=parseInt(e.data.objectId,10);if(!isNaN(t)&&-1!==t){var i=this.viewer.impl.clientToViewport(e.marker.position.x,e.marker.position.y),n=this.viewer.impl.castRayViewport(i,!1);if(n&&n.dbId){if(e.data.externalId)return this.fetchExternalId(n.model,n.dbId,(function(t){e&&e.marker&&e.data&&(e.marker.style.opacity=t===e.data.externalId?"1.0":"0.15")}));e.data.objectId&&-1!==parseInt(e.data.objectId,10)&&(e.marker.style.opacity=n.dbId===parseInt(e.data.objectId,10)?"1.0":"0.15")}else e.marker.style.opacity="0.15"}}},{key:"updatePushpins",value:function(){var e=this;this.updateTimestamp++,this.raycastThrottle(),this.pushpins.forEach((function(t){e.setMarkerPosition(t)})),this.pushpins.forEach((function(t){var i=t.selected?b:g,n=t.marker.position.x-i/2,s=t.marker.position.y-i/2;t.marker.style.transform="translate(".concat(n,"px, ").concat(s,"px)"),e.dirty&&(t.label&&t.label.update(t.data.label),t.draggable?e.enableDragging(t):e.disableDragging(t),t.marker.style.backgroundColor=v[t.data.status],t.visible?e.showMarker(t.marker):e.hideMarker(t.marker))})),this.dirty=!1}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"selectPushpin",value:function(e){this.deselect(),this.viewer.clearSelection(),e.label=new ee(e.marker,e.data.label),e.marker.classList.add("selected"),this.selectedPushpin=e}},{key:"deselect",value:function(){this.selectedPushpin&&(this.destroyLabel(this.selectedPushpin),this.selectedPushpin.marker.style.pointerEvents="none",this.selectedPushpin.marker.classList.remove("selected"),this.selectedPushpin=null)}},{key:"enableDragging",value:function(e){this.selectedPushpin&&this.selectedPushpin.data.id===e.data.id&&(e.marker.style.pointerEvents="auto"),e.marker.style.backgroundImage=m}},{key:"disableDragging",value:function(e){var t=e||this.selectedPushpin;t.marker.style.pointerEvents="none",t.marker.style.backgroundImage="none",t.draggable=!1}},{key:"hideLabel",value:function(){this.selectedPushpin&&this.selectedPushpin.label.hide()}},{key:"showMarker",value:function(e){e.style.display=""}},{key:"hideMarker",value:function(e){e.style.display="none"}},{key:"showMarkers",value:function(){var e=this;this.pushpins.forEach((function(t){t.visible?e.project(t):e.hideMarker(t.marker)}))}},{key:"hideMarkers",value:function(){var e=this;this.pushpins.forEach((function(t){e.hideMarker(t.marker)})),this.selectedPushpin&&this.destroyLabel(this.selectedPushpin)}},{key:"handleButtonDown",value:function(e,t){return!1}},{key:"handleButtonUp",value:function(e,t){return!1}},{key:"handleResize",value:function(){this.updatePushpins()}}])&&he(t.prototype,i),n&&he(t,n),e}();function pe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}ce.GlobalManagerMixin.call(de.prototype),AutodeskNamespace("Autodesk.BIM360.Extension.PushPin").PushPinBillboardTool3D=de;var Ae=Autodesk.Viewing,fe=function(){function e(t,i){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t,this.setGlobalManager(this.viewer.globalManager),this.pushPinManager=i,this.pushpinDirty=!1,this.selectedItem=null,this.onSectionBind=function(e){return n.onSection(e)},this.onSelectedChangedBind=function(e){return n.onSelectedChanged(e)},this.onRemoveBind=function(e){return n.onRemove(e)},this.onRemoveAllBind=function(e){return n.onRemoveAll(e)},this.onModifyBind=function(e){return n.onModify(e)},this.onUpdateBind=function(e){return n.onUpdate(e)},this.createBind=function(e){return n.create(e)},this.onVisibilityChangedBind=function(e){return n.onVisibilityChanged(e)}}var t,i,n;return t=e,(i=[{key:"register",value:function(){this.pushpinBillboardTool=new de(this.viewer,this.pushPinManager.options),this.viewer.toolController.registerTool(this.pushpinBillboardTool)}},{key:"deregister",value:function(){this.pushpinBillboardTool&&(this.viewer.toolController.deregisterTool(this.pushpinBillboardTool),this.pushpinBillboardTool=null)}},{key:"activate",value:function(){return this.pushpinBillboardTool.isActive()||this.viewer.toolController.activateTool("pushpinBillboard3D"),this.inputHandler=new oe(this),this.viewer.addEventListener(Autodesk.Viewing.CUTPLANES_CHANGE_EVENT,this.onSectionBind),this.pushPinManager.addEventListener(a.PUSH_PIN_SELECTED_EVENT,this.onSelectedChangedBind),this.pushPinManager.addEventListener(a.PUSH_PIN_REMOVED_EVENT,this.onRemoveBind),this.pushPinManager.addEventListener(a.PUSH_PIN_REMOVE_ALL_EVENT,this.onRemoveAllBind),this.pushPinManager.addEventListener(a.PUSH_PIN_MODIFY_EVENT,this.onModifyBind),this.pushPinManager.addEventListener(a.PUSH_PIN_UPDATE_EVENT,this.onUpdateBind),this.pushPinManager.addEventListener(a.PUSH_PIN_VISIBILITY_EVENT,this.onVisibilityChangedBind),this.pushPinManager.setCreateFunction(this.createBind),!0}},{key:"deactivate",value:function(){this.pushpinBillboardTool.isActive()&&this.viewer.toolController.deactivateTool("pushpinBillboard3D"),this.inputHandler.detach(),this.viewer.removeEventListener(Autodesk.Viewing.CUTPLANES_CHANGE_EVENT,this.onSectionBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_SELECTED_EVENT,this.onSelectedChangedBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_REMOVED_EVENT,this.onRemoveBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_REMOVE_ALL_EVENT,this.onRemoveAllBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_MODIFY_EVENT,this.onModifyBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_UPDATE_EVENT,this.onUpdateBind),this.pushPinManager.removeEventListener(a.PUSH_PIN_VISIBILITY_EVENT,this.onVisibilityChangedBind),this.pushPinManager.removeCreateFunction(this.createBind)}},{key:"setPushpinDirty",value:function(){this.pushpinDirty=!0}},{key:"onSelectedChanged",value:function(e){if(e.value)this.selectedItem=e.value,this.selectedItem.marker||this.create(this.selectedItem),this.pushpinBillboardTool.selectPushpin(this.selectedItem),h(this.viewer,this.selectedItem),this.selectedItem.draggable&&this.enableItemDragging(this.selectedItem),this.viewer.dispatchEvent({type:a.PUSH_PIN_SELECTED_EVENT});else{this.deselectItem(),this.pushpinBillboardTool.deselect();var t=this.viewer.getExtension("Autodesk.Section");t&&1===t.getSectionPlanes().length?t.setSectionFromPlane(null):this.viewer.impl.setCutPlaneSet("__set_view",void 0)}this.setPushpinDirty()}},{key:"deselectItem",value:function(){this.selectedItem=null,this.inputHandler.detach()}},{key:"onRemove",value:function(e){this.selectedItem&&e.value.data.id===this.selectedItem.data.id&&this.deselectItem(),e.value&&e.value.marker&&this.pushpinBillboardTool.removePushpin(e.value)}},{key:"onRemoveAll",value:function(){this.deselectItem(),this.pushpinBillboardTool.removeAll()}},{key:"onModify",value:function(){this.pushpinDirty=!0}},{key:"onVisibilityChanged",value:function(){this.pushpinBillboardTool.showMarkers()}},{key:"onUpdate",value:function(){var e=this;setTimeout((function(){e.setPushpinDirty(),e.pushpinBillboardTool&&e.pushpinBillboardTool.setDirty();var t=e.pushPinManager?e.pushPinManager.getSelectedItem():null;t&&(t.draggable&&t.marker?e.enableItemDragging(t):e.disableItemDragging(t))}),1)}},{key:"enableItemDragging",value:function(e){this.pushpinBillboardTool.enableDragging(e),this.inputHandler.attachTo(e.marker)}},{key:"disableItemDragging",value:function(e){this.pushpinBillboardTool.disableDragging(e),this.inputHandler.detach()}},{key:"onSection",value:function(){}},{key:"create",value:function(e){return this.createRenderItem(e,Autodesk.Viewing.isIOSDevice())}},{key:"createRenderItem",value:function(e,t){var i,n=e.data.id.length>20;return n||this.pushpinBillboardTool.deselect(),n&&!t?i=this.pushpinBillboardTool.loadPushpin(e):(i=this.pushpinBillboardTool.createPushpin(e),this.pushPinManager.selectOne(e.data.id)),i}},{key:"updatePattern",value:function(e,t,i){this.pushpinBillboardTool.updateStyle(e,t,i),this.setPushpinDirty()}},{key:"render",value:function(){var e=this;this.pushPinManager&&this.viewer.model&&(this.pushPinManager.items().reverse().forEach((function(t){t.marker||e.createRenderItem(t,!1)})),this.pushpinDirty&&(this.pushpinBillboardTool.updatePushpins(),this.pushpinDirty=!1))}},{key:"findIntersections",value:function(e){var t=e.clientX,i=e.clientY,n=null;return this.pushPinManager.items().some((function(e){if(e.selectable&&e.marker){var s=e.marker.getBoundingClientRect();if(t>s.left&&t<s.left+s.width&&i>s.top&&i<s.top+s.height)return n=e,!0}return!1})),n}},{key:"handleMouseMove",value:function(e){var t=this;if(this.selectedItem.marker.startDragging){this.newX||(this.selectedItem.marker.style.transform="translate(0px, 0px)");var i=function(e){if(e.pageX||e.pageY)return{x:e.pageX,y:e.pageY};var i=t.getDocument();return{x:e.clientX+i.body.scrollLeft-i.body.clientLeft,y:e.clientY+i.body.scrollTop-i.body.clientTop}}(e);this.newX=i.x-this.mouseOffset.x,this.newY=i.y-this.mouseOffset.y;var n=this.viewer.navigation.getScreenViewport(),s=this.selectedItem.marker.clientWidth,o=this.selectedItem.marker.clientHeight;this.newX<5&&(this.newX=0),this.newY<5&&(this.newY=0),n.width-5<this.newX+s&&(this.newX=n.width-s),n.height-5<this.newY+o&&(this.newY=n.height-o),this.selectedItem.marker.style.left="".concat(this.newX,"px"),this.selectedItem.marker.style.top="".concat(this.newY,"px");var r=this.viewer.impl.clientToViewport(this.newX+this.offsetWidth/2,this.newY+this.offsetWidth/2);this.viewer.impl.castRayViewport(r,!1)||this.pushPinManager.isPseudo2D?this.selectedItem.marker.classList.remove("grey-out"):this.selectedItem.marker.classList.add("grey-out"),this.selectedItem.marker.dragging=!0}}},{key:"handleMouseUp",value:function(e){var t=this;if(this.selectedItem.marker.dragging){var i;this.selectedItem.marker.style.left="0px",this.selectedItem.marker.style.top="0px",this.selectedItem.marker.style.transform="translate(".concat(this.newX,"px, ").concat(this.newY,"px)"),this.newX+=this.offsetWidth/2,this.newY+=this.offsetWidth/2,(i=this.pushPinManager.isPseudo2D?{point:this.viewer.impl.intersectGround(this.newX,this.newY)}:this.viewer.impl.clientToWorld(this.newX,this.newY))&&(this.selectedItem.data.position=new THREE.Vector3(i.point.x,i.point.y,i.point.z),D(this.selectedItem.data.position,i.model),this.selectedItem.setSeedUrn(i.model.getSeedUrn())),this.pushpinBillboardTool.removePushpin(this.selectedItem);var n=this.createRenderItem(this.selectedItem,!0);i&&n.then((function(){return t.pushPinManager.generateThumbnail(t.selectedItem)})).then((function(e){t.pushPinManager.fireEvent({type:a.PUSH_PIN_MODIFY_EVENT,value:t.selectedItem,thumbnail:e})})),this.selectedItem.marker.startDragging=!1,this.selectedItem.marker.dragging=!1,this.onUpdate()}else this.selectedItem.marker.startDragging=!1}},{key:"handleMouseDown",value:function(e){"textarea"!==e.target.tagName.toLowerCase()&&(this.offsetWidth=this.selectedItem.selected?b:g,this.mouseOffset=function(e,t){var i=function(e){for(var t=0,i=0;e.offsetParent;)t+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;return{x:t+=e.offsetLeft,y:i+=e.offsetTop}}(e);return i.x+=t/2,i.y+=t/2,{x:i.x,y:i.y}}(this.viewer.container,this.offsetWidth),this.selectedItem.marker.style.opacity="1.0",this.newX=null,this.newY=null,this.selectedItem.marker.startDragging=!0)}}])&&pe(t.prototype,i),n&&pe(t,n),e}();function ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Ae.GlobalManagerMixin.call(fe.prototype);var ye=Autodesk.Viewing,ge=function(){function e(t,i){ve(this,e),this.setGlobalManager(t.globalManager),this.names=["pushpin"],this.priority=65,this.pushpinCursor=y,this.isActive=!1,this.pushPinInitData=null,this.viewer=t,this.pushPinManager=i,this.createMode=!1,this.testId="1111122222333334444455555",this.autoCreate=!1}var t,i,n;return t=e,n=[{key:"convertEventHammerToMouse",value:function(e){e.shiftKey=!1,e.clientX=e.pointers[0].clientX,e.clientY=e.pointers[0].clientY}}],(i=[{key:"getNames",value:function(){return this.names}},{key:"getName",value:function(){return this.names[0]}},{key:"getPriority",value:function(){return this.priority}},{key:"setAutoCreate",value:function(e){this.autoCreate=e}},{key:"getCursor",value:function(){return this.createMode?this.pushpinCursor:this.isHover?"pointer":null}},{key:"register",value:function(){this.renderTool||(this.pushPinManager.is2D?this.renderTool=new le(this.viewer,this.pushPinManager):this.renderTool=new fe(this.viewer,this.pushPinManager),this.renderTool.register())}},{key:"deregister",value:function(){this.renderTool&&(this.renderTool.deregister(),this.renderTool=null)}},{key:"activate",value:function(e,t){e===this.getName()&&(this.renderTool.activate(),this.isActive=!0)}},{key:"deactivate",value:function(e){e===this.getName()&&(this.show(!1),this.isActive=!1)}},{key:"update",value:function(){return this.isActive&&this.duringShowing&&this.renderTool&&this.renderTool.render(),!1}},{key:"show",value:function(e){this.duringShowing=e}},{key:"enablePushPinSelect",value:function(e){this.pushPinManager.items().forEach((function(t){t.selectable=e}))}},{key:"startCreateItem",value:function(e){if(this.isActive){var t=this.viewer.toolController;t&&t.getActiveToolName()!==this.getName()&&(t.deactivateTool(this.getName()),t.activateTool(this.getName())),this.duringShowing||this.show(!0),this.pushPinInitData=e,this.createMode=!0,this.enablePushPinSelect(!1)}this.viewer.dispatchEvent({type:a.PUSH_PIN_SELECTED_EVENT})}},{key:"endCreateItem",value:function(){this.pushPinInitData=null,this.createMode&&(this.createMode=!1,this.enablePushPinSelect(!0))}},{key:"createThreePushPin",value:function(e){var t,i,n=null,s=e.canvasX,o=e.canvasY;return(t=this.pushPinManager.isPseudo2D?{point:this.viewer.impl.intersectGround(s,o)}:this.viewer.impl.clientToWorld(s,o))&&this.pushPinInitData&&(this.pushPinInitData.position=new THREE.Vector3(t.point.x,t.point.y,t.point.z),D(this.pushPinInitData.position,t.model),this.pushPinInitData.seedURN=null===(i=t.model)||void 0===i?void 0:i.getSeedUrn(),n=this.pushPinManager.createItem(this.pushPinInitData),this.pushPinInitData=null),n}},{key:"createTwoPushPin",value:function(e){var t=null,i=e.canvasX,n=e.canvasY,s=T(this.viewer,i,n);return s&&this.pushPinInitData&&(this.pushPinInitData.position={x:s.x,y:s.y,z:s.z},t=this.pushPinManager.createItem(this.pushPinInitData),this.pushPinInitData=null),t}},{key:"createPushPin",value:function(e){return this.autoCreate&&!this.pushPinInitData&&(this.pushPinInitData={id:this.testId+"1",status:"issues-open",type:"issues"}),!!this.pushPinInitData&&(this.pushPinManager.is2D?this.createTwoPushPin(e):this.createThreePushPin(e))}},{key:"handleSingleTap",value:function(t){return e.convertEventHammerToMouse(t),this.handleSingleClick(t,0)}},{key:"triggerPushpinClick",value:function(e){this.pushPinManager.selectOne(e.data.id),this.pushPinManager.fireEvent({type:a.PUSH_PIN_CLICKED_EVENT,value:this.pushPinManager.getSelectedItem()})}},{key:"checkPushpinClick",value:function(e){return this.renderTool.findIntersections(e)}},{key:"handleSingleClick",value:function(e,t){var i=this.checkPushpinClick(e),n=!1;if(this.createMode||(i?(this.triggerPushpinClick(i),n=!0):this.pushPinManager.selectedItem&&(this.pushPinManager.selectNone(),this.pushPinManager.fireEvent({type:a.PUSH_PIN_SELECT_NONE,value:null}))),this.isActive&&0===t){if(!i)return this.createPushPin(e);n||this.triggerPushpinClick(i)}if(i){var s=this;this.addDocumentEventListener("click",(function e(t){t.stopPropagation(),s.removeDocumentEventListener("click",e,!0)}),!0)}return!!i}},{key:"handleMouseMove",value:function(e){var t=this.checkPushpinClick(e);return this.isHover=!!t,this.pushPinManager.selectedItem&&this.pushPinManager.selectedItem.draggable||this.pushPinManager.hoverLocations(e),!1}}])&&me(t.prototype,i),n&&me(t,n),e}();function be(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}ye.GlobalManagerMixin.call(ge.prototype),AutodeskNamespace("Autodesk.BIM360.Extension.PushPin").PushPinTool=ge;var Ee=Autodesk.Viewing,Pe=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t,this.setGlobalManager(t.globalManager),this.extension=i,this.pushpinVisBtn=null,this.initiallyHidePushpins=n,this.setButtonConstants()}var t,i,n;return t=e,(i=[{key:"setButtonConstants",value:function(){this.buttonConstants={btnClass:"",btnLabel:"",noPushpinLabel:"",hidePushpinLabel:"",showPushpinLabel:"",pushpinNormalIcon:"",pushpinHideIcon:""},this.type=""}},{key:"createButton",value:function(){var e=new Autodesk.Viewing.UI.Button(this.buttonConstants.btnClass);return e.setGlobalManager(this.globalManager),e.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.btnLabel)),e.setIcon(this.buttonConstants.pushpinNormalIcon),e.onClick=function(){var t=e.getState();t!==Autodesk.Viewing.UI.Button.State.DISABLED&&e.setState(t===Autodesk.Viewing.UI.Button.State.INACTIVE?Autodesk.Viewing.UI.Button.State.ACTIVE:Autodesk.Viewing.UI.Button.State.INACTIVE)},e}},{key:"onPushpinVisBtnStateChange",value:function(e){if(e.state!==Autodesk.Viewing.UI.Button.State.DISABLED){var t=e.state===Autodesk.Viewing.UI.Button.State.ACTIVE&&!this.initiallyHidePushpins;this.initiallyHidePushpins&&(this.pushpinVisBtn.setState(Autodesk.Viewing.UI.Button.State.INACTIVE),this.initiallyHidePushpins=!1),t?(this.extension.tool.show(!0),this.extension.showByType(this.type),this.pushpinVisBtn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.hidePushpinLabel)),this.pushpinVisBtn.setIcon(this.buttonConstants.pushpinNormalIcon)):(this.extension.hideByType(this.type),this.pushpinVisBtn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.showPushpinLabel)),this.pushpinVisBtn.setIcon(this.buttonConstants.pushpinHideIcon))}else this.pushpinVisBtn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.noPushpinLabel))}},{key:"addButton",value:function(){var e=this;if(!this.pushpinVisBtn&&this.viewer.getToolbar){var t=this.viewer.getToolbar();if(t){var i=t.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID);if(!i){var n=t.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID),s={};s.index=n?t.indexOf(n)+1:0,(i=new Autodesk.Viewing.UI.ControlGroup(Autodesk.Viewing.TOOLBAR.MODELTOOLSID)).setGlobalManager(this.globalManager),t.addControl(i,s)}this.pushpinVisBtn=this.createButton(),this.pushpinVisBtn.addEventListener(Autodesk.Viewing.UI.Button.Event.STATE_CHANGED,(function(t){e.onPushpinVisBtnStateChange(t)})),this.updateButtonStatus(),i.addControl(this.pushpinVisBtn),this.extension.pushPinManager.addEventListener(a.PUSH_PIN_REMOVED_EVENT,(function(){e.updateButtonStatus()})),this.extension.pushPinManager.addEventListener(a.PUSH_PIN_REMOVE_ALL_EVENT,(function(){e.updateButtonStatus()})),this.extension.pushPinManager.addEventListener(a.PUSH_PIN_CREATED_EVENT,(function(){e.updateButtonStatus()})),this.extension.pushPinManager.addEventListener(a.PUSH_PIN_ITEMS_LOADED,(function(){e.updateButtonStatus()})),this.extension.pushPinManager.addEventListener(a.PUSH_PIN_PREPARING_THUMBNAIL,(function(){e.updateButtonStatus()})),this.extension.pushPinManager.addEventListener(a.PUSH_PIN_ITEMS_LOADED,(function(){e.updateButtonStatus()}))}}}},{key:"updateButtonStatus",value:function(){if(this.pushpinVisBtn)if(this.extension.tool.createMode)this.pushpinVisBtn.getState()!==Autodesk.Viewing.UI.Button.State.DISABLED&&this.pushpinVisBtn.setState(Autodesk.Viewing.UI.Button.State.DISABLED);else{var e=this.extension.pushPinManager.getItemCountByType(this.type),t=this.pushpinVisBtn.getState()===Autodesk.Viewing.UI.Button.State.DISABLED;e>0&&t?this.pushpinVisBtn.setState(Autodesk.Viewing.UI.Button.State.ACTIVE):0!==e||t||this.pushpinVisBtn.setState(Autodesk.Viewing.UI.Button.State.DISABLED)}}},{key:"destroyButton",value:function(){this.pushpinVisBtn&&(this.extension.pushPinManager.removeEventListener(a.PUSH_PIN_REMOVED_EVENT,this.updateButtonStatus),this.extension.pushPinManager.removeEventListener(a.PUSH_PIN_REMOVE_ALL_EVENT,this.updateButtonStatus),this.extension.pushPinManager.removeEventListener(a.PUSH_PIN_CREATED_EVENT,this.updateButtonStatus),this.viewer.getToolbar()&&this.pushpinVisBtn.removeFromParent(),this.pushpinVisBtn.removeEventListener(Autodesk.Viewing.UI.Button.Event.STATE_CHANGED,this.onPushpinVisBtnStateChange),this.pushpinVisBtn=null)}},{key:"pushPinButton",get:function(){return this.pushpinVisBtn}}])&&be(t.prototype,i),n&&be(t,n),e}();function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Se(e);if(t){var s=Se(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return Me(this,i)}}function Me(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Ee.GlobalManagerMixin.call(Pe.prototype);var Te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(o,e);var t,i,n,s=Be(o);function o(e,t,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=s.call(this,e,t,i)).viewer=e,n.extension=t,n.pushpinVisBtn=null,n.setButtonConstants(),n}return t=o,(i=[{key:"setButtonConstants",value:function(){this.buttonConstants={btnClass:"toolbar-pushpinVis",btnLabel:"Show all pushpins",noPushpinLabel:"No issue in current doc",hidePushpinLabel:"Hide all issues",showPushpinLabel:"Show all issues",pushpinNormalIcon:"issueicon-issue_normal",pushpinHideIcon:"issueicon-issue_hide"},this.type=this.extension.pushPinManager.PushPinTypes.ISSUES}}])&&Ie(t.prototype,i),n&&Ie(t,n),o}(Pe);function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function De(e,t){return(De=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ce(e);if(t){var s=Ce(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return Ve(this,i)}}function Ve(e,t){return!t||"object"!==xe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&De(e,t)}(o,e);var t,i,n,s=Re(o);function o(e,t,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=s.call(this,e,t,i)).viewer=e,n.extension=t,n.pushpinVisBtn=null,n.setButtonConstants(),n}return t=o,(i=[{key:"setButtonConstants",value:function(){this.buttonConstants={btnClass:"toolbar-pushpinRfisVis",btnLabel:"Show all rfis",noPushpinLabel:"No RFI in current doc",hidePushpinLabel:"Hide all RFIs",showPushpinLabel:"Show all RFIs",pushpinNormalIcon:"rfiicon-rfi_normal",pushpinHideIcon:"rfiicon-rfi_hide"},this.type=this.extension.pushPinManager.PushPinTypes.RFIS}}])&&Ne(t.prototype,i),n&&Ne(t,n),o}(Pe);function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=je(e);if(t){var s=je(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return Fe(this,i)}}function Fe(e,t){return!t||"object"!==He(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(o,e);var t,i,n,s=Ue(o);function o(e,t,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=s.call(this,e,t,i)).viewer=e,n.extension=t,n.pushpinVisBtn=null,n.setButtonConstants(),n}return t=o,(i=[{key:"setButtonConstants",value:function(){this.buttonConstants={btnClass:"toolbar-pushpinFieldIssuesVis",btnLabel:"Show all field pushpins",noPushpinLabel:"No field issue in current doc",hidePushpinLabel:"Hide all field issues",showPushpinLabel:"Show all field issues",pushpinNormalIcon:"fieldissueicon-issue_normal",pushpinHideIcon:"fieldissueicon-issue_hide"},this.type=this.extension.pushPinManager.PushPinTypes.QUALITY_ISSUES}}])&&Oe(t.prototype,i),n&&Oe(t,n),o}(Pe);function ze(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ye=Autodesk.Viewing.getGlobal(),Qe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pushpinExtension=t,this.addListeners()}var t,i,n;return t=e,n=[{key:"postMessage",value:function(e,t){var i=t.value,n=t.thumbnail||"",s={};i&&(s={id:i.data.id,label:i.data.label,status:i.data.status,position:{x:i.data.position.x,y:i.data.position.y,z:i.data.position.z},type:i.data.type,objectId:i.data.objectId,externalId:i.data.externalId,viewerState:i.data.viewerState,attributesVersion:i.getAttributesVersion(),locationIds:i.data.locationIds||[]}),void 0!==Ye.webkit?Ye.webkit.messageHandlers.callbackHandler.postMessage({command:e,data:{metadata:s,thumbnail:n}}):Ye.JSINTERFACE&&(i?Ye.JSINTERFACE[e](s.id,s.type,s.label,s.status,s.position.x,s.position.y,s.position.z,s.objectId,JSON.stringify(s.viewerState),s.externalId,s.attributesVersion,JSON.stringify(s.locationIds),n):Ye.JSINTERFACE[e]())}}],(i=[{key:"addListeners",value:function(){this.pushpinExtension&&(this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_CREATED_EVENT,(function(t){e.postMessage("onPushPinCreated",t)})),this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_PREPARING_THUMBNAIL,(function(t){e.postMessage("onPushPinPreparingThumbnail",t)})),this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_CLICKED_EVENT,(function(t){e.postMessage("onPushPinActived",t)})),this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_MODIFY_EVENT,(function(t){e.postMessage("onPushPinMoved",t)})),this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_SELECT_NONE,(function(t){e.postMessage("onPushPinSelectNone",t)})),this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_UPDATE_EVENT,(function(t){e.postMessage("onPushPinUpdated",t)})),this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_ITEMS_LOADED,(function(t){e.postMessage("onPushPinItemsLoaded",t)})),e.postMessage("onPushPinToolLoaded",{}))}}])&&ze(t.prototype,i),n&&ze(t,n),e}(),We=function(e,t){if(function(e){var t=e&&e.myData.metadata["world bounding box"],i=new THREE.Box3;return i.min.fromArray(t.minXYZ),i.max.fromArray(t.maxXYZ),i}(e).distanceToPoint(t.position)*e.getUnitScale()<100)return!1;var i=e.getBoundingBox(),n=(new THREE.Vector3).copy(t.position);return t.viewerState&&t.viewerState.globalOffset&&n.sub(t.viewerState.globalOffset),i.containsPoint(n)},Je=function(e,t){if(e.viewerState){var i=k(t,e.viewerState.seedUrn);i&&We(i,e)&&function(e,t){var i=e.myData.placementTransform,n=i&&(new THREE.Matrix4).getInverse(i);i&&t.viewerState&&(t.position=(new THREE.Vector3).copy(t.position).applyMatrix4(n),t.viewerState=JSON.parse(JSON.stringify(t.viewerState)),f(t.viewerState,n))}(i,e)}},Xe={en:i(153),cs:i(154),de:i(155),es:i(156),fr:i(157),"fr-CA":i(158),it:i(159),ja:i(160),ko:i(161),pl:i(162),"pt-BR":i(163),ru:i(164),tr:i(165),"zh-HANS":i(166),"zh-HANT":i(167),nl:i(168),sv:i(169),da:i(170),no:i(171)};i(346);function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $e(e,t){return($e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=it(e);if(t){var s=it(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return tt(this,i)}}function tt(e,t){return!t||"object"!==Ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function it(e){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nt=AutodeskNamespace("Autodesk.BIM360.Extension.PushPin"),st=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$e(e,t)}(o,Autodesk.Viewing.Extension);var t,i,n,s=et(o);function o(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ke(this,o),(t=s.call(this,e,i)).viewer=e,t.options=i,t}return t=o,(i=[{key:"load",value:function(){return!!this.viewer.model&&(this.extendLocalization(Xe),this.pushPinManager=new G(this.viewer,this.options),this.tool=new ge(this.viewer,this.pushPinManager,this.options),this.pushpinsByType=this.pushPinManager.getInitialPushpinsByType(),Autodesk.Viewing.isMobileDevice()&&(this.observer=new Qe(this)),!!this.viewer.toolController&&(this.viewer.toolController.registerTool(this.tool),this.viewer.toolController.activateTool(this.tool.getName()),this.createUI(),!0))}},{key:"unload",value:function(){return this.destroyUI(),this.pushPinManager&&(this.pushPinManager.selectNone(),this.pushPinManager.removeAllItems(),this.pushPinManager=null),this.tool&&(this.viewer.toolController.deregisterTool(this.tool),this.tool=null),!0}},{key:"startCreateItem",value:function(e){this.tool.startCreateItem(e),this.updateButtonsStatus(),this.pushPinManager.fireEvent({type:a.PUSH_PIN_EDIT_START_EVENT})}},{key:"endCreateItem",value:function(){this.tool.endCreateItem(),this.updateButtonsStatus(),this.pushPinManager.fireEvent({type:a.PUSH_PIN_EDIT_END_EVENT})}},{key:"showAll",value:function(){for(var e in this.pushPinManager.PushPinTypes)this.showByType(this.pushPinManager.PushPinTypes[e])}},{key:"hideAll",value:function(){for(var e in this.pushPinManager.PushPinTypes)this.hideByType(this.pushPinManager.PushPinTypes[e])}},{key:"enableItemSelect",value:function(e){this.tool.enablePushPinSelect(e)}},{key:"updatePattern",value:function(e,t,i){this.tool.renderTool.updatePattern(e,t,i)}},{key:"loadItems",value:function(e){this.viewer.model.is3d()&&console.warn("loadItems is deprecated for 3D models. Use loadItemsV2 instead."),this.tool.show(!0),this.pushPinManager.addItems(e)}},{key:"loadItemFromLocal",value:function(e){this.pushPinManager.addItems([e],!0,this.viewer)}},{key:"loadItemsV2",value:function(e){var t=this;Array.isArray(e)||(e=[e]),this.tool.show(!0),e.forEach((function(e){t.viewer.model.is3d()?(t.legacyToLocalPushPinData(e),t.loadItemFromLocal(e)):t.pushPinManager.addItems([e])}))}},{key:"updateItemById",value:function(e,t){return this.pushPinManager.updateItemById(e,t)}},{key:"getItemById",value:function(e){var t=this.pushPinManager.getItemById(e);return t?t.data:null}},{key:"setDraggableById",value:function(e,t,i){var n=this.pushPinManager.getItemById(e);n&&(i&&n.setPosition(this.origItemPosition),n.draggable=t,this.pushPinManager.fireEvent({type:a.PUSH_PIN_UPDATE_EVENT,value:n}),this.origItemPosition=Object.assign({},n.data.position),t?this.pushPinManager.fireEvent({type:a.PUSH_PIN_EDIT_START_EVENT}):this.pushPinManager.fireEvent({type:a.PUSH_PIN_EDIT_END_EVENT}))}},{key:"setVisibleById",value:function(e,t){var i=this.pushPinManager.getItemById(e);i&&(i.visible=t,this.pushPinManager.fireEvent({type:a.PUSH_PIN_UPDATE_EVENT,value:i}))}},{key:"selectOne",value:function(e){this.pushPinManager&&this.pushPinManager.selectOne(e)}},{key:"selectNone",value:function(){this.pushPinManager&&this.pushPinManager.selectNone()}},{key:"removeItemById",value:function(e){this.pushPinManager.getItemById(e)&&this.pushPinManager.removeItemById(e)}},{key:"removeItemsByType",value:function(e){this.pushPinManager.removeItemsByType(e)}},{key:"removeAllItems",value:function(){this.pushPinManager&&this.pushPinManager.removeAllItems()}},{key:"addEventListener",value:function(e,t){this.pushPinManager&&this.pushPinManager.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.pushPinManager&&this.pushPinManager.removeEventListener(e,t)}},{key:"hasEventListener",value:function(e,t){this.pushPinManager&&this.pushPinManager.hasEventListener(e,t)}},{key:"createUI",value:function(){if(this.uiButtons=[],this.options.hideIssuesButton||this.uiButtons.push(new Te(this.viewer,this,this.options.initiallyHideIssuesPushpins)),this.options.hideFieldIssuesButton||this.uiButtons.push(new Ge(this.viewer,this,this.options.initiallyHideFieldIssuesPushpins)),this.options.hideRfisButton||this.uiButtons.push(new _e(this.viewer,this,this.options.initiallyHideRfisPushpins)),this.viewer.model)this.uiButtons.forEach((function(e){e.addButton()}));else{var e=this;this.viewer.addEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,(function t(){e.viewer.model&&e.uiButtons.forEach((function(e){e.addButton()})),e.viewer.removeEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,t)}))}}},{key:"destroyUI",value:function(){this.uiButtons.forEach((function(e){e.destroyButton()}))}},{key:"updateButtonsStatus",value:function(){this.uiButtons.forEach((function(e){e.updateButtonStatus()}))}},{key:"hideByType",value:function(e){this.pushPinManager&&this.pushPinManager.setVisibleByType(e,!1)}},{key:"showByType",value:function(e){this.pushPinManager&&this.pushPinManager.setVisibleByType(e,!0)}},{key:"legacyToLocalPushPinData",value:function(e){!function(e,t){var i=e.viewerState&&e.viewerState.globalOffset;i||(i=t.model&&t.model.myData.globalOffset),i&&(e.position.x+=i.x,e.position.y+=i.y,e.position.z+=i.z)}(e,this.viewer),this.options.useLegacyFallback&&Je(e,this.viewer)}},{key:"getLegacyPushPinData",value:function(e){return function(e,t){if(!t.model||!t.model.is3d())return e.data;var i=e.getLocal(t),n=e.findModel(t);return n?(function(e,t){e.viewerState&&(e.viewerState.globalOffset=function(e){var t=e&&e.myData.metadata["world bounding box"],i=t.minXYZ,n=t.maxXYZ;return{x:.5*(i[0]+n[0]),y:.5*(i[1]+n[1]),z:.5*(i[2]+n[2])}}(t),e.position.x-=e.viewerState.globalOffset.x,e.position.y-=e.viewerState.globalOffset.y,e.position.z-=e.viewerState.globalOffset.z)}(i,n),i):(console.error("Saving issue attributes failed: Issue must be assigned to a visible model."),e.data)}(e,this.viewer)}}])&&qe(t.prototype,i),n&&qe(t,n),o}();nt.PUSH_PIN_EXT_NAME="Autodesk.BIM360.Extension.PushPin",Object.assign(nt,a),Autodesk.Viewing.theExtensionManager.registerExtension(nt.PUSH_PIN_EXT_NAME,st)}});
//# sourceMappingURL=Pushpins.min.js.map